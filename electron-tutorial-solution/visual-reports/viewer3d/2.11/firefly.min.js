function getGlobal(){return"undefined"!=typeof window&&null!==window?window:"undefined"!=typeof self&&null!==self?self:global}function getGlobal(){return"undefined"!=typeof window&&null!==window?window:"undefined"!=typeof self&&null!==self?self:global}function trace(a){"\n"==a[a.length-1]&&(a=a.substring(0,a.length-1)),console.log((performance.now()/1e3).toFixed(3)+": "+a)}function init_three_dds_loader(){THREE.DDSLoader=function(){this._parser=THREE.DDSLoader.parse},THREE.DDSLoader.prototype=Object.create(THREE.CompressedTextureLoader.prototype),THREE.DDSLoader.prototype.constructor=THREE.DDSLoader,THREE.DDSLoader.parse=function(a,b){function c(a){return a.charCodeAt(0)+(a.charCodeAt(1)<<8)+(a.charCodeAt(2)<<16)+(a.charCodeAt(3)<<24)}function d(a){return String.fromCharCode(255&a,a>>8&255,a>>16&255,a>>24&255)}function e(a,b,c,d){for(var e=c*d*4,f=new Uint8Array(a,b,e),g=new Uint8Array(e),h=0,i=0,j=0;j<d;j++)for(var k=0;k<c;k++){var l=f[i];i++;var m=f[i];i++;var n=f[i];i++;var o=f[i];i++,g[h]=n,h++,g[h]=m,h++,g[h]=l,h++,g[h]=o,h++}return g}var f={mipmaps:[],width:0,height:0,format:null,mipmapCount:1},g=542327876,h=512,i=4,j=c("DXT1"),k=c("DXT3"),l=c("DXT5"),m=31,n=0,o=1,p=3,q=4,r=7,s=20,t=21,u=22,v=23,w=24,x=25,y=26,z=28,A=new Int32Array(a,0,m);if(A[n]!==g)return console.error("THREE.DDSLoader.parse: Invalid magic number in DDS header."),f;if(!A[s]&i)return console.error("THREE.DDSLoader.parse: Unsupported format, must contain a FourCC code."),f;var B,C=A[t],D=!1;switch(C){case j:B=8,f.format=THREE.RGB_S3TC_DXT1_Format;break;case k:B=16,f.format=THREE.RGBA_S3TC_DXT3_Format;break;case l:B=16,f.format=THREE.RGBA_S3TC_DXT5_Format;break;default:if(!(32==A[u]&&16711680&A[v]&&65280&A[w]&&255&A[x]&&4278190080&A[y]))return console.error("THREE.DDSLoader.parse: Unsupported FourCC code ",d(C)),f;D=!0,B=64,f.format=THREE.RGBAFormat}f.mipmapCount=1,A[r]>0&&b!==!1&&(f.mipmapCount=Math.max(1,A[r])),f.isCubemap=!!(A[z]&h),f.width=A[q],f.height=A[p];for(var E=A[o]+4,F=f.width,G=f.height,H=f.isCubemap?6:1,I=0;I<H;I++){for(var J=0;J<f.mipmapCount;J++){if(D)var K=e(a,E,F,G),L=K.length;else var L=Math.max(4,F)/4*Math.max(4,G)/4*B,K=new Uint8Array(a,E,L);var M={data:K,width:F,height:G};f.mipmaps.push(M),E+=L,F=Math.max(.5*F,1),G=Math.max(.5*G,1)}F=f.width,G=f.height}return f}}function init_three_pvr_loader(){THREE.PVRLoader=function(a){this.manager=void 0!==a?a:THREE.DefaultLoadingManager,this._parser=THREE.PVRLoader.parse},THREE.PVRLoader.prototype=Object.create(THREE.CompressedTextureLoader.prototype),THREE.PVRLoader.prototype.constructor=THREE.PVRLoader,THREE.PVRLoader.parse=function(a,b){var c=13,d=new Uint32Array(a,0,c),e={buffer:a,header:d,loadMipmaps:b};if(55727696===d[0])return THREE.PVRLoader._parseV3(e);if(559044176===d[11])return THREE.PVRLoader._parseV2(e);throw new Error("[THREE.PVRLoader] Unknown PVR format")},THREE.PVRLoader._parseV3=function(a){var b,c,d=a.header,e=d[12],f=d[2],g=d[6],h=d[7],i=(d[9],d[10]),j=d[11];switch(f){case 0:b=2,c=THREE.RGB_PVRTC_2BPPV1_Format;break;case 1:b=2,c=THREE.RGBA_PVRTC_2BPPV1_Format;break;case 2:b=4,c=THREE.RGB_PVRTC_4BPPV1_Format;break;case 3:b=4,c=THREE.RGBA_PVRTC_4BPPV1_Format;break;default:throw new Error("pvrtc - unsupported PVR format "+f)}return a.dataPtr=52+e,a.bpp=b,a.format=c,a.width=h,a.height=g,a.numSurfaces=i,a.numMipmaps=j,a.isCubemap=6===i,THREE.PVRLoader._extract(a)},THREE.PVRLoader._parseV2=function(a){var b,c,d=a.header,e=d[0],f=d[1],g=d[2],h=d[3],i=d[4],b=(d[5],d[6]),j=(d[7],d[8],d[9],d[10]),k=(d[11],d[12]),l=255,m=24,n=25,o=i&l,p=j>0;if(o===n)c=p?THREE.RGBA_PVRTC_4BPPV1_Format:THREE.RGB_PVRTC_4BPPV1_Format,b=4;else{if(o!==m)throw new Error("pvrtc - unknown format "+o);c=p?THREE.RGBA_PVRTC_2BPPV1_Format:THREE.RGB_PVRTC_2BPPV1_Format,b=2}return a.dataPtr=e,a.bpp=b,a.format=c,a.width=g,a.height=f,a.numSurfaces=k,a.numMipmaps=h+1,a.isCubemap=6===k,THREE.PVRLoader._extract(a)},THREE.PVRLoader._extract=function(a){var b={mipmaps:[],width:a.width,height:a.height,format:a.format,mipmapCount:a.numMipmaps,isCubemap:a.isCubemap},c=a.buffer,d=a.dataPtr,e=a.bpp,f=a.numSurfaces,g=0,h=0,i=0,j=0,k=0,l=0;2===e?(i=8,j=4):(i=4,j=4),h=i*j*e/8,b.mipmaps.length=a.numMipmaps*f;for(var m=0;m<a.numMipmaps;){var n=a.width>>m,o=a.height>>m;k=n/i,l=o/j,k<2&&(k=2),l<2&&(l=2),g=k*l*h;for(var p=0;p<f;p++){var q=new Uint8Array(c,d,g),r={data:q,width:n,height:o};b.mipmaps[p*a.numMipmaps+m]=r,d+=g}m++}return b}}function init_three_triangulator(){"use strict";Autodesk.Viewing.Private.Triangulator||(Autodesk.Viewing.Private.Triangulator=function(){function a(a,b,c){var d=a<b?a+":"+b:b+":"+a;return c+":"+d}function b(b,c,d,e,f,g,h){this.pt1=b,this.pt2=c,this.p1=-1,this.p2=-1,this.eid1=a(d,e,h),this.eid2=a(f,g,h)}function c(){this.bbox=new THREE.Box2,this.left=null,this.right=null,this.node_edges=[]}function d(a,b,c){this.pts=a,this.edges=b,this.bbox=c,this.pipResult=!1}function e(a,b){this.edges=a,this.bbox=b,this.pts=[],this.idmap={},this.xymap={},this.contours=[],this.scale=1e6/this.bbox.size().length()}function f(a){this.indices=[],this.cset=a;var b=this.pts=a.pts;this.intervalTree=new d(a.pts,a.edges,a.bbox),this.intervalTree.build();for(var c=0;c<b.length;c++)b[c].id=c;var e=new lmv_poly2tri.SweepContext([]);if(e.points_=b.slice(),a.contours)for(var f=this.cset.contours,g=0;g<f.length;g++){for(var h=f[g],i=h[0]!==h[h.length-1],j=[],k=0;k<h.length-1;k++)j.push(b[h[k]]);e.initEdges(j,i)}else for(var l=this.cset.edges,c=0;c<l.length;c++){var m=l[c];if(m.p1!=m.p2){var n=[b[m.p1],b[m.p2]];e.initEdges(n,!0)}}this.triangulate(e),this.processResult(e)}var g=Autodesk.Viewing.Private;return d.prototype.splitNode=function(a){if(!(a.bbox.min.y>=a.bbox.max.y||a.node_edges.length<3)){var b=.5*(a.bbox.min.y+a.bbox.max.y);a.left=new c,a.right=new c;for(var d=this.pts,e=a.node_edges,f=[],g=new THREE.Vector2,h=0;h<e.length;h++){var i=this.edges[e[h]],j=d[i.p1].y,k=d[i.p2].y;if(j>k){var l=j;j=k,k=l}var m=null;k<b?(a.left.node_edges.push(e[h]),m=a.left.bbox):j>b?(a.right.node_edges.push(e[h]),m=a.right.bbox):f.push(e[h]),m&&(g.set(d[i.p1].x,d[i.p1].y),m.expandByPoint(g),g.set(d[i.p2].x,d[i.p2].y),m.expandByPoint(g))}a.node_edges=f,a.left.node_edges.length&&this.splitNode(a.left),a.right.node_edges.length&&this.splitNode(a.right)}},d.prototype.build=function(){this.root=new c;for(var a=this.root.node_edges,b=0;b<this.edges.length;b++)a.push(b);this.root.bbox.copy(this.bbox),this.splitNode(this.root)},d.prototype.pointInPolygonRec=function(a,b,c){if(a.bbox.min.y<=c&&a.bbox.max.y>=c)for(var d=this.pts,e=a.node_edges,f=0,g=e.length;f<g;f++){var h=this.edges[e[f]],i=d[h.p1],j=i.x,k=i.y,l=k>=c,m=d[h.p2],n=m.x,o=m.y,p=o>=c;l!=p&&(o-c)*(j-n)>=(n-b)*(k-o)==p&&(this.pipResult=!this.pipResult)}var q=a.left;q&&q.bbox.min.y<=c&&q.bbox.max.y>=c&&this.pointInPolygonRec(q,b,c);var r=a.right;r&&r.bbox.min.y<=c&&r.bbox.max.y>=c&&this.pointInPolygonRec(r,b,c)},d.prototype.pointInPolygon=function(a,b){return this.pipResult=!1,this.pointInPolygonRec(this.root,a,b),this.pipResult},e.prototype.getPointIndex=function(a,b,c){var d=this.idmap[c];if(void 0!==d)return d;var e,f=0|a*this.scale,g=0|b*this.scale,h=this.xymap[f];return void 0===h?(this.xymap[f]=h={},e=void 0):e=h[g],void 0===e&&(h[g]=e=this.pts.length,this.idmap[c]=e,this.pts.push({x:a,y:b})),e},e.prototype.snapEdges=function(){for(var a=0;a<this.edges.length;a++){var b=this.edges[a];b.p1=this.getPointIndex(b.pt1.x,b.pt1.y,b.eid1),b.p2=this.getPointIndex(b.pt2.x,b.pt2.y,b.eid2)}},e.prototype.sanitizeEdges=function(){for(var a={},b=[],c=0,d=this.edges.length;c<d;c++){var e=this.edges[c];if(e.p1!==e.p2){var f=Math.min(e.p1,e.p2)+":"+Math.max(e.p1,e.p2);a[f]!==!0&&(a[f]=!0,b.push(e))}}this.edges=b},e.prototype.stitchContours=function(){for(var a={},b=0;b<this.edges.length;b++){var c=this.edges[b];c.p1!==c.p2&&(void 0!==a[c.p1]?a[c.p1].push(c.p2):a[c.p1]=[c.p2],void 0!==a[c.p2]?a[c.p2].push(c.p1):a[c.p2]=[c.p1])}var d=[];for(var e in a)if(2!==a[e].length){g.logger.warn("Incomplete edge table");break}for(;;){var f=void 0;for(var e in a)if(a[e].length>1){f=e;break}if(!f)for(var e in a)if(a[e].length>0){f=e;break}if(!f)break;var h=-1,i=parseInt(f),j=a[f];for(d.push(i);j&&j.length;){var k=j.shift();if(k===h&&(k=j.shift()),void 0===k){delete a[i];break}d.push(k),0==j.length?delete a[i]:j[0]===h&&delete a[i],h=i,i=k,j=a[k]}d.length&&(this.contours.push(d),d=[])}for(var l=[],b=0;b<this.contours.length;b++){var m=this.contours[b];m[0]!==m[m.length-1]&&l.push(m)}if(l.length)for(var n=!0;n;){n=!1;for(var o={},p=this.contours,b=0;b<p.length;b++){var m=p[b],q=m[0],r=m[m.length-1];q!==r&&(o[q]?o[q].push(-b-1):o[q]=[-b-1],o[r]?o[r].push(b):o[r]=[b])}for(var e in o){var s=o[e];if(2==s.length){var t=void 0;if(s[0]<0&&s[1]<0){var u=-s[0]-1,v=-s[1]-1;p[v].shift(),Array.prototype.push.apply(p[u].reverse(),p[v]),t=v}if(s[0]<0&&s[1]>0){var u=-s[0]-1,v=s[1];p[v].pop(),Array.prototype.push.apply(p[v],p[u]),t=u}if(s[0]>0&&s[1]<0){var u=s[0],v=-s[1]-1;p[u].pop(),Array.prototype.push.apply(p[u],p[v]),t=v}if(s[0]>0&&s[1]>0){var u=s[0],v=s[1];p[u].pop(),Array.prototype.push.apply(p[u],p[v].reverse()),t=v}void 0!==t&&(p.splice(t,1),n=!0);break}}}},f.prototype.triangulate=function(a){try{a.triangulate()}catch(a){}},f.prototype.processResult=function(a){for(var b=0;b<a.map_.length;b++){var c=a.map_[b],d=c.points_[0],e=c.points_[1],f=c.points_[2];void 0!==d.id&&void 0!==e.id&&void 0!==f.id&&this.filterFace(d.id,e.id,f.id)}},f.prototype.pointInEdgeList=function(a,b){for(var c,d,e,f,g,h,i=this.cset.pts,j=this.cset.edges,k=!1,l=0,m=j.length;l<m;++l){var n=j[l];e=i[n.p1].x,f=i[n.p1].y,c=f>=b,g=i[n.p2].x,h=i[n.p2].y,d=h>=b,c!=d&&(h-b)*(e-g)>=(g-a)*(f-h)==d&&(k=!k)}return k},f.prototype.pointInContour=function(a,b,c){var d,e,f,g,h,i,j=!1,k=this.cset.pts;f=k[c[c.length-1]].x,g=k[c[c.length-1]].y,d=g>=b;for(var l=0,m=c.length;l<m;++l)h=k[c[l]].x,i=k[c[l]].y,e=i>=b,d!=e&&(i-b)*(f-h)>=(h-a)*(g-i)==e&&(j=!j),d=e,f=h,g=i;return j},f.prototype.pointInPolygon=function(a,b){for(var c=!1,d=0;d<this.cset.contours.length;d++)this.pointInContour(a,b,this.cset.contours[d])&&(c=!c);return c},f.prototype.filterFace=function(a,b,c){var d=this.pts[a],e=this.pts[b],f=this.pts[c],g=(d.x+e.x+f.x)/3,h=(d.y+e.y+f.y)/3;if(this.intervalTree.pointInPolygon(g,h)){var i=e.x-d.x,j=e.y-d.y,k=f.x-d.x,l=f.y-d.y,m=i*l-k*j;m>0?this.indices.push(a,b,c):this.indices.push(a,c,b)}},{TriangulatedSurface:f,ContourSet:e,Edge:b}}())}function init_three_intersector(){"use strict";Autodesk.Viewing.Private.Intersector||(Autodesk.Viewing.Private.Intersector=function(){function a(a){return Math.abs(a)<j}function b(b,c,d,e,f){var g=l.subVectors(d,c),h=b.normal.dot(g);if(a(h))return e.copy(c),f.copy(d),2;h=1/h;var i=-(c.dot(b.normal)*h+b.constant*h);if(i<-j||i>1+j)return 0;var k=g.multiplyScalar(i).add(c);return e.copy(k),1}function c(a,c,d,e,f,g,h,l,o){var p=a.distanceToPoint(c),q=a.distanceToPoint(d),r=a.distanceToPoint(e);if(p<-j&&q<-j&&r<-j)return null;if(p>j&&q>j&&r>j)return null;var s=Math.sign(p),t=Math.sign(q),u=Math.sign(r);if(0===s&&0===t&&0===u)return null;var v,w,x,y,z,A;if(s!==t){var B=b(a,c,d,m,n);if(2==B)return void l.push(new k(c.clone(),d.clone(),f,f,g,g,o));1==B?(x=f,y=g,v=m.clone()):i.logger.warn("Unexpected zero intersections where at least one was expected")}if(t!==u){var B=b(a,d,e,m,n);if(2==B)return void l.push(new k(d.clone(),e.clone(),g,g,h,h,o));1==B?v?m.distanceTo(v)>j&&(z=g,A=h,w=m.clone()):(x=g,y=h,v=m.clone()):i.logger.warn("Unexpected zero intersections where at least one was expected")}if(u!==s){var B=b(a,e,c,m,n);if(2==B)return void l.push(new k(e.clone(),c.clone(),h,h,f,f,o));1==B?v?m.distanceTo(v)>j&&(z=h,A=f,w=m.clone()):i.logger.warn("Unexpected single intersection point"):i.logger.warn("Unexpected zero intersections where at least one was expected")}v&&w?l.push(new k(v,w,x,y,z,A,o)):i.logger.warn("Unexpected one intersection where two were expected")}function d(a,b){o.set(b.min.x,b.min.y,b.min.z);var c=a.distanceToPoint(o),d=Math.sign(c);o.set(b.min.x,b.min.y,b.max.z);var e=a.distanceToPoint(o);return Math.sign(e)!==d||(o.set(b.min.x,b.max.y,b.min.z),e=a.distanceToPoint(o),Math.sign(e)!==d||(o.set(b.min.x,b.max.y,b.max.z),e=a.distanceToPoint(o),Math.sign(e)!==d||(o.set(b.max.x,b.min.y,b.min.z),e=a.distanceToPoint(o),Math.sign(e)!==d||(o.set(b.max.x,b.min.y,b.max.z),e=a.distanceToPoint(o),Math.sign(e)!==d||(o.set(b.max.x,b.max.y,b.min.z),e=a.distanceToPoint(o),Math.sign(e)!==d||(o.set(b.max.x,b.max.y,b.max.z),e=a.distanceToPoint(o),Math.sign(e)!==d))))))}function e(a,b,d){var e=b.geometry,f=d.length,g=e.attributes,h=b.matrixWorld;s.getInverse(h),t.copy(a).applyMatrix4(s);var i,j,k;if(void 0!==g.index){var l=g.index.array||e.ib,m=e.vb?e.vb:g.position.array,n=e.vb?e.vbstride:3,o=e.offsets;o&&0!==o.length||(o=[{start:0,count:l.length,index:0}]);for(var u=0,v=o.length;u<v;++u)for(var w=o[u].start,x=o[u].count,y=o[u].index,z=w,A=w+x;z<A;z+=3)i=y+l[z],j=y+l[z+1],k=y+l[z+2],p.x=m[i*n],p.y=m[i*n+1],p.z=m[i*n+2],q.x=m[j*n],q.y=m[j*n+1],q.z=m[j*n+2],r.x=m[k*n],r.y=m[k*n+1],r.z=m[k*n+2],c(t,p,q,r,i,j,k,d,b.fragId)}else for(var m=e.vb?e.vb:g.position.array,n=e.vb?e.vbstride:3,z=0,B=0,A=m.length;z<A;z+=3,B+=9)i=z,j=z+1,k=z+2,p.x=m[i*n],p.y=m[i*n+1],p.z=m[i*n+2],q.x=m[j*n],q.y=m[j*n+1],q.z=m[j*n+2],r.x=m[k*n],r.y=m[k*n+1],r.z=m[k*n+2],c(t,p,q,r,i,j,k,d,b.fragId);for(var z=f;z<d.length;z++)d[z].pt1.applyMatrix4(h),d[z].pt2.applyMatrix4(h)}function f(a,b,c){var d=b,e=Math.sqrt(1-d*d),f=1-d,g=a.x,h=a.y,i=a.z,j=f*g,k=f*h;c.set(j*g+d,j*h-e*i,j*i+e*h,0,j*h+e*i,k*h+d,k*i-e*g,0,j*i-e*h,k*i+e*g,f*i*i+d,0,0,0,0,1)}function g(b){var c=new THREE.Vector3(0,0,1),d=b.normal.clone().cross(c);d=d.normalize();var e=c.dot(b.normal),g=new THREE.Matrix4;return a(d.x)&&a(d.y)&&a(d.z)?g.elements[14]=e*b.constant:(f(d,e,g),g.elements[14]=b.constant),g}function h(a,b,c){for(var d=0;d<b.length;d++){var e=b[d];e.pt1.applyMatrix4(a),e.pt2.applyMatrix4(a),c.expandByPoint(e.pt1),c.expandByPoint(e.pt2)}}var i=Autodesk.Viewing.Private,j=1e-10,k=Autodesk.Viewing.Private.Triangulator.Edge,l=new THREE.Vector3,m=new THREE.Vector3,n=new THREE.Vector3,o=new THREE.Vector3,p=new THREE.Vector3,q=new THREE.Vector3,r=new THREE.Vector3,s=new THREE.Matrix4,t=new THREE.Plane;return{makePlaneBasis:g,convertToPlaneCoords:h,intersectTrianglePlane:c,intersectMeshPlane:e,intersectBoxPlane:d}}())}function MobileCallbacks(){this.ios=window.webkit,this.android=window.JSINTERFACE,this.iosSend=function(a,b){window.webkit.messageHandlers.callbackHandler.postMessage({command:a,data:b})},this.androidSend=window.JSINTERFACE}var AutodeskNamespace=function(a){for(var b=getGlobal(),c=a.split("."),d=0;d<c.length;++d)b[c[d]]=b[c[d]]||{},b=b[c[d]];return b};AutodeskNamespace("Autodesk.Viewing.Private"),AutodeskNamespace("Autodesk.Viewing.Extensions"),AutodeskNamespace("Autodesk.Viewing.Shaders"),AutodeskNamespace("Autodesk.Viewing.UI"),AutodeskNamespace("Autodesk.LMVTK"),Autodesk.Viewing.getGlobal=getGlobal,Autodesk.Viewing.AutodeskNamespace=AutodeskNamespace,Autodesk.Viewing.Private.initializeLegacyNamespaces=function(a){var b=Autodesk.Viewing,c=b.Shaders,d=b.Private;d.InstanceTreeStorage=WGS.InstanceTreeStorage,d.InstanceTreeAccess=WGS.InstanceTreeAccess,d.BVHBuilder=WGS.BVHBuilder,d.NodeArray=WGS.NodeArray,a||(c.PackDepthShaderChunk=WGS.PackDepthShaderChunk,c.TonemapShaderChunk=WGS.TonemapShaderChunk,c.OrderedDitheringShaderChunk=WGS.OrderedDitheringShaderChunk,c.CutPlanesUniforms=WGS.CutPlanesUniforms,c.CutPlanesShaderChunk=WGS.CutPlanesShaderChunk,c.PackNormalsShaderChunk=WGS.PackNormalsShaderChunk,c.HatchPatternShaderChunk=WGS.HatchPatternShaderChunk,c.EnvSamplingShaderChunk=WGS.EnvSamplingShaderChunk,c.IdUniforms=WGS.IdUniforms,c.IdFragmentDeclaration=WGS.IdFragmentDeclaration,c.IdOutputShaderChunk=WGS.IdOutputShaderChunk,c.FinalOutputShaderChunk=WGS.FinalOutputShaderChunk,c.ThemingUniform=WGS.ThemingUniform,c.ThemingFragmentDeclaration=WGS.ThemingFragmentDeclaration,c.ThemingFragmentShaderChunk=WGS.ThemingFragmentShaderChunk,c.BackgroundShader=WGS.BackgroundShader,c.BlendShader=WGS.BlendShader,c.CelShader=WGS.CelShader,c.CopyShader=WGS.CopyShader,c.FXAAShader=WGS.FXAAShader,c.SAOBlurShader=WGS.SAOBlurShader,c.SAOMinifyFirstShader=WGS.SAOMinifyFirstShader,c.SAOMinifyShader=WGS.SAOMinifyShader,c.SAOShader=WGS.SAOShader,c.NormalsShader=WGS.NormalsShader,c.LineShader=WGS.LineShader,d.LineStyleDefs=WGS.LineStyleDefs,d.CreateLinePatternTexture=WGS.CreateLinePatternTexture,d.FloatToHalf=WGS.FloatToHalf,d.HalfToFloat=WGS.HalfToFloat,d.IntToHalf=WGS.IntToHalf,d.HalfToInt=WGS.HalfToInt,d.HalfTest=WGS.HalfTest,c.createShaderMaterial=WGS.createShaderMaterial,c.setMacro=WGS.setMacro,c.removeMacro=WGS.removeMacro,c.LmvShaderPass=WGS.ShaderPass,c.GaussianPass=WGS.GaussianPass,c.GroundShadow=WGS.GroundShadow,c.createGroundShape=WGS.createGroundShape,c.setGroundShapeTransform=WGS.setGroundShapeTransform,c.GroundReflection=WGS.GroundReflection,d.FireflyWebGLShader=WGS.WebGLShader,d.PrismMaps=WGS.PrismMaps,d.GetPrismMapChunk=WGS.GetPrismMapChunk,d.FireflyWebGLProgram=WGS.WebGLProgram,c.ShadowMapCommonUniforms=WGS.ShadowMapCommonUniforms,c.ShadowMapUniforms=WGS.ShadowMapUniforms,c.ShadowMapDeclareCommonUniforms=WGS.ShadowMapDeclareCommonUniforms,c.ShadowMapVertexDeclaration=WGS.ShadowMapVertexDeclaration,c.ShadowMapVertexShaderChunk=WGS.ShadowMapVertexShaderChunk,c.ShadowMapFragmentDeclaration=WGS.ShadowMapFragmentDeclaration,c.FireflyPhongShader=WGS.PhongShader,c.PrismShader=WGS.PrismShader,c.GetPrismMapUniforms=WGS.GetPrismMapUniforms,c.GetPrismMapSampleChunk=WGS.GetPrismMapSampleChunk,c.GetPrismMapUniformChunk=WGS.GetPrismMapUniformChunk,c.AverageOfFloat3=WGS.AverageOfFloat3,d.createPrismMaterial=WGS.createPrismMaterial,d.clonePrismMaterial=WGS.clonePrismMaterial,d.ShadowMapShader=WGS.ShadowMapShader,d.GroundShadowShader=WGS.GroundShadowShader,d.ShadowMapOverrideMaterials=WGS.ShadowMapOverrideMaterials,d.SHADOWMAP_NEEDS_UPDATE=WGS.SHADOWMAP_NEEDS_UPDATE,d.SHADOWMAP_INCOMPLETE=WGS.SHADOWMAP_INCOMPLETE,d.SHADOWMAP_VALID=WGS.SHADOWMAP_VALID,d.ShadowConfig=WGS.ShadowConfig,d.ShadowRender=WGS.ShadowRender,d.ShadowMaps=WGS.ShadowMaps,d.FrustumIntersector=WGS.FrustumIntersector,d.OUTSIDE=WGS.OUTSIDE,d.INTERSECTS=WGS.INTERSECTS,d.CONTAINS=WGS.CONTAINS,d.VBIntersector=WGS.VBIntersector,d.memoryOptimizedLoading=WGS.memoryOptimizedLoading,d.GPU_MEMORY_LIMIT=WGS.GPU_MEMORY_LIMIT,d.GPU_OBJECT_LIMIT=WGS.GPU_OBJECT_LIMIT,d.FRAGS_PERSISTENT_COUNT=WGS.FRAGS_PERSISTENT_COUNT,d.FRAGS_PERSISTENT_MAX_COUNT=WGS.FRAGS_PERSISTENT_MAX_COUNT,d.GEOMS_COUNT_LIMIT=WGS.GEOMS_COUNT_LIMIT,d.onDemandLoading=WGS.onDemandLoading,d.cullGeometryOnLoading=WGS.cullGeometryOnLoading,d.pageOutGeometryEnabled=WGS.pageOutGeometryEnabled,d.PAGEOUT_SUCCESS=WGS.PAGEOUT_SUCCESS,d.PAGEOUT_FAIL=WGS.PAGEOUT_FAIL,d.PAGEOUT_NONE=WGS.PAGEOUT_NONE,d.PAGEOUT_PERCENTAGE=WGS.PAGEOUT_PERCENTAGE,d.GEOMS_PAGEOUT_COUNT=WGS.GEOMS_PAGEOUT_COUNT,d.GeometryList=WGS.GeometryList,d.MESH_VISIBLE=WGS.MESH_VISIBLE,d.MESH_HIGHLIGHTED=WGS.MESH_HIGHLIGHTED,d.MESH_HIDE=WGS.MESH_HIDE,d.MESH_ISLINE=WGS.MESH_ISLINE,d.MESH_MOVED=WGS.MESH_MOVED,d.MESH_TRAVERSED=WGS.MESH_TRAVERSED,d.MESH_RENDERFLAG=WGS.MESH_RENDERFLAG,d.FragmentPointer=WGS.FragmentPointer,d.FragmentList=WGS.FragmentList,d.RENDER_NORMAL=WGS.RENDER_NORMAL,d.RENDER_HIGHLIGHTED=WGS.RENDER_HIGHLIGHTED,d.RENDER_HIDDEN=WGS.RENDER_HIDDEN,d.RENDER_SHADOWMAP=WGS.RENDER_SHADOWMAP,d.RENDER_FINISHED=WGS.RENDER_FINISHED,d.RenderBatch=WGS.RenderBatch,b.rescueFromPolymer=WGS.rescueFromPolymer,d.FireflyWebGLRenderer=WGS.WebGLRenderer,d.ModelIteratorLinear=WGS.ModelIteratorLinear,d.ModelIteratorBVH=WGS.ModelIteratorBVH,d.BufferGeometryUtils=WGS.BufferGeometry,d.RenderScene=WGS.RenderScene,d.SortedList=WGS.SortedList,d.ModelIteratorTexQuad=WGS.ModelIteratorTexQuad,d.TexQuadConfig=WGS.TexQuadConfig,d.InstanceTree=WGS.InstanceTree,b.SelectionMode=WGS.SelectionMode,d.MaterialConverter=WGS.MaterialConverter)};var av=Autodesk.Viewing,avp=av.Private;av.getGlobal=getGlobal;var isBrowser=av.isBrowser="undefined"!=typeof navigator,isIE11=av.isIE11=isBrowser&&!!navigator.userAgent.match(/Trident\/7\./);"undefined"!=typeof window&&isIE11&&!function(){function a(a,b){b=b||{bubbles:!1,cancelable:!1,detail:void 0};var c=document.createEvent("CustomEvent");return c.initCustomEvent(a,b.bubbles,b.cancelable,b.detail),c}a.prototype=window.CustomEvent.prototype,window.CustomEvent=a}(),ArrayBuffer.prototype.slice||(ArrayBuffer.prototype.slice=function(a,b){if(!b||b>this.byteLength?b=this.byteLength:b<0&&(b=this.byteLength+b,b<0&&(b=0)),a<0&&(a=this.byteLength+a,a<0&&(a=0)),b<=a)return new ArrayBuffer;for(var c=b-a,d=new Uint8Array(this,a,c),e=new Uint8Array(c),f=0;f<c;f++)e[f]=d[f];return e.buffer}),function(){Math.log2=Math.log2||function(a){return Math.log(a)/Math.LN2}}(),"undefined"!=typeof window&&(window.BlobBuilder=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder);var launchFullscreen=av.launchFullscreen=function(a,b){a.requestFullscreen?a.requestFullscreen(b):a.mozRequestFullScreen?a.mozRequestFullScreen(b):a.webkitRequestFullscreen?a.webkitRequestFullscreen(b):a.msRequestFullscreen&&a.msRequestFullscreen(b)},exitFullscreen=av.exitFullscreen=function(){document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen()},inFullscreen=av.inFullscreen=function(){return"webkitIsFullScreen"in document?document.webkitIsFullScreen:!!(document.mozFullScreenElement||document.msFullscreenElement||document.fullscreenEnabled||document.querySelector(".viewer-fill-browser"))},fullscreenElement=av.fullscreenElement=function(){return document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement},isFullscreenAvailable=av.isFullscreenAvailable=function(a){return a.requestFullscreen||a.mozRequestFullScreen||a.webkitRequestFullscreen||a.msRequestFullscreen},getAndroidVersion=av.getAndroidVersion=function(a){var a=a||navigator.userAgent,b=a.match(/Android\s([0-9\.]*)/);return!!b&&b[1]},isTouchDevice=av.isTouchDevice=function(){return"undefined"!=typeof window&&"ontouchstart"in window};av.isIOSDevice=function(){return!!isBrowser&&/ip(ad|hone|od)/.test(navigator.userAgent.toLowerCase())},av.isAndroidDevice=function(){return!!isBrowser&&navigator.userAgent.toLowerCase().indexOf("android")!==-1},av.isMobileDevice=function(){return!!isBrowser&&(av.isIOSDevice()||av.isAndroidDevice())},av.isSafari=function(){if(!isBrowser)return!1;var a=navigator.userAgent.toLowerCase();return a.indexOf("safari")!==-1&&a.indexOf("chrome")===-1},av.isFirefox=function(){if(!isBrowser)return!1;var a=navigator.userAgent.toLowerCase();return a.indexOf("firefox")!==-1},av.isMac=function(){if(!isBrowser)return!1;var a=navigator.userAgent.toLowerCase();return a.indexOf("mac os")!==-1},av.isWindows=function(){if(!isBrowser)return!1;var a=navigator.userAgent.toLowerCase();return a.indexOf("win32")!==-1||a.indexOf("windows")!==-1};var detectWebGL=av.detectWebGL=function(){if(window.WebGLRenderingContext){for(var a=document.createElement("canvas"),b=["webgl","experimental-webgl","moz-webgl","webkit-3d"],c=!1,d=0;d<4;d++)try{if(c=a.getContext(b[d]),c=rescueFromPolymer(c),c&&"function"==typeof c.getParameter)return 1}catch(a){}return 0}return-1},touchStartToClick=av.touchStartToClick=function(a){a.preventDefault(),a.stopPropagation(),a.target.click()};!function(){var a=getGlobal();a.performance||(a.performance=Date)}();var av=Autodesk.Viewing,avp=Autodesk.Viewing.Private;if(avp.BUILD_LMV_WORKER_URL="lmvworker.js",avp.LMV_WORKER_URL=avp.BUILD_LMV_WORKER_URL,avp.ENABLE_DEBUG=avp.ENABLE_DEBUG||!1,avp.ENABLE_TRACE=avp.ENABLE_TRACE||!1,avp.ENABLE_INLINE_WORKER=!0,function(){"use strict";function a(){this.adp=null,this.runtimeStats={},this.level=-1,this.setLevel(d.ENABLE_TRACE?d.LogLevels.DEBUG:d.LogLevels.ERROR)}function b(){return"undefined"!=typeof window?encodeURI(window.location.href):""}var c=Autodesk.Viewing,d=Autodesk.Viewing.Private;d.LogLevels={DEBUG:5,LOG:4,INFO:3,WARNING:2,ERROR:1,NONE:0},a.prototype.initialize=function(a){if(a.eventCallback&&(this.callback=a.eventCallback),this.sessionId=a.sessionId,!this.sessionId){var e=Date.now()+"";this.sessionId=parseFloat((1e4*Math.random()|0)+""+e.substring(4))}this.environmentInfo={touch:c.isTouchDevice(),env:d.env,referer:b(),version:LMV_VIEWER_VERSION,patch:LMV_VIEWER_PATCH,build_type:LMV_BUILD_TYPE};var f={category:"viewer_start",touch:this.environmentInfo.touch,env:this.environmentInfo.env,referer:this.environmentInfo.referer,version:this.environmentInfo.version,patch:this.environmentInfo.patch,build_type:this.environmentInfo.build_type};this.track(f);var g=this;this.interval=setInterval(function(){g.reportRuntimeStats()},6e4)},a.prototype.shutdown=function(){clearInterval(this.interval),this.interval=void 0},a.prototype.track=function(a){if(this.updateRuntimeStats(a),!d.offline&&this.sessionId){a.timestamp=Date.now(),a.sessionId=this.sessionId;var b=this.logToADP(a);this.callback&&this.callback(a,{adp:b})}},a.prototype.logToADP=function(a){if(!this.adp)return!1;var c="",d="";switch(a.category){case"tool_changed":case"pref_changed":c="CLICK_OPERATION",d=a.category+"/"+a.name;break;case"screen_mode":c="CLICK_OPERATION",d="pref_changed/"+a.category;break;case"metadata_load_stats":c="DOCUMENT_START",d="stats",a.full_url=b();break;case"model_load_stats":c="DOCUMENT_FULL",d="stats";break;case"error":c="BACKGROUND_CALL",d="error"}return!!c&&(this.adp.trackEvent(c,{operation:{id:a.sessionId,type:d,stage:"",status:"C",meta:a}}),!0)},a.prototype.updateRuntimeStats=function(a){if(a.hasOwnProperty("aggregate"))switch(a.aggregate){case"count":this.runtimeStats[a.name]>0?this.runtimeStats[a.name]++:this.runtimeStats[a.name]=1,this.runtimeStats._nonempty=!0;break;case"last":this.runtimeStats[a.name]=a.value,this.runtimeStats._nonempty=!0;break;default:this.warn("unknown log aggregate type")}},a.prototype.reportRuntimeStats=function(){this.runtimeStats._nonempty&&(delete this.runtimeStats._nonempty,this.adp&&this.adp.trackEvent("BACKGROUND_CALL",{operation:{id:this.sessionId,type:"stats",stage:"",status:"C",meta:this.runtimeStats}}),this.runtimeStats.category="misc_stats",this.track(this.runtimeStats),this.runtimeStats={})},a.prototype.setLevel=function(a){if(this.level!==a){this.level=a;var b=function(){},c=d.LogLevels;this.debug=a>=c.DEBUG?console.log.bind(console):b,this.log=a>=c.LOG?console.log.bind(console):b,this.info=a>=c.INFO?console.info.bind(console):b,this.warn=a>=c.WARNING?console.warn.bind(console):b,this.error=a>=c.ERROR?console.error.bind(console):b}},Autodesk.Viewing.Private.logger=new a}(),function(){"use strict";function a(a){var b=a.split("/");if(0==b.length)return a;for(var c=[],d=0;d<b.length;++d){var e=b[d];"."!==e&&(".."===e&&c.length?c.pop():c.push(e))}return 0==c.length?"":c.join("/")}function b(a,b){for(var c=a.length-b,d=new ArrayBuffer(c),e=new Uint8Array(d,0),f=0,g=b;f<c;f++,g++)e[f]=255&a.charCodeAt(g);return e}function c(a,b){return b.indexOf("file://")===-1&&(b.indexOf("://")!==-1||(!!a||void 0))}function d(a,b,c,d){function e(a){if("json"==d.responseType)try{return JSON.parse(a.toString("utf8"))}catch(a){c(a)}return a}0===a.indexOf("file://")&&(a=a.substr(7)),require("fs").readFile(a,function(f,g){f?c(0,0,{httpStatusText:f,url:a}):31==g[0]&&139==g[1]?require("zlib").gunzip(g,null,function(f,g){f?c(0,0,{httpStatusText:f,url:a}):(g=e(g),d.ondata&&d.ondata(g),b(g))}):(g=e(g),d.ondata&&d.ondata(g),b(g))})}function e(a,b){b.hasOwnProperty("asynchronous")?b.asynchronous||g.logger.warn("LMV: Sync XHR used. Performance warning."):b.asynchronous=!0,b.hasOwnProperty("responseType")||(b.responseType="arraybuffer"),b.withCredentials=!!a.auth,b.headers=a.headers,b.queryParams=a.queryParams,b.endpoint=a.endpoint}var f=Autodesk.Viewing,g=f.Private;g.inWorkerThread="undefined"!=typeof self&&"undefined"==typeof window;var h;"undefined"!=typeof XMLHttpRequest?h=XMLHttpRequest:(h=require("xhr2"),h.prototype._restrictedHeaders.cookie=!1);var i={},j=!1;i.OSS_PREFIX="urn:adsk.objects:os.object:",i.getDirectOSSUrl=function(b,c){var d=c.indexOf(i.OSS_PREFIX);if(d!==-1){var e=c.substr(d+i.OSS_PREFIX.length),g=e.substr(0,e.indexOf("/")),h=e.substr(e.indexOf("/")+1);return h=a(h),f.makeOssPath(b.endpoint,g,h)}},i.generateUrl=function(b,c,d){if(d=a(d),0!==decodeURIComponent(d).indexOf("urn:"))return d;switch("items"!==c&&(d=d.substr(4)),c){case"items":return f.getItemApi(b)+d;case"bubbles":return f.getManifestApi(b)+d;case"thumbnails":return f.getThumbnailApi(b)+d}},i.rawGet=function(a,e,k,l,m,n){function o(a){m&&m(r.status,r.statusText,{url:k})}function p(a){if(200===r.status)if(r.response&&r.response instanceof ArrayBuffer){var b=new Uint8Array(r.response);if(!n.skipDecompress&&31==b[0]&&139==b[1]){j||(j=!0,g.logger.warn("An LMV resource ("+k+") was not uncompressed by the browser. This hurts performance. Check the Content-Encoding header returned by the server and check whether you're getting double-compressed streams. The warning prints only once but it's likely the problem affects multiple resources."));try{b=new Zlib.Gunzip(b).decompress()}catch(a){m(f.ErrorCodes.BAD_DATA,"Malformed data received when requesting file",{url:k,exception:a.toString(),stack:a.stack})}}l(b)}else l(r.response||r.responseText);else o(a)}var n=n?n:{};if(f.isNodeJS&&!c(a,k))return void d(k,l,m,n);var q=i.getDirectOSSUrl(n,k);k=q?q:i.generateUrl(a,e,k),n.queryParams&&(k=k+"?"+n.queryParams);var r=new h;try{var s=!n.hasOwnProperty("asynchronous")||n.asynchronous;if(r.open(n.noBody?"HEAD":"GET",k,s),n.hasOwnProperty("responseType")&&(r.responseType=n.responseType),r.withCredentials=!0,n.hasOwnProperty("withCredentials")&&(r.withCredentials=n.withCredentials),n.headers)for(var t in n.headers)r.setRequestHeader(t,n.headers[t]),"authorization"===t.toLocaleLowerCase()&&(r.withCredentials=!1);s&&(r.onload=p,r.onerror=o,r.ontimeout=o,n.ondata&&(r.overrideMimeType("text/plain; charset=x-user-defined"),n._dlProgress={streamOffset:0,counter:0},r.onreadystatechange=function(){if(r.readyState>2){var a=r.responseText;if(n._dlProgress.streamOffset>=a.length)return;var c=b(a,n._dlProgress.streamOffset);n._dlProgress.streamOffset=a.length,n.ondata(c)}})),r.send(),n.skipAssetCallback||(g.inWorkerThread?self.postMessage({assetRequest:[k,n.headers,null]}):g.assets.push([k,n.headers,null])),s||p()}catch(a){m(r.status,r.statusText,{url:k,exception:a})}},i.defaultFailureCallback=function(a,b,c){403==a?this.raiseError(f.ErrorCodes.NETWORK_ACCESS_DENIED,"Access denied to remote resource",{url:c.url,httpStatus:a,httpStatusText:b}):404==a?this.raiseError(f.ErrorCodes.NETWORK_FILE_NOT_FOUND,"Remote resource not found",{url:c.url,httpStatus:a,httpStatusText:b}):a>=500&&a<600?this.raiseError(f.ErrorCodes.NETWORK_SERVER_ERROR,"Server error when accessing resource",{url:c.url,httpStatus:a,httpStatusText:b}):c.exception?this.raiseError(f.ErrorCodes.NETWORK_FAILURE,"Network failure",{url:c.url,exception:c.exception.toString(),stack:c.exception.stack}):this.raiseError(f.ErrorCodes.NETWORK_UNHANDLED_RESPONSE_CODE,"Unhandled response code from server",{url:c.url,httpStatus:a,httpStatusText:b,data:c})},i.getItem=function(a,b,c,d,f){f=f||{},e(a,f);var g=b.indexOf("urn:"),h=b.indexOf("?");g!==-1&&(b=h!==-1?b.substr(0,g)+encodeURIComponent(b.substring(g,h))+b.substr(h):b.substr(0,g)+encodeURIComponent(b.substr(g))),i.rawGet(a.endpoint,"items",b,c,d,f)},i.getManifest=function(a,b,c,d,f){f=f||{},f.hasOwnProperty("responseType")||(f.responseType="json"),e(a,f),i.rawGet(a.endpoint,"bubbles",b,c,d,f)},i.getThumbnail=function(a,b,c,d,f){if(f=f||{},e(a,f),!f.queryParams){var g=f.role||"rendered",h=f.size||400;f.queryParams="guid="+encodeURIComponent(f.guid)+"&role="+g+"&width="+h+"&height="+h}i.rawGet(a.endpoint,"thumbnails",b,c,d,f)},i.getACMSession=function(a,b,c,d){var e,g={};for(var h in b)"oauth2AccessToken"===h?e=b[h]:h.indexOf("x-ads-acm")!==-1&&(g[h]=b[h]),
f.isMobileDevice()&&(f.HTTP_REQUEST_HEADERS=g);g.application="autodesk";var i=new XMLHttpRequest;i.open("POST",a+"/oss-ext/v2/acmsessions",!0),i.setRequestHeader("Content-Type","application/json"),i.setRequestHeader("Authorization","Bearer "+e),i.responseType="json",i.onload=function(){if(200===i.status&&i.response){var a="string"==typeof i.response?JSON.parse(i.response):i.response;a&&a.acmsession?c(a.acmsession):d(i.status,"Can't get acm session from response.")}else d(i.status)},i.onerror=d,i.ontimeout=d,i.send(JSON.stringify(g)),delete g.application},g.ViewingService=i}(),"undefined"!=typeof window){var RTCPeerConnection=null,getUserMedia=null,attachMediaStream=null,reattachMediaStream=null,webrtcDetectedBrowser=null,webrtcDetectedVersion=null;if(navigator.mozGetUserMedia)webrtcDetectedBrowser="firefox",webrtcDetectedVersion=parseInt(navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1]),RTCPeerConnection=mozRTCPeerConnection,RTCSessionDescription=mozRTCSessionDescription,RTCIceCandidate=mozRTCIceCandidate,getUserMedia=navigator.mozGetUserMedia.bind(navigator),createIceServer=function(a,b,c){var d=null,e=a.split(":");if(0===e[0].indexOf("stun"))d={url:a};else if(0===e[0].indexOf("turn")&&(a.indexOf("transport=udp")!==-1||a.indexOf("?transport")===-1)){var f=a.split("?");d={url:f[0],credential:c,username:b}}return d},attachMediaStream=function(a,b){console.log("Attaching media stream"),a.mozSrcObject=b,a.play()},reattachMediaStream=function(a,b){console.log("Reattaching media stream"),a.mozSrcObject=b.mozSrcObject,a.play()},MediaStream.prototype.getVideoTracks=function(){return[]},MediaStream.prototype.getAudioTracks=function(){return[]};else if(navigator.webkitGetUserMedia){var match=navigator.userAgent.match(/Chrom(e|ium)\/([0-9]+)\./);webrtcDetectedBrowser="chrome",webrtcDetectedVersion=match?parseInt(navigator.userAgent.match(/Chrom(e|ium)\/([0-9]+)\./)[2]):40,createIceServer=function(a,b,c){var d=null,e=a.split(":");if(0===e[0].indexOf("stun"))d={url:a};else if(0===e[0].indexOf("turn"))if(webrtcDetectedVersion<28){var f=a.split("turn:");d={url:"turn:"+b+"@"+f[1],credential:c}}else d={url:a,credential:c,username:b};return d},RTCPeerConnection=webkitRTCPeerConnection,getUserMedia=navigator.webkitGetUserMedia.bind(navigator),attachMediaStream=function(a,b){"undefined"!=typeof a.srcObject?a.srcObject=b:"undefined"!=typeof a.mozSrcObject?a.mozSrcObject=b:"undefined"!=typeof a.src?a.src=URL.createObjectURL(b):console.log("Error attaching stream to element.")},reattachMediaStream=function(a,b){a.src=b.src},webkitMediaStream.prototype.getVideoTracks||(webkitMediaStream.prototype.getVideoTracks=function(){return this.videoTracks},webkitMediaStream.prototype.getAudioTracks=function(){return this.audioTracks}),webkitRTCPeerConnection.prototype.getLocalStreams||(webkitRTCPeerConnection.prototype.getLocalStreams=function(){return this.localStreams},webkitRTCPeerConnection.prototype.getRemoteStreams=function(){return this.remoteStreams})}else console.log("Browser does not appear to be WebRTC-capable")}!function(){"use strict";var a=Autodesk.Viewing;a.EventDispatcher=function(){},a.EventDispatcher.prototype={constructor:a.EventDispatcher,apply:function(b){b.addEventListener=a.EventDispatcher.prototype.addEventListener,b.hasEventListener=a.EventDispatcher.prototype.hasEventListener,b.removeEventListener=a.EventDispatcher.prototype.removeEventListener,b.fireEvent=a.EventDispatcher.prototype.fireEvent,b.dispatchEvent=a.EventDispatcher.prototype.fireEvent},addEventListener:function(a,b){a&&(void 0===this.listeners&&(this.listeners={}),"undefined"==typeof this.listeners[a]&&(this.listeners[a]=[]),this.listeners[a].push(b))},hasEventListener:function(a,b){if(!a)return!1;if(void 0===this.listeners)return!1;var c=this.listeners;return void 0!==c[a]&&c[a].indexOf(b)!==-1},removeEventListener:function(a,b){if(a&&(void 0===this.listeners&&(this.listeners={}),this.listeners[a]instanceof Array))for(var c=this.listeners[a],d=0,e=c.length;d<e;d++)if(c[d]===b){c.splice(d,1);break}},fireEvent:function(a){if(void 0===this.listeners&&(this.listeners={}),"string"==typeof a&&(a={type:a}),!a.target)try{a.target=this}catch(a){}if(!a.type)throw new Error("event type unknown.");if(this.listeners[a.type]instanceof Array)for(var b=this.listeners[a.type].slice(),c=0;c<b.length;c++)b[c].call(this,a)}}}(),Autodesk.Viewing.FileLoader=function(a){this.viewer=a},Autodesk.Viewing.FileLoader.prototype.constructor=Autodesk.Viewing.FileLoader,Autodesk.Viewing.FileLoader.prototype.loadFile=function(a,b,c,d){return!1},function(){"use strict";var a=function(){function a(a,b,c){return!e[a]&&(e[a]={loader:c,extensions:b},!0)}function b(a){return e[a]?e[a].loader:null}function c(a){return!!e[a]&&(delete e[a],!0)}function d(a){a=a?a.toLowerCase():"";for(var b in e){var c=e[b];if(c)for(var d=0;d<c.extensions.length;d++)if(c.extensions[d].toLowerCase()===a)return c.loader}return null}var e={};return{registerFileLoader:a,getFileLoader:b,getFileLoaderForExtension:d,unregisterFileLoader:c}},b=Autodesk.Viewing;b.FileLoaderManager=new a}(),function(){"use strict";function a(a,b){function e(){return c.config.userName&&c.config.userName.length?c.config.userName:p?p.slice(0,5):"Unknown"}function f(a){switch(a.type){case"txt":j(a);break;case"joinok":i(a);break;case"join_error":break;case"sessionId":c.logger.info("Connect successful, your id is: "+a.id),p=a.id;break;case"joined":a.userStatus="joined",g(a);break;case"left":a.userStatus="left",h(a);break;case"camera":case"pointer":break;default:c.logger.log(a)}var b=a.roomId,d={type:o[a.type],data:a,channelId:b};u.dispatchEvent(d)}function g(a){if(a.user.name&&a.user.name.length||(a.user.name=a.user.id.slice(0,5)),a.roomId){var b=t[a.roomId];b?(b.users.push(a.user),c.logger.info(a.user+" joined room "+a.roomId)):c.logger.warn("Channel "+a.roomId+" does not exist for socket "+p)}}function h(a){c.logger.info(a.user+" left room "+a.room);for(var b in t){for(var d=t[b].users,e=-1,f=0;f<d.length;f++)if(d[f].id==a.user){e=f;break}e!=-1&&d.splice(e,1),delete t[b].userSet[a.user]}}function i(a){var b=t[a.roomId];c.logger.info("joined channel "+a.roomId),a.users&&a.users.length?b.users=a.users:b.users=[];for(var d=0;d<b.users.length;d++)b.users[d].name&&b.users[d].name.length||(b.users[d].name=b.users[d].id.slice(0,5));var f=e(),g=Autodesk.Viewing.i18n.translate("you"),h={id:p,name:f+" ("+g+")",isSelf:!0,status:0};b.userSet[p]||(b.users.push(h),b.userSet[p]=h),0!=h.id.indexOf(f)&&u.sendChatMessage("/nick "+f,a.roomId)}function j(a){if(0==a.msg.indexOf("/nick ")){var b=u.getUserById(a.from,a.roomId),c=a.msg.slice(6);if(c.length&&(b.name=c,b.id==p)){var d=Autodesk.Viewing.i18n.translate("you");b.name+=" ("+d+")"}u.dispatchEvent({type:"userListChange",data:a,channelId:a.roomId})}}function k(a){r<q.length?(c.logger.info("Connect failed, trying another server..."),n.disconnect(),n=null,r++,u.connect(u.sessionID)):u.dispatchEvent({type:"socketError",data:a})}function l(a){u.dispatchEvent({type:"socketError",data:a})}function m(a){r=0;for(var b in s)u.join(b)}var n,o={camera:"cameraChange",pointer:"pointerMove",joystick:"joystick",state:"viewerState",txt:"chatReceived",joinok:"userListChange",sessionId:"connectSucceeded",joined:"userListChange",left:"userListChange",private:"privateMessage",join_error:"socketError"},p=null,q=Array.isArray(a)?a:[a],r=0,s={},t={},u=this;this.connect=function(a){if(!n)return"undefined"!=typeof window.WebSocket&&(d||(d="undefined"!=typeof lmv_io?lmv_io:io),this.sessionID=a,n=d.connect(q[r]+"?sessionID="+a,{path:b,forceNew:!0}),n.on("connect",m),n.on("message",f),n.on("connect_error",k),n.on("error",l),!0)},this.join=function(a){return n&&n.connected?(delete s[a],t[a]={id:a,users:[],userSet:{}},void n.emit("join",{roomId:a,name:e()})):void(s[a]=1)},this.disconnect=function(){n&&(n.disconnect(),n=null,t={},p=null)},this.sendMessage=function(a,b,c){var d={type:a,from:p,msg:b,roomId:c};n.emit("message",d)},this.sendPrivateMessage=function(a,b){var c={type:"private",target:a,from:p,msg:b};n.emit("message",c)},this.sendChatMessage=function(a,b){var c={type:"txt",from:p,msg:a,roomId:b};n.emit("message",c),f(c)},this.getUserById=function(a,b){for(var c=t[b].users,d=0;d<c.length;d++)if(c[d].id==a)return c[d];return null},this.getLocalId=function(){return p},this.getChannelInfo=function(a){return t[a]},this.isConnected=function(){return n}}var b=Autodesk.Viewing,c=b.Private;c.config={userName:""},c.setUserName=function(a){c.config.userName=a};var d;a.prototype.constructor=a,b.EventDispatcher.prototype.apply(a.prototype);var e={};a.GetInstance=function(a,b){a||(a=c.EnvironmentConfigurations[c.env].LMV.RTC),Array.isArray(a)||(a=[a]);var d=e[a[0]];return d?d:(d=new c.MessageClient(a,b),e[a[0]]=d,d)},Autodesk.Viewing.Private.MessageClient=a}(),AutodeskNamespace("Autodesk.Viewing.Private"),function(){var a=Autodesk.Viewing,b=a.Private;b.P2PClient=function(a){function c(a){try{k=new RTCPeerConnection(t),k.onicecandidate=function(a){a.candidate?q.sendPrivateMessage(l,{type:"candidate",label:a.candidate.sdpMLineIndex,id:a.candidate.sdpMid,candidate:a.candidate.candidate}):b.logger.log("End of candidates.")},k.ondatachannel=function(a){b.logger.log("Data channel added."),o=a.channel,o.onmessage=h,p.dispatchEvent({type:"dataChannelAdded",data:a.channel})},k.onaddstream=function(a){b.logger.log("Remote stream added."),n=a.stream,p.dispatchEvent({type:"remoteStreamAdded",data:a.stream})},k.onremovestream=function(a){b.logger.log("Remote stream removed. Event: ",a),n=null,p.dispatchEvent({type:"remoteStreamRemoved",data:a.stream})},a&&(o=k.createDataChannel("sendDataChannel",{reliable:!1,ordered:!1}),o.onmessage=h)}catch(a){return b.logger.error("Failed to create PeerConnection, exception: "+a.message),void alert("Cannot create RTCPeerConnection object.")}}function d(a){b.logger.error("createOffer() error: ",e)}function f(a){if(k.setLocalDescription(a),q.sendPrivateMessage(l,a),s.length){for(var b=0;b<s.length;b++)k.addIceCandidate(s[b]);s=[]}}function g(a){for(var b=a.split("\n"),c=!1,d=!1,e=!1,f=0;f<b.length;f++)0==b[f].indexOf("a=mid:data")&&(c=!0),0==b[f].indexOf("a=mid:video")&&(e=!0),0==b[f].indexOf("a=mid:audio")&&(d=!0);return c&&!e&&!d}function h(a){var b=JSON.parse(a.data);switch(b.type){case"camera":p.dispatchEvent({type:"cameraChange",data:b});break;case"joystick":p.dispatchEvent({type:"joystick",data:b});break;case"state":p.dispatchEvent({type:"viewerState",data:b})}}function i(a){var c=a.data.msg;if(b.logger.debug("Client received message:"+JSON.stringify(c)),"offer"!=c.type||r)if("answer"===c.type&&r)k.setRemoteDescription(new RTCSessionDescription(c));else if("candidate"===c.type){var d=new RTCIceCandidate({sdpMLineIndex:c.label,candidate:c.candidate});r?k.addIceCandidate(d):s.push(d)}else"bye"===c&&r&&(p.dispatchEvent({type:"remoteHangup",data:null}),b.logger.info("Session terminated."),j());else b.logger.log("Received offer. Accepting."),p.receiveCall(a.data)}function j(){r=!1,k.close(),k=null,m=null,n=null,l=null}var k,l,m,n,o,p=this,q=a,r=!1,s=[],t={iceServers:[{url:"stun:stun.l.google.com:19302"}]},u={mandatory:{OfferToReceiveAudio:!0,OfferToReceiveVideo:!0}},v={mandatory:{OfferToReceiveAudio:!1,OfferToReceiveVideo:!1}};q.addEventListener("privateMessage",i),this.hangup=function(){b.logger.log("Hanging up."),r&&(q.sendPrivateMessage(l,"bye"),j())},this.initUserMedia=function(a){function c(c){b.logger.log("Adding local stream."),a&&a(c),p.dispatchEvent({type:"localStreamAdded",data:c})}function d(a){b.logger.error("getUserMedia error: ",a)}var e={video:!0,audio:!0};window.getUserMedia(e,c,d),b.logger.log("Getting user media with constraints",e)},this.callUser=function(a,e){return l?void b.logger.warn("Already in a call. Ignoring call request."):(l=a,b.logger.info("Calling user "+l),void(e?(c(!0),r=!0,b.logger.log("Sending data channel offer to peer"),k.createOffer(f,d)):this.initUserMedia(function(a){m=a,r||"undefined"==typeof m||(c(!1),k.addStream(m),r=!0,b.logger.log("Sending audio/video offer to peer"),k.createOffer(f,d))})))},this.receiveCall=function(a){l=a.from,l||(l=a.senderId);var d=a.msg.sdp;g(d)?(c(!0),r=!0,k.setRemoteDescription(new RTCSessionDescription(a.msg)),b.logger.log("Sending data-only answer to peer."),k.createAnswer(f,null,v)):this.initUserMedia(function(d){m=d,r||"undefined"==typeof m||(c(!1),k.addStream(m),r=!0),k.setRemoteDescription(new RTCSessionDescription(a.msg)),b.logger.log("Sending audio+video answer to peer."),k.createAnswer(f,null,u)})},this.getCurrentCallTarget=function(){return l},this.dataChannel=function(){return o}},b.P2PClient.prototype.constructor=b.P2PClient,Autodesk.Viewing.EventDispatcher.prototype.apply(b.P2PClient.prototype)}(),function(){var a=Autodesk.Viewing.Private;Autodesk.Viewing.Private.LiveReviewClient=function(a){this.viewer=a,this.messageClient=null,this.presenceChannelId=null,this.p2p=null,this.viewtx=null,this.interceptor=null},Autodesk.Viewing.Private.LiveReviewClient.prototype.destroy=function(){this.leaveLiveReviewSession()},Autodesk.Viewing.Private.LiveReviewClient.prototype.joinLiveReviewSession=function(b){this.messageClient||(this.messageClient=a.MessageClient.GetInstance()),this.presenceChannelId||(this.presenceChannelId=window.location.host),this.messageClient.isConnected()||this.messageClient.connect(b),this.viewtx||(this.viewtx=new a.ViewTransceiver(this.messageClient)),this.viewtx.channelId=b,this.viewtx.attach(this.viewer),this.p2p||(this.p2p=new a.P2PClient(this.messageClient)),this.messageClient.join(this.viewtx.channelId),this.interceptor||(this.interceptor=new a.InteractionInterceptor(this.viewtx)),this.viewer.toolController.registerTool(this.interceptor),this.viewer.toolController.activateTool(this.interceptor.getName())},Autodesk.Viewing.Private.LiveReviewClient.prototype.leaveLiveReviewSession=function(){this.p2p&&this.p2p.hangup(),this.viewtx&&this.viewtx.detach(this.viewer),this.messageClient&&this.messageClient.disconnect(),this.interceptor&&this.viewer.toolController.deactivateTool(this.interceptor.getName()),this.p2p=null,this.viewtx=null,this.messageClient=null,this.interceptor=null};var b=Autodesk.Viewing,a=b.Private;a.InteractionInterceptor=function(a){this.getNames=function(){return["intercept"]},this.getName=function(){return"intercept"},this.activate=function(a){},this.deactivate=function(a){},this.update=function(a){return!1},this.handleSingleClick=function(a,b){return!1},this.handleDoubleClick=function(a,b){return!1},this.handleSingleTap=function(a){return!1},this.handleDoubleTap=function(a,b){return!1},this.handleKeyDown=function(a,b){return!1},this.handleKeyUp=function(a,b){return!1},this.handleWheelInput=function(b){return a.takeControl(),!1},this.handleButtonDown=function(b,c){return a.takeControl(),!1},this.handleButtonUp=function(a,b){return!1},this.handleMouseMove=function(b){return a.updatePointer(b),!1},this.handleGesture=function(b){return a.takeControl(),!1},this.handleBlur=function(a){return!1},this.handleResize=function(){}},a.ViewTransceiver=function(c){function d(a){p=!0;var b=JSON.parse(a.data.msg);w.restoreState(b),o.impl.invalidate(!0,!1,!0),p=!1}function e(a){return Math.round(1e3*a)/1e3}function f(a){for(var b=0;b<a.length;b++)a[b]=e(a[b])}function g(a){var b=a.data.msg;b[1]===!0||r||(b[0]!=m&&(m=b[0],a.data.lastInControl=b[0],n.dispatchEvent({type:"controlChange",channelId:n.channelId,data:a.data})),q=!1,o.navigation.setView((new THREE.Vector3).set(b[2],b[3],b[4]),(new THREE.Vector3).set(b[5],b[6],b[7])),o.navigation.setCameraUpVector((new THREE.Vector3).set(b[8],b[9],b[10])))}function h(a){if(q||r){var b=a.camera,d=[b.position.x,b.position.y,b.position.z,b.target.x,b.target.y,b.target.z,b.up.x,b.up.y,b.up.z];f(d),d.unshift(r),d.unshift(c.getLocalId()),s.sendMessage("camera",d,n.channelId),m!=d[0]&&(m=d[0],n.dispatchEvent({type:"controlChange",channelId:n.channelId,data:{lastInControl:m}}))}}function i(a,b,c){a&&!u&&(u=document.createElement("div"),u.classList.add("collabPointer")),a&&!v?(o.container.appendChild(u),v=!0):!a&&v&&(o.container.removeChild(u),v=!1),a&&(u.style.left=b-6+"px",u.style.top=c-6+"px")}function j(a){if(!q&&!r){var b=a.data.msg;t.origin.set(b[1],b[2],b[3]),t.direction.set(b[4],b[5],b[6]);var c=t.at(o.getCamera().near);c.project(o.getCamera()),c=o.impl.viewportToClient(c.x,c.y),i(!0,c.x,c.y)}}function k(a){if(q){var b=o.impl.clientToViewport(a.canvasX,a.canvasY);o.impl.viewportToRay(b,t);var d=[t.origin.x,t.origin.y,t.origin.z,t.direction.x,t.direction.y,t.direction.z];f(d),d.unshift(c.getLocalId()),s.sendMessage("pointer",d,n.channelId)}}function l(a){if(!p){var b=w.getState(x);c.sendMessage("state",JSON.stringify(b),n.channelId)}}var m,n=this,o=this.viewer=null,p=!1,q=!1,r=!1,s=this.client=c,t=new THREE.Ray,u=null,v=!1;this.channelId=null;var w,x={seedURN:!1,objectSet:!0,viewport:!1,cutplanes:!0,renderOptions:{environment:!1,ambientOcclusion:!1,toneMap:{exposure:!1},appearance:!1}};this.takeControl=function(){q=!0,i(!1)},this.updatePointer=function(a){k(a)},this.connectCamera=function(a){r=!a},this.attach=function(c,e){o&&this.detach(),this.viewer=o=c,w=new a.ViewerState(o),s.addEventListener("cameraChange",g),s.addEventListener("pointerMove",j),o.hasEventListener(b.CAMERA_CHANGE_EVENT,h)||o.addEventListener(b.CAMERA_CHANGE_EVENT,h),e||(s.addEventListener("viewerState",d),o.hasEventListener(b.SELECTION_CHANGED_EVENT,l)||(o.addEventListener(b.SELECTION_CHANGED_EVENT,l),o.addEventListener(b.ISOLATE_EVENT,l),o.addEventListener(b.HIDE_EVENT,l),o.addEventListener(b.SHOW_EVENT,l),o.addEventListener(b.EXPLODE_CHANGE_EVENT,l),o.addEventListener(b.LAYER_VISIBILITY_CHANGED_EVENT,l),o.addEventListener(b.CUTPLANES_CHANGE_EVENT,l)))},this.detach=function(){i(!1),s&&(s.removeEventListener("cameraChange",g),s.removeEventListener("viewerState",d)),o&&(o.removeEventListener(b.CAMERA_CHANGE_EVENT,h),o.removeEventListener(b.SELECTION_CHANGED_EVENT,l),o.removeEventListener(b.ISOLATE_EVENT,l),o.removeEventListener(b.HIDE_EVENT,l),o.removeEventListener(b.SHOW_EVENT,l),o.removeEventListener(b.EXPLODE_CHANGE_EVENT,l),o.removeEventListener(b.LAYER_VISIBILITY_CHANGED_EVENT,l),o.removeEventListener(b.CUTPLANES_CHANGE_EVENT,l),this.viewer=o=null,w=null)}},a.ViewTransceiver.prototype.constructor=a.ViewTransceiver,Autodesk.Viewing.EventDispatcher.prototype.apply(a.ViewTransceiver.prototype)}(),LmvMatrix4=function(a){a?this.elements=new Float64Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]):this.elements=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])},LmvMatrix4.prototype={constructor:LmvMatrix4,set:function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){var q=this.elements;return q[0]=a,q[4]=b,q[8]=c,q[12]=d,q[1]=e,q[5]=f,q[9]=g,q[13]=h,q[2]=i,q[6]=j,q[10]=k,q[14]=l,q[3]=m,q[7]=n,q[11]=o,q[15]=p,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},copy:function(a){return this.elements.set(a.elements),this},makeRotationFromQuaternion:function(a){var b=this.elements,c=a.x,d=a.y,e=a.z,f=a.w,g=c+c,h=d+d,i=e+e,j=c*g,k=c*h,l=c*i,m=d*h,n=d*i,o=e*i,p=f*g,q=f*h,r=f*i;return b[0]=1-(m+o),b[4]=k-r,b[8]=l+q,b[1]=k+r,b[5]=1-(j+o),b[9]=n-p,b[2]=l-q,b[6]=n+p,b[10]=1-(j+m),b[3]=0,b[7]=0,b[11]=0,b[12]=0,b[13]=0,b[14]=0,b[15]=1,this},multiply:function(a){return this.multiplyMatrices(this,a)},multiplyMatrices:function(a,b){var c=a.elements,d=b.elements,e=this.elements,f=c[0],g=c[4],h=c[8],i=c[12],j=c[1],k=c[5],l=c[9],m=c[13],n=c[2],o=c[6],p=c[10],q=c[14],r=c[3],s=c[7],t=c[11],u=c[15],v=d[0],w=d[4],x=d[8],y=d[12],z=d[1],A=d[5],B=d[9],C=d[13],D=d[2],E=d[6],F=d[10],G=d[14],H=d[3],I=d[7],J=d[11],K=d[15];return e[0]=f*v+g*z+h*D+i*H,e[4]=f*w+g*A+h*E+i*I,e[8]=f*x+g*B+h*F+i*J,e[12]=f*y+g*C+h*G+i*K,e[1]=j*v+k*z+l*D+m*H,e[5]=j*w+k*A+l*E+m*I,e[9]=j*x+k*B+l*F+m*J,e[13]=j*y+k*C+l*G+m*K,e[2]=n*v+o*z+p*D+q*H,e[6]=n*w+o*A+p*E+q*I,e[10]=n*x+o*B+p*F+q*J,e[14]=n*y+o*C+p*G+q*K,e[3]=r*v+s*z+t*D+u*H,e[7]=r*w+s*A+t*E+u*I,e[11]=r*x+s*B+t*F+u*J,e[15]=r*y+s*C+t*G+u*K,this},multiplyToArray:function(a,b,c){var d=this.elements;return this.multiplyMatrices(a,b),c[0]=d[0],c[1]=d[1],c[2]=d[2],c[3]=d[3],c[4]=d[4],c[5]=d[5],c[6]=d[6],c[7]=d[7],c[8]=d[8],c[9]=d[9],c[10]=d[10],c[11]=d[11],c[12]=d[12],c[13]=d[13],c[14]=d[14],c[15]=d[15],this},multiplyScalar:function(a){var b=this.elements;return b[0]*=a,b[4]*=a,b[8]*=a,b[12]*=a,b[1]*=a,b[5]*=a,b[9]*=a,b[13]*=a,b[2]*=a,b[6]*=a,b[10]*=a,b[14]*=a,b[3]*=a,b[7]*=a,b[11]*=a,b[15]*=a,this},determinant:function(){var a=this.elements,b=a[0],c=a[4],d=a[8],e=a[12],f=a[1],g=a[5],h=a[9],i=a[13],j=a[2],k=a[6],l=a[10],m=a[14],n=a[3],o=a[7],p=a[11],q=a[15];return n*(+e*h*k-d*i*k-e*g*l+c*i*l+d*g*m-c*h*m)+o*(+b*h*m-b*i*l+e*f*l-d*f*m+d*i*j-e*h*j)+p*(+b*i*k-b*g*m-e*f*k+c*f*m+e*g*j-c*i*j)+q*(-d*g*j-b*h*k+b*g*l+d*f*k-c*f*l+c*h*j)},transpose:function(){var a,b=this.elements;return a=b[1],b[1]=b[4],b[4]=a,a=b[2],b[2]=b[8],b[8]=a,a=b[6],b[6]=b[9],b[9]=a,a=b[3],b[3]=b[12],b[12]=a,a=b[7],b[7]=b[13],b[13]=a,a=b[11],b[11]=b[14],b[14]=a,this},flattenToArrayOffset:function(a,b){var c=this.elements;return a[b]=c[0],a[b+1]=c[1],a[b+2]=c[2],a[b+3]=c[3],a[b+4]=c[4],a[b+5]=c[5],a[b+6]=c[6],a[b+7]=c[7],a[b+8]=c[8],a[b+9]=c[9],a[b+10]=c[10],a[b+11]=c[11],a[b+12]=c[12],a[b+13]=c[13],a[b+14]=c[14],a[b+15]=c[15],a},setPosition:function(a){var b=this.elements;return b[12]=a.x,b[13]=a.y,b[14]=a.z,this},getInverse:function(a,b){var c=this.elements,d=a.elements,e=d[0],f=d[4],g=d[8],h=d[12],i=d[1],j=d[5],k=d[9],l=d[13],m=d[2],n=d[6],o=d[10],p=d[14],q=d[3],r=d[7],s=d[11],t=d[15];c[0]=k*p*r-l*o*r+l*n*s-j*p*s-k*n*t+j*o*t,c[4]=h*o*r-g*p*r-h*n*s+f*p*s+g*n*t-f*o*t,c[8]=g*l*r-h*k*r+h*j*s-f*l*s-g*j*t+f*k*t,c[12]=h*k*n-g*l*n-h*j*o+f*l*o+g*j*p-f*k*p,c[1]=l*o*q-k*p*q-l*m*s+i*p*s+k*m*t-i*o*t,c[5]=g*p*q-h*o*q+h*m*s-e*p*s-g*m*t+e*o*t,c[9]=h*k*q-g*l*q-h*i*s+e*l*s+g*i*t-e*k*t,c[13]=g*l*m-h*k*m+h*i*o-e*l*o-g*i*p+e*k*p,c[2]=j*p*q-l*n*q+l*m*r-i*p*r-j*m*t+i*n*t,c[6]=h*n*q-f*p*q-h*m*r+e*p*r+f*m*t-e*n*t,c[10]=f*l*q-h*j*q+h*i*r-e*l*r-f*i*t+e*j*t,c[14]=h*j*m-f*l*m-h*i*n+e*l*n+f*i*p-e*j*p,c[3]=k*n*q-j*o*q-k*m*r+i*o*r+j*m*s-i*n*s,c[7]=f*o*q-g*n*q+g*m*r-e*o*r-f*m*s+e*n*s,c[11]=g*j*q-f*k*q-g*i*r+e*k*r+f*i*s-e*j*s,c[15]=f*k*m-g*j*m+g*i*n-e*k*n-f*i*o+e*j*o;var u=e*c[0]+i*c[4]+m*c[8]+q*c[12];if(0==u){var v="Matrix4.getInverse(): can't invert matrix, determinant is 0";if(b)throw new Error(v);return console.warn(v),this.identity(),this}return this.multiplyScalar(1/u),this},scale:function(a){var b=this.elements,c=a.x,d=a.y,e=a.z;return b[0]*=c,b[4]*=d,b[8]*=e,b[1]*=c,b[5]*=d,b[9]*=e,b[2]*=c,b[6]*=d,b[10]*=e,b[3]*=c,b[7]*=d,b[11]*=e,this},makeTranslation:function(a,b,c){return this.set(1,0,0,a,0,1,0,b,0,0,1,c,0,0,0,1),this},makeRotationX:function(a){var b=Math.cos(a),c=Math.sin(a);return this.set(1,0,0,0,0,b,-c,0,0,c,b,0,0,0,0,1),this},makeRotationY:function(a){var b=Math.cos(a),c=Math.sin(a);return this.set(b,0,c,0,0,1,0,0,-c,0,b,0,0,0,0,1),this},makeRotationZ:function(a){var b=Math.cos(a),c=Math.sin(a);return this.set(b,-c,0,0,c,b,0,0,0,0,1,0,0,0,0,1),this},makeRotationAxis:function(a,b){var c=Math.cos(b),d=Math.sin(b),e=1-c,f=a.x,g=a.y,h=a.z,i=e*f,j=e*g;return this.set(i*f+c,i*g-d*h,i*h+d*g,0,i*g+d*h,j*g+c,j*h-d*f,0,i*h-d*g,j*h+d*f,e*h*h+c,0,0,0,0,1),this},makeScale:function(a,b,c){return this.set(a,0,0,0,0,b,0,0,0,0,c,0,0,0,0,1),this},compose:function(a,b,c){return this.makeRotationFromQuaternion(b),this.scale(c),this.setPosition(a),this},transformPoint:function(a){var b=a.x,c=a.y,d=a.z,e=this.elements;return a.x=e[0]*b+e[4]*c+e[8]*d+e[12],a.y=e[1]*b+e[5]*c+e[9]*d+e[13],a.z=e[2]*b+e[6]*c+e[10]*d+e[14],a},transformDirection:function(a){var b=a.x,c=a.y,d=a.z,e=this.elements;a.x=e[0]*b+e[4]*c+e[8]*d,a.y=e[1]*b+e[5]*c+e[9]*d,a.z=e[2]*b+e[6]*c+e[10]*d;var f=Math.sqrt(a.x*a.x+a.y*a.y+a.z*a.z);if(f>0){var g=1/f;a.x*=g,a.y*=g,a.z*=g}return a},fromArray:function(a){return this.elements.set(a),this},toArray:function(){var a=this.elements;return[a[0],a[1],a[2],a[3],a[4],a[5],a[6],a[7],a[8],a[9],a[10],a[11],a[12],a[13],a[14],a[15]]},clone:function(){return(new LmvMatrix4).fromArray(this.elements)}},!function(a){var b;"undefined"!=typeof window?b=window:"undefined"!=typeof global?b=global:"undefined"!=typeof self&&(b=self),b.lmv_poly2tri=a()}(function(){return function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);throw new Error("Cannot find module '"+g+"'")}var j=c[g]={exports:{}};b[g][0].call(j.exports,function(a){var c=b[g][1][a];return e(c?c:a)},j,j.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){b.exports={version:"1.3.5"}},{}],2:[function(a,b,c){"use strict";var d=function(a,b){this.point=a,this.triangle=b||null,this.next=null,this.prev=null,this.value=a.x},e=function(a,b){this.head_=a,this.tail_=b,this.search_node_=a};e.prototype.head=function(){return this.head_},e.prototype.setHead=function(a){this.head_=a},e.prototype.tail=function(){return this.tail_},e.prototype.setTail=function(a){this.tail_=a},e.prototype.search=function(){return this.search_node_},e.prototype.setSearch=function(a){this.search_node_=a},e.prototype.findSearchNode=function(){return this.search_node_},e.prototype.locateNode=function(a){var b=this.search_node_;if(a<b.value){for(;b=b.prev;)if(a>=b.value)return this.search_node_=b,b}else for(;b=b.next;)if(a<b.value)return this.search_node_=b.prev,b.prev;return null},e.prototype.locatePoint=function(a){var b=a.x,c=this.findSearchNode(b),d=c.point.x;if(b===d){if(a!==c.point)if(a===c.prev.point)c=c.prev;else{if(a!==c.next.point)throw new Error("poly2tri Invalid AdvancingFront.locatePoint() call");c=c.next}}else if(b<d)for(;(c=c.prev)&&a!==c.point;);else for(;(c=c.next)&&a!==c.point;);return c&&(this.search_node_=c),c},b.exports=e,b.exports.Node=d},{}],3:[function(a,b,c){"use strict";function d(a,b){if(!a)throw new Error(b||"Assert Failed")}b.exports=d},{}],4:[function(a,b,c){"use strict";var d=a("./xy"),e=function(a,b){this.x=+a||0,this.y=+b||0,this._p2t_edge_list=null};e.prototype.toString=function(){return d.toStringBase(this)},e.prototype.toJSON=function(){return{x:this.x,y:this.y}},e.prototype.clone=function(){return new e(this.x,this.y)},e.prototype.set_zero=function(){return this.x=0,this.y=0,this},e.prototype.set=function(a,b){return this.x=+a||0,this.y=+b||0,this},e.prototype.negate=function(){return this.x=-this.x,this.y=-this.y,this},e.prototype.add=function(a){return this.x+=a.x,this.y+=a.y,this},e.prototype.sub=function(a){return this.x-=a.x,this.y-=a.y,this},e.prototype.mul=function(a){return this.x*=a,this.y*=a,this},e.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},e.prototype.normalize=function(){var a=this.length();return this.x/=a,this.y/=a,a},e.prototype.equals=function(a){return this.x===a.x&&this.y===a.y},e.negate=function(a){return new e(-a.x,-a.y)},e.add=function(a,b){return new e(a.x+b.x,a.y+b.y)},e.sub=function(a,b){return new e(a.x-b.x,a.y-b.y)},e.mul=function(a,b){return new e(a*b.x,a*b.y)},e.cross=function(a,b){return"number"==typeof a?"number"==typeof b?a*b:new e(-a*b.y,a*b.x):"number"==typeof b?new e(b*a.y,-b*a.x):a.x*b.y-a.y*b.x},e.toString=d.toString,e.compare=d.compare,e.cmp=d.compare,e.equals=d.equals,e.dot=function(a,b){return a.x*b.x+a.y*b.y},b.exports=e},{"./xy":11}],5:[function(a,b,c){"use strict";var d=a("./xy"),e=function(a,b){this.name="PointError",this.points=b=b||[],this.message=a||"Invalid Points!";for(var c=0;c<b.length;c++)this.message+=" "+d.toString(b[c])};e.prototype=new Error,e.prototype.constructor=e,b.exports=e},{"./xy":11}],6:[function(a,b,c){(function(b){"use strict";var d=b.poly2tri;c.noConflict=function(){return b.poly2tri=d,c},c.VERSION=a("../dist/version.json").version,c.PointError=a("./pointerror"),c.Point=a("./point"),c.Triangle=a("./triangle"),c.SweepContext=a("./sweepcontext");var e=a("./sweep");c.triangulate=e.triangulate,c.sweep={Triangulate:e.triangulate}}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../dist/version.json":1,"./point":4,"./pointerror":5,"./sweep":7,"./sweepcontext":8,"./triangle":9}],7:[function(a,b,c){"use strict";function d(a){a.initTriangulation(),a.createAdvancingFront(),e(a),f(a)}function e(a){var b,c=a.pointCount();for(b=1;b<c;++b)for(var d=a.getPoint(b),e=g(a,d),f=d._p2t_edge_list,i=0;f&&i<f.length;++i)h(a,f[i],e)}function f(a){for(var b=a.front().head().next.triangle,c=a.front().head().next.point;!b.getConstrainedEdgeCW(c);)b=b.neighborCCW(c);a.meshClean(b)}function g(a,b){var c=a.locateNode(b),d=k(a,b,c);return b.x<=c.point.x+M&&l(a,c),m(a,d),d}function h(a,b,c){a.edge_event.constrained_edge=b,a.edge_event.right=b.p.x>b.q.x,j(c.triangle,b.p,b.q)||(u(a,b,c),i(a,b.p,b.q,c.triangle,b.q))}function i(a,b,c,d,e){if(!j(d,b,c)){var f=d.pointCCW(e),g=O(c,f,b);if(g===N.COLLINEAR)throw new I("poly2tri EdgeEvent: Collinear not supported!",[c,f,b]);var h=d.pointCW(e),k=O(c,h,b);if(k===N.COLLINEAR)throw new I("poly2tri EdgeEvent: Collinear not supported!",[c,h,b]);g===k?(d=g===N.CW?d.neighborCCW(e):d.neighborCW(e),i(a,b,c,d,e)):D(a,b,c,d,e)}}function j(a,b,c){var d=a.edgeIndex(b,c);if(d!==-1){a.markConstrainedEdgeByIndex(d);var e=a.getNeighbor(d);return e&&e.markConstrainedEdgeByPoints(b,c),!0}return!1}function k(a,b,c){var d=new J(b,c.point,c.next.point);d.markNeighbor(c.triangle),a.addToMap(d);var e=new K(b);return e.next=c.next,e.prev=c,c.next.prev=e,c.next=e,o(a,d)||a.mapTriangleToNodes(d),e}function l(a,b){var c=new J(b.prev.point,b.point,b.next.point);c.markNeighbor(b.prev.triangle),c.markNeighbor(b.triangle),a.addToMap(c),b.prev.next=b.next,b.next.prev=b.prev,o(a,c)||a.mapTriangleToNodes(c)}function m(a,b){for(var c=b.next;c.next&&!Q(c.point,c.next.point,c.prev.point);)l(a,c),c=c.next;for(c=b.prev;c.prev&&!Q(c.point,c.next.point,c.prev.point);)l(a,c),c=c.prev;b.next&&b.next.next&&n(b)&&r(a,b)}function n(a){var b=a.point.x-a.next.next.point.x,c=a.point.y-a.next.next.point.y;return H(c>=0,"unordered y"),b>=0||Math.abs(b)<c}function o(a,b){for(var c=0;c<3;++c)if(!b.delaunay_edge[c]){var d=b.getNeighbor(c);if(d){var e=b.getPoint(c),f=d.oppositePoint(b,e),g=d.index(f);if(d.constrained_edge[g]||d.delaunay_edge[g]){b.constrained_edge[c]=d.constrained_edge[g];continue}var h=p(e,b.pointCCW(e),b.pointCW(e),f);if(h){b.delaunay_edge[c]=!0,d.delaunay_edge[g]=!0,q(b,e,d,f);var i=!o(a,b);return i&&a.mapTriangleToNodes(b),i=!o(a,d),i&&a.mapTriangleToNodes(d),b.delaunay_edge[c]=!1,d.delaunay_edge[g]=!1,!0}}}return!1}function p(a,b,c,d){var e=a.x-d.x,f=a.y-d.y,g=b.x-d.x,h=b.y-d.y,i=e*h,j=g*f,k=i-j;if(k<=0)return!1;var l=c.x-d.x,m=c.y-d.y,n=l*f,o=e*m,p=n-o;if(p<=0)return!1;var q=g*m,r=l*h,s=e*e+f*f,t=g*g+h*h,u=l*l+m*m,v=s*(q-r)+t*p+u*k;return v>0}function q(a,b,c,d){var e,f,g,h;e=a.neighborCCW(b),f=a.neighborCW(b),g=c.neighborCCW(d),h=c.neighborCW(d);var i,j,k,l;i=a.getConstrainedEdgeCCW(b),j=a.getConstrainedEdgeCW(b),k=c.getConstrainedEdgeCCW(d),l=c.getConstrainedEdgeCW(d);var m,n,o,p;m=a.getDelaunayEdgeCCW(b),n=a.getDelaunayEdgeCW(b),o=c.getDelaunayEdgeCCW(d),p=c.getDelaunayEdgeCW(d),a.legalize(b,d),c.legalize(d,b),c.setDelaunayEdgeCCW(b,m),a.setDelaunayEdgeCW(b,n),a.setDelaunayEdgeCCW(d,o),c.setDelaunayEdgeCW(d,p),c.setConstrainedEdgeCCW(b,i),a.setConstrainedEdgeCW(b,j),a.setConstrainedEdgeCCW(d,k),c.setConstrainedEdgeCW(d,l),a.clearNeighbors(),c.clearNeighbors(),e&&c.markNeighbor(e),f&&a.markNeighbor(f),g&&a.markNeighbor(g),h&&c.markNeighbor(h),a.markNeighbor(c)}function r(a,b){for(O(b.point,b.next.point,b.next.next.point)===N.CCW?a.basin.left_node=b.next.next:a.basin.left_node=b.next,a.basin.bottom_node=a.basin.left_node;a.basin.bottom_node.next&&a.basin.bottom_node.point.y>=a.basin.bottom_node.next.point.y;)a.basin.bottom_node=a.basin.bottom_node.next;if(a.basin.bottom_node!==a.basin.left_node){for(a.basin.right_node=a.basin.bottom_node;a.basin.right_node.next&&a.basin.right_node.point.y<a.basin.right_node.next.point.y;)a.basin.right_node=a.basin.right_node.next;a.basin.right_node!==a.basin.bottom_node&&(a.basin.width=a.basin.right_node.point.x-a.basin.left_node.point.x,
a.basin.left_highest=a.basin.left_node.point.y>a.basin.right_node.point.y,s(a,a.basin.bottom_node))}}function s(a,b){if(!t(a,b)){l(a,b);var c;if(b.prev!==a.basin.left_node||b.next!==a.basin.right_node){if(b.prev===a.basin.left_node){if(c=O(b.point,b.next.point,b.next.next.point),c===N.CW)return;b=b.next}else if(b.next===a.basin.right_node){if(c=O(b.point,b.prev.point,b.prev.prev.point),c===N.CCW)return;b=b.prev}else b=b.prev.point.y<b.next.point.y?b.prev:b.next;s(a,b)}}}function t(a,b){var c;return c=a.basin.left_highest?a.basin.left_node.point.y-b.point.y:a.basin.right_node.point.y-b.point.y,a.basin.width>c}function u(a,b,c){a.edge_event.right?v(a,b,c):z(a,b,c)}function v(a,b,c){for(;c.next.point.x<b.p.x;)O(b.q,c.next.point,b.p)===N.CCW?w(a,b,c):c=c.next}function w(a,b,c){c.point.x<b.p.x&&(O(c.point,c.next.point,c.next.next.point)===N.CCW?x(a,b,c):(y(a,b,c),w(a,b,c)))}function x(a,b,c){l(a,c.next),c.next.point!==b.p&&O(b.q,c.next.point,b.p)===N.CCW&&O(c.point,c.next.point,c.next.next.point)===N.CCW&&x(a,b,c)}function y(a,b,c){O(c.next.point,c.next.next.point,c.next.next.next.point)===N.CCW?x(a,b,c.next):O(b.q,c.next.next.point,b.p)===N.CCW&&y(a,b,c.next)}function z(a,b,c){for(;c.prev.point.x>b.p.x;)O(b.q,c.prev.point,b.p)===N.CW?A(a,b,c):c=c.prev}function A(a,b,c){c.point.x>b.p.x&&(O(c.point,c.prev.point,c.prev.prev.point)===N.CW?C(a,b,c):(B(a,b,c),A(a,b,c)))}function B(a,b,c){O(c.prev.point,c.prev.prev.point,c.prev.prev.prev.point)===N.CW?C(a,b,c.prev):O(b.q,c.prev.prev.point,b.p)===N.CW&&B(a,b,c.prev)}function C(a,b,c){l(a,c.prev),c.prev.point!==b.p&&O(b.q,c.prev.point,b.p)===N.CW&&O(c.point,c.prev.point,c.prev.prev.point)===N.CW&&C(a,b,c)}function D(a,b,c,d,e){var f=d.neighborAcross(e);H(f,"FLIP failed due to missing triangle!");var g=f.oppositePoint(d,e);if(d.getConstrainedEdgeAcross(e)){var h=d.index(e);throw new I("poly2tri Intersecting Constraints",[e,g,d.getPoint((h+1)%3),d.getPoint((h+2)%3)])}if(P(e,d.pointCCW(e),d.pointCW(e),g))if(q(d,e,f,g),a.mapTriangleToNodes(d),a.mapTriangleToNodes(f),e===c&&g===b)c===a.edge_event.constrained_edge.q&&b===a.edge_event.constrained_edge.p&&(d.markConstrainedEdgeByPoints(b,c),f.markConstrainedEdgeByPoints(b,c),o(a,d),o(a,f));else{var j=O(c,g,b);d=E(a,j,d,f,e,g),D(a,b,c,d,e)}else{var k=F(b,c,f,g);G(a,b,c,d,f,k),i(a,b,c,d,e)}}function E(a,b,c,d,e,f){var g;return b===N.CCW?(g=d.edgeIndex(e,f),d.delaunay_edge[g]=!0,o(a,d),d.clearDelaunayEdges(),c):(g=c.edgeIndex(e,f),c.delaunay_edge[g]=!0,o(a,c),c.clearDelaunayEdges(),d)}function F(a,b,c,d){var e=O(b,d,a);if(e===N.CW)return c.pointCCW(d);if(e===N.CCW)return c.pointCW(d);throw new I("poly2tri [Unsupported] nextFlipPoint: opposing point on constrained edge!",[b,d,a])}function G(a,b,c,d,e,f){var g=e.neighborAcross(f);H(g,"FLIP failed due to missing triangle");var h=g.oppositePoint(e,f);if(P(c,d.pointCCW(c),d.pointCW(c),h))D(a,c,h,g,h);else{var i=F(b,c,g,h);G(a,b,c,d,g,i)}}var H=a("./assert"),I=a("./pointerror"),J=a("./triangle"),K=a("./advancingfront").Node,L=a("./utils"),M=L.EPSILON,N=L.Orientation,O=L.orient2d,P=L.inScanArea,Q=L.isAngleObtuse;c.triangulate=d},{"./advancingfront":2,"./assert":3,"./pointerror":5,"./triangle":9,"./utils":10}],8:[function(a,b,c){"use strict";var d=a("./pointerror"),e=a("./point"),f=a("./triangle"),g=a("./sweep"),h=a("./advancingfront"),i=h.Node,j=.3,k=function(a,b){if(this.p=a,this.q=b,a.y>b.y)this.q=a,this.p=b;else if(a.y===b.y)if(a.x>b.x)this.q=a,this.p=b;else if(a.x===b.x)throw new d("poly2tri Invalid Edge constructor: repeated points!",[a]);this.q._p2t_edge_list||(this.q._p2t_edge_list=[]),this.q._p2t_edge_list.push(this)},l=function(){this.left_node=null,this.bottom_node=null,this.right_node=null,this.width=0,this.left_highest=!1};l.prototype.clear=function(){this.left_node=null,this.bottom_node=null,this.right_node=null,this.width=0,this.left_highest=!1};var m=function(){this.constrained_edge=null,this.right=!1},n=function(a,b){b=b||{},this.triangles_=[],this.map_=[],this.points_=b.cloneArrays?a.slice(0):a,this.edge_list=[],this.pmin_=this.pmax_=null,this.front_=null,this.head_=null,this.tail_=null,this.af_head_=null,this.af_middle_=null,this.af_tail_=null,this.basin=new l,this.edge_event=new m,this.initEdges(this.points_)};n.prototype.addHole=function(a){this.initEdges(a);var b,c=a.length;for(b=0;b<c;b++)this.points_.push(a[b]);return this},n.prototype.AddHole=n.prototype.addHole,n.prototype.addHoles=function(a){var b,c=a.length;for(b=0;b<c;b++)this.initEdges(a[b]);return this.points_=this.points_.concat.apply(this.points_,a),this},n.prototype.addPoint=function(a){return this.points_.push(a),this},n.prototype.AddPoint=n.prototype.addPoint,n.prototype.addPoints=function(a){return this.points_=this.points_.concat(a),this},n.prototype.triangulate=function(){return g.triangulate(this),this},n.prototype.getBoundingBox=function(){return{min:this.pmin_,max:this.pmax_}},n.prototype.getTriangles=function(){return this.triangles_},n.prototype.GetTriangles=n.prototype.getTriangles,n.prototype.front=function(){return this.front_},n.prototype.pointCount=function(){return this.points_.length},n.prototype.head=function(){return this.head_},n.prototype.setHead=function(a){this.head_=a},n.prototype.tail=function(){return this.tail_},n.prototype.setTail=function(a){this.tail_=a},n.prototype.getMap=function(){return this.map_},n.prototype.initTriangulation=function(){var a,b=this.points_[0].x,c=this.points_[0].x,d=this.points_[0].y,f=this.points_[0].y,g=this.points_.length;for(a=1;a<g;a++){var h=this.points_[a];h.x>b&&(b=h.x),h.x<c&&(c=h.x),h.y>d&&(d=h.y),h.y<f&&(f=h.y)}this.pmin_=new e(c,f),this.pmax_=new e(b,d);var i=j*(b-c),k=j*(d-f);this.head_=new e(b+i,f-k),this.tail_=new e(c-i,f-k),this.points_.sort(e.compare)},n.prototype.initEdges=function(a,b){var c,d=a.length,e=b?a.length-1:a.length;for(c=0;c<e;++c)this.edge_list.push(new k(a[c],a[(c+1)%d]))},n.prototype.getPoint=function(a){return this.points_[a]},n.prototype.addToMap=function(a){this.map_.push(a)},n.prototype.locateNode=function(a){return this.front_.locateNode(a.x)},n.prototype.createAdvancingFront=function(){var a,b,c,d=new f(this.points_[0],this.tail_,this.head_);this.map_.push(d),a=new i(d.getPoint(1),d),b=new i(d.getPoint(0),d),c=new i(d.getPoint(2)),this.front_=new h(a,c),a.next=b,b.next=c,b.prev=a,c.prev=b},n.prototype.removeNode=function(a){},n.prototype.mapTriangleToNodes=function(a){for(var b=0;b<3;++b)if(!a.getNeighbor(b)){var c=this.front_.locatePoint(a.pointCW(a.getPoint(b)));c&&(c.triangle=a)}},n.prototype.removeFromMap=function(a){var b,c=this.map_,d=c.length;for(b=0;b<d;b++)if(c[b]===a){c.splice(b,1);break}},n.prototype.meshClean=function(a){for(var b,c,d=[a];b=d.pop();)if(!b.isInterior())for(b.setInterior(!0),this.triangles_.push(b),c=0;c<3;c++)b.constrained_edge[c]||d.push(b.getNeighbor(c))},b.exports=n},{"./advancingfront":2,"./point":4,"./pointerror":5,"./sweep":7,"./triangle":9}],9:[function(a,b,c){"use strict";var d=a("./xy"),e=function(a,b,c){this.points_=[a,b,c],this.neighbors_=[null,null,null],this.interior_=!1,this.constrained_edge=[!1,!1,!1],this.delaunay_edge=[!1,!1,!1]},f=d.toString;e.prototype.toString=function(){return"["+f(this.points_[0])+f(this.points_[1])+f(this.points_[2])+"]"},e.prototype.getPoint=function(a){return this.points_[a]},e.prototype.GetPoint=e.prototype.getPoint,e.prototype.getPoints=function(){return this.points_},e.prototype.getNeighbor=function(a){return this.neighbors_[a]},e.prototype.containsPoint=function(a){var b=this.points_;return a===b[0]||a===b[1]||a===b[2]},e.prototype.containsEdge=function(a){return this.containsPoint(a.p)&&this.containsPoint(a.q)},e.prototype.containsPoints=function(a,b){return this.containsPoint(a)&&this.containsPoint(b)},e.prototype.isInterior=function(){return this.interior_},e.prototype.setInterior=function(a){return this.interior_=a,this},e.prototype.markNeighborPointers=function(a,b,c){var d=this.points_;if(a===d[2]&&b===d[1]||a===d[1]&&b===d[2])this.neighbors_[0]=c;else if(a===d[0]&&b===d[2]||a===d[2]&&b===d[0])this.neighbors_[1]=c;else{if(!(a===d[0]&&b===d[1]||a===d[1]&&b===d[0]))throw new Error("poly2tri Invalid Triangle.markNeighborPointers() call");this.neighbors_[2]=c}},e.prototype.markNeighbor=function(a){var b=this.points_;a.containsPoints(b[1],b[2])?(this.neighbors_[0]=a,a.markNeighborPointers(b[1],b[2],this)):a.containsPoints(b[0],b[2])?(this.neighbors_[1]=a,a.markNeighborPointers(b[0],b[2],this)):a.containsPoints(b[0],b[1])&&(this.neighbors_[2]=a,a.markNeighborPointers(b[0],b[1],this))},e.prototype.clearNeighbors=function(){this.neighbors_[0]=null,this.neighbors_[1]=null,this.neighbors_[2]=null},e.prototype.clearDelaunayEdges=function(){this.delaunay_edge[0]=!1,this.delaunay_edge[1]=!1,this.delaunay_edge[2]=!1},e.prototype.pointCW=function(a){var b=this.points_;return a===b[0]?b[2]:a===b[1]?b[0]:a===b[2]?b[1]:null},e.prototype.pointCCW=function(a){var b=this.points_;return a===b[0]?b[1]:a===b[1]?b[2]:a===b[2]?b[0]:null},e.prototype.neighborCW=function(a){return a===this.points_[0]?this.neighbors_[1]:a===this.points_[1]?this.neighbors_[2]:this.neighbors_[0]},e.prototype.neighborCCW=function(a){return a===this.points_[0]?this.neighbors_[2]:a===this.points_[1]?this.neighbors_[0]:this.neighbors_[1]},e.prototype.getConstrainedEdgeCW=function(a){return a===this.points_[0]?this.constrained_edge[1]:a===this.points_[1]?this.constrained_edge[2]:this.constrained_edge[0]},e.prototype.getConstrainedEdgeCCW=function(a){return a===this.points_[0]?this.constrained_edge[2]:a===this.points_[1]?this.constrained_edge[0]:this.constrained_edge[1]},e.prototype.getConstrainedEdgeAcross=function(a){return a===this.points_[0]?this.constrained_edge[0]:a===this.points_[1]?this.constrained_edge[1]:this.constrained_edge[2]},e.prototype.setConstrainedEdgeCW=function(a,b){a===this.points_[0]?this.constrained_edge[1]=b:a===this.points_[1]?this.constrained_edge[2]=b:this.constrained_edge[0]=b},e.prototype.setConstrainedEdgeCCW=function(a,b){a===this.points_[0]?this.constrained_edge[2]=b:a===this.points_[1]?this.constrained_edge[0]=b:this.constrained_edge[1]=b},e.prototype.getDelaunayEdgeCW=function(a){return a===this.points_[0]?this.delaunay_edge[1]:a===this.points_[1]?this.delaunay_edge[2]:this.delaunay_edge[0]},e.prototype.getDelaunayEdgeCCW=function(a){return a===this.points_[0]?this.delaunay_edge[2]:a===this.points_[1]?this.delaunay_edge[0]:this.delaunay_edge[1]},e.prototype.setDelaunayEdgeCW=function(a,b){a===this.points_[0]?this.delaunay_edge[1]=b:a===this.points_[1]?this.delaunay_edge[2]=b:this.delaunay_edge[0]=b},e.prototype.setDelaunayEdgeCCW=function(a,b){a===this.points_[0]?this.delaunay_edge[2]=b:a===this.points_[1]?this.delaunay_edge[0]=b:this.delaunay_edge[1]=b},e.prototype.neighborAcross=function(a){return a===this.points_[0]?this.neighbors_[0]:a===this.points_[1]?this.neighbors_[1]:this.neighbors_[2]},e.prototype.oppositePoint=function(a,b){var c=a.pointCW(b);return this.pointCW(c)},e.prototype.legalize=function(a,b){var c=this.points_;if(a===c[0])c[1]=c[0],c[0]=c[2],c[2]=b;else if(a===c[1])c[2]=c[1],c[1]=c[0],c[0]=b;else{if(a!==c[2])throw new Error("poly2tri Invalid Triangle.legalize() call");c[0]=c[2],c[2]=c[1],c[1]=b}},e.prototype.index=function(a){var b=this.points_;if(a===b[0])return 0;if(a===b[1])return 1;if(a===b[2])return 2;throw new Error("poly2tri Invalid Triangle.index() call")},e.prototype.edgeIndex=function(a,b){var c=this.points_;if(a===c[0]){if(b===c[1])return 2;if(b===c[2])return 1}else if(a===c[1]){if(b===c[2])return 0;if(b===c[0])return 2}else if(a===c[2]){if(b===c[0])return 1;if(b===c[1])return 0}return-1},e.prototype.markConstrainedEdgeByIndex=function(a){this.constrained_edge[a]=!0},e.prototype.markConstrainedEdgeByEdge=function(a){this.markConstrainedEdgeByPoints(a.p,a.q)},e.prototype.markConstrainedEdgeByPoints=function(a,b){var c=this.points_;b===c[0]&&a===c[1]||b===c[1]&&a===c[0]?this.constrained_edge[2]=!0:b===c[0]&&a===c[2]||b===c[2]&&a===c[0]?this.constrained_edge[1]=!0:(b===c[1]&&a===c[2]||b===c[2]&&a===c[1])&&(this.constrained_edge[0]=!0)},b.exports=e},{"./xy":11}],10:[function(a,b,c){"use strict";function d(a,b,c){var d=(a.x-c.x)*(b.y-c.y),e=(a.y-c.y)*(b.x-c.x),f=d-e;return f>-1e-12&&f<g?h.COLLINEAR:f>0?h.CCW:h.CW}function e(a,b,c,d){var e=(a.x-b.x)*(d.y-b.y)-(d.x-b.x)*(a.y-b.y);if(e>=-1e-12)return!1;var f=(a.x-c.x)*(d.y-c.y)-(d.x-c.x)*(a.y-c.y);return!(f<=g)}function f(a,b,c){var d=b.x-a.x,e=b.y-a.y,f=c.x-a.x,g=c.y-a.y;return d*f+e*g<0}var g=1e-12;c.EPSILON=g;var h={CW:1,CCW:-1,COLLINEAR:0};c.Orientation=h,c.orient2d=d,c.inScanArea=e,c.isAngleObtuse=f},{}],11:[function(a,b,c){"use strict";function d(a){return"("+a.x+";"+a.y+")"}function e(a){var b=a.toString();return"[object Object]"===b?d(a):b}function f(a,b){return a.y===b.y?a.x-b.x:a.y-b.y}function g(a,b){return a.x===b.x&&a.y===b.y}b.exports={toString:e,toStringBase:d,compare:f,equals:g}},{}]},{},[6])(6)}),function(){"use strict";function a(a,b){var c=b||65536;this.FULL_COUNT=c/2-1|0,this.useInstancing=a,this.stride=12,this.vb=new ArrayBuffer(4*this.stride*(this.useInstancing?c/4:c)),this.vbf=new Float32Array(this.vb),this.vbi=new Int32Array(this.vb),this.vcount=0,this.ib=this.useInstancing?null:new Uint16Array(c),this.icount=0,this.minx=this.miny=1/0,this.maxx=this.maxy=-(1/0),this.dbIds={},this.numEllipticals=0,this.numCirculars=0,this.numTriangleGeoms=0}var b=Autodesk.Viewing,c=b.Private,d=2*Math.PI,e=0,f=1,g=2,h=3,i=4,j=5,k=0,l=1,m=2,n=3,o=6,p=7,q=8,r=9,s=[0,1,3,0,3,2];a.prototype.expandStride=function(){},a.prototype.addToBounds=function(a,b){a<this.minx&&(this.minx=a),a>this.maxx&&(this.maxx=a),b<this.miny&&(this.miny=b),b>this.maxy&&(this.maxy=b)},a.prototype.setCommonVertexAttribs=function(a,b,c,d,e,f,g,h){b&=255,c&=255,h&=255,f&=65535,g&=65535,this.vbi[a+q]=b|c<<8|h<<16,this.vbi[a+o]=d,this.vbi[a+p]=e,this.vbi[a+r]=f|g<<16,this.dbIds[e]=1},a.prototype.addVertexTriangleGeom=function(a,b,c,d,e,f,g,h,i,l){for(var m=this.vcount,n=this.vbf,o=this.useInstancing?1:4,p=0;p<o;p++){var q=(m+p)*this.stride;n[q]=a,n[q+1]=b,n[q+2]=c,n[q+3]=d,n[q+4]=e,n[q+5]=f,this.setCommonVertexAttribs(q,k+p,j,g,h,i,l,0),this.vcount++}return m},a.prototype.addVertexLine=function(a,b,c,d,e,g,h,i,j,l,m){for(var n=this.vcount,o=this.vbf,p=this.useInstancing?1:4,q=0;q<p;q++){var r=(n+q)*this.stride;o[r]=a,o[r+1]=b,o[r+2]=c,o[r+3]=d,o[r+4]=.5*g,o[r+5]=e,this.setCommonVertexAttribs(r,k+q,f,h,i,j,l,m),this.vcount++}return n},a.prototype.addVertexTexQuad=function(a,b,c,d,e,f,g,h,j){for(var l=this.vcount,m=this.vbf,n=this.useInstancing?1:4,o=0;o<n;o++){var p=(l+o)*this.stride;m[p]=a,m[p+1]=b,m[p+2]=e,m[p+3]=c,m[p+4]=d,this.setCommonVertexAttribs(p,k+o,i,f,g,h,j,0),this.vcount++}return l},a.prototype.addVertexArc=function(a,b,c,d,e,f,i,j,l,m,n,o){for(var p=this.vcount,q=this.vbf,r=e==f?g:h,s=this.useInstancing?1:4,t=0;t<s;t++){var u=(p+t)*this.stride;q[u]=a,q[u+1]=b,q[u+2]=c,q[u+3]=d,q[u+4]=.5*j,q[u+5]=e,r===h&&(q[u+10]=f,q[u+11]=i),this.setCommonVertexAttribs(u,k+t,r,l,m,n,o,0),this.vcount++}return p},a.prototype.addVertex=function(a,b,c,d,f,g){if(!this.useInstancing){var h=this.vcount,i=this.stride*h,j=this.vbf;return j[i]=a,j[i+1]=b,this.setCommonVertexAttribs(i,0,e,c,d,f,g,0),this.vcount++,h}},a.prototype.addVertexPolytriangle=function(a,b,c,d,e,f){this.useInstancing||(this.addVertex(a,b,c,d,e,f),this.addToBounds(a,b))},a.prototype.addIndices=function(a,b){if(!this.useInstancing){var c=this.ib,d=this.icount;if(d+a.length>=c.length){for(var e=new Uint16Array(2*c.length),f=0;f<d;++f)e[f]=c[f];this.ib=c=e}for(var f=0;f<a.length;++f)c[d+f]=b+a[f];this.icount+=a.length}},a.prototype.finalizeQuad=function(a){this.useInstancing||this.addIndices(s,a)},a.prototype.addSegment=function(a,b,c,d,e,f,g,h,i,j,k){var l=c-a,m=d-b,n=l||m?Math.atan2(m,l):0,o=l||m?Math.sqrt(l*l+m*m):0,p=this.addVertexLine(a,b,n,o,e,f,g,h,i,j,k);this.finalizeQuad(p),this.addToBounds(a,b),this.addToBounds(c,d)},a.prototype.addTriangleGeom=function(a,b,c,d,e,f,g,h,i,j){this.numTriangleGeoms++;var k=this.addVertexTriangleGeom(a,b,c,d,e,f,g,h,i,j);this.finalizeQuad(k),this.addToBounds(a,b),this.addToBounds(c,d),this.addToBounds(e,f)},a.prototype.addArc=function(a,b,c,e,f,g,h,i,j,k,l,m){f==g?this.numCirculars++:this.numEllipticals++;var n=t(c,e);c=n.start,e=n.end,0==c&&0==e&&(e=d);var o=Math.abs(c-e);if(o>1e-4&&Math.abs(o-d)>1e-4){var p=a+f*Math.cos(c),q=b+g*Math.sin(c);this.addSegment(p,q,p,q,0,i,j,k,l,m);var r=a+f*Math.cos(e),s=b+g*Math.sin(e);this.addSegment(r,s,r,s,0,i,j,k,l,m)}else this.addToBounds(a-f,b-g),this.addToBounds(a+f,b+g);var u=this.addVertexArc(a,b,c,e,f,g,h,i,j,k,l,m);this.finalizeQuad(u);var o,p,q,r,s},a.prototype.addTexturedQuad=function(a,b,c,d,e,f,g,h,i){var j=this.addVertexTexQuad(a,b,c,d,e,f,g,h,i);this.finalizeQuad(j);var k=.5*Math.cos(e),l=.5*Math.sin(e),m=Math.abs(c*k)+Math.abs(d*l),n=Math.abs(c*l)+Math.abs(d*k);this.addToBounds(a-m,b-n),this.addToBounds(a+m,b+n)},a.prototype.isFull=function(a){a=a||3;var b=this.useInstancing?4:1;return this.vcount*b+a>this.FULL_COUNT},a.prototype.toMesh=function(){var a={};a.vb=new Float32Array(this.vb.slice(0,this.vcount*this.stride*4)),a.vbstride=this.stride;var b=this.useInstancing?1:0;if(a.vblayout={fields1:{offset:0,itemSize:3,bytesPerItem:4,divisor:b,normalize:!1},fields2:{offset:3,itemSize:3,bytesPerItem:4,divisor:b,normalize:!1},color4b:{offset:o,itemSize:4,bytesPerItem:1,divisor:b,normalize:!0},dbId4b:{offset:p,itemSize:4,bytesPerItem:1,divisor:b,normalize:!1},flags4b:{offset:q,itemSize:4,bytesPerItem:1,divisor:b,normalize:!1},layerVp4b:{offset:r,itemSize:4,bytesPerItem:1,divisor:b,normalize:!1}},this.stride>10&&(a.vblayout.extraParams={offset:10,itemSize:2,bytesPerItem:4,divisor:b,normalize:!1}),this.useInstancing){a.numInstances=this.vcount;var c=new Int32Array([k,l,m,n]);a.vblayout.instFlags4b={offset:0,itemSize:4,bytesPerItem:1,divisor:0,normalize:!1},a.vblayout.instFlags4b.array=c.buffer;a.indices=new Uint16Array(s)}else a.indices=new Uint16Array(this.ib.buffer.slice(0,2*this.icount));a.dbIds=this.dbIds;var d=this.maxx-this.minx,e=this.maxy-this.miny,f=Math.max(d,e);a.boundingBox={min:{x:this.minx,y:this.miny,z:.001*-f},max:{x:this.maxx,y:this.maxy,z:.001*f}};a.boundingSphere={center:{x:.5*(this.minx+this.maxx),y:.5*(this.miny+this.maxy),z:0},radius:.5*Math.sqrt(d*d+e*e)};return a};var t=function(a,b){function c(){function c(a,b){return Math.abs(a-b)<.001}c(a,0)&&(a=0),c(b,0)&&(b=0),c(a,d)&&(a=d),c(b,d)&&(b=d)}if(c(),a>b)for(;a>d;)a-=d,b-=d;else for(;b>d;)a-=d,b-=d;return c(),a<0&&b>0&&(a+=d),{start:a,end:b}};c.VertexBufferBuilder=a}(),function(){"use strict";var a=Autodesk.Viewing,b=a.Private,c={METER:"m",CENTIMETER:"cm",MILLIMETER:"mm",FOOT:"ft",INCH:"in"};a.ModelUnits=c;var d=function(a){WGS.RenderModel.call(this),this.myData=a,this.sharedPath=null,this.propWorker=null,this.getInstanceTree=function(){return this.myData?this.myData.instanceTree:null},this.getBoundingBox=function(){return this.myData?this.myData.bbox:null},this.is2d=function(){return!(!this.myData||!this.myData.is2d)}};a.EventDispatcher.prototype.apply(d.prototype),d.prototype.constructor=d,d.prototype.setData=function(a){this.myData=a},d.prototype.getData=function(){return this.myData},d.prototype.getDocumentNode=function(){return this.myData.loadOptions?this.myData.loadOptions.bubbleNode||null:null},d.prototype.getRoot=function(){return this.myData&&this.myData.instanceTree?this.myData.instanceTree.root:null},d.prototype.getRootId=function(){return this.myData&&this.myData.instanceTree?this.myData.instanceTree.getRootId():0},d.prototype.getUnitScale=function(){var a;switch(a=this.is2d()?this.getMetadata("page_dimensions","page_units",null):this.myData&&this.myData.scalingUnit?this.myData.scalingUnit:this.getMetadata("distance unit","value",null),a&&(a=a.toLowerCase()),a){case"meter":case"meters":case"m":return 1;case"feet and inches":case"foot":case"feet":case"ft":return.3048;case"inch":case"inches":case"in":return.0254;case"centimeter":case"centimeters":case"cm":return.01;case"millimeter":case"millimeters":case"mm":return.001;default:return 1}},d.prototype.getUnitString=function(){var a;switch(a=this.is2d()?this.getMetadata("page_dimensions","page_units",null):this.myData&&this.myData.overriddenUnits?this.myData.overriddenUnits:this.myData&&this.myData.scalingUnit?this.myData.scalingUnit:this.getMetadata("distance unit","value",null),a&&(a=a.toLowerCase()),a){case"meter":case"meters":case"m":return c.METER;case"feet and inches":case"foot":case"feet":case"ft":return c.FOOT;case"inch":case"inches":case"in":return c.INCH;case"centimeter":case"centimeters":case"cm":return c.CENTIMETER;case"millimeter":case"millimeters":case"mm":return c.MILLIMETER;default:return null}},d.prototype.getDisplayUnit=function(){var a;switch(a=this.is2d()?this.getMetadata("page_dimensions","model_units",null)||this.getMetadata("page_dimensions","page_units",null):this.myData&&this.myData.scalingUnit?this.myData.scalingUnit:this.getMetadata("distance unit","value",null),a&&(a=a.toLowerCase()),a){case"meter":case"meters":case"m":return c.METER;case"feet and inches":case"foot":case"feet":case"ft":return c.FOOT;case"inch":case"inches":case"in":return c.INCH;case"centimeter":case"centimeters":case"cm":return c.CENTIMETER;case"millimeter":case"millimeters":case"mm":return c.MILLIMETER;default:return null}},d.prototype.getMetadata=function(a,b,c){if(this.myData){var d=this.myData.metadata;if(d){var e=d[a];if(void 0!==e){if(!b)return e;var f=e[b];if(void 0!==f)return f}}}return c},d.prototype.getDefaultCamera=function(){var a=this.myData;if(!a)return null;var b=null,c=a.cameras?a.cameras.length:0;if(0<c){var d=this.getMetadata("default camera","index",null);if(null!==d&&a.cameras[d])b=a.cameras[d];else{for(var e=0;e<c;e++){var f=a.cameras[e];if(f.isPerspective){b=f;break}}b||(b=a.cameras[0])}}return b},d.prototype.getUpVector=function(){return this.getMetadata("world up vector","XYZ",null)},d.prototype.geomPolyCount=function(){return this.myData?this.myData.geomPolyCount:null},d.prototype.instancePolyCount=function(){return this.myData?this.myData.instancePolyCount:null},d.prototype.getLayersRoot=function(){return this.is2d()?this.myData?this.myData.layersRoot:null:(b.logger.warn("Autodesk.Viewing.Model.getLayersRoot is not yet implemented for 3D"),null)},d.prototype.isLoadDone=function(){return!(!this.myData||!this.myData.loadDone)},d.prototype.isObjectTreeCreated=function(){return!!this.myData.instanceTree},d.prototype.getProperties=function(a,b,c){this.myData&&this.myData.propWorker&&a>0&&this.myData.propWorker.getProperties(a,b,c)},d.prototype.getBulkProperties=function(a,b,c,d){this.myData&&this.myData.propWorker&&this.myData.propWorker.getBulkProperties(a,b,c,d)},d.prototype.getExternalIdMapping=function(a,b){this.myData&&this.myData.propWorker.getExternalIdMapping(a,b)},d.prototype.getObjectTree=function(a,b){this.myData&&this.myData.propWorker?this.myData.propWorker.getObjectTree(a,b):b&&b()},d.prototype.search=function(a,b,c,d,e){var f=this;this.isLoadDone()?this.myData.propWorker.searchProperties(a,d,b,c,e):this.getObjectTree(function(){f.myData.propWorker.searchProperties(a,d,b,c,e)})};var e=function(a){var b=.001,c=a;if(Math.abs(c[0])<b)if(Math.abs(c[4])>b)for(var d=0;d<4;d++){var e=c[d];c[d]=c[d+4],c[d+4]=e}else for(var d=0;d<4;d++){var e=c[d];c[d]=c[d+8],c[d+8]=e}if(Math.abs(c[5])<b)for(var d=4;d<8;d++){var e=c[d];c[d]=c[d+4],c[d+4]=e}},f=function(a,b,c,d){var e,f,g,h,i,j,k=!1;g=d[c[c.length-1]].x,h=d[c[c.length-1]].y,e=h>=b;for(var l=0,m=c.length;l<m;++l)i=d[c[l]].x,j=d[c[l]].y,f=j>=b,e!=f&&(j-b)*(g-i)>=(i-a)*(h-j)==f&&(k=!k),e=f,g=i,h=j;return k};d.prototype.pointInPolygon=function(a,b,c,d){for(var e=!1,g=0;g<c.length;g++)f(a,b,c[g],d)&&(e=!e);return e},d.prototype.getPageToModelTransform=function(a){if(this.myData.pageToModelTransform)return this.myData.pageToModelTransform;var b=this.myData,c=b.metadata,d=c.page_dimensions,f=b.viewports[a];if(!f)return new THREE.Matrix4;b.viewportTransforms||(b.viewportTransforms=new Array(b.viewports.length));var g=b.viewportTransforms[a];if(g)return g;var h=new LmvMatrix4(!0).set(d.logical_width/d.page_width,0,0,d.logical_offset_x,0,d.logical_height/d.page_height,0,d.logical_offset_y,0,0,1,0,0,0,0,1),i=f.transform.slice();e(i);var j=new LmvMatrix4(!0);j.elements.set(i);var k=new LmvMatrix4(!0);return k.getInverse(j),k.multiply(h),b.viewportTransforms[a]=k,k},d.prototype.pageToModel=function(a,b,c){var d=this.getPageToModelTransform(c),e=(new THREE.Vector3).set(a.x,a.y,0).applyMatrix4(d),f=(new THREE.Vector3).set(b.x,b.y,0).applyMatrix4(d);a.x=e.x,a.y=e.y,b.x=f.x,b.y=f.y},d.prototype.pointInClip=function(a,b){for(var c=this.myData.clips,d=[],e=1;e<c.length;e++)if(e!==b){for(var f=[],g=[],h=c[e].contourCounts,i=c[e].points,j=0,k=[],l=0;l<h.length;l++){for(var m=0;m<h[l];m++)f.push(j),j++;g.push(f),f=[]}for(var l=0;l<i.length;l+=2){var n={x:i[l],y:i[l+1]};k.push(n)}var o=this.pointInPolygon(a.x,a.y,g,k);o&&d.push(e)}return d},d.prototype.getClip=function(a){for(var b=this.myData.clips,c=[],d=[],e=b[a].contourCounts,f=b[a].points,g=0,h=[],i=0;i<e.length;i++){for(var j=0;j<e[i];j++)c.push(g),g++;d.push(c),c=[]}for(var i=0;i<f.length;i+=2){var k={x:f[i],y:f[i+1]};h.push(k)}return{contours:d,points:h}},d.prototype.getTopoIndex=function(a){if(this.myData&&this.myData.fragments){var b=this.myData.fragments.topoIndexes;if(b)return b[a]}},d.prototype.getTopology=function(a){if(this.myData){var b=this.myData.topology;if(b){var c=b[a];if(c)return c}}},d.prototype.hasTopology=function(){if(this.myData){var a=this.myData.topology;if(a)return!0}return!1},d.prototype.hasGeometry=function(){return!!this.myData&&(!!this.myData.isLeaflet||this.myData.fragments.length>0)},a.Model=d}(),function(){"use strict";var a=(Autodesk.Viewing,Autodesk.Viewing.Private),b=(2*Math.PI,0),c=1,d=2,e=3,f=4,g=5,h=7,i=8,j=9;a.VertexBufferReader=function(a){this.vb=a.vb.buffer,this.vbf=new Float32Array(this.vb),this.vbi=new Int32Array(this.vb),this.stride=a.vbstride,this.vcount=this.vbf.length/this.stride,this.useInstancing=!1},a.VertexBufferReader.prototype.getDbIdAt=function(a){return this.vbi[a*this.stride+h]},a.VertexBufferReader.prototype.getVertexFlagsAt=function(a){return this.vbi[a*this.stride+i]},a.VertexBufferReader.prototype.getLayerIndexAt=function(a){return 65535&this.vbi[a*this.stride+j]},a.VertexBufferReader.prototype.getViewportIndexAt=function(a){return this.vbi[a*this.stride+j]>>16&65535},a.VertexBufferReader.prototype.decodeLineAt=function(a,b,c,d){if(d.onLineSegment){var e=this.stride*a,f=this.vbf[e],g=this.vbf[e+1],h=this.vbf[e+2],i=this.vbf[e+3],j=f+i*Math.cos(h),k=g+i*Math.sin(h);d.onLineSegment(f,g,j,k,c)}},a.VertexBufferReader.prototype.decodeCircularArcAt=function(a,b,c,d){if(d.onCircularArc){var e=this.stride*a,f=this.vbf[e],g=this.vbf[e+1],h=this.vbf[e+2],i=this.vbf[e+3],j=this.vbf[e+5];d.onCircularArc(f,g,h,i,j,c)}},a.VertexBufferReader.prototype.decodeEllipticalArcAt=function(a,b,c,d){if(d.onEllipticalArc){var e=this.stride*a,f=this.vbf[e],g=this.vbf[e+1],h=this.vbf[e+2],i=this.vbf[e+3],j=this.vbf[e+5],k=this.vbf[e+10],l=this.vbf[e+11];d.onEllipticalArc(f,g,h,i,j,k,l,c)}},a.VertexBufferReader.prototype.decodeTriangleVertex=function(a,b,c,d){if(d.onTriangleVertex){var e=this.stride*a,f=this.vbf[e],g=this.vbf[e+1];d.onTriangleVertex(f,g,c)}},a.VertexBufferReader.prototype.enumGeomsForObject=function(a,h){for(var i=0;i<this.vcount;){var j=this.getVertexFlagsAt(i),k=j>>8&255,l=this.getLayerIndexAt(i),m=this.getViewportIndexAt(i);if(this.getDbIdAt(i)===a)switch(k){case b:this.decodeTriangleVertex(i,l,m,h);break;case c:this.decodeLineAt(i,l,m,h);break;case d:this.decodeCircularArcAt(i,l,m,h);break;case e:this.decodeEllipticalArcAt(i,l,m,h);break;case f:break;case g:}i+=this.useInstancing||k==b?1:4}}}(),function(){"use strict";function a(){function a(){var a=da.NormalsShader;h=da.createShaderMaterial(a),h.blending=THREE.NoBlending,h.packedNormals=!0;var b={NoCutPlanes:1,Instancing:2,Count:4},c=[];c[0]=null;for(var d=1;d<b.Count;d++){var e=h.clone();d&b.NoCutPlanes&&(e.cutPlanes=null,e.blending=THREE.NoBlending,e.packedNormals=!0,e.doNotCut=!0),d&b.Instancing&&(e.useInstancing=!0),c[d]=e}h.variants=c,h.getCustomOverrideMaterial=function(a){var c=!a.cutplanes||0==a.cutplanes.length,d=a.useInstancing,e=(c?b.NoCutPlanes:0)|(d?b.Instancing:0);return this.variants[e]}}function d(a){a(h);for(var b=1;b<h.variants.length;b++)a(h.variants[b])}function e(){function b(a){a.material.blending=THREE.NoBlending,a.material.depthWrite=!1,a.material.depthTest=!1}a(),o=new da.LmvShaderPass(da.SAOShader),b(o),n=new da.LmvShaderPass(da.SAOBlurShader),b(n),q=new da.LmvShaderPass(da.SAOMinifyFirstShader),b(q),p=new da.LmvShaderPass(da.SAOMinifyShader),b(p),r=new da.LmvShaderPass(da.FXAAShader),b(r),s=new da.LmvShaderPass(da.CelShader),b(s),t=new da.LmvShaderPass(da.BlendShader),b(t),m=new da.LmvShaderPass(da.BackgroundShader),b(m),u=new da.LmvShaderPass(da.CopyShader),b(u)}function f(a,b){var c=3*a[1],d=3*(a[3]-a[1])-c,e=1-c-d;return((e*b+d)*b+c)*b}var g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D=!1,E=!1,F=null,G=null,H=null,I=null,J=null,K=[],L=0,M=0,N=0,O=1,P=!1,Q=new Uint8Array(4),R=(new THREE.Color).setRGB(1,1,1),S=(new THREE.Color).setRGB(0,0,0),T=null,U=!1,V=!1,W=!1,X=!1,Y=0,Z=0,$=0,_=[.42,0,1,1],aa=.004,ba={antialias:!0,sao:!1,useHdrTarget:!1,haveTwoSided:!1,useSSAA:!1,idbuffer:!0,customPresentPass:!1,toonShaded:!1,envMapBg:!1,swapBlackAndWhite:!1,numIdTargets:1},ca={},da=Autodesk.Viewing.Shaders;this.settings=ba,this.init=function(a,d,f){if(e(),!a)return void c.logger.error("You need a gl context to make a renderer. Things will go downhill from here.");U=window.navigator.userAgent.indexOf("Firefox")!=-1&&window.navigator.userAgent.indexOf("Mac OS")!=-1;var h=window.navigator.userAgent.indexOf("Firefox")!=-1;C=h?THREE.RGBAFormat:THREE.RGBFormat,V=b.isMobileDevice(),ba.idbuffer=!V,A=d,B=f,g=a},this.overlayUpdate=function(a){if(0===Z||Z===-1)return!1;var b=t.uniforms.highlightIntensity.value,c=(performance.now()-Y)*aa;c=Math.min(c,1);var d=f(_,c);return b!=d&&(t.uniforms.highlightIntensity.value=d,!0)},this.beginScene=function(a,b,d,e){if(j=b,l=a.fog,k=d,D=!1,E=!1,!G&&A)this.initPostPipeline(ba.sao,ba.antialias);else if(!G&&!A)return void(P||(c.logger.error("Rendering to a canvas that was resized to zero. If you see this message you may be accidentally leaking a viewer instance."),P=!0));if(e)if(T&&!ba.envMapBg){if(ba.swapBlackAndWhite){var f=new THREE.Color(1,1,1),h=new THREE.Color(0,0,0);T.equals(f)?g.setClearColor(h,1):T.equals(h)?g.setClearColor(f,1):g.setClearColor(T,1)}else g.setClearColor(T,1);g.clearTarget(G,!0,!0,!1)}else m.uniforms.uCamDir.value=j.worldUpTransform?j.getWorldDirection().clone().applyMatrix4(j.worldUpTransform):j.getWorldDirection(),m.uniforms.uCamUp.value=j.worldUpTransform?j.up.clone().applyMatrix4(j.worldUpTransform):j.up,m.uniforms.uResolution.value.set(A,B),m.uniforms.uHalfFovTan.value=Math.tan(THREE.Math.degToRad(.5*j.fov)),g.clearTarget(G,!1,!0,!1),m.render(g,G,null);for(var i=0;i<K.length;i++)g.setClearColor(R,1),g.clearTarget(K[i],!0,!1,!1);if(ba.sao||ba.toonShaded){e&&(g.setClearColor(S,0),g.clearTarget(z,!0,!1,!1));var n=b.near,p=b.far;o.uniforms.cameraNear.value=n,o.uniforms.cameraFar.value=p,s.uniforms.cameraNear.value=n,s.uniforms.cameraFar.value=p,q.uniforms.cameraNear.value=n,q.uniforms.cameraInvNearFar.value=1/(n-p);var r=b.projectionMatrix.elements;b.isPerspective?(o.uniforms.projInfo.value.set(-2/(G.width*r[0]),-2/(G.height*r[5]),(1-r[8])/r[0],(1+r[9])/r[5]),s.uniforms.projInfo.value.copy(o.uniforms.projInfo.value),o.uniforms.isOrtho.value=0,s.uniforms.isOrtho.value=0):(o.uniforms.projInfo.value.set(-2/(G.width*r[0]),-2/(G.height*r[5]),(1-r[12])/r[0],(1-r[13])/r[5]),s.uniforms.projInfo.value.copy(o.uniforms.projInfo.value),o.uniforms.isOrtho.value=1,s.uniforms.isOrtho.value=1);var u=.25;o.uniforms.projScale.value=.5*u*(G.height*r[5])}ba.sao||(t.uniforms.useAO.value=0),this.renderScenePart(a,!0,!0,!1,!0)},this.renderScenePart=function(a,b,c,d,e){
D=!1,E=!1;var f=e?k:void 0;a.fog=l;var m;W&&X?ba.idbuffer&&d&&(ba.sao||ba.toonShaded)?g.render(a,j,[G,z].concat(K),!1,f):ba.sao||ba.toonShaded?g.render(a,j,[G,z],!1,f):ba.idbuffer&&d?g.render(a,j,[G].concat(K)):g.render(a,j,G,!1,f):X?(ba.idbuffer&&d?g.render(a,j,[G].concat(K),!1,f):g.render(a,j,G,!1,f),(ba.sao||ba.toonShaded)&&c&&(m=a.overrideMaterial,a.overrideMaterial=h,g.render(a,j,z,!1,void 0),a.overrideMaterial=m)):(b&&g.render(a,j,G,!1,f),ba.idbuffer&&d&&i&&(m=a.overrideMaterial,a.overrideMaterial=i,g.render(a,j,K[0],!1,void 0),a.overrideMaterial=m),(ba.sao||ba.toonShaded)&&c&&(m=a.overrideMaterial,a.overrideMaterial=h,g.render(a,j,z,!1,void 0),a.overrideMaterial=m))},this.clearAllOverlays=function(){g.clearTarget(H,!0,!1,!1)},this.renderOverlays=function(a,b){var c=0;for(var d in a){var e=a[d],f=e.scene,h=e.camera?e.camera:j;f.children.length&&(c||(c=1,g.setClearColor(S,0),g.clearTarget(H,!0,!1,!1)),e.materialPre&&(f.overrideMaterial=e.materialPre),g.render(f,h,H,!1,b),e.materialPost&&(f.overrideMaterial=e.materialPost,g.context.depthFunc(g.context.GREATER),g.render(f,h,H,!1,b),g.context.depthFunc(g.context.LEQUAL)),f.overrideMaterial=null)}t.uniforms.useOverlay.value=c},this.computeSSAO=function(a){if(a||!ba.sao||ba.toonShaded)t.uniforms.useAO.value=0;else{if(!D){if(F){var b=F[0];q.uniforms.resolution.value.set(1/b.width,1/b.height),q.render(g,b,z);for(var c=1;c<F.length;c++){var d=F[c];p.uniforms.resolution.value.set(1/d.width,1/d.height),p.render(g,d,b),b=d}}o.render(g,J,G),n.uniforms.axis.value.set(1,0),n.render(g,I,J),n.uniforms.axis.value.set(0,1),n.render(g,J,I),D=!0}t.uniforms.useAO.value=1}},this.presentBuffer=function(a){if(g){var b=!(ba.sao||t.uniforms.useOverlay.value||0!==Z&&Z!==-1||0!==$&&$!==-1);b?ba.antialias?a?(r.render(g,I,G),a.render(g,null,I)):ba.toonShaded?(s.render(g,I,G),r.render(g,null,I)):r.render(g,null,G):a?a.render(g,null,G):ba.toonShaded?(s.render(g,I,G),u.render(g,null,I)):u.render(g,null,G):ba.antialias?(t.render(g,I,G),a?(r.render(g,J,I),a.render(g,null,J)):ba.toonShaded?(s.render(g,J,I),r.render(g,null,J)):r.render(g,null,I)):a?(t.render(g,I,G),a.render(g,null,I)):ba.toonShaded?(t.render(g,I,G),s.render(g,J,I),u.render(g,null,J)):t.render(g,null,G)}},this.composeFinalFrame=function(a,b){ba.sao&&!ba.toonShaded&&this.computeSSAO(a),b||this.presentBuffer()},this.cleanup=function(){if(G&&(G.dispose(),G=null),z&&(z.dispose(),z=null),H&&(H.dispose(),H=null),I&&(I.dispose(),I=null),J&&(J.dispose(),J=null),F){for(var a=0;a<F.length;a++)F[a].dispose();F=[]}},this.setSize=function(a,d,e){if(A=a,B=d,ba.logicalWidth=a,ba.logicalHeight=d,0===a&&0===d||!g)return void this.cleanup();var f=0|a*g.getPixelRatio(),h=0|d*g.getPixelRatio();ba.deviceWidth=f,ba.deviceHeight=h,g.setSize(a,d),c.logger.log("width: "+f+" height: "+h);var i=1/f,j=1/h;if((ba.useSSAA||ba.toonShaded&&g.getPixelRatio()<=1)&&(f*=2,h*=2,e=!0),!e&&G&&G.width==f&&G.height==h||(c.logger.log("Reallocating render targets."),this.cleanup(),G=new THREE.WebGLRenderTarget(f,h,{minFilter:THREE.LinearFilter,magFilter:THREE.LinearFilter,format:THREE.RGBFormat,type:ba.useHdrTarget?THREE.FloatType:THREE.UnsignedByteType,stencilBuffer:!1}),G.generateMipmaps=!1,H=new THREE.WebGLRenderTarget(f,h,{minFilter:THREE.NearestFilter,magFilter:THREE.NearestFilter,format:THREE.RGBAFormat,stencilBuffer:!1}),H.generateMipmaps=!1,H.shareDepthFrom=G,z=null,I=null,J=null,F=[]),(ba.antialias||ba.sao||ba.customPresentPass||ba.toonShaded)&&(!e&&I&&I.width==f&&I.height==h||(I=new THREE.WebGLRenderTarget(f,h,{minFilter:THREE.LinearFilter,magFilter:THREE.LinearFilter,format:THREE.RGBAFormat,stencilBuffer:!1,depthBuffer:!1}),I.generateMipmaps=!1)),ba.sao||ba.toonShaded){if(e||!z||z.width!=f||z.height!=h){var k=THREE.FloatType;b.isMobileDevice()&&(k=THREE.HalfFloatType),z=new THREE.WebGLRenderTarget(f,h,{minFilter:THREE.NearestFilter,magFilter:THREE.NearestFilter,format:C,type:k,stencilBuffer:!1}),z.shareDepthFrom=G,F=[];for(var l=0;l<5;l++){var m=new THREE.WebGLRenderTarget(0|f/(2<<l),0|h/(2<<l),{minFilter:THREE.NearestFilter,magFilter:THREE.NearestFilter,format:THREE.RGBAFormat,depthBuffer:!1,stencilBuffer:!1});m.generateMipmaps=!1,F.push(m),o.uniforms["tDepth_mip"+(l+1)].value=m}W=!U&&g.verifyMRTWorks([G,z]),J=I.clone()}!J&&ba.antialias&&ba.customPresentPass&&(J=I.clone()),o.uniforms.size.value.set(f,h),o.uniforms.resolution.value.set(i,j),o.uniforms.tDepth.value=z,n.uniforms.size.value.set(f,h),n.uniforms.resolution.value.set(i,j),s.uniforms.tDepth.value=z}if(ba.idbuffer){if(e||!K[0]||K[0].width!=f||K[0].height!=h){K=[];for(var p=0;p<ba.numIdTargets;p++)K[p]=new THREE.WebGLRenderTarget(f,h,{minFilter:THREE.NearestFilter,magFilter:THREE.NearestFilter,format:THREE.RGBFormat,type:THREE.UnsignedByteType,stencilBuffer:!1}),K[p].generateMipmaps=!1,K[p].shareDepthFrom=G,K[p].canReadPixels=!0;X=!U&&g.verifyMRTWorks([G].concat(K)),X||c.logger.warn("ID buffer requested, but MRT is not supported. Some features will not work.")}s.uniforms.tID.value=K[0]}else if(K[0])for(var p=0;p<K.length;p++)K[p].dispose(),K[p]=null;r.uniforms.uResolution.value.set(i,j),s.uniforms.resolution.value.set(i,j),t.uniforms.tOverlay.value=H,t.uniforms.tAO.value=J,t.uniforms.useAO.value=ba.sao?1:0,t.uniforms.resolution.value.set(i,j),t.uniforms.tID.value=K[0]},this.getMaxAnisotropy=function(){return g.getMaxAnisotropy()},this.hasMRT=function(){return!U&&g&&g.supportsMRT()},this.applyMRTFlags=function(a){var b=a.mrtNormals,c=a.mrtIdBuffer;a.mrtNormals=this.hasMRT()&&W&&(ba.sao||ba.toonShaded),a.mrtIdBuffer=this.hasMRT()&&X&&ba.idbuffer?ba.numIdTargets:void 0,a.mrtNormals===b&&a.mrtIdBuffer===c||(a.needsUpdate=!0)},this.getAntialiasing=function(){return ba.antialias},this.initPostPipeline=function(a,c){ba.sao=a&&!b.isIE11,ba.antialias=c&&!b.isIE11,ba.sao&&(ba.toonShaded=!1),ba.haveTwoSided&&d(function(a){a.side=THREE.DoubleSide}),d(function(a){a.needsUpdate=!0}),o.material.needsUpdate=!0,n.material.needsUpdate=!0,q.material.needsUpdate=!0,p.material.needsUpdate=!0,r.material.needsUpdate=!0,s.material.needsUpdate=!0,t.material.needsUpdate=!0,m.material.needsUpdate=!0,u.material.needsUpdate=!0,this.setSize(A,B)},this.setClearColors=function(a,b){T=b?a.equals(b)||V?new THREE.Color(.5*(a.x+b.x),.5*(a.y+b.y),.5*(a.z+b.z)):void 0:a.clone(),T||(m.uniforms.color1.value.copy(a),m.uniforms.color2.value.copy(b))},this.setAOEnabled=function(a){ba.sao=a},this.setAOOptions=function(a,c){void 0!==a&&(o.uniforms.radius.value=a,o.uniforms.bias.value=a*b.isMobileDevice()?.1:.01,n.uniforms.radius.value=a),void 0!==c&&(o.uniforms.intensity.value=c),D=!1},this.getAOEnabled=function(){return ba.sao},this.getAORadius=function(){return o.uniforms.radius.value},this.getAOIntensity=function(){return o.uniforms.intensity.value},this.setCubeMap=function(a){m.material.envMap=a},this.setEnvRotation=function(a){M=a,m.material.envRotationSin=Math.sin(a),m.material.envRotationCos=Math.cos(a)},this.getEnvRotation=function(){return M},this.setEnvExposure=function(a){m.uniforms.envMapExposure.value=Math.pow(2,a),m.material.envMapExposure=Math.pow(2,a),m.material.needsUpdate=!0},this.setTonemapExposureBias=function(a){L=a,m.uniforms.exposureBias.value=Math.pow(2,a)},this.getExposureBias=function(){return L},this.setTonemapMethod=function(a){N=a,0===a?g.gammaInput=!1:g.gammaInput=!0,m.material.tonemapOutput=N,m.material.needsUpdate=!0},this.getToneMapMethod=function(){return N},this.toggleTwoSided=function(a){ba.haveTwoSided!=a&&h&&d(function(b){b.side=a?THREE.DoubleSide:THREE.FrontSide,b.needsUpdate=!0}),ba.haveTwoSided=a},this.toggleCelShading=function(a){ba.sao=!a,ba.toonShaded=a,ba.idbuffer=a,this.initPostPipeline(ba.sao,ba.antialias)},this.toggleEnvMapBackground=function(a){ba.envMapBg=a,m.uniforms.envMapBackground.value=a},this.toggleSwapBlackAndWhite=function(a){ba.swapBlackAndWhite=a},this.enter2DMode=function(a){i=a,ca.sao=ba.sao,ca.toonShaded=ba.toonShaded,ca.antialias=ba.antialias,ca.idbuffer=ba.idbuffer,ba.idbuffer=!0,ba.toonShaded=!1,t.material.defines.IS_2D="",this.initPostPipeline(!1,!1)},this.exit2DMode=function(){i=null,ba.idbuffer=ca.idbuffer,ba.toonShaded=ca.toonShaded,delete t.material.defines.IS_2D,this.initPostPipeline(ca.sao,ca.antialias)},this.idAtPixel=function(a,b,c){if(!K[0])return 0;var d=0|.5*(a+1)*K[0].width,e=0|.5*(b+1)*K[0].height;if(E&&d===v&&e===w)return c&&(c[0]=x,c[1]=y),x;g.readRenderTargetPixels(K[0],d,e,1,1,Q);var f=Q[2]<<16|Q[1]<<8|Q[0],h=0;return K[1]?(g.readRenderTargetPixels(K[1],d,e,1,1,Q),h=Q[1]<<8|Q[0],h=h<<16>>16,f=f<<8>>8):f=f<<8>>8,v=d,w=e,x=f,y=h,E=!0,c&&(c[0]=f,c[1]=h),f},this.idAtPixels=function(a,b,c,d){function e(){for(var a,b=0,e=0,f=0,g=-1,h=0;h<c*c;h++){var k=b+(c-1)/2,l=e+(c-1)/2;if(k>=0&&k<=c&&l>=0&&l<=c){var m=k+l*c;if(a=i[4*m+2]<<16|i[4*m+1]<<8|i[4*m],a=a<<8>>8,a>=0){if(j){var n=j[4*m+1]<<8|j[4*m];n=n<<16>>16,d[0]=a,d[1]=n}break}}if(b==e||b<0&&b==-e||b>0&&b==1-e){var o=f;f=-g,g=o}b+=f,e+=g}return a}if(!K[0])return 0;var f=.5*(a+1)*K[0].width-.5*(c-1),h=.5*(b+1)*K[0].height-.5*(c-1),i=new Uint8Array(4*c*c);g.readRenderTargetPixels(K[0],f,h,c,c,i);var j=void 0;return d&&K[1]&&(j=new Uint8Array(4*c*c),g.readRenderTargetPixels(K[1],f,h,c,c,j)),e()},this.readbackTargetId=function(){if(!K[0])return null;var a=new Uint8Array(4*K[0].width*K[0].height);return g.readRenderTargetPixels(K[0],0,0,K[0].width,K[0].height,a),{buffer:a,width:K[0].width,height:K[0].height}},this.rolloverObjectViewport=function(a,b,c){var d=c?c[0]:this.idAtPixel(a,b);return this.rolloverObjectId(d,c)},this.rolloverObjectId=function(a,b,c){return c=c||0,(a!==Z||c!==$)&&(t.uniforms.highlightIntensity.value=0,t.uniforms.objID.value=a,Y=performance.now(),Z=a,$=c,b?(b.length>1&&b.shift(),t.uniforms.highlightRange.value=1,t.uniforms.objIDStart.value=b[0],t.uniforms.objIDEnd.value=b[b.length-1]):(t.uniforms.highlightRange.value=0,a<=0&&(a=0),t.uniforms.objIDv3.value.set((255&a)/255,(a>>8&255)/255,(a>>16&255)/255)),!0)},this.setUnitScale=function(a){O=a},this.getUnitScale=function(){return O},this.getBlendPass=function(){return t},this.getClearPass=function(){return m},this.getColorTarget=function(){return G},this.getDepthMaterial=function(){return h}}var b=Autodesk.Viewing,c=b.Private;c.RenderContext=a}(),function(){"use strict";function a(a,b){var c=255*b[2]+b[3],d=Math.pow(2,(c-127)/2),e=d/b[1],f=b[0]*e,g=h[0]*f+h[3]*d+h[6]*e,i=h[1]*f+h[4]*d+h[7]*e,j=h[2]*f+h[5]*d+h[8]*e;g<0&&(g=0),i<0&&(i=0),j<0&&(j=0),a[0]=g,a[1]=i,a[2]=j}function b(a,b,c){var d=.0625*Math.sqrt(b[0]*c),e=.0625*Math.sqrt(b[1]*c),f=.0625*Math.sqrt(b[2]*c),g=Math.max(Math.max(d,e),Math.max(f,1e-6));g>1&&(g=1);var h=Math.ceil(255*g)/255;d>1&&(d=1),e>1&&(e=1),f>1&&(f=1),a[3]=h;var i=1/h;a[0]=d*i,a[1]=e*i,a[2]=f*i}function c(a,b,c){var d=Math.sqrt(b[0]*c),e=Math.sqrt(b[1]*c),f=Math.sqrt(b[2]*c),g=65504;d>g&&(d=g),e>g&&(e=g),f>g&&(f=g),a[0]=d,a[1]=e,a[2]=f}function d(a){for(var b=[],c=Array.isArray(a.image)?a.image:[a.image],d=0;d<c.length;d++)for(var e=c[d],f=0;f<e.mipmaps.length;f++){var g=e.mipmaps[f];b.push(g.data.buffer)}return b}var e=(Autodesk.Viewing,Autodesk.Viewing.Private),f=Autodesk.LMVTK;e.DefaultLightPreset=1,e.DefaultLightPreset2d=0,e.ModelSettingsEnvironment=null,e.BackgroundPresets={"Fusion Grey":[230,230,230,150,150,150],"Sky Blue":[226,244,255,156,172,180],Snow:[181,186,199,181,186,199],Midnight:[41,76,120,1,2,3],White:[255,255,255,255,255,255],AutoCADModel:[30,40,48,30,40,48],"Dark Grey":[51,51,51,51,51,51],"Dark Sky":[51,51,51,51,51,51],"Infinity Pool":[255,255,255,255,255,255],Tranquility:[0,84,166,0,84,166],"Grey Room":[129,129,129,129,129,129],"Photo Booth":[237,237,237,237,237,237],"RaaS SBS":[1,1,1,90,90,90],Plaza:[79,102,130,79,102,130],Custom:[230,230,230,150,150,150]};var g=e.BackgroundPresets;e.LightPresets=[{name:"Simple Grey",path:null,tonemap:0,E_bias:0,directLightColor:[1,.84,.67],ambientColor:[.2,.225,.25],lightMultiplier:1,bgColorGradient:g["Fusion Grey"],darkerFade:!1,rotation:0},{name:"Sharp Highlights",path:"SharpHighlights",type:"logluv",tonemap:1,E_bias:-9,directLightColor:[.5,.5,.5],ambientColor:[.25/8,.25/8,.25/8],lightMultiplier:0,lightDirection:[.5,-.2,-.06],bgColorGradient:g["Photo Booth"],darkerFade:!0,rotation:0},{name:"Dark Sky",path:"DarkSky",type:"logluv",tonemap:1,E_bias:-1,directLightColor:[1,1,1],ambientColor:[.25/8,.25/8,.25/8],lightMultiplier:1,lightDirection:[.1,-.55,-1],bgColorGradient:g["Dark Sky"],darkerFade:!1,rotation:0},{name:"Grey Room",path:"GreyRoom",type:"logluv",tonemap:1,E_bias:-1,directLightColor:[1,1,1],ambientColor:[.25/8,.25/8,.25/8],lightMultiplier:.5,lightDirection:[.1,-.55,-1],bgColorGradient:g["Grey Room"],darkerFade:!0,rotation:0},{name:"Photo Booth",path:"PhotoBooth",type:"logluv",tonemap:1,E_bias:0,directLightColor:[1,1,1],ambientColor:[.25/8,.25/8,.25/8],lightMultiplier:.5,lightDirection:[.1,-.55,-1],bgColorGradient:g["Photo Booth"],darkerFade:!0,rotation:0},{name:"Tranquility",path:"TranquilityBlue",type:"logluv",tonemap:1,E_bias:-1,directLightColor:[1,1,1],ambientColor:[.25/8,.25/8,.25/8],lightMultiplier:.5,lightDirection:[.1,-.55,-1],bgColorGradient:g.Tranquility,darkerFade:!1,rotation:0},{name:"Infinity Pool",path:"InfinityPool",type:"logluv",tonemap:1,E_bias:-1,directLightColor:[1,.84,.67],ambientColor:[.25/8,.25/8,.25/8],lightMultiplier:.5,lightDirection:[.1,-.55,-1],bgColorGradient:g["Infinity Pool"],darkerFade:!1,rotation:0},{name:"Simple White",path:null,tonemap:0,E_bias:0,directLightColor:[1,1,1],ambientColor:[.25,.25,.25],lightMultiplier:1,bgColorGradient:g.White,saoRadius:.06,saoIntensity:.15,darkerFade:!0,rotation:0},{name:"Riverbank",path:"riverbank",type:"logluv",tonemap:1,E_bias:-5.7,directLightColor:[1,1,1],lightMultiplier:0,bgColorGradient:g["Sky Blue"],darkerFade:!1,rotation:0},{name:"Contrast",path:"IDViz",type:"logluv",tonemap:1,E_bias:0,directLightColor:[1,1,1],lightMultiplier:0,bgColorGradient:g.Midnight,darkerFade:!1,rotation:0},{name:"Rim Highlights",path:"RimHighlights",type:"logluv",tonemap:1,E_bias:-9,directLightColor:[.5,.5,.5],ambientColor:[.25/8,.25/8,.25/8],lightMultiplier:0,lightDirection:[.35,-.35,-.5],bgColorGradient:g["Photo Booth"],darkerFade:!0,rotation:0},{name:"Cool Light",path:"CoolLight",type:"logluv",tonemap:1,E_bias:-9,directLightColor:[1,1,1],ambientColor:[.25/8,.25/8,.25/8],lightMultiplier:0,lightDirection:[-0,-.15,-.5],bgColorGradient:g["Fusion Grey"],darkerFade:!0,rotation:0},{name:"Warm Light",path:"WarmLight",type:"logluv",tonemap:1,E_bias:-9,directLightColor:[1,1,1],ambientColor:[.25/8,.25/8,.25/8],lightMultiplier:0,lightDirection:[-0,-.15,-.5],bgColorGradient:g["Fusion Grey"],darkerFade:!0,rotation:0},{name:"Soft Light",path:"SoftLight",type:"logluv",tonemap:1,E_bias:-9,directLightColor:[1,1,1],ambientColor:[.25/8,.25/8,.25/8],lightMultiplier:0,lightDirection:[-.5,-.5,0],bgColorGradient:g["Fusion Grey"],darkerFade:!0,rotation:0},{name:"Grid Light",path:"GridLight",type:"logluv",tonemap:1,E_bias:-9,directLightColor:[1,1,1],ambientColor:[.25/8,.25/8,.25/8],lightMultiplier:0,lightDirection:[-.5,-.6,0],bgColorGradient:g["Fusion Grey"],darkerFade:!0,rotation:0},{name:"Plaza",path:"Plaza",type:"logluv",tonemap:1,E_bias:-14,directLightColor:[.9,.9,1],ambientColor:[.25/8,.25/8,.25/8],lightMultiplier:0,lightDirection:[-.2,-.18,.72],bgColorGradient:g.Plaza,darkerFade:!1,rotation:0},{name:"Snow Field",path:"SnowField",type:"logluv",tonemap:1,E_bias:-10.461343,directLightColor:[1,1,1],ambientColor:[.25/8,.25/8,.25/8],lightMultiplier:0,lightDirection:[0,-1,0],bgColorGradient:g.Snow,darkerFade:!1,rotation:0}],e.DebugEnvironments=[{name:"Field",path:"field",type:"logluv",tonemap:1,E_bias:-2.9,directLightColor:[1,1,1],lightMultiplier:0,bgColorGradient:g["Sky Blue"],darkerFade:!1,rotation:0},{name:"Crossroads",path:"crossroads",type:"logluv",tonemap:1,E_bias:-5.5,directLightColor:[1,1,1],lightMultiplier:0,bgColorGradient:g["Sky Blue"],darkerFade:!1,rotation:0},{name:"Seaport",path:"seaport",type:"logluv",tonemap:1,E_bias:-6.5,directLightColor:[1,1,1],lightMultiplier:0,bgColorGradient:g["Sky Blue"],darkerFade:!1,rotation:0},{name:"Glacier",path:"glacier",type:"logluv",tonemap:1,E_bias:0,directLightColor:[1,1,1],lightMultiplier:0,bgColorGradient:g.Midnight,darkerFade:!1,rotation:0},{name:"Boardwalk",path:"boardwalk",type:"logluv",tonemap:1,E_bias:-7,directLightColor:[1,1,1],lightMultiplier:0,bgColorGradient:g["Sky Blue"],darkerFade:!1,rotation:0},{name:"RaaS Test Env",path:"Reflection",type:"logluv",tonemap:2,E_bias:-1.5,directLightColor:[1,1,1],lightMultiplier:0,bgColorGradient:g["RaaS SBS"],darkerFade:!1,rotation:0}],e.ENABLE_DEBUG&&(e.LightPresets=e.LightPresets.concat(e.DebugEnvironments)),e.copyLightPreset=function(a,b){b.name=a.name+" (copy)",b.path=a.path,b.type=a.type,b.tonemap=a.tonemap,b.E_bias=a.E_bias,b.directLightColor=a.directLightColor,b.ambientColor=a.ambientColor,b.lightMultiplier=a.lightMultiplier,b.bgColorGradient=a.bgColorGradient,b.darkerFade=a.darkerFade,b.rotation=a.rotation},e.CreateCubeMapFromColors=function(a,b){for(var c=255*a.x,d=255*a.y,e=255*a.z,f=255*b.x,g=255*b.y,h=255*b.z,i=new Uint8Array(16),j=new Uint8Array(16),k=new Uint8Array(16),l=0;l<4;l++)i[4*l]=c,i[4*l+1]=d,i[4*l+2]=e,i[4*l+3]=255,j[4*l]=f,j[4*l+1]=g,j[4*l+2]=h,j[4*l+3]=255,l>1?(k[4*l]=c,k[4*l+1]=d,k[4*l+2]=e,k[4*l+3]=255):(k[4*l]=f,k[4*l+1]=g,k[4*l+2]=h,k[4*l+3]=255);var m=new THREE.DataTexture(k,2,2,THREE.RGBAFormat),n=new THREE.DataTexture(k,2,2,THREE.RGBAFormat),o=new THREE.DataTexture(j,2,2,THREE.RGBAFormat),p=new THREE.DataTexture(i,2,2,THREE.RGBAFormat),q=new THREE.DataTexture(k,2,2,THREE.RGBAFormat),r=new THREE.DataTexture(k,2,2,THREE.RGBAFormat),s=new THREE.Texture(null,THREE.CubeReflectionMapping,THREE.RepeatWrapping,THREE.RepeatWrapping,THREE.LinearFilter,THREE.LinearFilter,THREE.RGBAFormat);return s.image=[n,m,p,o,r,q],s.needsUpdate=!0,s};var h=[6.0014,-2.7008,-1.7996,-1.332,3.1029,-5.7721,.3008,-1.0882,5.6268],i=new Float32Array(4),j=new Float32Array(4);e.DecodeEnvMap=function(d,f,g,h){if(!d.LogLuv)return void e.logger.warn("Environment map expected to be in LogLuv format.");for(var k=Math.pow(2,f),l=Array.isArray(d.image)?d.image:[d.image],m=0;m<l.length;m++)for(var n=l[m],o=0;o<n.mipmaps.length;o++){var p,q=n.mipmaps[o],r=q.data;g?(p=new Uint16Array(r.length/4*3),q.data=p):p=r.buffer;for(var s=0,t=0;t<r.length;t+=4)i[0]=r[t]/255,i[1]=r[t+1]/255,i[2]=r[t+2]/255,i[3]=r[t+3]/255,a(j,i),g?(c(i,j,k),p[s++]=e.FloatToHalf(i[0]),p[s++]=e.FloatToHalf(i[1]),p[s++]=e.FloatToHalf(i[2])):(b(i,j,k),r[t]=Math.round(255*i[0]),r[t+1]=Math.round(255*i[1]),r[t+2]=Math.round(255*i[2]),r[t+3]=Math.round(255*i[3]))}d.LogLuv=!1,g?(d.type=THREE.HalfFloatType,d.format=THREE.RGBFormat,d.RGBM=!1,d.GammaEncoded=!0):d.RGBM=!0,h&&h(d)},e.imageWorker=null;var k=1;e.DecodeEnvMapAsync=function(a,b,c,f){if(!a.LogLuv)return void e.logger.warn("Environment map expected to be in LogLuv format.");e.imageWorker||(e.imageWorker=e.createWorker());var g=k++,h=function(b){if(b.data.id===g){e.imageWorker.removeEventListener("message",h);var d=b.data.map;a.image=d.image,a.LogLuv=!1,c?(a.type=THREE.HalfFloatType,a.format=THREE.RGBFormat,a.RGBM=!1,a.GammaEncoded=!0):a.RGBM=!0,f(a)}};e.imageWorker.addEventListener("message",h),e.imageWorker.postMessage({operation:"DECODE_ENVMAP",map:a,exposure:b,useHalfFloat:c,id:g},d(a))},f.doDecodeEnvmap=function(a){e.DecodeEnvMap(a.map,a.exposure,a.useHalfFloat),self.postMessage({map:a.map,id:a.id},d(a.map))}}(),function(){"use strict";function a(a,c,d,e){if(g.getUseCredentials()){var f=a.indexOf("://")===-1||a.indexOf(window.location.host)!==-1||h.urlIsApiViewingOrDev(a);f?THREE.ImageUtils.crossOrigin="use-credentials":THREE.ImageUtils.crossOrigin="anonymous"}var i=a.indexOf("urn:");if(i!==-1){var j=g.getUseCredentials()&&!g.isNodeJS?"domain="+encodeURIComponent(window.location.origin):"",k=j;e&&(k&&(k+="&"),k+="acmsession="+e),k&&(a+="?"+k)}var l=h.ViewingService.getDirectOSSUrl({endpoint:g.getApiEndpoint()},a);if(l&&(a=l),".dds"===a.slice(a.length-4).toLocaleLowerCase()){if(g.isIOSDevice()){var m=a.slice(0,a.length-4)+".pvr";return(new THREE.PVRLoader).load(m,d)}return(new THREE.DDSLoader).load(a,d)}return!LMV_THIRD_PARTY_COOKIE&&f?b(a,c,d):THREE.ImageUtils.loadTexture(a,c,d)}function b(a,b,d){function e(a){return c(a,g,d)}function f(a,b,c){var d="Error: "+a+" ("+b+")";h.logger.error(d)}var g=new THREE.Texture(void 0,b);return h.ViewingService.getItem(h.initLoadContext(),a,e,f),g}function c(a,b,c){function d(a){for(var b="",c=new Uint8Array(a),d=c.byteLength,e=0;e<d;e++)b+=String.fromCharCode(c[e]);var f="data:image/jpeg;base64,"+window.btoa(b);return f}var e=new Image;b.image=e,e.onload=function(){b.needsUpdate=!0,c&&c(b)},e.onerror=function(a){h.logger.error(a)},e.src=d(a)}function d(a){var b=a.width,c=a.height;if(0===(b&b-1)&&0===(c&c-1))return a;for(var d=1;2*d<b;)d*=2;for(var e=1;2*e<c;)e*=2;var f=document.createElement("canvas"),g=f.getContext("2d");return f.width=d,f.height=e,g.drawImage(a,0,0,d,e),f}function e(b){function c(a){return a.indexOf("__lineMaterial__")!=-1}function e(a,b){return c(b)?b:a.basePath+"|mat|"+b}this.viewer=b;var f=this,i=this.materials={},j=this.materialsNonHDR={};this.textures={},this.layerMaskTex=null,this.reflectionCube=null,this.irradianceMap=null;var k=1,l=0,m=1,n=[];this.hasPrism=!1,this.renderPrism=!0;var o=1,p=0,q=[];this.defaultMaterial=new THREE.MeshPhongMaterial({ambient:197379,color:7829367,specular:3355443,shininess:30,shading:THREE.SmoothShading,reflectivity:0}),this.dtor=function(){this.cleanup(),THREE.Cache.clear(),this.viewer=null,f=null},this.findMaterial=function(a,b){var c=i[e(a,b)];return c||(h.logger.warn("Unknown material "+b+". Using default."),c=this.defaultMaterial),c},this.setRenderPrism=function(a){this.renderPrism=a},this.convertMaterials=function(a){if(!a.materials)return 0;{if(!a.gltfMaterials){var b=a.materials.materials,c=a.proteinMaterials?a.proteinMaterials.materials:null,d=this.renderPrism,f=0;for(var i in b){var j=!1;c&&(j=d&&h.MaterialConverter.isPrismMaterial(c[i]));var k=j?c[i]:b[i],l=h.MaterialConverter.convertMaterial(k,j);!g.isIE11&&a.doubleSided&&(l.side=THREE.DoubleSide),j&&l.transparent&&l.side===THREE.FrontSide&&(l.side=THREE.DoubleSide),j&&l.transparent&&l.side===THREE.DoubleSide&&l.depthTest&&(l.twoPassTransparency=!0);var m=e(a,i);if(this.addMaterial(m,l,j),f++,k.decals){l.decals=[];for(var n=0,o=k.decals.length;n<o;n++){var p=k.decals[n];j=d&&h.MaterialConverter.isPrismMaterial(p.material);var q=h.MaterialConverter.convertMaterial(p.material,j);l.decals.push({uv:p.uv||0,material:q}),this.addMaterial(m+"|decal|"+n,q,j)}}}return f}var r=a.materials.materials;for(var i in r){var s=r[i],t=h.MaterialConverter.convertMaterialGltf(s,a),m=e(a,i);this.addMaterial(m,t,!1)}}},this.updateMaterials=function(){for(;n.length;)for(var a=n.pop(),b=0;b<a.mats.length;b++)a.mats[b][a.slot]=a.tex,a.mats[b].needsUpdate=!0,this.viewer.invalidate(!0,!1,!1)},this.loadTexture=function(b,c){if(b.textureMaps&&!b.texturesLoaded&&(b.texturesLoaded=!0,!g.isNodeJS)){var e=b.textureMaps;for(var i in e){var j=e[i],k=c.basePath+j.uri+j.mapName,l=f.textures[k];if(l)l.tex?(b[j.mapName]=l.tex,b.needsUpdate=!0):(f.textures[k].mats.push(b),f.textures[k].slots.push(j.mapName));else{var m=null,o=b.proteinType&&b.proteinType.length,p=o&&0===b.proteinType.indexOf("Prism"),q=(p&&PRISM_ROOT||o&&PROTEIN_ROOT)&&(0===j.uri.indexOf("1/Mats")||0===j.uri.indexOf("2/Mats")||0===j.uri.indexOf("3/Mats"));if(q)m=p?PRISM_ROOT+j.uri:PROTEIN_ROOT+j.uri;else{for(var r=0;r<c.manifest.assets.length;++r){var s=c.manifest.assets[r];if(s.id==j.uri){m=h.pathToURL(c.basePath+s.URI);break}}m||(m=h.pathToURL(c.basePath+j.uri))}f.textures[k]={mats:[b],slots:[j.mapName],tex:null};var t=function(b,e){return a(e,THREE.UVMapping,function(a){if(f){a.image=d(a.image);var c=f.textures[b];if(c){c.tex||(c.tex=a);for(var e=0;e<c.mats.length;e++)c.mats[e][c.slots[e]]=a;n.push(c)}}},c.acmSessionId)}(k,m);"bumpMap"==j.mapName||"normalMap"==j.mapName?t.anisotropy=0:t.anisotropy=this.viewer.renderer().getMaxAnisotropy(),t.flipY=void 0===j.flipY||j.flipY,t.invert=!1,t.wrapS=THREE.RepeatWrapping,t.wrapT=THREE.RepeatWrapping,h.MaterialConverter.convertTexture(j.textureObj,t,c.materials.scene.SceneUnit,j.isPrism)}}}},this.loadTextures=function(a){for(var b in i)if(b.indexOf(a.basePath)!=-1){var c=i[b];this.loadTexture(c,a)}},this.create2DMaterial=function(b,c,f,h){var j="__lineMaterial__";if(c.image&&(j+="|image:"+c.image.name),c.clip&&(j+="|clip:"+JSON.stringify(c.clip)),f&&(j+="|id"),h&&(j+="|selection"),c.skipEllipticals&&(j+="|skipEllipticals"),c.skipCircles&&(j+="|skipCircles"),c.skipTriangleGeoms&&(j+="|skipTriangleGeoms"),c.useInstancing&&(j+="|useInstancing"),b&&(j+=b.basePath),j=e(null,j),!i.hasOwnProperty(j)){var k=g.Shaders,l=k.createShaderMaterial(k.LineShader);if(l.transparent=!0,l.depthWrite=!1,l.depthTest=!1,l.side=THREE.DoubleSide,l.blending=THREE.NormalBlending,f?(l.defines.ID_COLOR=1,l.blending=THREE.NoBlending):h?(this.setSelectionTexture(l),l.defines.SELECTION_RENDERER=1,l.uniforms.selectionColor.value=new THREE.Vector4(0,0,1,1)):this.viewer.renderer().hasMRT()&&(l.mrtIdBuffer=this.viewer.renderer().settings.numIdTargets),c.skipEllipticals||(l.defines.HAS_ELLIPTICALS=1),c.skipCircles||(l.defines.HAS_CIRCLES=1),c.skipTriangleGeoms||(l.defines.HAS_TRIANGLE_GEOMS=1),c.useInstancing&&(l.defines.USE_INSTANCING=1),c.image&&!g.isNodeJS){var m=this,n=function(a){m.viewer&&(a.image=d(a.image),a.wrapS=THREE.ClampToEdgeWrapping,a.wrapT=THREE.ClampToEdgeWrapping,a.minFilter=THREE.LinearMipMapLinearFilter,a.magFilter=THREE.LinearFilter,a.anisotropy=1,a.flipY=!0,a.generateMipmaps=!0,a.needsUpdate=!0,l.defines.HAS_RASTER_QUADS=1,l.uniforms.tRaster.value=a,c.image.dataURI.indexOf("png")!=-1&&(l.transparent=!0),l.needsUpdate=!0,m.viewer.invalidate(!1,!0,!1))};a(c.image.dataURI,THREE.UVMapping,n,b.acmSessionId)}l.modelScale=c.modelScale||1,this.add2DMaterial(j,l)}return j},this.add2DMaterial=function(a,b){this.layerMaskTex&&(b.defines.HAS_LAYERS=1,b.uniforms.tLayerMask.value=f.layerMaskTex),this.lineStyleTex&&(b.defines.HAS_LINESTYLES=1,b.defines.MAX_LINESTYLE_LENGTH=f.lineStyleTex.image.width,b.uniforms.tLineStyle.value=f.lineStyleTex,b.uniforms.vLineStyleTexSize.value.set(f.lineStyleTex.image.width,f.lineStyleTex.image.height)),b.uniforms.aaRange.value=.5/(o*b.modelScale),b.uniforms.pixelsPerUnit.value=o*b.modelScale,b.uniforms.swap.value=p,i[a]=b},this.addMaterial=function(a,b,c){function d(a){return.299*a.r+.587*a.g+.114*a.b}var e=b.proteinMat?b.proteinMat:null,g=b.proteinType&&b.proteinType.indexOf("Prism")!=-1;if(this.hasPrism=g||this.hasPrism,!c){if(b.metal)b.reflectivity||(b.reflectivity=d(b.specular)),e&&(1===b.reflectivity&&(b.reflectivity=d(b.specular)),0===b.color.r&&0===b.color.g&&0===b.color.b||(b.color.r*=.1,b.color.g*=.1,b.color.b*=.1));else if(g){var h=!1;if("PrismLayered"==b.proteinType&&(b.clearcoat=!0,b.reflectivity=.06,e)){var j=e.materials[e.userassets[0]],n=j.categories;n&&n.length&&n[0].indexOf("Metal")!=-1&&(h=!0)}b.reflectivity=Math.sqrt(b.reflectivity),h?b.specular.copy(b.color):(b.specular.r=b.reflectivity,b.specular.g=b.reflectivity,b.specular.b=b.reflectivity)}else b.reflectivity?b.reflectivity>.3?(b.metal=!0,b.specular.r=b.color.r,b.specular.g=b.color.g,b.specular.b=b.color.b,b.color.r*=.1,b.color.g*=.1,b.color.b*=.1):(b.specular.r*=b.reflectivity,b.specular.g*=b.reflectivity,b.specular.b*=b.reflectivity):1!==b.color.r||1!==b.color.g||1!==b.color.b||1!==b.specular.r||1!==b.specular.g||1!==b.specular.b||b.textureMaps&&(b.textureMaps.map||b.textureMaps.specularMap)?(b.reflectivity=.01+.06*d(b.specular),b.specular.r*=b.reflectivity,b.specular.g*=b.reflectivity,b.specular.b*=b.reflectivity):(b.metal=!0,b.reflectivity=.7,b.color.r*=.1,b.color.g*=.1,b.color.b*=.1),b.opacity<1&&(b.reflectivity=1);(b.transparent||b.textureMaps&&(b.textureMaps.map&&b.textureMaps.map.uri.toLowerCase().indexOf(".png")!=-1||b.textureMaps.opacityMap))&&(b.alphaTest=.01)}if(b.textureMaps&&b.textureMaps.normalMap){var o=b.bumpScale;(void 0===o||o>=1)&&(o=1),b.normalScale=new THREE.Vector2(o,o)}else void 0===b.bumpScale&&b.textureMaps&&(b.textureMaps.map||b.textureMaps.bumpMap)?b.bumpScale=.03:b.bumpScale>=1&&(b.bumpScale=.03);void 0!==b.shininess&&(b.shininess*=.25),f.reflectionCube&&!b.disableEnvMap&&(b.envMap=f.reflectionCube),f.irradianceMap&&(b.irradianceMap=f.irradianceMap),b.exposureBias=Math.pow(2,this.viewer.renderer().getExposureBias()),b.tonemapOutput=this.viewer.renderer().getToneMapMethod(),b.envMapExposure=k,b.envRotationSin=l,b.envRotationCos=m,this.viewer.renderer().applyMRTFlags(b),b.side==THREE.DoubleSide&&this.viewer.renderer().toggleTwoSided(!0),b.doNotCut||(b.cutplanes=q),i[a]=b},this.addMaterialNonHDR=function(a,b){b.doNotCut||(b.cutplanes=q),j[a]=b},this.addOverrideMaterial=function(a,b){if(this.addMaterialNonHDR(a,b),b.variants)for(var c=0;c<b.variants.length;c++){var d=b.variants[c];if(d){var e=a+"_variant_"+c;this.addMaterialNonHDR(e,d)}}},this.togglePolygonOffset=function(a){for(var b in i){var c=i[b];c instanceof THREE.MeshPhongMaterial&&(c.polygonOffset=!0,c.polygonOffsetFactor=a?1:0,c.polygonOffsetUnits=a?.1:0,c.needsUpdate=!0)}},this.applyGeometryFlagsToMaterial=function(a,b){b.attributes.color&&(a.vertexColors=THREE.VertexColors,a.needsUpdate=!0),!a.proteinType&&b.attributes.uv&&b.attributes.uv.isPattern&&(a.map&&!a.bumpMap&&(a.bumpMap=a.map,a.needsUpdate=!0),a.textureMaps&&a.textureMaps.map&&!a.textureMaps.bumpMap&&(a.textureMaps.bumpMap=a.textureMaps.map,a.needsUpdate=!0))},this.toggleMRTSetting=function(){for(var a in i){var b=i[a];c(a)||this.viewer.renderer().applyMRTFlags(b)}},this.updatePixelScale=function(a){o=a;var b=i;for(var d in b)if(c(d)){var e=b[d];e.uniforms.aaRange.value=.5/(o*e.modelScale),e.uniforms.pixelsPerUnit.value=o*e.modelScale}},this.updateSwapBlackAndWhite=function(a){p=a?1:0;var b=i;for(var d in b)if(c(d)){var e=b[d];e.uniforms.swap.value=p}},this.updateViewportId=function(a){var b=i;for(var d in b)if(c(d)){var e=b[d];e.uniforms.viewportId.value=a,e.needsUpdate=!0}this.viewer.invalidate(!0)},this.setCubeMapFromColors=function(a,b){var c=h.CreateCubeMapFromColors(a,b);f.reflectionCube=c,f.reflectionCube.isBgColor=!0;for(var d in i){var e=i[d];e.disableEnvMap||(e.envMap=c,e.needsUpdate=!0)}return this.viewer.invalidate(!0),f.reflectionCube},this.setCubeMap=function(a,b){var c=this,d=function(a){if(c.reflectionCube=a,c.reflectionCube)for(var b in i){var d=i[b];d.disableEnvMap||(d.envMap=f.reflectionCube,d.needsUpdate=!0)}else c.setCubeMapFromColors(c.viewer.clearColorTop,c.viewer.clearColorBottom);c.viewer.invalidate(!0)},e=function(c){c?(c.mapping=THREE.CubeReflectionMapping,c.LogLuv=a.indexOf("logluv")!=-1,c.RGBM=a.indexOf("rgbm")!=-1,h.DecodeEnvMap(c,b,!1,d)):d(c)};return Array.isArray(a)?(this.reflectionCube=THREE.ImageUtils.loadTextureCube(a,THREE.CubeReflectionMapping,e),this.reflectionCube.format=THREE.RGBFormat):"string"==typeof a?a.toLowerCase().indexOf(".dds")!=-1?this.reflectionCube=(new THREE.DDSLoader).load(a,e):(this.reflectionCube=THREE.ImageUtils.loadTexture(a,THREE.SphericalReflectionMapping,d),this.reflectionCube.format=THREE.RGBFormat):d(a?a:null),c.reflectionCube},this.setIrradianceMap=function(a,b){var c=this,d=function(a){for(var b in i){var d=i[b];d.irradianceMap=a,d.needsUpdate=!0}c.irradianceMap=a,c.viewer.invalidate(!0)},e=function(e){e?(e.mapping=THREE.CubeReflectionMapping,e.LogLuv=a.indexOf("logluv")!=-1,e.RGBM=a.indexOf("rgbm")!=-1,h.DecodeEnvMap(e,b,!1,d)):c.irradianceMap&&d(null)};return THREE.ImageUtils.crossOrigin="",Array.isArray(a)?(f.irradianceMap=THREE.ImageUtils.loadTextureCube(a,THREE.CubeReflectionMapping,d),f.irradianceMap.format=THREE.RGBFormat):"string"==typeof a?a.toLowerCase().indexOf(".dds")!=-1&&(this.irradianceMap=(new THREE.DDSLoader).load(a,e)):d(a?a:null),c.irradianceMap},this.setTonemapMethod=function(a){for(var b in i){var c=i[b];c.tonemapOutput=a,c.needsUpdate=!0}},this.setEnvExposure=function(a){var b=Math.pow(2,a);k=b;for(var c in i){var d=i[c];d.envMapExposure=b,d.needsUpdate=!0}},this.setEnvRotation=function(a){
l=Math.sin(a),m=Math.cos(a);for(var b in i){var c=i[b];c.envRotationSin=l,c.envRotationCos=m,c.needsUpdate=!0}},this.setTonemapExposureBias=function(a){var b=Math.pow(2,a);for(var c in i){var d=i[c];d.exposureBias=b,d.needsUpdate=!0}},this.initLayersTexture=function(a){for(var b=a.getData().layerCount,c=256,d=256,e=new Uint8Array(c*d),f=0,g=b;f<g;f++)e[f]=255;var h=new THREE.DataTexture(e,c,d,THREE.LuminanceFormat,THREE.UnsignedByteType,THREE.UVMapping,THREE.ClampToEdgeWrapping,THREE.ClampToEdgeWrapping,THREE.NearestFilter,THREE.NearestFilter,0);h.generateMipmaps=!1,h.flipY=!1,h.needsUpdate=!0,this.layerMaskTex=h,this.layersMap=a.getData().layersMap},this.initLineStyleTexture=function(){this.lineStyleTex=h.CreateLinePatternTexture()},this.initSelectionTexture=function(a){for(var b=a||1,c=4096,d=0|Math.ceil(b/c),e=1;e<d;)e*=2;d=e;for(var f=new Uint8Array(c*d),g=0;g<b;g++)f[g]=0;var h=new THREE.DataTexture(f,c,d,THREE.LuminanceFormat,THREE.UnsignedByteType,THREE.UVMapping,THREE.ClampToEdgeWrapping,THREE.ClampToEdgeWrapping,THREE.NearestFilter,THREE.NearestFilter,0);h.generateMipmaps=!1,h.flipY=!1,h.needsUpdate=!0,this.selectionTex=h},this.setSelectionTexture=function(a){if(this.selectionTex){var b=this.selectionTex.image;a.uniforms.tSelectionTexture.value=this.selectionTex,a.uniforms.vSelTexSize.value.set(b.width,b.height),a.needsUpdate=!0}},this.init2DSelectionMaterial=function(a){this.selectionTex||this.initSelectionTexture(a.myData.maxObjectNumber);var b=this.create2DMaterial(a.getData(),{},!1,!0),c=i[b];return c},this.setLayerVisible=function(a,b){for(var d=this.layerMaskTex,e=d.image.data,f=this.layersMap,g=b?255:0,h=0;h<a.length;++h){var j=a[h];e[f[j]]=g}d.needsUpdate=!0;for(var k in i)c(k)&&(i[k].needsUpdate=!0);this.viewer.invalidate(!0)},this.isLayerVisible=function(a){return!!this.layerMaskTex.image.data[this.layersMap[a]]},this.highlightObject2D=function(a,b){var c=this.selectionTex.image.data;c[a]=b?255:0,this.selectionTex.needsUpdate=!0,this.viewer.invalidate(!1,!1,!0)},this.cloneMaterial=function(a){var b=a.isPrismMaterial?h.clonePrismMaterial(a):a.clone();return(b instanceof THREE.MeshPhongMaterial||b.isPrismMaterial)&&(b.packedNormals=a.packedNormals,b.exposureBias=a.exposureBias,b.irradianceMap=a.irradianceMap,b.envMapExposure=a.envMapExposure,b.envRotationSin=a.envRotationSin,b.envRotationCos=a.envRotationCos,b.proteinType=a.proteinType,b.proteinMat=a.proteinMat,b.tonemapOutput=a.tonemapOutput,b.cutplanes=a.cutplanes),this.viewer.renderer().applyMRTFlags(b),b},this.getCutPlanes=function(){return q.slice()},this.getCutPlanesRaw=function(){return q},this.setCutPlanes=function(a){if(q.length!==(a?a.length||0:0)){var b;for(b in i){var c=i[b];c.doNotCut||(c.needsUpdate=!0,a&&a.length>0&&(c.side=THREE.DoubleSide))}for(b in j)j[b].doNotCut||(j[b].needsUpdate=!0)}for(;q.length>0;)q.pop();if(a)for(var d=0;d<a.length;d++)q.push(a[d].clone())},this.cleanup=function(a){var b={};for(var d in this.textures){var e=this.textures[d];d.indexOf(a.basePath)===-1?b[d]=e:e.tex&&(e.tex.dispose(),e.tex.needsUpdate=!0)}this.textures=b;var f={},g={type:"dispose"};for(var h in i)if(a&&h.indexOf(a.basePath)===-1)f[h]=i[h];else{var k=i[h];if(k.dispatchEvent(g),k.needsUpdate=!0,k.envMap=null,c(h)){k.uniforms.tLayerMask.value=null,k.uniforms.tLineStyle.value=null;var l=k.uniforms.tRaster;l&&l.value instanceof THREE.Texture&&(l.value.dispose(),l.value.needsUpdate=!0)}}i=this.materials=f;var m={};for(var h in j)if(a&&h.indexOf(a.basePath)===-1)m[h]=j[h];else{var k=j[h];k.dispatchEvent(g),k.needsUpdate=!0}j=m},this.addSimpleMaterial=function(a,b,c){var d=h.MaterialConverter.convertMaterial(b),f=e(c,a);this.addMaterial(f,d),this.loadTexture(d,c)},this.addMaterial("__defaultMaterial__",this.defaultMaterial),this.removeMaterial=function(a){delete i[a]},this.exportModelMaterials=function(a,b){var c=a.getData(),d={};for(var e in i)if(e.indexOf(c.basePath)!==-1){var f=i[e],g=f.defines&&f.defines.hasOwnProperty("SELECTION_RENDERER");g||(d[e]=f)}var h={};for(var e in j)e.indexOf(c.basePath)!==-1&&(h[e]=j[e]);var k={};for(var l in this.textures)l.indexOf(c.basePath)!==-1&&(k[l]=this.textures[l]);return this.cleanup(c),{mats:d,matsNonHDR:h,textures:k}},this.importModelMaterials=function(a){for(var b in a.mats)c(b)?this.add2DMaterial(b,a.mats[b]):this.addMaterial(b,a.mats[b],!0);for(var b in a.matsNonHDR)this.addMaterialNonHDR(b,a.matsNonHDR[b]);for(var d in a.textures)this.textures[d]=a.textures[d]},this.setShadowParams=function(a){for(var b in i){var c=i[b];a.apply(c)}},this.getMaterialVariant=function(a,b,c){var d=c+"|"+a.id+"|"+b,e=i[d];return e||(e=this.cloneMaterial(a),b===h.MATERIAL_VARIANT.INSTANCED?(e.useInstancing=!0,e.vertexIds=!0):b===h.MATERIAL_VARIANT.VERTEX_IDS&&(e.vertexIds=!0),this.addMaterial(d,e,!0)),e}}function f(a){var b=a.clone();b.useInstancing=!0,a.variants=[b],a.getCustomOverrideMaterial=function(a){return a.useInstancing?this.variants[0]:null}}var g=Autodesk.Viewing,h=g.Private;Autodesk.Viewing.Private.MATERIAL_VARIANT={INSTANCED:0,VERTEX_IDS:1},Autodesk.Viewing.Private.MaterialManager=e,Autodesk.Viewing.Private.loadTextureWithSecurity=a,Autodesk.Viewing.Private.addInstancingSupport=f}();var av=Autodesk.Viewing,avp=Autodesk.Viewing.Private,LMV_WORKER_URL=avp.LMV_WORKER_URL||"src/workers/MainWorker-web.js",ENABLE_INLINE_WORKER=avp.ENABLE_INLINE_WORKER||!1;!function(){"use strict";var a=null,b=!1,c=[];avp.initWorkerScript=function(d,e){if(ENABLE_INLINE_WORKER&&!a){if(c.push({successCB:d}),b)return;var f=new XMLHttpRequest,g=LMV_WORKER_URL,h=avp.getResourceUrl(LMV_WORKER_URL);h&&(g=h),f.open("GET",g,!0),f.withCredentials=!1,f.onload=function(){b=!1;var d;window.URL=window.URL||window.webkitURL;try{d=new Blob([f.responseText],{type:"application/javascript"})}catch(a){d=new BlobBuilder,d.append(f.responseText),d=d.getBlob()}a=URL.createObjectURL(d);var e=c.concat();c=[];for(var g=0;g<e.length;++g)e[g].successCB&&e[g].successCB()},b=!0,f.send()}else d&&d()},avp.createWorker=function(){var b;return b=ENABLE_INLINE_WORKER?new Worker(a):new Worker(avp.getResourceUrl(LMV_WORKER_URL)),b.doOperation=b.postMessage,b},avp.createWorkerWithIntercept=function(){function a(a){if(!c)return null;for(var b=0;b<c.length;++b)if(c[b].arg===a){var d=c[b].callback;return c.splice(b,1),0===c.length&&(c=null),d}return null}var b=avp.createWorker();b.checkEvent=function(a){return!(!a.data||!a.data.assetRequest)&&(avp.assets&&avp.assets.push(a.data.assetRequest),!0)};var c=[];return b.addEventListenerWithIntercept=function(a){var d=function(c){b.checkEvent(c)||a(c)};return c||(c=[]),c.push({arg:a,callback:d}),b.addEventListener("message",d,!1),d},b.removeEventListenerWithIntercept=function(c){var d=a(c);d&&b.removeEventListener("message",d,!1)},b.clearAllEventListenerWithIntercept=function(){if(c)for(var a=c.concat(),d=0;d<a.length;++d)b.removeEventListenerWithIntercept(a[d].arg)},b}}(),function(){"use strict";function a(a){var b=a.data;if(b&&b.debug)return void d.logger.debug(b.message);if(b.cbId){var c=l[b.cbId];b&&b.error?c[1]&&c[1](b.error):c[0]&&c[0](b.result),delete l[b.cbId]}}function b(a,b){var c=k++;return l[c]=[a,b],c}var c=Autodesk.Viewing,d=c.Private,e="GET_PROPERTIES",f="SEARCH_PROPERTIES",g="BUILD_EXTERNAL_ID_MAPPING",h="GET_OBJECT_TREE",i=function(a,b,d){this.sharedDbPath=a,this.propWorker=null,this.eventTarget=d||new c.EventDispatcher,this.model=b,this.svf=b&&b.getData();var e=c.getUseCredentials()&&!c.isNodeJS?"domain="+encodeURIComponent(window.location.origin):"";this.queryParam=e,this.svf&&this.svf.acmSessionId&&(this.queryParam&&(this.queryParam+="&"),this.queryParam+="acmsession="+this.svf.acmSessionId)};i.prototype.dtor=function(){this.propWorker&&!this.sharedDbPath&&(this.propWorker.clearAllEventListenerWithIntercept(),this.propWorker.terminate(),this.propWorker=null)};var j={},k=1,l={};i.prototype.processLoadResult=function(a){var b=this;if(a.instanceTreeStorage){var e=new d.InstanceTreeAccess(a.instanceTreeStorage,a.rootId,a.instanceBoxes);b.instanceTree=new d.InstanceTree(e,a.objectCount,a.maxTreeDepth),b.svf&&(b.svf.instanceTree=b.instanceTree)}else a.instanceTree?(d.logger.warn("glTF instance tree not supported"),b.hasObjectProperties=a.objectCount):a.objectCount&&(b.hasObjectProperties=a.objectCount,b.svf&&(b.svf.hasObjectProperties=a.objectCount));b.eventTarget.fireEvent({type:c.OBJECT_TREE_CREATED_EVENT,svf:b.svf,model:b.model,target:b})},i.prototype.processLoadError=function(a){var b=this;b.propertyDbError=a,b.eventTarget.fireEvent({type:c.OBJECT_TREE_UNAVAILABLE_EVENT,svf:b.svf,model:b.model,target:b})},i.prototype.load=function(){var c=this;if(this.svf&&this.svf.instanceTree&&this.svf.instanceBoxes)return void setTimeout(function(){c.processLoadResult(c.svf)},0);var e=function(a){c.processLoadResult(a);var b=!!c.sharedDbPath,d=b&&j[c.sharedDbPath];if(d&&d.waitingLoaders){for(var e=0;e<d.waitingLoaders.length;e++)d.waitingLoaders[e].processLoadResult(a);d.waitingLoaders=null,d.workerResult=a}},f=function(a){c.processLoadError(a);var b=!!c.sharedDbPath,d=b&&j[c.sharedDbPath];if(d&&d.waitingLoaders){for(var e=0;e<d.waitingLoaders.length;e++)d.waitingLoaders[e].processLoadError(a);d.waitingLoaders=null,d.workerError=a}},g=!!this.sharedDbPath,i=g&&j[this.sharedDbPath];i?(d.logger.log("Using cached property worker for ",this.sharedDbPath),this.propWorker=i):(this.propWorker=d.createWorkerWithIntercept(),this.propWorker.addEventListenerWithIntercept(a),g&&(j[this.sharedDbPath]=this.propWorker));var k,l=b(e,f);this.svf&&this.svf.propertydb.values.length?k=d.pathToURL(this.svf.basePath):(k=this.sharedDbPath,d.logger.log("Using shared property db: "+k));var m={operation:h,url:k,propertydb:this.svf&&this.svf.propertydb||{attrs:[],avs:[],ids:[],values:[],offsets:[]},fragToDbId:this.svf&&this.svf.fragments.fragId2dbId,fragBoxes:this.svf&&this.svf.fragments.boxes,cbId:l,queryParams:this.queryParam};this.propWorker.doOperation(d.initLoadContext(m))},i.prototype.asyncPropertyOperation=function(a,d,e){var f=this;if(f.instanceTree||f.hasObjectProperties)a.cbId=b(d,e),this.propWorker.doOperation(a);else if(f.propertyDbError)e&&e(f.propertyDbError);else{var g=function(b){f.eventTarget.removeEventListener(c.OBJECT_TREE_CREATED_EVENT,g),f.eventTarget.removeEventListener(c.OBJECT_TREE_UNAVAILABLE_EVENT,g),f.instanceTree||f.hasObjectProperties||f.propertyDbError?f.asyncPropertyOperation(a,d,e):e&&e({code:c.UNKNOWN_FAILURE,msg:"Failed to load properties"})};f.eventTarget.addEventListener(c.OBJECT_TREE_CREATED_EVENT,g),f.eventTarget.addEventListener(c.OBJECT_TREE_UNAVAILABLE_EVENT,g)}},i.prototype.getProperties=function(a,b,c){this.asyncPropertyOperation({operation:e,dbId:a},b,c)},i.prototype.getBulkProperties=function(a,b,c,d){this.asyncPropertyOperation({operation:e,dbIds:a,propFilter:b},c,d)},i.prototype.searchProperties=function(a,b,c,d,e){this.asyncPropertyOperation({operation:f,searchText:a,attributeNames:b,completeInfo:e},c,d)},i.prototype.getExternalIdMapping=function(a,b){this.asyncPropertyOperation({operation:g},a,b)},i.prototype.getObjectTree=function(a,b){var d=this;if(d.instanceTree)a(d.instanceTree);else if(d.propertyDbError||"hasObjectProperties"in d)b&&b(d.propertyDbError);else{var e=function(){d.eventTarget.removeEventListener(c.OBJECT_TREE_CREATED_EVENT,e),d.eventTarget.removeEventListener(c.OBJECT_TREE_UNAVAILABLE_EVENT,e),d.getObjectTree(a,b)};d.eventTarget.addEventListener(c.OBJECT_TREE_CREATED_EVENT,e),d.eventTarget.addEventListener(c.OBJECT_TREE_UNAVAILABLE_EVENT,e)}},d.PropDbLoader=i}(),function(){"use strict";var a=Autodesk.Viewing,b=a.Private,c=a.isNodeJS?10:a.isMobileDevice()?2:6,d="LOAD_GEOMETRY",e="LOAD_SVF",f="LOAD_SVF_CONTD",g=function(c){this.viewer3DImpl=c,this.next_pack=0,this.loading=!1,this.loadedPacksCount=0,this.loadedPacks=[],this.tmpMatrix=new THREE.Matrix4,this.tmpBox=new THREE.Box3,this.logger=b.logger,this.loadTime=0,this.domainParam=a.getUseCredentials()&&!a.isNodeJS?"domain="+encodeURIComponent(window.location.origin):""};g.prototype.dtor=function(){if(this.svf=null,this.options=null,this.svfWorker&&(this.svfWorker.clearAllEventListenerWithIntercept(),this.svfWorker.terminate(),this.svfWorker=null),this.pack_workers){for(var a=0;a<this.pack_workers.length;a++)this.pack_workers[a].clearAllEventListenerWithIntercept(),this.pack_workers[a].terminate();this.pack_workers=null}},b.pathToURL=function(a){if(a.indexOf("://")!==-1||0===a.indexOf("urn:"))return a;if("undefined"==typeof window)return a;var b=window.location.pathname,c=b.lastIndexOf("/");b=b.substr(0,c+1);var d=window.location.protocol+"//"+window.location.host+b+a;return d},g.prototype.loadFile=function(a,c,d,e,f){if(this.loading)return b.logger.log("Loading of SVF already in progress. Ignoring new request."),!1;this.dtor();var g=a.indexOf("urn:");if(g!=-1){a=decodeURIComponent(a);var h=a.substr(g,a.substr(g).indexOf("/"));b.logger.log("Extracted URN: "+h);var i=h.lastIndexOf(":");this.svfUrn=h.substr(i+1)}else this.svfUrn=a;this.sharedDbPath=c.sharedPropertyDbPath,this.currentLoadPath=a;var j=this.currentLoadPath.lastIndexOf("/");j!=-1&&(this.basePath=this.currentLoadPath.substr(0,j+1)),this.acmSessionId=c.acmSessionId,this.queryParam=this.domainParam,this.acmSessionId&&(this.queryParam&&(this.queryParam+="&"),this.queryParam+="acmsession="+this.acmSessionId),this.options=c;var k=this;return b.initWorkerScript(function(){k.loadSvfCB(a,c,d,e,f)}),!0},g.prototype.interceptManifest=void 0,g.prototype.loadSvfCB=function(d,g,h,i,j){this.t0=(new Date).getTime(),this.firstPixelTimestamp=null,this.failedToLoadSomeGeometryPacks=null;var k=!0,l=this,m={url:b.pathToURL(d),basePath:this.currentLoadPath,objectIds:g.ids,globalOffset:g.globalOffset,placementTransform:g.placementTransform,applyRefPoint:g.applyRefPoint,queryParams:this.queryParam,bvhOptions:g.bvhOptions||{isWeakDevice:a.isMobileDevice()},applyScaling:g.applyScaling};b.memoryOptimizedSvfLoading&&(m.perfOpt={memoryOptimizedSvfLoading:b.memoryOptimizedSvfLoading,forceMemoryOptimizedMode:b.forceMemoryOptimizedModeOnSvfLoading}),g.useConsolidation&&!g.bvhOptions&&(m.bvhOptions.frags_per_leaf_node=256,m.bvhOptions.max_polys_per_node=5e4);var n=this.svfWorker=b.createWorkerWithIntercept(),o=function(d){var e=function(){n.clearAllEventListenerWithIntercept(),n.terminate(),l.svfWorker=null,n=null};if(k&&j&&(k=!1,j()),d.data&&d.data.manifest)l.interceptManifest(d.data.manifest),m.operation=f,m.manifest=d.data.manifest,n.doOperation(m);else if(d.data&&d.data.svf){var g=l.svf=d.data.svf;l.failedToLoadSomeGeometryPacks&&(i&&i(l.failedToLoadSomeGeometryPacks.code,l.failedToLoadSomeGeometryPacks.msg),l.failedToLoadSomeGeometryPacks=null),l.onModelRootLoadDone(g),h&&h(l.model),l.viewer3DImpl.api.fireEvent({type:a.MODEL_ROOT_LOADED_EVENT,svf:g,model:l.model}),l.svf.loadDone=!1;var o=!1;if(l.svf.metadata&&l.svf.metadata.gltf&&(o=!0),!o){var p=g.geompacks.length;if(0==p)l.onGeomLoadDone();else if(l.model.getFragmentList().onDemandLoadingEnabled())b.logger.debug("[On Demand Loading]: Enabled."),l.loadedPacksCount=0;else if(p)for(var q=Math.min(p,c),r=0;r<q;r++){var s=g.geompacks[l.next_pack++];s.loading=!0,a.isNodeJS?l.loadGeometryPack(s.id,s.uri):!function(a){setTimeout(function(){l.loadGeometryPack(a.id,a.uri)},200*r)}(s)}}1==d.data.progress&&(l.loading=!1,e()),g.fragments.polygonCounts||(g.fragments.polygonCounts=new Int32Array(g.fragments.length)),d.data.bvh&&(l.svf.bvh=d.data.bvh,l.model.setBVH(new b.NodeArray(l.svf.bvh.nodes,l.svf.bvh.useLeanNodes),l.svf.bvh.primitives,l.options.bvhOptions),l.viewer3DImpl.invalidate(!1,!0))}else d.data&&d.data.bvh?(l.svf.bvh||(l.svf.bvh=d.data.bvh,l.model.setBVH(new b.NodeArray(l.svf.bvh.nodes,l.svf.bvh.useLeanNodes),l.svf.bvh.primitives,l.options.bvhOptions),l.viewer3DImpl.invalidate(!1,!0)),l.loading=!1,e()):d.data&&d.data.mesh?(l.processReceivedMesh(d.data),1===d.data.progress&&(l.onGeomLoadDone(),l.loading=!1,e())):d.data&&d.data.progress?1==d.data.progress&&(l.loading=!1,e()):d.data&&d.data.error?(l.loading=!1,e(),i&&i(d.data.error.code,d.data.error.msg,d.data.error.args.httpStatus,d.data.error.args.httpStatusText)):d.data&&d.data.debug?b.logger.debug(d.data.message):(b.logger.error("SVF download failed."),l.loading=!1,e())};return n.addEventListenerWithIntercept(o),m.operation=e,m.interceptManifest=!!this.interceptManifest,n.doOperation(b.initLoadContext(m)),!0},g.prototype.loadGeometryPackOnDemand=function(a){var e=this,f=e.svf.geompacks[a];if(!f.loading){this.t0||(this.t0=(new Date).getTime());var g,h=function(a){if(a.data&&a.data.meshes){for(var c=a.data.meshes,d={packId:a.data.packId,meshIndex:0,mesh:null},f=0;f<c.length;f++){var g=c[f];g&&(d.meshIndex=f,d.mesh=g,e.processReceivedMesh(d))}if(a.data.progress>=1){e.pack_workers[a.data.workerId].queued-=1,e.svf.geompacks[a.data.packId].loading=!1;var h=e.model.geomPacksMissingLastFrame(),i=h.indexOf(a.data.packId);i>=0&&h.splice(i,1);for(var j=!0,k=0;k<e.pack_workers.length;k++)if(0!=e.pack_workers[k].queued){j=!1;break}e.loadedPacks.indexOf(a.data.packId)==-1&&e.loadedPacks.push(a.data.packId),j&&0==e.model.geomPacksMissingLastFrame().length&&e.onDemandGeomLoadDone()}}else if(a.data&&a.data.progress){e.pack_workers[a.data.workerId].queued-=1,e.loadedPacksCount++;var l,m=null,h=e.model.geomPacksMissingLastFrame();for(f=0;f<h.length&&(l=h[f],m=e.svf.geompacks[l],m.loading);++f);m&&!m.loading&&e.loadGeometryPackOnDemand(l),e.viewer3DImpl.signalProgress(100*e.loadedPacks.length/e.svf.geompacks.length)}else a.data&&a.data.debug?b.logger.debug(a.data.message):a.data&&a.data.error?e.failedToLoadSomeGeometryPacks={code:a.data.error.code,msg:a.data.error.msg}:(e.pack_workers[a.data.workerId].queued-=2,e.svf.geompacks[a.data.packId].loading=!1)};if(!this.pack_workers)for(this.pack_workers=[],g=0;g<c;g++){var i=b.createWorkerWithIntercept();i.addEventListenerWithIntercept(h),i.queued=0,this.pack_workers.push(i)}var j=0,k=this.pack_workers[0].queued;for(g=1;g<c;g++)this.pack_workers[g].queued<k&&(j=g,k=this.pack_workers[g].queued);if(k>2)return void(this.model.addGeomPackMissingLastFrame(a)||this.viewer3DImpl.invalidate(!1,!0));var l,m,n=f.uri;l=this.pack_workers[j],l.queued+=2,m=j,f.loading=!0,e.svf.partPacksLoadDone=!1,b.logger.debug("[On Demand Loading] Loading Geometry Pack file: "+a);var o=b.pathToURL(this.svf.basePath+n),p={operation:d,url:o,packId:parseInt(a),workerId:m,skipAssetCallback:!0,queryParams:this.queryParam};l.doOperation(b.initLoadContext(p))}},g.prototype.loadGeometryPack=function(a,e){var f,g,h,i,j=this;if(this.svf){var k=function(a){if(a.data&&a.data.meshes){for(var c=a.data.meshes,d={packId:a.data.packId,meshIndex:0,mesh:null},e=0;e<c.length;e++){var f=c[e];f&&(d.meshIndex=e,d.mesh=f,j.processReceivedMesh(d))}if(a.data.progress>=1){j.pack_workers[a.data.workerId].queued-=1,j.loadedPacksCount++,j.viewer3DImpl.signalProgress(100*j.loadedPacksCount/j.svf.geompacks.length);var g=!0;for(i=0;i<j.pack_workers.length;i++)if(0!=j.pack_workers[i].queued){g=!1;break}if(g){for(i=0;i<j.pack_workers.length;i++)j.pack_workers[i].clearAllEventListenerWithIntercept(),j.pack_workers[i].terminate();j.pack_workers=null}j.svf.fragments.numLoaded==j.svf.fragments.length&&j.onGeomLoadDone()}}else if(a.data&&a.data.progress){if(j.pack_workers[a.data.workerId].queued-=1,j.next_pack<j.svf.geompacks.length){var h=null,k=j.model.geomPacksMissingLastFrame();for(e=0;e<k.length&&(h=j.svf.geompacks[k[e]],!h||h.loading);++e);if(!h||h.loading)for(;j.next_pack<j.svf.geompacks.length&&(h=j.svf.geompacks[j.next_pack++],h.loading););h&&!h.loading?(h.loading=!0,j.loadGeometryPack(h.id,h.uri)):(j.viewer3DImpl.modelQueue().enforceBvh=!1,j.svf.fragments.packIds=null)}}else a.data&&a.data.debug?b.logger.debug(a.data.message):a.data&&a.data.error?j.failedToLoadSomeGeometryPacks={code:a.data.error.code,msg:a.data.error.msg}:j.pack_workers[a.data.workerId].queued-=2},l=this.pack_workers;if(l||(l=this.pack_workers=[]),l.length<c){for(var m=!0,h=0;h<l.length;h++)if(0===l.queued){m=!1;break}if(m){var n=b.createWorkerWithIntercept();n.addEventListenerWithIntercept(k),n.queued=0,l.push(n)}}var o=0,p=l[0].queued;for(h=1;h<l.length;h++)l[h].queued<p&&(o=h,p=l[h].queued);f=l[o],f.queued+=2,g=o;var q=b.pathToURL(this.svf.basePath+e),r={operation:d,url:q,packId:parseInt(a),workerId:g,queryParams:this.queryParam};f.doOperation(b.initLoadContext(r))}},g.prototype.checkCull=function(a,b,c){var d=this.tmpBox;if(a.getWorldBounds(b,d),!c.intersectsBox(d))return!0;var e=c.projectedArea(d);return e*=c.areaConv,e<c.areaCullThreshold},g.prototype.processReceivedMesh=function(a){var c=a.packId+":"+a.meshIndex,d=this.svf,e=d.fragments,f=this.model,g=e.mesh2frag[c];if(void 0===g)return void b.logger.warn("Mesh "+c+" was not referenced by any fragments.");Array.isArray(g)||(g=[g]),b.BufferGeometryUtils.meshToGeometry(a);var h=g.length,i=f.getFragmentList().getGeometryId(g[0]),j=f.getGeometryList().addGeometry(a.geometry,h,i);f.getFragmentList().onDemandLoadingEnabled()&&h>1&&null==f.getFragmentList().geomidsmap[j]&&(f.getFragmentList().geomidsmap[j]={n:h,t:0});for(var k=a.geometry.attributes.index.array||a.geometry.ib,l=k.length/3,m=0;m<g.length;m++){var n=0|g[m];f.getFragmentList().getOriginalWorldMatrix(n,this.tmpMatrix);var o=e.materials[n].toString();e.polygonCounts&&(e.polygonCounts[n]=l);var p=this.viewer3DImpl.setupMesh(this.model,a.geometry,o,this.tmpMatrix);f.activateFragment(n,p,!!d.placementTransform)}this.model.getFragmentList().onDemandLoadingEnabled()||(e.mesh2frag[c]=null),e.numLoaded+=g.length,d.geomPolyCount>d.nextRepaintPolys&&(this.firstPixelTimestamp=this.firstPixelTimestamp||Date.now(),d.numRepaints++,d.nextRepaintPolys+=1e4*Math.pow(1.5,d.numRepaints),this.viewer3DImpl.invalidate(!1,!0))},g.prototype.onModelRootLoadDone=function(c){c.geomPolyCount=0,c.instancePolyCount=0,c.geomMemory=0,c.fragments.numLoaded=0,c.meshCount=0,c.gpuNumMeshes=0,c.gpuMeshMemory=0,c.nextRepaintPolys=0,c.numRepaints=0,c.urn=this.svfUrn,c.acmSessionId=this.acmSessionId,c.basePath=this.basePath,c.loadOptions=this.options;var d=Date.now();this.loadTime+=d-this.t0,b.logger.log("SVF load: "+(d-this.t0));var e=this.model=new a.Model(c);e.loader=this;var f=this.viewer3DImpl.api.config?this.viewer3DImpl.api.config.memPerfOpts||{}:{};this.viewer3DImpl.modelQueue().getModels().length>0&&(f.pageOutGeometryEnabled=!1),e.initialize({fragsPersistentCont:f.fragsPersistentCont>0?f.fragsPersistentCont:b.FRAGS_PERSISTENT_COUNT,fragsPersistentMaxCount:f.fragsPersistentMaxCount>0?f.fragsPersistentMaxCount:b.FRAGS_PERSISTENT_MAX_COUNT,geomCountLimit:f.geomCountLimit>0?f.geomCountLimit:b.GEOMS_COUNT_LIMIT,pageOutPercentage:f.pageOutPercentage>0&&f.pageOutPercentage<1?f.pageOutPercentage:b.PAGEOUT_PERCENTAGE,maxQueuedGeomPFForLoading:f.maxQueuedGeomPFForLoading>0?f.maxQueuedGeomPFForLoading:WGS.MAX_QUEUED_GEOM_PF_FOR_LOADING,pixelCullingEnable:void 0!==f.pixelCullingEnable?f.pixelCullingEnable:WGS.pixelCullingEnable,pixelCullingThreshold:f.pixelCullingThreshold>0?f.pixelCullingThreshold:WGS.PIXEL_CULLING_THRESHOLD,onDemandLoading:void 0!==f.onDemandLoading?f.onDemandLoading:b.onDemandLoading,pageOutGeometryEnabled:void 0!==f.pageOutGeometryEnabled?f.pageOutGeometryEnabled:b.pageOutGeometryEnabled,forceOnDemandLoading:void 0!==f.forceOnDemandLoading?f.forceOnDemandLoading:WGS.forceOnDemandLoading,requestGeometryCallback:this.loadGeometryPackOnDemand.bind(this)});var g=!(this.model.getFragmentList().onDemandLoadingEnabled()&&a.isMobileDevice());g&&!this.options.skipPropertyDb&&this.loadPropertyDb();var h=this.viewer3DImpl.matman().convertMaterials(c);if(this.t0=d,c.bbox=(new THREE.Box3).copy(c.bbox),c.modelBox&&(c.modelBox=(new THREE.Box3).copy(c.modelBox)),c.refPointTransform&&(c.refPointTransform=new LmvMatrix4(!0).copy(c.refPointTransform)),c.placementTransform&&(c.placementTransform=new LmvMatrix4(!0).copy(c.placementTransform)),c.cameras)for(var i=0;i<c.cameras.length;i++){var j=c.cameras[i];j.position=(new THREE.Vector3).copy(j.position),j.target=(new THREE.Vector3).copy(j.target),j.up=(new THREE.Vector3).copy(j.up)}c.proteinMaterials&&PROTEIN_ROOT&&PRISM_ROOT&&this.viewer3DImpl.matman().loadTextures(c),b.logger.log("scene bounds: "+JSON.stringify(c.bbox));var k={category:"metadata_load_stats",urn:c.urn,has_topology:!!c.topology,has_animations:!!c.animations,cameras:c.cameras?c.cameras.length:0,lights:c.lights?c.lights.length:0,materials:h};b.logger.track(k),this.viewer3DImpl.signalProgress(5),this.viewer3DImpl.invalidate(!1,!1)},g.prototype.addTransparencyFlagsToMaterials=function(a){for(var b in a){var c=a[b],d=c.userassets;if(d){var e=c.materials,f=e[d[0]];c.transparent=f.transparent}}},g.prototype.makeBVH=function(c){var d=performance.now(),e=c.materials?c.materials.materials:null;e&&this.addTransparencyFlagsToMaterials(e),c.bvh=new b.BVHBuilder(c.fragments,e),c.bvh.build(this.options.bvhOptions||{isWeakDevice:a.isMobileDevice()});var f=performance.now();b.logger.log("BVH build time: "+(f-d))},g.prototype.onDemandGeomLoadDone=function(){!this.svf.proteinMaterials||!PROTEIN_ROOT||!PRISM_ROOT;var a=Date.now(),c="[On Demand Loading]: On demand requested geometries load time: "+(a-this.t0);this.t0=null,b.logger.log(c);var d={category:"on_demand_geom_load_stats",is_f2d:!1,has_prism:this.viewer3DImpl.matman().hasPrism,load_time:a-this.t0,geometry_size:this.model.getGeometryList().geomMemory,meshes_count:this.model.getGeometryList().geoms.length,fragments_count:this.model.getFragmentList().getCount(),load_pack_count:this.loadedPacksCount,urn:this.svfUrn};b.logger.track(d,!0),this.loadedPacksCount=0,this.svf.partPacksLoadDone=!0,this.viewer3DImpl.onDemandLoadComplete(this.model)},g.prototype.onGeomLoadDone=function(){function c(b){var c={command:"assets",data:b};a.isBrowser&&window.webkit.messageHandlers.callbackHandler.postMessage(c)}this.svf.loadDone=!0,this.svf.proteinMaterials&&PROTEIN_ROOT&&PRISM_ROOT||this.viewer3DImpl.matman().loadTextures(this.svf),this.svf.fragments.entityIndexes=null,this.svf.fragments.mesh2frag=null;var d=Date.now(),e="Fragments load time: "+(d-this.t0);this.loadTime+=d-this.t0;var f=this.firstPixelTimestamp-this.t0;if(e+=" (first pixel time: "+f+")",this.svf.bvh&&!this.svf.placementTransform||(this.makeBVH(this.svf),this.model.setBVH(this.svf.bvh.nodes,this.svf.bvh.primitives,this.options.bvhOptions)),b.logger.log(e),this.options.useConsolidation){var g=this.viewer3DImpl.glrenderer();this.model.consolidate(this.viewer3DImpl.getMaterials(),this.options.consolidationMemoryLimit,g)}var h={category:"model_load_stats",is_f2d:!1,has_prism:this.viewer3DImpl.matman().hasPrism,load_time:this.loadTime,geometry_size:this.model.getGeometryList().geomMemory,meshes_count:this.model.getGeometryList().geoms.length,fragments_count:this.model.getFragmentList().getCount(),urn:this.svfUrn};f>0&&(h.first_pixel_time=f),b.logger.track(h,!0),b.assets&&a.isBrowser&&window.webkit&&(c(b.assets),b.assets=null),this.currentLoadPath=null,this.viewer3DImpl.onLoadComplete(this.model)},g.prototype.loadPropertyDb=function(){this.svf.propWorker=new b.PropDbLoader(this.sharedDbPath,this.model,this.viewer3DImpl.api),this.svf.propWorker.load()},b.SvfLoader=g,a.FileLoaderManager.registerFileLoader("svf",["svf","gltf","glb"],b.SvfLoader)}(),function(){"use strict";function a(a){this.viewer3DImpl=a,this.loading=!1,this.tmpMatrix=new THREE.Matrix4,this.logger=c.logger,this.loadTime=0,this.domainParam=b.getUseCredentials()&&!b.isNodeJS?"domain="+encodeURIComponent(window.location.origin):""}var b=Autodesk.Viewing,c=b.Private,d="PARSE_F2D",e="STREAM_F2D",f="PARSE_F2D_FRAME";a.prototype.dtor=function(){this.svf=null,this.options=null,this.parsingWorker&&(this.parsingWorker.terminate(),this.parsingWorker=null),this.streamingWorker&&(this.streamingWorker.terminate(),this.streamingWorker=null)},a.prototype.loadFile=function(a,b,d,e,f){if(this.loading)return c.logger.log("Loading of F2D already in progress. Ignoring new request."),!1;this.dtor();var g=a.indexOf("urn:");if(g!=-1){a=decodeURIComponent(a);var h=a.substr(g,a.substr(g).indexOf("/"));c.logger.log("Extracted URN: "+h);var i=h.lastIndexOf(":");this.svfUrn=h.substr(i+1)}else this.svfUrn=a;this.sharedDbPath=b.sharedPropertyDbPath,this.currentLoadPath=a,this.acmSessionId=b.acmSessionId,this.queryParam=this.domainParam,this.acmSessionId&&(this.queryParam&&(this.queryParam+="&"),this.queryParam+="acmsession="+this.acmSessionId),this.options=b,this.options.placementTransform?this.modelScale=this.options.modelScale||this.options.placementTransform.getMaxScaleOnAxis():this.modelScale=this.options.modelScale||1,this.isf2d=!0;var j=this;return c.initWorkerScript(function(){j.loadFydoCB(a,b,d,e,f)}),!0},a.prototype.loadFydoCB=function(a,g,h,i,j){this.t0=Date.now();var k=c.pathToURL(a),l=this.streamingWorker=c.createWorker(),m=this.parsingWorker=c.createWorker(),n=this,o=!0,p=function(a){if(o&&j&&(o=!1,j()),a.data&&"F2DBLOB"==a.data.type){var e={operation:d,data:a.data.buffer,metadata:a.data.metadata,manifest:a.data.manifest,basePath:a.data.basePath,f2dLoadOptions:{modelSpace:g.modelSpace,bgColor:g.bgColor,isMobile:b.isMobileDevice()},url:k};m.doOperation(e,[e.data]),l.terminate()}else if(a.data&&"F2DSTREAM"==a.data.type){var e={operation:f,data:a.data.frames,url:k,f2dLoadOptions:{modelSpace:g.modelSpace,bgColor:g.bgColor,isMobile:b.isMobileDevice()}};a.data.metadata&&(e.metadata=a.data.metadata,e.manifest=a.data.manifest),a.data.finalFrame&&(e.finalFrame=!0),a.data.progress&&n.viewer3DImpl.signalProgress(100*a.data.progress),m.doOperation(e,e.data?[e.data]:void 0),a.data.finalFrame&&l.terminate()}else a.data&&"F2DAssetURL"==a.data.type?c.assets=c.assets.concat(a.data.urls):a.data&&a.data.assetRequest?c.assets.push(a.data.assetRequest):a.data&&a.data.progress||(a.data&&a.data.debug?c.logger.debug(a.data.message):a.data&&a.data.error?(n.loading=!1,l.terminate(),i&&i.call(this,a.data.error.code,a.data.error.msg,a.data.error.args.httpStatus,a.data.error.args.httpStatusText)):(c.logger.error("F2D download failed."),n.loading=!1,l.terminate()))},q=function(a){if(o&&j&&(o=!1,j()),a.data&&a.data.f2d){var d=n.svf=a.data.f2d;m.terminate(),c.logger.info("Num polylines: "+d.numPolylines),c.logger.info("Line segments: "+d.numLineSegs),c.logger.info("Circular arcs: "+d.numCircles),c.logger.info("Ellipitcal arcs:"+d.numEllipses),c.logger.info("Plain triangles:"+d.numTriangles),c.logger.info("Total # of op codes generated by fydo.parse: "+d.opCount),n.onModelRootLoadDone(n.svf),h&&h(n.model),n.viewer3DImpl.api.fireEvent({type:b.MODEL_ROOT_LOADED_EVENT,svf:n.svf,model:n.model});for(var e=0;e<d.meshes.length;e++)n.processReceivedMesh2D(d.meshes[e],e);d.meshes=null,n.onGeomLoadDone(),n.loading=!1}else if(a.data&&a.data.f2dframe){var f=0;if(a.data.meshes){var g=a.data.bbox;n.svf.bbox=new THREE.Box3(g.min,g.max),f=a.data.baseIndex}else n.svf=a.data.f2dframe,f=a.data.baseIndex;var d=n.svf;if(d.fragments&&d.fragments.initialized||(n.onModelRootLoadDone(d),h&&h(n.model),n.viewer3DImpl.api.fireEvent({type:b.MODEL_ROOT_LOADED_EVENT,svf:d,model:n.model})),a.data.meshes&&a.data.meshes.length)for(var e=0;e<a.data.meshes.length;e++)n.processReceivedMesh2D(a.data.meshes[e],f+e);if(a.data.finalFrame){var k=a.data.cumulativeProps;for(var l in k)d[l]=k[l];n.onGeomLoadDone(),n.loading=!1,m.terminate()}}else a.data&&a.data.progress||(a.data&&a.data.debug?c.logger.debug(a.data.message):a.data&&a.data.error?(n.loading=!1,m.terminate(),c.logger.error("Error while parsing F2d: "+JSON.stringify(a.data.error.args)),i&&i.call(this,a.data.error.code,a.data.error.msg,a.data.error.args.httpStatus,a.data.error.args.httpStatusText)):(c.logger.error("F2D download failed."),n.loading=!1,m.terminate()))};l.addEventListener("message",p,!1),m.addEventListener("message",q,!1);var r={operation:e,url:k,objectIds:g.ids,queryParams:this.queryParam};return l.doOperation(c.initLoadContext(r)),!0},a.prototype.processReceivedMesh=function(a){var b=a.packId+":"+a.meshIndex,d=this.svf,e=d.fragments,f=e.mesh2frag[b];if(void 0===f)return void c.logger.warn("Mesh "+b+" was not referenced by any fragments.");
Array.isArray(f)||(f=[f]),c.BufferGeometryUtils.meshToGeometry(a);for(var g=f.length,h=this.model,i=(h.getGeometryList().addGeometry(a.geometry,g),a.geometry.attributes.index.array||a.geometry.ib),j=i.length/3,k=0;k<f.length;k++){var l=0|f[k];h.getFragmentList().getOriginalWorldMatrix(l,this.tmpMatrix),this.options.placementTransform&&(this.tmpMatrix=(new THREE.Matrix4).multiplyMatrices(this.options.placementTransform,this.tmpMatrix));var m=e.materials[l].toString();e.polygonCounts&&(e.polygonCounts[l]=j);var n=this.viewer3DImpl.setupMesh(this.model,a.geometry,m,this.tmpMatrix);h.activateFragment(l,n)}e.mesh2frag[b]=null,e.numLoaded+=f.length;e.numLoaded},a.prototype.processReceivedMesh2D=function(a,b){var c={mesh:a,is2d:!0,packId:"0",meshIndex:b},d="0:"+b,e=this.svf.fragments,f=Object.keys(c.mesh.dbIds).map(function(a){return parseInt(a)});e.fragId2dbId[b]=f;for(var g=0;g<f.length;g++){var h=f[g],i=e.dbId2fragId[h];Array.isArray(i)?i.push(b):"undefined"!=typeof i?e.dbId2fragId[h]=[i,b]:e.dbId2fragId[h]=b}e.mesh2frag[d]=b,a.material.modelScale=this.modelScale,e.materials[b]=this.viewer3DImpl.matman().create2DMaterial(this.svf,a.material),e.length++,this.processReceivedMesh(c)},a.prototype.onModelRootLoadDone=function(a){a.fragments={},a.fragments.mesh2frag={},a.fragments.materials=[],a.fragments.fragId2dbId=[],a.fragments.dbId2fragId=[],a.fragments.length=0,a.fragments.initialized=!0,a.geomPolyCount=0,a.instancePolyCount=0,a.geomMemory=0,a.fragments.numLoaded=0,a.meshCount=0,a.gpuNumMeshes=0,a.gpuMeshMemory=0,a.nextRepaintPolys=1e4,a.numRepaints=0,a.urn=this.svfUrn,a.acmSessionId=this.acmSessionId,a.basePath="";var d=this.currentLoadPath.lastIndexOf("/");d!=-1&&(a.basePath=this.currentLoadPath.substr(0,d+1)),a.loadOptions=this.options;var e=Date.now();this.loadTime+=e-this.t0,c.logger.log("SVF load: "+(e-this.t0)),this.t0=e,a.bbox=(new THREE.Box3).copy(a.bbox);var f=this.model=new b.Model(a);f.initialize(this),f.loader=this,this.svf.propWorker=new c.PropDbLoader(this.sharedDbPath,this.model,this.viewer3DImpl.api),c.logger.log("scene bounds: "+JSON.stringify(a.bbox));var g={category:"metadata_load_stats",urn:a.urn,layers:a.layerCount};c.logger.track(g),this.viewer3DImpl.signalProgress(5),this.viewer3DImpl.invalidate(!1,!1)},a.prototype.onGeomLoadDone=function(){function a(a){if(b.isBrowser){var c=window.webkit.messageHandlers.callbackHandler,d=c.doOperation||c.postMessage;d&&d({command:"assets",data:a})}}this.svf.loadDone=!0,this.svf.fragments.entityIndexes=null,this.svf.fragments.mesh2frag=null;var d=Date.now(),e="Fragments load time: "+(d-this.t0);this.loadTime+=d-this.t0,this.options.skipPropertyDb||this.loadPropertyDb(),c.logger.log(e);var f={category:"model_load_stats",is_f2d:!0,has_prism:this.viewer3DImpl.matman().hasPrism,load_time:this.loadTime,geometry_size:this.model.getGeometryList().geomMemory,meshes_count:this.model.getGeometryList().geoms.length,urn:this.svfUrn};c.logger.track(f,!0),c.assets&&b.isBrowser&&window.webkit&&(a(c.assets),c.assets=null),this.currentLoadPath=null,this.isf2d=void 0,this.viewer3DImpl.onLoadComplete(this.model)},a.prototype.loadPropertyDb=function(){this.svf.propWorker.load()},c.F2DLoader=a,b.FileLoaderManager.registerFileLoader("f2d",["f2d"],c.F2DLoader)}(),function(){"use strict";function a(a){var d=a;this.loadFile=function(a,e,f,g,h){function i(){function d(b){this.bbox=new THREE.Box3,this.basePath=a,this.is2d=!0;var c=b&&b.paperWidth>=0?b.paperWidth:k.texWidth,d=b&&b.paperHeight>=0?b.paperHeight:k.texHeight;this.pageToModelTransform=k.getPageToModelTransform(c,d),this.metadata=new Object,this.metadata.page_dimensions=new Object;var e=this.metadata.page_dimensions;e.page_width=c,e.page_height=d,e.page_units=b.paperUnits,this.loadDone=!0,this.isLeaflet=!0,k.texWidth>0&&(this.maxPixelPerUnit=k.texWidth/k.getQuadWidth())}var g=new d(e.loadOptions);g.loadOptions=e,l.getVisibleBounds(g.bbox);var h=new b.Model(g);h.initFromCustomIterator(l),l.callWhenRefined(function(){var a=Date.now();g.loadTime=a-j,c.logger.log("SVF load: "+g.loadTime)}.bind(this)),f(h)}var j=Date.now(),k=new c.TexQuadConfig;k.initFromLoadOptions(a,e.loadOptions,function(a,b,d){c.loadTextureWithSecurity(a,THREE.UVMapping,b,e.acmSessionId)});var l=null;h&&h();var m=!k.valid();m&&k.initForSimpleImage(a,i),l=new c.ModelIteratorTexQuad(k,d.getMaterials()),m||i()}}var b=Autodesk.Viewing,c=Autodesk.Viewing.Private;a.computeLevelOffset=function(a){for(var b=20,d=1,e=0,f=0;f<b;f++){if(d*=2,d>a)return e;e++}return c.logger.log("unexpected leaflet tileSize"),0},Autodesk.Viewing.Private.LeafletLoader=a,Autodesk.Viewing.FileLoaderManager.registerFileLoader("Leaflet",["jpeg","jpg","png"],c.LeafletLoader)}(),AutodeskNamespace("Autodesk.Viewing.i18n"),function(){function a(){A="aaaa",V()}function b(){A=null,V()}function c(a,b){if(!b||"function"==typeof b)return a;for(var c in b)a[c]=b[c];return a}function d(a,b,c){var d,e=0,f=a.length,g=void 0===f||"[object Array]"!==Object.prototype.toString.apply(a)||"function"==typeof a;if(c)if(g){for(d in a)if(b.apply(a[d],c)===!1)break}else for(;e<f&&b.apply(a[e++],c)!==!1;);else if(g){for(d in a)if(b.call(a[d],d,a[d])===!1)break}else for(;e<f&&b.call(a[e],e,a[e++])!==!1;);return a}function e(a){return"string"==typeof a?a.replace(/[&<>"'\/]/g,function(a){return K[a]}):a}function f(a){var b=function(a){if(window.XMLHttpRequest)return a(null,new XMLHttpRequest);if(window.ActiveXObject)try{return a(null,new ActiveXObject("Msxml2.XMLHTTP"))}catch(b){return a(null,new ActiveXObject("Microsoft.XMLHTTP"))}return a(new Error)},c=function(a){if("string"==typeof a)return a;var b=[];for(var c in a)a.hasOwnProperty(c)&&b.push(encodeURIComponent(c)+"="+encodeURIComponent(a[c]));return b.join("&")},d=function(a){a=a.replace(/\r\n/g,"\n");for(var b="",c=0;c<a.length;c++){var d=a.charCodeAt(c);d<128?b+=String.fromCharCode(d):d>127&&d<2048?(b+=String.fromCharCode(d>>6|192),b+=String.fromCharCode(63&d|128)):(b+=String.fromCharCode(d>>12|224),b+=String.fromCharCode(d>>6&63|128),b+=String.fromCharCode(63&d|128))}return b},e=function(a){var b="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";a=d(a);var c,e,f,g,h,i,j,k="",l=0;do c=a.charCodeAt(l++),e=a.charCodeAt(l++),f=a.charCodeAt(l++),g=c>>2,h=(3&c)<<4|e>>4,i=(15&e)<<2|f>>6,j=63&f,isNaN(e)?i=j=64:isNaN(f)&&(j=64),k+=b.charAt(g)+b.charAt(h)+b.charAt(i)+b.charAt(j),c=e=f="",g=h=i=j="";while(l<a.length);return k},f=function(){for(var a=arguments[0],b=1;b<arguments.length;b++){var c=arguments[b];for(var d in c)c.hasOwnProperty(d)&&(a[d]=c[d])}return a},g=function(a,d,e,h){"function"==typeof e&&(h=e,e={}),e.doNotCache=e.doNotCache||!1,e.data=e.data||{},e.headers=e.headers||{},e.jsonp=e.jsonp||!1,e.async=void 0===e.async||e.async;var i,j=f({accept:"*/*","content-type":"application/x-www-form-urlencoded;charset=UTF-8"},g.headers,e.headers);if(i="application/json"===j["content-type"]?JSON.stringify(e.data):c(e.data),"GET"===a){var k=[];if(i&&(k.push(i),i=null),e.doNotCache&&k.push("_="+(new Date).getTime()),e.jsonp&&(k.push("callback="+e.jsonp),k.push("jsonp="+e.jsonp)),k=k.join("&"),k.length>1&&(d+=d.indexOf("?")>-1?"&"+k:"?"+k),e.jsonp){var l=document.getElementsByTagName("head")[0],m=document.createElement("script");return m.type="text/javascript",m.src=d,void l.appendChild(m)}}b(function(b,c){if(b)return h(b);c.open(a,d,e.async);for(var f in j)j.hasOwnProperty(f)&&c.setRequestHeader(f,j[f]);c.onreadystatechange=function(){if(4===c.readyState){var a=c.responseText||"";if(!h)return;h(c.status,a)}},c.send(i)})},h={authBasic:function(a,b){g.headers.Authorization="Basic "+e(a+":"+b)},connect:function(a,b,c){return g("CONNECT",a,b,c)},del:function(a,b,c){return g("DELETE",a,b,c)},get:function(a,b,c){return g("GET",a,b,c)},head:function(a,b,c){return g("HEAD",a,b,c)},headers:function(a){g.headers=a||{}},isAllowed:function(a,b,c){this.options(a,function(a,d){c(d.text().indexOf(b)!==-1)})},options:function(a,b,c){return g("OPTIONS",a,b,c)},patch:function(a,b,c){return g("PATCH",a,b,c)},post:function(a,b,c){return g("POST",a,b,c)},put:function(a,b,c){return g("PUT",a,b,c)},trace:function(a,b,c){return g("TRACE",a,b,c)}},i=a.type?a.type.toLowerCase():"get";h[i](a.url,a,function(b,c){200===b?a.success(c,b,null):a.error(c,b,null)})}function g(a,b){"function"==typeof a&&(b=a,a={}),a=a||{},O.extend(J,a),delete J.fixLng,"string"==typeof J.ns&&(J.ns={namespaces:[J.ns],defaultNs:J.ns}),"string"==typeof J.fallbackNS&&(J.fallbackNS=[J.fallbackNS]),"string"!=typeof J.fallbackLng&&"boolean"!=typeof J.fallbackLng||(J.fallbackLng=[J.fallbackLng]),J.interpolationPrefixEscaped=O.regexEscape(J.interpolationPrefix),J.interpolationSuffixEscaped=O.regexEscape(J.interpolationSuffix),J.lng||(J.lng=O.detectLanguage()),J.lng?J.useCookie&&O.cookie.create(J.cookieName,J.lng,J.cookieExpirationTime,J.cookieDomain):(J.lng=J.fallbackLng[0],J.useCookie&&O.cookie.remove(J.cookieName)),H=O.toLanguages(J.lng),B=H[0],O.log("currentLng set to: "+B);var c=u;if(a.fixLng&&(c=function(a,b){return b=b||{},b.lng=b.lng||c.lng,u(a,b)},c.lng=B),Q.setCurrentLng(B),J.resStore)return F=J.resStore,I=!0,void(b&&b(c));var d=O.toLanguages(J.lng);"string"==typeof J.preload&&(J.preload=[J.preload]);for(var e=0,f=J.preload.length;e<f;e++)for(var g=O.toLanguages(J.preload[e]),h=0,i=g.length;h<i;h++)d.indexOf(g[h])<0&&d.push(g[h]);Autodesk.Viewing.i18n.sync.load(d,J,function(a,d){F=d,I=!0,b&&b(c)})}function h(a,b){"string"==typeof a&&(a=[a]);for(var c=0,d=a.length;c<d;c++)J.preload.indexOf(a[c])<0&&J.preload.push(a[c]);return g(b)}function i(a,b,c){"string"!=typeof b?(c=b,b=J.ns.defaultNs):J.ns.namespaces.indexOf(b)<0&&J.ns.namespaces.push(b),F[a]=F[a]||{},F[a][b]=F[a][b]||{},O.extend(F[a][b],c)}function j(a,b){"string"!=typeof b&&(b=J.ns.defaultNs),F[a]=F[a]||{},F[a][b]={}}function k(a){J.ns.defaultNs=a}function l(a,b){m([a],b)}function m(a,b){var c={dynamicLoad:J.dynamicLoad,resGetPath:J.resGetPath,getAsync:J.getAsync,customLoad:J.customLoad,ns:{namespaces:a,defaultNs:""}},d=O.toLanguages(J.lng);"string"==typeof J.preload&&(J.preload=[J.preload]);for(var e=0,f=J.preload.length;e<f;e++)for(var g=O.toLanguages(J.preload[e]),h=0,i=g.length;h<i;h++)d.indexOf(g[h])<0&&d.push(g[h]);for(var j=[],k=0,l=d.length;k<l;k++){var m=!1,n=F[d[k]];if(n)for(var o=0,p=a.length;o<p;o++)n[a[o]]||(m=!0);else m=!0;m&&j.push(d[k])}j.length?Autodesk.Viewing.i18n.sync._fetch(j,c,function(c,d){var e=a.length*j.length;O.each(a,function(a,c){J.ns.namespaces.indexOf(c)<0&&J.ns.namespaces.push(c),O.each(j,function(a,f){F[f]=F[f]||{},F[f][c]=d[f][c],e--,0===e&&b&&(J.useLocalStorage&&Autodesk.Viewing.i18n.sync._storeLocal(F),b())})})}):b&&b()}function n(a,b,c){return"function"==typeof b?(c=b,b={}):b||(b={}),b.lng=a,g(b,c)}function o(){return B}function p(a,b,c,d){if(!a)return a;if(d=d||b,a.indexOf(d.interpolationPrefix||J.interpolationPrefix)<0)return a;var e=d.interpolationPrefix?O.regexEscape(d.interpolationPrefix):J.interpolationPrefixEscaped,f=d.interpolationSuffix?O.regexEscape(d.interpolationSuffix):J.interpolationSuffixEscaped,g="HTML"+f;return O.each(b,function(b,h){var i=c?c+J.keyseparator+b:b;"object"==typeof h&&null!==h?a=p(a,h,i,d):d.escapeInterpolation||J.escapeInterpolation?(a=a.replace(new RegExp([e,i,g].join(""),"g"),h),a=a.replace(new RegExp([e,i,f].join(""),"g"),O.escape(h))):a=a.replace(new RegExp([e,i,f].join(""),"g"),h)}),a}function q(a,b){var c=",",d="{",e="}",f=O.extend({},b);for(delete f.postProcess;a.indexOf(J.reusePrefix)!=-1&&(G++,!(G>J.maxRecursion));){var g=a.lastIndexOf(J.reusePrefix),h=a.indexOf(J.reuseSuffix,g)+J.reuseSuffix.length,i=a.substring(g,h),j=i.replace(J.reusePrefix,"").replace(J.reuseSuffix,"");if(j.indexOf(c)!=-1){var k=j.indexOf(c);if(j.indexOf(d,k)!=-1&&j.indexOf(e,k)!=-1){var l=j.indexOf(d,k),m=j.indexOf(e,l)+e.length;try{f=O.extend(f,JSON.parse(j.substring(l,m))),j=j.substring(0,k)}catch(a){}}}var n=x(j,f);a=a.replace(i,n)}return a}function r(a){return a.context&&("string"==typeof a.context||"number"==typeof a.context)}function s(a){return void 0!==a.count&&"string"!=typeof a.count&&1!==a.count}function t(a,b){b=b||{};var c=v(a,b),d=y(a,b);return void 0!==d||d===c}function u(a,b){if(b=b||{},!I){O.log("i18next not finished initialization. you might have called t function before loading resources finished.");var c=a.indexOf(":");c<0?c=0:c++;var d=b.defaultValue||a.substr(c);return d&&(d=p(d,b)),d}return G=0,x.apply(null,arguments)}function v(a,b){return void 0!==b.defaultValue?b.defaultValue:a}function w(){for(var a=[],b=1;b<arguments.length;b++)a.push(arguments[b]);return{postProcess:"sprintf",sprintf:a}}function x(a,b){if(b&&"object"!=typeof b?"sprintf"===J.shortcutFunction?b=w.apply(null,arguments):"defaultValue"===J.shortcutFunction&&(b={defaultValue:b}):b=b||{},void 0===a||null===a)return"";"string"==typeof a&&(a=[a]);var c=a[0];if(a.length>1)for(var d=0;d<a.length&&(c=a[d],!t(c,b));d++);var e,f=v(c,b),g=y(c,b),h=b.lng?O.toLanguages(b.lng):H,i=b.ns||J.ns.defaultNs;c.indexOf(J.nsseparator)>-1&&(e=c.split(J.nsseparator),i=e[0],c=e[1]),void 0===g&&J.sendMissing&&(b.lng?P.postMissing(h[0],i,c,f,h):P.postMissing(J.lng,i,c,f,h));var j=b.postProcess||J.postProcess;if(void 0!==g&&j&&R[j]&&(g=R[j](g,c,b)),A&&void 0!==g)return A;var k=f;if(f.indexOf(J.nsseparator)>-1&&(e=f.split(J.nsseparator),k=e[1]),k===c&&J.parseMissingKey&&(f=J.parseMissingKey(f)),void 0===g&&(f=p(f,b),f=q(f,b),j&&R[j])){var l=v(c,b);g=R[j](l,c,b)}return void 0!==g?g:f}function y(a,b){b=b||{};var c,d,e=v(a,b),f=H;if(!F)return e;if("cimode"===f[0].toLowerCase())return e;if(b.lng&&(f=O.toLanguages(b.lng),!F[f[0]])){var g=J.getAsync;J.getAsync=!1,Autodesk.Viewing.i18n.sync.load(f,J,function(a,b){O.extend(F,b),J.getAsync=g})}var h=b.ns||J.ns.defaultNs;if(a.indexOf(J.nsseparator)>-1){var i=a.split(J.nsseparator);h=i[0],a=i[1]}if(r(b)){c=O.extend({},b),delete c.context,c.defaultValue=J.contextNotFound;var j=h+J.nsseparator+a+"_"+b.context;if(d=u(j,c),d!=J.contextNotFound)return p(d,{context:b.context})}if(s(b)){c=O.extend({},b),delete c.count,c.defaultValue=J.pluralNotFound;var k=h+J.nsseparator+a+J.pluralSuffix,l=Q.get(f[0],b.count);if(l>=0?k=k+"_"+l:1===l&&(k=h+J.nsseparator+a),d=u(k,c),d!=J.pluralNotFound)return p(d,{count:b.count,interpolationPrefix:b.interpolationPrefix,interpolationSuffix:b.interpolationSuffix})}for(var m,n=a.split(J.keyseparator),o=0,t=f.length;o<t&&void 0===m;o++){for(var w=f[o],z=0,A=F[w]&&F[w][h];n[z];)A=A&&A[n[z]],z++;if(void 0!==A){var B=Object.prototype.toString.apply(A);if("string"==typeof A)A=p(A,b),A=q(A,b);else if("[object Array]"!==B||J.returnObjectTrees||b.returnObjectTrees){if(null===A&&J.fallbackOnNull===!0)A=void 0;else if(null!==A)if(J.returnObjectTrees||b.returnObjectTrees){if("[object Number]"!==B&&"[object Function]"!==B&&"[object RegExp]"!==B){var C="[object Array]"===B?[]:{};O.each(A,function(c){C[c]=x(h+J.nsseparator+a+J.keyseparator+c,b)}),A=C}}else J.objectTreeKeyHandler&&"function"==typeof J.objectTreeKeyHandler?A=J.objectTreeKeyHandler(a,A,w,h,b):(A="key '"+h+":"+a+" ("+w+")' returned an object instead of string.",O.log(A))}else A=A.join("\n"),A=p(A,b),A=q(A,b);"string"==typeof A&&""===A.trim()&&J.fallbackOnEmpty===!0&&(A=void 0),m=A}}if(void 0===m&&!b.isFallbackLookup&&(J.fallbackToDefaultNS===!0||J.fallbackNS&&J.fallbackNS.length>0))if(b.isFallbackLookup=!0,J.fallbackNS.length){for(var D=0,E=J.fallbackNS.length;D<E;D++)if(m=y(J.fallbackNS[D]+J.nsseparator+a,b)){var G=m.indexOf(J.nsseparator)>-1?m.split(J.nsseparator)[1]:m,I=e.indexOf(J.nsseparator)>-1?e.split(J.nsseparator)[1]:e;if(G!==I)break}}else m=y(a,b);return m}function z(){var a,b=[];if("undefined"!=typeof window&&(!function(){for(var a=window.location.search.substring(1),c=a.split("&"),d=0;d<c.length;d++){var e=c[d].indexOf("=");if(e>0){var f=c[d].substring(0,e),g=c[d].substring(e+1);b[f]=g}}}(),b[J.detectLngQS]&&(a=b[J.detectLngQS])),!a&&"undefined"!=typeof document&&J.useCookie){var c=O.cookie.read(J.cookieName);c&&(a=c)}return a||"undefined"==typeof navigator||(a=navigator.language?navigator.language:navigator.userLanguage),a}var A=null;Array.prototype.indexOf||(Array.prototype.indexOf=function(a){"use strict";if(null==this)throw new TypeError;var b=Object(this),c=b.length>>>0;if(0===c)return-1;var d=0;if(arguments.length>0&&(d=Number(arguments[1]),d!=d?d=0:0!=d&&d!=1/0&&d!=-(1/0)&&(d=(d>0||-1)*Math.floor(Math.abs(d)))),d>=c)return-1;for(var e=d>=0?d:Math.max(c-Math.abs(d),0);e<c;e++)if(e in b&&b[e]===a)return e;return-1}),Array.prototype.lastIndexOf||(Array.prototype.lastIndexOf=function(a){"use strict";if(null==this)throw new TypeError;var b=Object(this),c=b.length>>>0;if(0===c)return-1;var d=c;arguments.length>1&&(d=Number(arguments[1]),d!=d?d=0:0!=d&&d!=1/0&&d!=-(1/0)&&(d=(d>0||-1)*Math.floor(Math.abs(d))));for(var e=d>=0?Math.min(d,c-1):c-Math.abs(d);e>=0;e--)if(e in b&&b[e]===a)return e;return-1}),"function"!=typeof String.prototype.trim&&(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")});var B,C=this,D=C.jQuery||C.Zepto,E={},F={},G=0,H=[],I=!1;"undefined"!=typeof module&&module.exports?module.exports=E:(D&&(D.i18n=D.i18n||E),C.i18n=C.i18n||E);var J={lng:void 0,load:"current",preload:[],lowerCaseLng:!1,returnObjectTrees:!1,fallbackLng:["dev"],fallbackNS:[],detectLngQS:"setLng",ns:"translation",fallbackOnNull:!0,fallbackOnEmpty:!1,fallbackToDefaultNS:!1,nsseparator:":",keyseparator:".",selectorAttr:"data-i18n",debug:!1,resGetPath:"res/locales/__lng__/__ns__.json",resPostPath:"res/locales/add/__lng__/__ns__",getAsync:!0,postAsync:!0,resStore:void 0,useLocalStorage:!1,localStorageExpirationTime:6048e5,dynamicLoad:!1,sendMissing:!1,sendMissingTo:"fallback",sendType:"POST",interpolationPrefix:"__",interpolationSuffix:"__",reusePrefix:"$t(",reuseSuffix:")",pluralSuffix:"_plural",pluralNotFound:["plural_not_found",Math.random()].join(""),contextNotFound:["context_not_found",Math.random()].join(""),escapeInterpolation:!1,defaultValueFromContent:!0,useDataAttrOptions:!1,cookieExpirationTime:void 0,useCookie:!0,cookieName:"i18next",cookieDomain:void 0,objectTreeKeyHandler:void 0,postProcess:void 0,parseMissingKey:void 0,shortcutFunction:"sprintf"},K={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"},L=function(a){for(var b,c,d=!1,e=!1,f="",g=0;g<a.length;g++)if(b=a[g],c=a[g+1],e||"\\"===a[g-1]||'"'!==b||(d=!d),d)f+=b;else{if(e||b+c!=="//")if("single"===e&&b+c==="\r\n")e=!1,g++;else if("single"===e&&"\n"===b)e=!1;else{if(!e&&b+c==="/*"){e="multi",g++;continue}if("multi"===e&&b+c==="*/"){e=!1,g++;continue}}else e="single",g++;e||(f+=b)}return f},M={create:function(a,b,c,d){var e;if(c){var f=new Date;f.setTime(f.getTime()+60*c*1e3),e="; expires="+f.toGMTString()}else e="";d=d?"domain="+d+";":"",document.cookie=a+"="+b+e+";"+d+"path=/"},read:function(a){for(var b=a+"=",c=document.cookie.split(";"),d=0;d<c.length;d++){for(var e=c[d];" "==e.charAt(0);)e=e.substring(1,e.length);if(0===e.indexOf(b))return e.substring(b.length,e.length)}return null},remove:function(a){this.create(a,"",-1)}},N={create:function(a,b,c,d){},read:function(a){return null},remove:function(a){}},O={extend:D?D.extend:c,each:D?D.each:d,ajax:D?D.ajax:"undefined"!=typeof document?f:function(){},cookie:"undefined"!=typeof document?M:N,detectLanguage:z,escape:e,log:function(a){J.debug&&"undefined"!=typeof console&&console.log(a)},toLanguages:function(a){var b=[];if("string"==typeof a&&a.indexOf("-")>-1){var c=a.split("-");a=J.lowerCaseLng?c[0].toLowerCase()+"-"+c[1].toLowerCase():c[0].toLowerCase()+"-"+c[1].toUpperCase(),"unspecific"!==J.load&&b.push(a),"current"!==J.load&&b.push(c[0])}else b.push(a);for(var d=0;d<J.fallbackLng.length;d++)b.indexOf(J.fallbackLng[d])===-1&&J.fallbackLng[d]&&b.push(J.fallbackLng[d]);return b},regexEscape:function(a){return a.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")}};O.applyReplacement=p;var P={load:function(a,b,c){b.useLocalStorage?P._loadLocal(a,b,function(d,e){for(var f=[],g=0,h=a.length;g<h;g++)e[a[g]]||f.push(a[g]);f.length>0?P._fetch(f,b,function(a,b){O.extend(e,b),P._storeLocal(b),c(null,e)}):c(null,e)}):P._fetch(a,b,function(a,b){c(null,b)})},_loadLocal:function(a,b,c){var d={},e=(new Date).getTime();if(window.localStorage){var f=a.length;O.each(a,function(a,g){var h=window.localStorage.getItem("res_"+g);h&&(h=JSON.parse(h),h.i18nStamp&&h.i18nStamp+b.localStorageExpirationTime>e&&(d[g]=h)),f--,0===f&&c(null,d)})}},_storeLocal:function(a){if(window.localStorage)for(var b in a)a[b].i18nStamp=(new Date).getTime(),window.localStorage.setItem("res_"+b,JSON.stringify(a[b]))},_fetch:function(a,b,c){var d=b.ns,e={};if(b.dynamicLoad){var f=function(a,b){c(null,b)};if("function"==typeof b.customLoad)b.customLoad(a,d.namespaces,b,f);else{var g=p(b.resGetPath,{lng:a.join("+"),ns:d.namespaces.join("+")});g=Autodesk.Viewing.Private.getResourceUrl(g),O.ajax({url:g,success:function(a,b,c){O.log("loaded: "+g),f(null,a.json())},error:function(a,b,c){O.log("failed loading: "+g),f("failed loading resource.json error: "+c)},dataType:"text",async:b.getAsync})}}else{var h,i=d.namespaces.length*a.length;O.each(d.namespaces,function(d,f){O.each(a,function(a,d){var g=function(a,b){a&&(h=h||[],h.push(a)),e[d]=e[d]||{},e[d][f]=b,i--,0===i&&c(h,e)};"function"==typeof b.customLoad?b.customLoad(d,f,b,g):P._fetchOne(d,f,b,g)})})}},_fetchOne:function(a,b,c,d){var e=p(c.resGetPath,{lng:a,ns:b});e=Autodesk.Viewing.Private.getResourceUrl(e),O.ajax({url:e,success:function(a,b,c){O.log("loaded: "+e);var f=L(a);d(null,JSON.parse(f))},error:function(a,b,c){if(b&&200==b||a&&a.status&&200==a.status)O.log("There is a typo in: "+e);else if(b&&404==b||a&&a.status&&404==a.status)O.log("Does not exist: "+e);else{var f=b?b:a&&a.status?a.status:null;O.log(f+" when loading "+e)}d(c,{})},dataType:"text",async:c.getAsync})},postMissing:function(a,b,c,d,e){var f={};f[c]=d;var g=[];if("fallback"===J.sendMissingTo&&J.fallbackLng[0]!==!1)for(var h=0;h<J.fallbackLng.length;h++)g.push({lng:J.fallbackLng[h],url:p(J.resPostPath,{lng:J.fallbackLng[h],ns:b})});else if("current"===J.sendMissingTo||"fallback"===J.sendMissingTo&&J.fallbackLng[0]===!1)g.push({lng:a,url:p(J.resPostPath,{lng:a,ns:b})});else if("all"===J.sendMissingTo)for(var h=0,i=e.length;h<i;h++)g.push({lng:e[h],url:p(J.resPostPath,{lng:e[h],ns:b})});for(var j=0,k=g.length;j<k;j++){var l=g[j];O.ajax({url:l.url,type:J.sendType,data:f,success:function(a,e,f){O.log("posted missing key '"+c+"' to: "+l.url);for(var g=c.split("."),h=0,i=F[l.lng][b];g[h];)i=h===g.length-1?i[g[h]]=d:i[g[h]]=i[g[h]]||{},h++},error:function(a,b,d){O.log("failed posting missing key '"+c+"' to: "+l.url)},dataType:"json",async:J.postAsync})}}},Q={rules:{ach:{name:"Acholi",numbers:[1,2],plurals:function(a){return Number(a>1)}},af:{name:"Afrikaans",numbers:[1,2],plurals:function(a){return Number(1!=a)}},ak:{name:"Akan",numbers:[1,2],plurals:function(a){return Number(a>1)}},am:{name:"Amharic",numbers:[1,2],plurals:function(a){return Number(a>1)}},an:{name:"Aragonese",numbers:[1,2],plurals:function(a){return Number(1!=a)}},ar:{name:"Arabic",numbers:[0,1,2,3,11,100],plurals:function(a){return Number(0===a?0:1==a?1:2==a?2:a%100>=3&&a%100<=10?3:a%100>=11?4:5)}},arn:{name:"Mapudungun",numbers:[1,2],plurals:function(a){return Number(a>1)}},ast:{name:"Asturian",numbers:[1,2],plurals:function(a){return Number(1!=a)}},ay:{name:"Aymará",numbers:[1],plurals:function(a){return 0}},az:{name:"Azerbaijani",numbers:[1,2],plurals:function(a){return Number(1!=a)}},be:{name:"Belarusian",numbers:[1,2,5],plurals:function(a){return Number(a%10==1&&a%100!=11?0:a%10>=2&&a%10<=4&&(a%100<10||a%100>=20)?1:2)}},bg:{name:"Bulgarian",numbers:[1,2],plurals:function(a){return Number(1!=a)}},bn:{name:"Bengali",numbers:[1,2],plurals:function(a){return Number(1!=a)}},bo:{name:"Tibetan",numbers:[1],plurals:function(a){return 0}},br:{name:"Breton",numbers:[1,2],plurals:function(a){return Number(a>1)}},bs:{name:"Bosnian",numbers:[1,2,5],plurals:function(a){return Number(a%10==1&&a%100!=11?0:a%10>=2&&a%10<=4&&(a%100<10||a%100>=20)?1:2)}},ca:{name:"Catalan",numbers:[1,2],plurals:function(a){return Number(1!=a)}},cgg:{name:"Chiga",numbers:[1],plurals:function(a){return 0}},cs:{name:"Czech",numbers:[1,2,5],plurals:function(a){return Number(1==a?0:a>=2&&a<=4?1:2)}},csb:{name:"Kashubian",numbers:[1,2,5],plurals:function(a){return Number(1==a?0:a%10>=2&&a%10<=4&&(a%100<10||a%100>=20)?1:2)}},cy:{name:"Welsh",numbers:[1,2,3,8],plurals:function(a){return Number(1==a?0:2==a?1:8!=a&&11!=a?2:3)}},da:{name:"Danish",numbers:[1,2],plurals:function(a){return Number(1!=a)}},de:{name:"German",numbers:[1,2],plurals:function(a){return Number(1!=a)}},dz:{name:"Dzongkha",numbers:[1],plurals:function(a){return 0}},el:{name:"Greek",numbers:[1,2],plurals:function(a){return Number(1!=a)}},en:{name:"English",numbers:[1,2],plurals:function(a){return Number(1!=a)}},eo:{name:"Esperanto",numbers:[1,2],plurals:function(a){return Number(1!=a)}},es:{name:"Spanish",numbers:[1,2],plurals:function(a){return Number(1!=a)}},es_ar:{name:"Argentinean Spanish",numbers:[1,2],plurals:function(a){return Number(1!=a)}},et:{name:"Estonian",numbers:[1,2],plurals:function(a){return Number(1!=a)}},eu:{name:"Basque",numbers:[1,2],plurals:function(a){return Number(1!=a)}},fa:{name:"Persian",numbers:[1],plurals:function(a){return 0}},fi:{name:"Finnish",numbers:[1,2],plurals:function(a){return Number(1!=a)}},fil:{name:"Filipino",numbers:[1,2],plurals:function(a){return Number(a>1)}},fo:{name:"Faroese",numbers:[1,2],plurals:function(a){return Number(1!=a)}},fr:{name:"French",numbers:[1,2],plurals:function(a){return Number(a>1)}},fur:{name:"Friulian",numbers:[1,2],plurals:function(a){return Number(1!=a)}},fy:{name:"Frisian",numbers:[1,2],plurals:function(a){return Number(1!=a)}},ga:{name:"Irish",numbers:[1,2,3,7,11],plurals:function(a){return Number(1==a?0:2==a?1:a<7?2:a<11?3:4)}},gd:{name:"Scottish Gaelic",numbers:[1,2,3,20],plurals:function(a){return Number(1==a||11==a?0:2==a||12==a?1:a>2&&a<20?2:3)}},gl:{name:"Galician",numbers:[1,2],plurals:function(a){return Number(1!=a)}},gu:{name:"Gujarati",numbers:[1,2],plurals:function(a){return Number(1!=a)}},gun:{name:"Gun",numbers:[1,2],plurals:function(a){return Number(a>1)}},ha:{name:"Hausa",numbers:[1,2],plurals:function(a){return Number(1!=a)}},he:{name:"Hebrew",numbers:[1,2],plurals:function(a){return Number(1!=a)}},hi:{name:"Hindi",numbers:[1,2],plurals:function(a){return Number(1!=a)}},hr:{name:"Croatian",numbers:[1,2,5],plurals:function(a){return Number(a%10==1&&a%100!=11?0:a%10>=2&&a%10<=4&&(a%100<10||a%100>=20)?1:2)}},hu:{name:"Hungarian",numbers:[1,2],plurals:function(a){return Number(1!=a)}},hy:{name:"Armenian",numbers:[1,2],plurals:function(a){return Number(1!=a)}},ia:{name:"Interlingua",numbers:[1,2],plurals:function(a){return Number(1!=a)}},id:{name:"Indonesian",numbers:[1],plurals:function(a){return 0}},is:{name:"Icelandic",numbers:[1,2],plurals:function(a){return Number(a%10!=1||a%100==11)}},it:{name:"Italian",numbers:[1,2],plurals:function(a){return Number(1!=a)}},ja:{name:"Japanese",numbers:[1],plurals:function(a){return 0}},jbo:{name:"Lojban",numbers:[1],plurals:function(a){return 0}},jv:{name:"Javanese",numbers:[0,1],plurals:function(a){return Number(0!==a)}},ka:{name:"Georgian",numbers:[1],plurals:function(a){return 0}},kk:{name:"Kazakh",numbers:[1],plurals:function(a){return 0}},km:{name:"Khmer",numbers:[1],plurals:function(a){return 0}},kn:{name:"Kannada",numbers:[1,2],plurals:function(a){return Number(1!=a)}},ko:{name:"Korean",numbers:[1],plurals:function(a){return 0}},ku:{name:"Kurdish",numbers:[1,2],plurals:function(a){return Number(1!=a)}},kw:{name:"Cornish",numbers:[1,2,3,4],plurals:function(a){return Number(1==a?0:2==a?1:3==a?2:3)}},ky:{name:"Kyrgyz",numbers:[1],plurals:function(a){return 0}},lb:{name:"Letzeburgesch",numbers:[1,2],plurals:function(a){return Number(1!=a)}},ln:{name:"Lingala",numbers:[1,2],plurals:function(a){return Number(a>1)}},lo:{name:"Lao",numbers:[1],plurals:function(a){return 0}},lt:{name:"Lithuanian",numbers:[1,2,10],plurals:function(a){return Number(a%10==1&&a%100!=11?0:a%10>=2&&(a%100<10||a%100>=20)?1:2)}},lv:{name:"Latvian",numbers:[1,2,0],plurals:function(a){return Number(a%10==1&&a%100!=11?0:0!==a?1:2)}},mai:{name:"Maithili",numbers:[1,2],plurals:function(a){return Number(1!=a)}},mfe:{name:"Mauritian Creole",numbers:[1,2],plurals:function(a){return Number(a>1)}},mg:{name:"Malagasy",numbers:[1,2],plurals:function(a){return Number(a>1)}},mi:{name:"Maori",numbers:[1,2],plurals:function(a){return Number(a>1)}},mk:{name:"Macedonian",numbers:[1,2],plurals:function(a){return Number(1==a||a%10==1?0:1)}},ml:{name:"Malayalam",numbers:[1,2],plurals:function(a){return Number(1!=a)}},mn:{name:"Mongolian",numbers:[1,2],plurals:function(a){return Number(1!=a)}},mnk:{name:"Mandinka",numbers:[0,1,2],plurals:function(a){return Number(1==a?1:2)}},mr:{name:"Marathi",numbers:[1,2],plurals:function(a){return Number(1!=a)}},ms:{name:"Malay",numbers:[1],plurals:function(a){return 0}},mt:{name:"Maltese",numbers:[1,2,11,20],plurals:function(a){return Number(1==a?0:0===a||a%100>1&&a%100<11?1:a%100>10&&a%100<20?2:3)}},nah:{name:"Nahuatl",numbers:[1,2],plurals:function(a){return Number(1!=a)}},nap:{name:"Neapolitan",numbers:[1,2],plurals:function(a){return Number(1!=a)}},nb:{name:"Norwegian Bokmal",numbers:[1,2],plurals:function(a){return Number(1!=a)}},ne:{name:"Nepali",numbers:[1,2],plurals:function(a){return Number(1!=a)}},nl:{name:"Dutch",numbers:[1,2],plurals:function(a){return Number(1!=a)}},nn:{name:"Norwegian Nynorsk",numbers:[1,2],plurals:function(a){return Number(1!=a)}},no:{name:"Norwegian",numbers:[1,2],plurals:function(a){return Number(1!=a)}},nso:{name:"Northern Sotho",numbers:[1,2],plurals:function(a){return Number(1!=a)}},oc:{name:"Occitan",numbers:[1,2],plurals:function(a){return Number(a>1)}},or:{name:"Oriya",numbers:[2,1],plurals:function(a){return Number(1!=a)}},pa:{name:"Punjabi",numbers:[1,2],plurals:function(a){return Number(1!=a)}},pap:{name:"Papiamento",numbers:[1,2],plurals:function(a){return Number(1!=a)}},pl:{name:"Polish",numbers:[1,2,5],plurals:function(a){return Number(1==a?0:a%10>=2&&a%10<=4&&(a%100<10||a%100>=20)?1:2)}},pms:{name:"Piemontese",numbers:[1,2],plurals:function(a){return Number(1!=a)}},ps:{name:"Pashto",numbers:[1,2],plurals:function(a){return Number(1!=a)}},pt:{name:"Portuguese",numbers:[1,2],plurals:function(a){return Number(1!=a)}},pt_br:{name:"Brazilian Portuguese",numbers:[1,2],plurals:function(a){return Number(1!=a)}},rm:{name:"Romansh",numbers:[1,2],plurals:function(a){return Number(1!=a)}},ro:{name:"Romanian",numbers:[1,2,20],plurals:function(a){return Number(1==a?0:0===a||a%100>0&&a%100<20?1:2)}},ru:{name:"Russian",numbers:[1,2,5],plurals:function(a){return Number(a%10==1&&a%100!=11?0:a%10>=2&&a%10<=4&&(a%100<10||a%100>=20)?1:2)}},sah:{name:"Yakut",numbers:[1],plurals:function(a){return 0}},sco:{name:"Scots",numbers:[1,2],plurals:function(a){return Number(1!=a)}},se:{name:"Northern Sami",numbers:[1,2],plurals:function(a){return Number(1!=a)}},si:{name:"Sinhala",numbers:[1,2],plurals:function(a){return Number(1!=a)}},sk:{name:"Slovak",numbers:[1,2,5],plurals:function(a){return Number(1==a?0:a>=2&&a<=4?1:2)}},sl:{name:"Slovenian",numbers:[5,1,2,3],plurals:function(a){return Number(a%100==1?1:a%100==2?2:a%100==3||a%100==4?3:0)}},so:{name:"Somali",numbers:[1,2],plurals:function(a){return Number(1!=a)}},son:{name:"Songhay",numbers:[1,2],plurals:function(a){return Number(1!=a)}},sq:{name:"Albanian",numbers:[1,2],plurals:function(a){return Number(1!=a)}},sr:{name:"Serbian",numbers:[1,2,5],plurals:function(a){return Number(a%10==1&&a%100!=11?0:a%10>=2&&a%10<=4&&(a%100<10||a%100>=20)?1:2)}},su:{name:"Sundanese",numbers:[1],plurals:function(a){return 0}},sv:{name:"Swedish",numbers:[1,2],plurals:function(a){return Number(1!=a)}},sw:{name:"Swahili",numbers:[1,2],plurals:function(a){return Number(1!=a)}},ta:{name:"Tamil",numbers:[1,2],plurals:function(a){return Number(1!=a)}},te:{name:"Telugu",numbers:[1,2],plurals:function(a){return Number(1!=a);
}},tg:{name:"Tajik",numbers:[1,2],plurals:function(a){return Number(a>1)}},th:{name:"Thai",numbers:[1],plurals:function(a){return 0}},ti:{name:"Tigrinya",numbers:[1,2],plurals:function(a){return Number(a>1)}},tk:{name:"Turkmen",numbers:[1,2],plurals:function(a){return Number(1!=a)}},tr:{name:"Turkish",numbers:[1,2],plurals:function(a){return Number(a>1)}},tt:{name:"Tatar",numbers:[1],plurals:function(a){return 0}},ug:{name:"Uyghur",numbers:[1],plurals:function(a){return 0}},uk:{name:"Ukrainian",numbers:[1,2,5],plurals:function(a){return Number(a%10==1&&a%100!=11?0:a%10>=2&&a%10<=4&&(a%100<10||a%100>=20)?1:2)}},ur:{name:"Urdu",numbers:[1,2],plurals:function(a){return Number(1!=a)}},uz:{name:"Uzbek",numbers:[1,2],plurals:function(a){return Number(a>1)}},vi:{name:"Vietnamese",numbers:[1],plurals:function(a){return 0}},wa:{name:"Walloon",numbers:[1,2],plurals:function(a){return Number(a>1)}},wo:{name:"Wolof",numbers:[1],plurals:function(a){return 0}},yo:{name:"Yoruba",numbers:[1,2],plurals:function(a){return Number(1!=a)}},zh:{name:"Chinese",numbers:[1],plurals:function(a){return 0}}},addRule:function(a,b){Q.rules[a]=b},setCurrentLng:function(a){if(!Q.currentRule||Q.currentRule.lng!==a){var b=a.split("-");Q.currentRule={lng:a,rule:Q.rules[b[0]]}}},get:function(a,b){function c(b,c){var d;if(d=Q.currentRule&&Q.currentRule.lng===a?Q.currentRule.rule:Q.rules[b]){var e=d.plurals(c),f=d.numbers[e];return 2===d.numbers.length&&1===d.numbers[0]&&(2===f?f=-1:1===f&&(f=1)),f}return 1===c?"1":"-1"}var d=a.split("-");return c(d[0],b)}},R={},S=function(a,b){R[a]=b},T=function(){function a(a){return Object.prototype.toString.call(a).slice(8,-1).toLowerCase()}function b(a,b){for(var c=[];b>0;c[--b]=a);return c.join("")}var c=function(){return c.cache.hasOwnProperty(arguments[0])||(c.cache[arguments[0]]=c.parse(arguments[0])),c.format.call(null,c.cache[arguments[0]],arguments)};return c.format=function(c,d){var e,f,g,h,i,j,k,l=1,m=c.length,n="",o=[];for(f=0;f<m;f++)if(n=a(c[f]),"string"===n)o.push(c[f]);else if("array"===n){if(h=c[f],h[2])for(e=d[l],g=0;g<h[2].length;g++){if(!e.hasOwnProperty(h[2][g]))throw T('[sprintf] property "%s" does not exist',h[2][g]);e=e[h[2][g]]}else e=h[1]?d[h[1]]:d[l++];if(/[^s]/.test(h[8])&&"number"!=a(e))throw T("[sprintf] expecting number but found %s",a(e));switch(h[8]){case"b":e=e.toString(2);break;case"c":e=String.fromCharCode(e);break;case"d":e=parseInt(e,10);break;case"e":e=h[7]?e.toExponential(h[7]):e.toExponential();break;case"f":e=h[7]?parseFloat(e).toFixed(h[7]):parseFloat(e);break;case"o":e=e.toString(8);break;case"s":e=(e=String(e))&&h[7]?e.substring(0,h[7]):e;break;case"u":e=Math.abs(e);break;case"x":e=e.toString(16);break;case"X":e=e.toString(16).toUpperCase()}e=/[def]/.test(h[8])&&h[3]&&e>=0?"+"+e:e,j=h[4]?"0"==h[4]?"0":h[4].charAt(1):" ",k=h[6]-String(e).length,i=h[6]?b(j,k):"",o.push(h[5]?e+i:i+e)}return o.join("")},c.cache={},c.parse=function(a){for(var b=a,c=[],d=[],e=0;b;){if(null!==(c=/^[^\x25]+/.exec(b)))d.push(c[0]);else if(null!==(c=/^\x25{2}/.exec(b)))d.push("%");else{if(null===(c=/^\x25(?:([1-9]\d*)\$|\(([^\)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-fosuxX])/.exec(b)))throw"[sprintf] huh?";if(c[2]){e|=1;var f=[],g=c[2],h=[];if(null===(h=/^([a-z_][a-z_\d]*)/i.exec(g)))throw"[sprintf] huh?";for(f.push(h[1]);""!==(g=g.substring(h[0].length));)if(null!==(h=/^\.([a-z_][a-z_\d]*)/i.exec(g)))f.push(h[1]);else{if(null===(h=/^\[(\d+)\]/.exec(g)))throw"[sprintf] huh?";f.push(h[1])}c[2]=f}else e|=2;if(3===e)throw"[sprintf] mixing positional and named placeholders is not (yet) supported";d.push(c)}b=b.substring(c[0].length)}return d},c}(),U=function(a,b){return b.unshift(a),T.apply(null,b)};S("sprintf",function(a,b,c){return c.sprintf?"[object Array]"===Object.prototype.toString.apply(c.sprintf)?U(a,c.sprintf):"object"==typeof c.sprintf?T(a,c.sprintf):a:a});var V=function(){function a(a){return[null,a]}Array.prototype.forEach.call(document.querySelectorAll("[data-i18n]"),function(b){var c=b.getAttribute("data-i18n"),d=a(c),e=d[0],f=d[1],g=Autodesk.Viewing.i18n.translate(f);g?e?b.setAttribute(e,g):b.textContent=g:e?b.setAttribute(e,f):b.textContent=f})};Autodesk.Viewing.i18n.init=g,Autodesk.Viewing.i18n.setLng=n,Autodesk.Viewing.i18n.preload=h,Autodesk.Viewing.i18n.addResourceBundle=i,Autodesk.Viewing.i18n.removeResourceBundle=j,Autodesk.Viewing.i18n.loadNamespace=l,Autodesk.Viewing.i18n.loadNamespaces=m,Autodesk.Viewing.i18n.localize=V,Autodesk.Viewing.i18n.setDefaultNamespace=k,Autodesk.Viewing.i18n.t=u,Autodesk.Viewing.i18n.translate=u,Autodesk.Viewing.i18n.exists=t,Autodesk.Viewing.i18n.detectLanguage=O.detectLanguage,Autodesk.Viewing.i18n.pluralExtensions=Q,Autodesk.Viewing.i18n.sync=P,Autodesk.Viewing.i18n.functions=O,Autodesk.Viewing.i18n.lng=o,Autodesk.Viewing.i18n.addPostProcessor=S,Autodesk.Viewing.i18n.options=J,Autodesk.Viewing.i18n.setDebugLocString=a,Autodesk.Viewing.i18n.clearDebugLocString=b}();var av=Autodesk.Viewing,avp=Autodesk.Viewing.Private,ENABLE_DEBUG=avp.ENABLE_DEBUG||!0,ENABLE_TRACE=avp.ENABLE_TRACE||!0;!function(){"use strict";function a(a,b){function c(a){if(!a)return null;var b=window.devicePixelRatio;b||(b=1);var c=av.InitParametersSetting;c.canvas=a,c.devicePixelRatio=b;var d=new avp.FireflyWebGLRenderer(c);return d.context?(d.autoClear=!1,d.sortObjects=!1,d):null}function d(a){var b=J,c=!0,d=b==avp.RENDER_NORMAL,e=z.settings.idbuffer&&b!=avp.RENDER_HIDDEN;b==avp.RENDER_HIDDEN?a.overrideMaterial=F.fadeMaterial:b==avp.RENDER_HIGHLIGHTED&&(a.overrideMaterial=F.highlightMaterial),z.renderScenePart(a,c,d,e),a.overrideMaterial=null}function e(a){$++,Y>0&&(Z=.8*Z+.2*(a-Y)),F.fpsCallback&&F.fpsCallback(F.fps())}function f(a){if(F.keyFrameAnimator){var b=Y>0?(a-Y)/1e3:0,c=F.keyFrameAnimator.update(b);if(c&&(F.sceneUpdated(!0),c&F.keyFrameAnimator.UPDATE_CAMERA))return!0}return!1}function g(){u&&(F.camera.aspect=v/w,F.camera.clientWidth=v,F.camera.clientHeight=w,z.setSize(v,w),F.controls.handleResize(),D&&D.setSize(v,w),F.invalidate(!0,!0,!0),u=!1,F.api.fireEvent({type:av.VIEWER_RESIZE_EVENT,width:v,height:w}))}function h(){if((C.enabled||D)&&!F.is2d){var a;if(a=F.model&&!F.model.isLoadDone()?F.model.getData().bbox:F.getVisibleBounds(!0,!1)){C.needClear=!0;var b=F.camera,c=a.clone(),d=new THREE.Vector3(1,0,0),e=P.clone();b.worldUpTransform&&(c.applyMatrix4(b.worldUpTransform),d.applyMatrix4(b.worldUpTransform),e.applyMatrix4(b.worldUpTransform)),c.min.y-=.005*(c.max.y-c.min.y),A&&A.expandByGroundShadow(c,e);var f=c.size(),g=c.center();if(A||(f.x*=1.25,f.z*=1.25,f.x=f.z=Math.max(f.x,f.z)),b.worldUpTransform){var h=(new THREE.Matrix4).getInverse(b.worldUpTransform);g.applyMatrix4(h)}if(C.setTransform(g,f,b.worldup,d),D){var i=(new THREE.Vector3).subVectors(g,b.worldup.clone().multiplyScalar(f.y/2));D.setTransform(i,b.worldup,f)}A&&A.setGroundShadowTransform(g,f,b.worldup,d)}}}function i(a){U&&(h(),U=!1)}function j(a){for(var b in F.selectionMeshes){var c=F.selectionMeshes[b],d=c.model.getFragmentList();c.geometry===d.getGeometry(c.fragId)&&d.getWorldMatrix(c.fragId,c.matrix)}}function k(){A&&(A.state=avp.SHADOWMAP_NEEDS_UPDATE)}function l(a){if(!A||!F)return a;var b=R||Q;if(J==avp.RENDER_SHADOWMAP){if(b)return J=avp.RENDER_FINISHED,a;a=A.continueUpdate(E,a,x),A.state==avp.SHADOWMAP_VALID&&(J=avp.RENDER_FINISHED,Q=!0,R=!0)}return A.state==avp.SHADOWMAP_NEEDS_UPDATE?a=A.startUpdate(E,a,F.camera,P,x):b||J==avp.RENDER_FINISHED&&A.state==avp.SHADOWMAP_INCOMPLETE&&(a=A.startUpdate(E,a,F.camera,P,x),J=avp.RENDER_SHADOWMAP),a}function m(a){x.updateMaterials();var b=f(a),c=F.controls.update(a),h=E&&E.update(a),k=c||b||B||h,m=u;u&&g(),Q=Q||k,S=S||k,S&&j(a),S=S||z.overlayUpdate(a);var n=F.model&&(F.model.isLoadDone()||F.model.myData.partPacksLoadDone===!0),o=F.progressiveRender?F.targetFrameBudget:1e10,p=o,q=E;if(U&&i(a),p=l(p),!A||J!=avp.RENDER_SHADOWMAP){var r=!1;if(!C||F.is2d||_||(r=C.prepareGroundShadow(F)),Q||R){if(k&&F.skipAOWhenMoving&&z.settings.sao&&!ba&&(z.setAOEnabled(!1),ba=!0),n&&F.signalProgress(0),W>0){var s=a-W;X=.75*X+.25*s}W=a,X<H&&o<G?F.targetFrameBudget+=1:X>H&&o>I&&(F.targetFrameBudget-=1),F.updateCameraMatrices(),z.beginScene(F.scene,F.camera,F.lightsOn?F.lights:F.no_lights,Q),(k||m)&&F.api.fireEvent(F.cameraChangedEvent),r&&!D&&F.renderGroundShadow(),q&&(q.hasHighlighted()?(J=avp.RENDER_HIGHLIGHTED,q.reset(F.camera,J,k|Q)):(J=avp.RENDER_NORMAL,q.reset(F.camera,J,k|Q)))}else W=-1;if(D&&!F.is2d&&!_){var t=D.prepareGroundReflection(F,C,Q);t&&E.isDone()&&F.showGhosting&&!E.areAllVisible()&&(J=avp.RENDER_HIDDEN,E.reset(F.camera,J))}var v=!1;q.isEmpty()||q.isDone()||(v=!0,p=q.renderSome(d,p),q.isDone()&&J===avp.RENDER_HIGHLIGHTED&&(J=avp.RENDER_NORMAL,q.reset(F.camera,J),p=q.renderSome(d,p)),q.isDone()?(J===avp.RENDER_NORMAL&&!q.areAllVisible()&&F.showGhosting?D&&!D.finished||(J=avp.RENDER_HIDDEN,q.reset(F.camera,J),p=q.renderSome(d,p)):(J=avp.RENDER_FINISHED,z.renderScenePart(F.sceneAfter,!0,!0,!0)),n&&F.signalProgress(100)):n&&F.signalProgress(100*q.getRenderProgress()),e(a)),S&&(v=!0,z.renderScenePart(F.sceneAfter,!0,!0,!0),!q.isEmpty()&&q.isDone()||F.showOverlaysWhileMoving?(F.renderOverlays(),q.isEmpty()||q.isDone()||(S=!0)):z.clearAllOverlays());var w=!0;F.skipAOWhenMoving&&(k||!q.isDone()?w=!1:M&&(v=!0,ba&&(ca=!0))),v&&z.composeFinalFrame(!w),M=k,Y=a,q&&q.needsRender()?(R=!0,q.resetNeedsRender()):R=!1,Q=!1,B=!1,ca&&(ca=!1,z.setAOEnabled(!0),ba=!1,F.invalidate(!0,!0))}}function n(){for(var a in F.selectionMeshes){var b=F.selectionMeshes[a];b.model&&b.model.isConsolidated()&&b.model.updateRenderProxy(b,b.fragId)}}function o(a){function b(){if(c.animations){F.keyFrameAnimator=new avp.KeyFrameAnimator(F,c.animations.duration);for(var a in c.animations.animations)F.keyFrameAnimator.add(c.animations.animations[a]);F.keyFrameAnimator.goto(0),F.api.fireEvent({type:av.ANIMATION_READY_EVENT})}F.api.removeEventListener(av.OBJECT_TREE_CREATED_EVENT,b)}var c=a.getData();a.isObjectTreeCreated()?b():F.api.addEventListener(av.OBJECT_TREE_CREATED_EVENT,b)}function p(a,b){ia=ia||new THREE.Box3,b.updateMatrixWorld(!0),b.traverse(function(b){var c=b.geometry;void 0!==c&&c.visible&&(c.boundingBox||c.computeBoundingBox(),ia.copy(c.boundingBox),ia.applyMatrix4(b.matrixWorld),a.union(ia))})}function q(){var a=new THREE.Box3,b=F.overlayScenes;for(var c in b)b.hasOwnProperty(c)&&p(a,b[c].scene);return p(a,F.scene),a}function r(a){var b,c,d,e=";base64,";if(a.indexOf(e)==-1)return b=a.split(","),c=b[0].split(":")[1],d=decodeURIComponent(b[1]),new Blob([d],{type:c});b=a.split(e),c=b[0].split(":")[1],d=window.atob(b[1]);for(var f=d.length,g=new Uint8Array(f),h=0;h<f;++h)g[h]=d.charCodeAt(h);return new Blob([g],{type:c})}var s,t,u,v,w,x,y,z,A,B,C,D,E,F=this,G=1e3/15,H=1e3/30,I=1e3/120,J=avp.RENDER_NORMAL,K=-1,L=-1,M=!1,N="y",O=null,P=null,Q=!1,R=!1,S=!1,T={type:Autodesk.Viewing.PROGRESS_UPDATE_EVENT,percent:0},U=!1,V=0,W=0,X=0,Y=0,Z=1e3/60,$=0,_=!0,aa=!1,ba=!1,ca=!1,da=!1,ea=1,fa=null,ga=null;a&&setInterval(function(){_||$<60||F.track({name:"fps",value:Number(F.fps().toFixed(2)),aggregate:"last"})},3e4),this.api=b,this.canvas=a,this.loader=null,this.initialize=function(){if(s=new THREE.Vector3(0,1,0),E=new avp.RenderScene,y=c(a),y||av.isNodeJS){z=new avp.RenderContext,z.init(y,a?a.clientWidth:0,a?a.clientHeight:0),x=new avp.MaterialManager(this),avp.init_UnifiedCamera(THREE),this.camera=new av.UnifiedCamera(a?a.clientWidth:512,a?a.clientHeight:512),this.lightsOn=!1,this.lights=[],this.no_lights=[],fa=(new THREE.Color).setRGB(1,1,1),ga=(new THREE.Color).setRGB(1,1,1),this.cameraChangedEvent=this.camera.getCameraChangedEvent(),O=new THREE.Vector3(1,1,1),P=(new THREE.Vector3).copy(O),this.scene=new THREE.Scene,this.sceneAfter=new THREE.Scene,this.sceneAfter.sortObjects=!1,this.overlayScenes={},this.selectionMaterial2d=null,this.selectionMaterialBase=new THREE.MeshPhongMaterial({color:6724095,specular:526344,emissive:3361911,ambient:0,opacity:1,transparent:!1}),this.selectionMaterialTop=new THREE.MeshPhongMaterial({color:6724095,specular:526344,emissive:3361911,ambient:0,opacity:.15,transparent:!0}),this.selectionMaterialTop.packedNormals=!0,this.selectionMaterialBase.packedNormals=!0,ha("selection",this.selectionMaterialBase,this.selectionMaterialTop),this.selectionMeshes={},this.fadeMaterial=new THREE.MeshPhongMaterial({color:16777215,opacity:.1,reflectivity:0,transparent:!0,depthWrite:!1}),this.fadeMaterial.packedNormals=!0,x.addMaterial("__fadeMaterial__",this.fadeMaterial,!0),this.highlightMaterial=new THREE.MeshPhongMaterial({color:6724095,specular:526344,emissive:3361911,ambient:0,opacity:1,transparent:!1}),this.highlightMaterial.packedNormals=!0,x.addMaterial("__highlightMaterial__",this.highlightMaterial,!0),this.progressiveRender=!0,this.swapBlackAndWhite=!1,this.targetFrameBudget=H,av.isMobileDevice()&&(G*=2,I/=2,H*=2,this.targetFrameBudget/=2),this.controls={update:function(a){this.camera.lookAt(this.camera.target),this.camera.updateProjectionMatrix(),this.camera.dirty=!1},handleResize:function(){},recordHomeView:function(){},uninitialize:function(){}},this.selector=new avp.MultiModelSelector(this),this.visibilityManager=new avp.MultiModelVisibilityManager(this),this.showGhosting=!0,this.showOverlaysWhileMoving=!0,this.skipAOWhenMoving=!1,this.keyFrameAnimator=null;var b=avp.LightPresets[avp.DefaultLightPreset].bgColorGradient;this.setClearColors(b[0],b[1],b[2],b[3],b[4],b[5]),C=new av.Shaders.GroundShadow(y),C.enabled=!0,x.addMaterialNonHDR("groundShadowDepthMaterial",C.getDepthMaterial()),x.addOverrideMaterial("normalsMaterial",z.getDepthMaterial()),z.beginScene(this.scene,this.camera,this.noLights,!0),z.composeFinalFrame(!0)}},this.renderGroundShadow=function(a){A?A.state==avp.SHADOWMAP_VALID&&A.renderGroundShadow(F.camera,a||z.getColorTarget()):(C.renderShadow(F.camera,a||z.getColorTarget()),C.rendered=!0)},this.run=function(){t=0,setTimeout(function(){!function a(b){t=window.requestAnimationFrame(a),m(b)}()},1)},this.toggleProgressive=function(a){this.progressiveRender=a,Q=!0},this.toggleSwapBlackAndWhite=function(a){this.swapBlackAndWhite=a,z.toggleSwapBlackAndWhite(a),Q=!0},this.toggleGhosting=function(a){this.showGhosting=a,Q=!0},this.toggleOverlaysWhileMoving=function(a){this.showOverlaysWhileMoving=a},this.togglePostProcess=function(a,b){z.initPostPipeline(a,b),this.fireRenderOptionChanged(),Q=!0},this.toggleCelShading=function(a){z.toggleCelShading(a),this.fireRenderOptionChanged(),Q=!0},this.toggleGroundShadow=function(a){C.enabled!==a&&(C.enabled=a,C.clear(),h(),this.fireRenderOptionChanged(),this.invalidate(!0,!1,!1))},this.setGroundShadowColor=function(a){C.enabled&&(C.setColor(a),this.invalidate(!0,!1,!1))},this.setGroundShadowAlpha=function(a){C.enabled&&(C.setAlpha(a),this.invalidate(!0,!1,!1))},this.toggleGroundReflection=function(a){a&&D||!a&&!D||(a?(D=new av.Shaders.GroundReflection(y,this.canvas.clientWidth,this.canvas.clientHeight,{clearPass:z.getClearPass()}),D.setClearColors(this.clearColorTop,this.clearColorBottom,av.isAndroidDevice()||av.isIOSDevice()),D.toggleEnvMapBackground(aa),D.setEnvRotation(z.getEnvRotation()),h()):(D.cleanup(),D=void 0),this.fireRenderOptionChanged(),this.invalidate(!0,!1,!1))},this.setGroundReflectionColor=function(a){D&&(D.setColor(a),this.invalidate(!0,!1,!1))},this.setGroundReflectionAlpha=function(a){D&&(D.setAlpha(a),this.invalidate(!0,!1,!1))},this.toggleEnvMapBackground=function(a){aa=a,z.toggleEnvMapBackground(a),D&&D.toggleEnvMapBackground(a),this.invalidate(!0,!0,!1)},this.isEnvMapBackground=function(){return aa},this.toggleRenderPrism=function(a){x.setRenderPrism(a)},this.setOptimizeNavigation=function(a){this.skipAOWhenMoving=a},this.renderOverlays=function(){n();var a=this.lightsOn;a||this.toggleLights(!0,!0);var b;this.dir_light1&&(b=this.dir_light1.intensity,this.dir_light1.intensity=1),z.renderOverlays(this.overlayScenes,this.lightsOn?this.lights:this.no_lights),a||this.toggleLights(!1,!0),this.dir_light1&&(this.dir_light1.intensity=b),S=!1},this.setLayerVisible=function(a,b){this.matman().setLayerVisible(a,b)},this.isLayerVisible=function(a){return this.matman().isLayerVisible(a)},this.updateCameraMatrices=function(){function a(){b=new THREE.Matrix4,c=new THREE.Matrix4,d=new THREE.Box3}var b,c,d;return function(){d||a();var e=this.camera;if(b.compose(e.position,e.quaternion,e.scale),c.getInverse(b),e.worldup&&this.setWorldUp(e.worldup),this.model){var f=this.getVisibleBounds(!0,S);if(d.copy(f),D){var g=new THREE.Vector3;g.multiplyVectors(d.max,e.worldup);var h=new THREE.Vector3;h.multiplyVectors(d.min,e.worldup),g.sub(h),g.x>=0?d.min.x-=g.x:d.max.x-=g.x,g.y>=0?d.min.y-=g.y:d.max.y-=g.y,g.z>=0?d.min.z-=g.z:d.max.z-=g.z}A&&A.groundShapeBox&&d.union(A.groundShapeBox),d.applyMatrix4(c);var i=1e-5*(d.max.z-d.min.z),j=.5*(d.max.y-d.min.y),k=-(d.max.z+i)-j,l=-(d.min.z-i)+j;e.isPerspective&&(k=Math.max(k,Math.min(1,1e-4*Math.abs(l-k)))),l=Math.max(l,k),e.near=k,e.far=l,e.updateProjectionMatrix();var m;if(this.model.is2d()){var n=this.intersectGroundViewport(new THREE.Vector3(0,0,1));m=n?e.position.distanceTo(n):e.position.distanceTo(f.center());var o=z.settings.deviceHeight/(2*m*Math.tan(THREE.Math.degToRad(.5*e.fov)));x.updatePixelScale(o),x.updateSwapBlackAndWhite(this.swapBlackAndWhite)}else{var p,q=x.getCutPlanesRaw();if(q&&q.length){var r=q[0],s=e.target.clone().sub(e.position).normalize(),t=s.dot(r);if(0===t)p=f.center();else{var u=-(e.position.clone().dot(r)+r.w)/t;p=f.clampPoint(s.multiplyScalar(u).add(e.position))}}else p=f.center();m=e.position.distanceTo(p);var o=z.settings.deviceHeight/(2*m*Math.tan(THREE.Math.degToRad(.5*e.fov)));x.updatePixelScale(o)}}}}(),this.initLights=function(){this.dir_light1=new THREE.DirectionalLight(fa,ea),this.dir_light1.position.set(-1,0,1),this.amb_light=new THREE.AmbientLight(ga),this.lights=[this.dir_light1,this.amb_light],this.camera.add(this.dir_light1),this.camera.add(this.dir_light1.target),da=!0},this.toggleLights=function(a,b){if(this.amb_light){this.lightsOn=a;var c=avp.LightPresets[K],d=c.ambientColor,e=c.directLightColor;d=d||ga.toArray(),e=e||fa.toArray(),this.lightsOn?(b&&this.amb_light?this.amb_light.color.setRGB(.5*e[0],.5*e[1],.5*e[2]):this.amb_light&&this.amb_light.color.setRGB(d[0],d[1],d[2]),this.dir_light1&&this.dir_light1.color.setRGB(e[0],e[1],e[2])):this.amb_light&&b&&this.amb_light.color.setRGB(d[0],d[1],d[2])}},this.syncCamera=function(a){this.camera.updateProjectionMatrix(),a&&this.setWorldUp(this.api.navigation.getWorldUpVector()),B=!0},this.setViewFromFile=function(a,b){var c,d=a.getDefaultCamera();if(d)c=d;else{c={};var e=a.getBoundingBox(),f=e.size();if(c.target=e.center(),a.is2d()){c.isPerspective=!1;var g=f.x/f.y,h=this.camera.aspect;h>g?c.orthoScale=f.y:c.orthoScale=f.x/h,c.up=new THREE.Vector3(0,0,1),c.position=c.target.clone(),c.position.z+=c.orthoScale,c.target.y+=1e-6*f.y}else c.isPerspective=!0,c.fov=this.camera.fov,c.up=this.camera.up.clone(),c.position=c.target.clone(),c.position.z+=1.5*Math.max(f.x,f.y,f.z)}this.setViewFromCamera(c,b)},this.adjustOrthoCamera=function(a){if(!a.isPerspective&&this.model){var b=this.model.getBoundingBox(),c=b.size(),d=a.target.clone().sub(a.position);if(d.length()>1e3*c.length()){var e=a.position.distanceTo(b.center());a.target.copy(a.position).add(d.normalize().multiplyScalar(e))}else a.position.copy(a.target).add(d.normalize().multiplyScalar(-a.orthoScale))}},this.setViewFromCamera=function(a,b){this.adjustOrthoCamera(a);var c=!1,d=this.model?this.model.getUpVector():null;this.model&&this.model.getData().basePath.indexOf("SaRang")!=-1&&(d=[0,0,1]);var e;e=d?(new THREE.Vector3).fromArray(d):c?a.up.clone():av.Navigation.snapToAxis(a.up.clone()),c?this.api.prefs&&this.api.prefs.set("fusionOrbitConstrained",e.equals(a.up)):a.up=e;var f=this.api.navigation;if(f)if(b){var g=this.camera;g.up.copy(a.up),g.position.copy(a.position),g.target.copy(a.target),a.isPerspective?g.fov=a.fov:(g.saveFov=a.fov,g.fov=av.UnifiedCamera.ORTHO_FOV),g.isPerspective=a.isPerspective,g.orthoScale=a.orthoScale,g.dirty=!0,f.setWorldUpVector(c?e:g.up),f.setView(g.position,g.target),f.setPivotPoint(g.target),this.syncCamera(!0)}else if(this.camera.isPerspective=a.isPerspective,c)f.setRequestTransitionWithUp(!0,a.position,a.target,a.fov,a.up,e);else{var h=f.computeOrthogonalUp(a.position,a.target);f.setRequestTransitionWithUp(!0,a.position,a.target,a.fov,h,e)}B=!0},this.setViewFromViewBox=function(a,b,c,d){if(a.is2d()){var e={},f=a.getBoundingBox(),g={width:b[2]-b[0],height:b[3]-b[1]};g.aspect=g.width/g.height,g.centerX=b[0]+g.width/2,g.centerY=b[1]+g.height/2;var h=this.camera.aspect;h>g.aspect?e.orthoScale=g.height:e.orthoScale=g.width/h,e.isPerspective=!1,e.position=new THREE.Vector3(g.centerX,g.centerY,f.center().z+e.orthoScale),e.target=new THREE.Vector3(g.centerX,g.centerY,f.center().z),e.target.y+=1e-6*g.height,e.up=new THREE.Vector3(0,0,1),this.setViewFromCamera(e,d)}},this.setWorldUp=function(a){if(!s.equals(a)){s.copy(a);var b=Math.abs(a.x);N="x",Math.abs(a.y)>b&&(N="y",b=Math.abs(a.y)),Math.abs(a.z)>b&&(N="z");var c=function(a,b){var c=(new THREE.Vector3).crossVectors(b,a).normalize(),d=Math.acos(a.dot(b));return(new THREE.Matrix4).makeRotationAxis(c,d)},d=new THREE.Vector3(0,1,0);F.camera.worldUpTransform=c(d,a),this.sceneUpdated(!1)}},this.addModel=function(a){if(a){var b=!!this.model,c=a.is2d(),d=0;if(!this.model){this.model=a,z.setUnitScale(a.getUnitScale());var e=a.getData().bbox;d=e.size().length()}if(E.addModel(a),this.selector.addModel(a),this.visibilityManager.addModel(a),c){x.initLayersTexture(a);var f=x.create2DMaterial(a.getData(),{},!0),g=x.findMaterial(a.getData(),f);if(z.enter2DMode(g),!b){this.is2d=!0,L=K,this.setLightPreset(avp.DefaultLightPreset2d);var h=a.getData();if(h.hidePaper){var i=h.bgColor,j=i>>16&255,k=i>>8&255,l=255&i;this.setClearColors(j,k,l,j,k,l)}}}if(this.api.navigation){this.api.navigation.setIs2D(c&&!b),this.api.setActiveNavigationTool();var m=a.getData();m.isLeaflet?this.api.navigation.setConstraints2D(m.bbox,m.maxPixelPerUnit):this.api.navigation.setConstraints2D()}b||(this.setViewFromFile(a,!0),this.controls.recordHomeView()),c||this.setLightPresetFromFile(a)||(L>=0?(this.setLightPreset(L,!0),L=-1):this.setLightPreset(K,!1)),d>0&&z.setAOOptions(Math.min(10,.05*d)),this.fireRenderOptionChanged(),this.invalidate(!0)}},this.getSvfMaterialId=function(a){return this.model.getFragmentList().getSvfMaterialId(a)},this.getMaterials=function(){return x},this.setupMesh=function(a,b,c,d){var e=a.getData(),f={geometry:b,matrix:d,isLine:b.isLines,is2d:b.is2d};if(b.isLines){var g=!!b.attributes.color,h=new THREE.LineBasicMaterial({vertexColors:g});if(!g){var i=x.findMaterial(e,c);h.color=i.color}x.addMaterialNonHDR(e.basePath+c+"_line_"+h.id,h),f.material=h,e.hasLines=!0}else{var h=x.findMaterial(e,c);h&&(h.svfMatId=c),x.applyGeometryFlagsToMaterial(h,b),f.material=h}return f},this.onDemandLoadComplete=function(a){_=!1,this.signalProgress(100),this.invalidate(!1,!0);var b=a.getData();b.hasLines&&x.togglePolygonOffset(!0),o(a),this.api.fireEvent({type:av.GEOMETRY_LOADED_EVENT,model:a,onDemandLoad:!0})},this.onLoadComplete=function(a){_=!1,this.signalProgress(100),this.sceneUpdated(!1),this.is2d&&(this.selectionMaterial2d=x.init2DSelectionMaterial(a),this.createOverlayScene("selection2d",this.selectionMaterial2d));var b=a.getData(),c=E.getGeometryList();c&&E.getGeometryList().printStats(),b.hasLines&&x.togglePolygonOffset(!0),o(a),a.hasGeometry()||avp.logger.warn("Loaded model has not geometry."),this.api.fireEvent({type:av.GEOMETRY_LOADED_EVENT,model:a})},this.signalProgress=function(a){T.percent!==a&&(T.percent=a,this.api.fireEvent(T))},this.resize=function(a,b){u=!0,v=a,w=b},this.unloadModel=function(a){if(this.removeModel(a)){if(a.isLoadDone()){var b=a.getData().propWorker;b&&b.dtor()}a.loader&&a.loader.dtor()}},this.removeModel=function(a){return!!E.removeModel(a)&&(this.keyFrameAnimator&&(this.keyFrameAnimator.destroy(),this.keyFrameAnimator=null),a.dtor(this.glrenderer()),x.cleanup(a.getData()),this.selector.removeModel(a),this.visibilityManager.removeModel(a),a===this.model&&(this.model=null,E.isEmpty()||(this.model=E.getModels()[0])),this.api.fireEvent({type:av.MODEL_UNLOADED_EVENT,model:a}),this.invalidate(!0,!0,!0),!0)},this.unloadCurrentModel=function(){this.is2d&&(this.is2d=void 0,this.selectionMaterial2d=null,this.removeOverlayScene("selection2d"),z.exit2DMode(),K=L),z.beginScene(this.scene,this.camera,this.lightsOn?this.lights:this.no_lights,!0),z.composeFinalFrame(!0);for(var a=E.getModels(),b=a.length-1;b>=0;b--)this.unloadModel(a[b])};var ha=function(a,b,c){b.depthWrite=!1,b.depthTest=!0,b.side=THREE.DoubleSide,c.depthWrite=!1,c.depthTest=!0,c.side=THREE.DoubleSide,avp.addInstancingSupport(b),avp.addInstancingSupport(c),F.createOverlayScene(a,b,c)};this.createOverlayScene=function(a,b,c,d){b&&x.addOverrideMaterial(a+"_pre",b),c&&x.addOverrideMaterial(a+"_post",c);var e=new THREE.Scene;e.__lights=this.scene.__lights,this.overlayScenes[a]={scene:e,camera:d,materialPre:b,materialPost:c}},this.removeOverlayScene=function(a){var b=this.overlayScenes[a];b&&(delete this.overlayScenes[a],this.invalidate(!1,!1,!0))},this.addOverlay=function(a,b){this.overlayScenes[a].scene.add(b),this.invalidate(!1,!1,!0)},this.addMultipleOverlays=function(a,b){for(var c in b)b.hasOwnProperty(c)&&this.addOverlay(a,b[c])},this.removeOverlay=function(a,b){this.overlayScenes[a]&&(this.overlayScenes[a].scene.remove(b),this.invalidate(!1,!1,!0))},this.removeMultipleOverlays=function(a,b){for(var c in b)b.hasOwnProperty(c)&&this.removeOverlay(a,b[c])},this.clearOverlay=function(a){if(this.overlayScenes[a]){var b,c,d=this.overlayScenes[a].scene;for(c=d.children.length-1;c>=0;--c)b=d.children[c],b&&d.remove(b);this.invalidate(!1,!1,!0)}},this.setClearColors=function(a,b,c,d,e,f){if(this.clearColorTop=new THREE.Vector3(a/255,b/255,c/255),this.clearColorBottom=new THREE.Vector3(d/255,e/255,f/255),!x.reflectionCube||x.reflectionCube.isBgColor){var g=x.setCubeMapFromColors(this.clearColorTop,this.clearColorBottom);z.setCubeMap(g)}z.setClearColors(this.clearColorTop,this.clearColorBottom),D&&D.setClearColors(this.clearColorTop,this.clearColorBottom,av.isAndroidDevice()||av.isIOSDevice()),Q=!0,this.fireRenderOptionChanged()};var ia;this.getVisibleBounds=function(a,b){var c=new THREE.Box3;return E.isEmpty()||(p(c,this.scene),c=E.getVisibleBounds(a).union(c),b&&(c=q().union(c))),c},this.getFitBounds=function(a){var b;return this.is2d&&(a=!0),a||null===this.selector||(b=this.selector.getSelectionBounds()),b&&!b.empty()||(b=this.getVisibleBounds()),b},this.getRenderProxy=function(a,b){return a.getFragmentList().getVizmesh(b)},this.getFragmentProxy=function(a,b){return new avp.FragmentPointer(a.getFragmentList(),b)},this.getRenderProxyCount=function(a){return a.getFragmentList().getCount()},this.getRenderProxyDbIds=function(a,b){return a.getFragmentList().getDbIds(b)},this.isWholeModelVisible=function(a){return!E||E.areAllVisible()},this.highlightObjectNode=function(a,b,c,d){a.is2d()&&x.highlightObject2D(b,c);var e=this,f=a.getData().instanceTree;if(f&&!a.is2d())f.enumNodeFragments(b,function(b){e.highlightFragment(a,b,c,d)},!1);else{var g=b;if(a.is2d()&&(g=a.getData().fragments.dbId2fragId[b]),Array.isArray(g))for(var h=0;h<g.length;h++)e.highlightFragment(a,g[h],c,d);else e.highlightFragment(a,g,c,d)}},this.highlightFragment=function(a,b,c,d){var e=this.getRenderProxy(a,b);if(e){var f=!d||e.is2d,g=a.id+":"+b;if(f){var h=a.is2d()?"selection2d":"selection";if(c){var i=new THREE.Mesh(e.geometry,e.material);i.matrix.copy(e.matrixWorld),i.matrixAutoUpdate=!1,i.matrixWorldNeedsUpdate=!0,i.frustumCulled=!1,i.model=a,i.fragId=b,this.addOverlay(h,i),this.selectionMeshes[g]=i}else this.selectionMeshes[g]&&(this.removeOverlay(h,this.selectionMeshes[g]),delete this.selectionMeshes[g])}f&&c||a.setHighlighted(b,c)&&this.invalidate(!0)}},this.explode=function(a){a!=V&&(V=a,E.explode(a),this.sceneUpdated(!0),this.api.fireEvent({type:av.EXPLODE_CHANGE_EVENT,scale:a}))},this.getExplodeScale=function(){return V},this.setGhostingBrightness=function(a){a?this.fadeMaterial.color=new THREE.Color(1052688):this.fadeMaterial.color=new THREE.Color(16777215),this.fadeMaterial.needsUpdate=!0},this.setLightPreset=function(a,b){if(da||this.initLights(),K!=a||b){(a<0||avp.LightPresets.length<=a)&&(a=avp.DefaultLightPreset),K=a;var c=avp.LightPresets[a];if(c&&c.path){var d="res/environments/"+c.path,e=avp.getResourceUrl(d+"_mipdrop."+(c.type||"")+".dds"),f=avp.getResourceUrl(d+"_irr."+(c.type||"")+".dds"),g=(x.setIrradianceMap(f,c.E_bias),x.setCubeMap(e,c.E_bias));z.setCubeMap(g),x.setEnvExposure(-c.E_bias),z.setEnvExposure(-c.E_bias),this.setTonemapExposureBias(c.E_bias),this.setTonemapMethod(c.tonemap),this.setGhostingBrightness(c.darkerFade)}else{x.setIrradianceMap(null);var g=x.setCubeMap(null);z.setCubeMap(g),x.setEnvExposure(0),z.setEnvExposure(0),this.setTonemapExposureBias(0),this.setTonemapMethod(0),this.setGhostingBrightness(!1)}var h=av.Shaders.SAOShader.uniforms.radius.value,i=av.Shaders.SAOShader.uniforms.intensity.value;c.hasOwnProperty("saoRadius")&&(h=c.saoRadius),c.hasOwnProperty("saoIntensity")&&(i=c.saoIntensity),z.setAOOptions(h,i);var j=c.bgColorGradient;j||(j=avp.BackgroundPresets.Custom),this.setClearColors(j[0],j[1],j[2],j[3],j[4],j[5]);var l=ea;null!==c.lightMultiplier&&void 0!==c.lightMultiplier&&(l=c.lightMultiplier),P.copy(O),c.lightDirection&&P.fromArray(c.lightDirection).negate(),A&&k(),this.dir_light1&&(this.dir_light1.intensity=l,c.lightDirection&&this.dir_light1.position.set(-c.lightDirection[0],-c.lightDirection[1],-c.lightDirection[2])),x.setEnvRotation(c.rotation||0),z.setEnvRotation(c.rotation||0),D&&D.setEnvRotation(c.rotation||0),this.toggleLights(0!==l),this.invalidate(!0,!1,!0),this.fireRenderOptionChanged()}},this.setLightPresetFromFile=function(a){if(!a||a.is2d())return!1;var b=a.getMetadata("renderEnvironmentStyle","value",null);if(null===b||""===b)return!1;var c=a.getMetadata("renderEnvironmentGroundReflection","value",null);null!==c&&(this.api.prefs.hasTag("groundReflection","ignore-producer")?avp.logger.debug("setLightPresetFromFile(): groundReflection is locked. No changes."):(this.api.prefs.tag("no-storage","groundReflection"),this.api.setGroundReflection(c)));var d=a.getMetadata("renderEnvironmentGroundShadow","value",null);null!==d&&(this.api.prefs.hasTag("groundShadow","ignore-producer")?avp.logger.debug("setLightPresetFromFile(): groundShadow is locked. No changes."):(this.api.prefs.tag("no-storage","groundShadow"),this.api.setGroundShadow(d)));var e=a.getMetadata("renderEnvironmentAmbientShadows","value",null);null!==e&&(this.api.prefs.hasTag("ambientShadows","ignore-producer")?avp.logger.debug("setLightPresetFromFile(): ambientShadows is locked. No changes."):(this.api.prefs.tag("no-storage","ambientShadows"),this.api.setQualityLevel(e,z.getAntialiasing())));var f=a.getMetadata("renderEnvironmentDisplayLines","value",null);null!==f&&(this.api.prefs.hasTag("lineRendering","ignore-producer")?avp.logger.debug("setLightPresetFromFile(): lineRendering is locked. No changes."):(this.api.prefs.tag("no-storage","lineRendering"),this.api.hideLines(!f)));var g=avp.LightPresets.filter(function(a){return a.name===b});if(g=g[0]||null)if(this.api.prefs.hasTag("lightPreset","ignore-producer"))avp.logger.debug("setLightPresetFromFile(): lightPreset is locked. No changes.");else{this.api.prefs.tag("no-storage","lightPreset");var h=avp.ModelSettingsEnvironment;h||(h=avp.ModelSettingsEnvironment={},avp.LightPresets.push(h)),avp.copyLightPreset(g,h),h.name="(Custom: Model defined)";var i=a.getMetadata("renderEnvironmentExposureBias","value",null),j=a.getMetadata("renderEnvironmentExposureBase","value",null);null!==i&&null!==j&&(h.E_bias=i+j);var k=a.getMetadata("renderEnvironmentBackgroundColor","value",null);this.api.prefs.hasTag("backgroundColorPreset","ignore-producer")?avp.logger.debug("setLightPresetFromFile(): backgroundColorPreset is locked. No changes."):k&&(h.bgColorGradient=[255*k[0],255*k[1],255*k[2],255*k[0],255*k[1],255*k[2]]);
var l=a.getMetadata("renderEnvironmentRotation","value",null);null!==l&&(h.rotation=l);var m=avp.LightPresets.indexOf(h);this.api.setLightPreset(m)}var n=a.getMetadata("renderEnvironmentBackgroundFromEnvironment","value",null);return null!==n&&(this.api.prefs.hasTag("envMapBackground","ignore-producer")?avp.logger.debug("setLightPresetFromFile(): envMapBackground is locked. No changes."):(this.api.prefs.tag("no-storage","envMapBackground"),this.api.setEnvMapBackground(n))),g},this.setTonemapMethod=function(a){a!=z.getToneMapMethod()&&(z.setTonemapMethod(a),x.setTonemapMethod(a),this.fireRenderOptionChanged(),this.invalidate(!0))},this.setTonemapExposureBias=function(a){a!=z.getExposureBias()&&(z.setTonemapExposureBias(a),x.setTonemapExposureBias(a),this.fireRenderOptionChanged(),this.invalidate(!0))},this.dtor=function(){window.cancelAnimationFrame(t),this.unloadCurrentModel(),this.controls=null,this.canvas=null,this.loader=null,this.selector.dtor(),this.selector=null,this.model=null,this.visibilityManager=null,E=null,z=null,x.dtor(),x=null},this.hideLines=function(a){return!(!E||E.isEmpty())&&(E.hideLines(a),this.sceneUpdated(!0),!0)},this.getCutPlanes=function(){return x.getCutPlanes()},this.setCutPlanes=function(a){x.setCutPlanes(a),this.sceneUpdated(),this.api.fireEvent({type:av.CUTPLANES_CHANGE_EVENT,planes:a})},this.fireRenderOptionChanged=function(){x.toggleMRTSetting(),this.api.fireEvent({type:av.RENDER_OPTION_CHANGED_EVENT})},this.viewportToRay=function(a,b){var c=this.camera;a.z=-1;var d=new THREE.Vector3(a.x,a.y,1);return a=a.unproject(c),d=d.unproject(c),d.sub(a).normalize(),b||(b=new THREE.Ray),b.set(c.isPerspective?c.position:a,d),b},this.rayIntersect=function(a,b,c,d){var e=E.rayIntersect(a.origin,a.direction,b,c,d);if(this.sceneAfter.children.length){var f=new THREE.Raycaster(a.origin,a.direction,this.camera.near,this.camera.far),g=[];avp.VBIntersector.intersectObject(this.sceneAfter,f,g,!0),g.length&&(!e||g[0].distance<e.distance)&&(e=g[0])}if(!e)return null;var h=e.fragId,i=e.point,j=e.face,k=e.model,l=e.dbId;if(void 0===l&&void 0!==h){l=k.getFragmentList().getDbIds(h);var m=k.getData().instanceTree;m||(l=h)}return{dbId:l,fragId:h,intersectPoint:i,face:j,model:k}},this.castRayViewport=function(){var a;return function(b,c,d,e){return a=a||new THREE.Ray,E?(this.viewportToRay(b,a),this.rayIntersect(a,c,d,e)):{}}}(),this.clientToViewport=function(a,b){var c=F.canvas.getBoundingClientRect();return new THREE.Vector3((a+.5)/c.width*2-1,2*-((b+.5)/c.height)+1,1)},this.viewportToClient=function(a,b){var c=F.canvas.getBoundingClientRect();return new THREE.Vector3(.5*(a+1)*c.width-.5,(b-1)*-.5*c.height-.5,0)},this.castRay=function(a,b,c){return this.castRayViewport(this.clientToViewport(a,b),c)},this.intersectGroundViewport=function(a){var b=this.camera,c="z";this.is2d||(c=N);var d=a;d.z=-1;var e=new THREE.Vector3(d.x,d.y,1);d=d.unproject(b),e=e.unproject(b),e.sub(d).normalize();var f=e;if(Math.abs(f[c])<1e-6)return null;var g;g=b.isPerspective?b.position:d;var h=this.model?this.model.getBoundingBox().min[c]:0,i=(h-g[c])/f[c];return f.multiplyScalar(i),f.add(g),f},this.intersectGround=function(a,b){return this.intersectGroundViewport(this.clientToViewport(a,b))},this.hitTestViewport=function(a,b){var c;if(F.is2d){var d,e=[];if(d=av.isMobileDevice()?z.idAtPixels(a.x,a.y,45,e):z.idAtPixels(a.x,a.y,5,e),d<=0)return null;var f=this.intersectGroundViewport(a),g=E.findModel(e[1])||F.model;c={intersectPoint:f,dbId:d,fragId:g.getData().fragments.dbId2fragId[d],model:g}}else c=this.castRayViewport(a,b);return c},this.hitTest=function(a,b,c){return F.hitTestViewport(this.clientToViewport(a,b),c)},this.snappingHitTestViewport=function(a,b){var c;if(F.is2d){var d;if(d=av.isMobileDevice()?z.idAtPixels(a.x,a.y,45):z.idAtPixels(a.x,a.y,17),d<0)return null;var e=this.intersectGroundViewport(a),f=F.model.getData().fragments,g=f?f.dbId2fragId[d]:-1;c={intersectPoint:e,dbId:d,fragId:g}}else{var d=z.idAtPixel(a.x,a.y);c=this.castRayViewport(a,b,d>0?[d]:null)}return c},this.snappingHitTest=function(a,b,c){return this.snappingHitTestViewport(this.clientToViewport(a,b),c)},this.rolloverObjectViewport=function(a){z.rolloverObjectViewport(a.x,a.y)&&this.invalidate(!1,!1,!0)},this.rolloverObject=function(a,b){this.rolloverDisabled||this.rolloverObjectViewport(this.clientToViewport(a,b))},this.disableRollover=function(a){this.rolloverDisabled=a},this.rolloverObjectNode=function(a){var b=[],c=F.model.getData().instanceTree;if(c){if(c.enumNodeChildren(a,function(a){b.push(a)},!0),b.length>1){var d=b.shift();b.sort(function(a,b){return a-b}),b.unshift(d)}}else b.push(a);z.rolloverObjectViewport(null,null,b)&&this.invalidate(!1,!1,!0)},this.getScreenShotBuffer=function(a,b,c){z.presentBuffer();var d=F.canvas.toDataURL("image/png"),e=av.isSafari();if(e&&(a=a?a:v,b=b?b:w),!a||!b)return d;var f,g,h=0,i=0;a>b||v/w<a/b?(f=a,g=w/v*a,i=b/2-g/2):(g=b,f=v/w*b,h=a/2-f/2);var j=window.URL.createObjectURL(r(F.canvas.toDataURL("image/png"))),k=new Image;k.src=j;var l=document.createElement("canvas"),m=l.getContext("2d");l.width=a,l.height=b,k.onload=function(){e&&(m.translate(0,g),m.scale(1,-1)),m.drawImage(k,h,i,f,g);var a=l.toDataURL("image/png"),b=window.URL.createObjectURL(r(l.toDataURL("image/png")));c?c(a):window.open(b)}},this.getScreenShot=function(a,b,c){function d(a,b,c,d,e){if(d||b&&c){var f,g,h=0,i=0;b>c||v/w<b/c?(f=b,g=w/v*b,i=c/2-g/2):(g=c,f=v/w*c,h=b/2-f/2);var j=new Image;j.src=a;var k=document.createElement("canvas"),l=k.getContext("2d");k.width=b,k.height=c,j.onload=function(){d&&(l.translate(0,g),l.scale(1,-1)),l.drawImage(j,h,i,f,g);var a=window.URL.createObjectURL(r(k.toDataURL("image/png")));e?e(a):window.open(a)}}else e&&e(a)}z.presentBuffer();var e=window.URL.createObjectURL(r(F.canvas.toDataURL("image/png"))),f=av.isSafari();f&&(a=a?a:v,b=b?b:w),d(e,a,b,f,c)},this.modelQueue=function(){return E},this.glrenderer=function(){return y},this.renderer=function(){return z},this.shadowMaps=function(){return A},this.worldUp=function(){return s},this.worldUpName=function(){return N},this.setUserRenderContext=function(a){z=a?a:new RenderContext,z.init(y,this.canvas.clientWidth,this.canvas.clientHeight),z.setClearColors(this.clearColorTop,this.clearColorBottom),this.invalidate(!0),this.sceneUpdated(!1)},this.invalidate=function(a,b,c){Q=Q||a,R=R||b,S=S||c},this.sceneUpdated=function(a){this.invalidate(!0,!1,!0),E&&a&&E.invalidateVisibleBounds(),U=!0,k()},this.currentLightPreset=function(){return K},this.matman=function(){return x},this.fps=function(){return 1e3/Z},this.setFPSTargets=function(a,b,c){G=1e3/c,I=1e3/a,H=1e3/b,this.targetFrameBudget=av.isMobileDevice()?H/4:H},this.track=function(a){avp.logger.track(a)},this.worldToClient=function(a){var b=new THREE.Vector4(a.x,a.y,a.z,1);return b.applyMatrix4(this.camera.matrixWorldInverse),b.applyMatrix4(this.camera.projectionMatrix),b.w>0&&(b.x/=b.w,b.y/=b.w,b.z/=b.w),this.viewportToClient(b.x,b.y)},this.clientToWorld=function(a,b,c){var d=null,e=this.model,f=e.getData();if(e.is2d()){var g=this.intersectGround(a,b);if(g){g.z=0;var h=f.bbox;(f.hidePaper||h.containsPoint(g))&&(d={point:g,model:e})}}else d=this.hitTest(a,b,c),d&&(d.point=d.intersectPoint);return d},this.setSelectionColor=function(a){this.selectionMaterialBase.color.set(a),this.selectionMaterialTop.color.set(a),this.invalidate(!1,!1,!0)},this.updateViewportId=function(a){x.updateViewportId(a)},this.findModel=function(a){return E.findModel(a)},this.setShadowLightDirection=function(a){P.copy(a),k(),this.invalidate(!0,!1,!1),h()},this.getShadowLightDirection=function(a){var b=a?a:new THREE.Vector3;return b.copy(P),b},this.toggleShadows=function(a){!!A!=!!a&&(a?A=new avp.ShadowMaps(y):(A.cleanup(x),A=null),h(),this.invalidate(!0,!0,!1))}}av.InitParametersSetting={canvas:null,antialias:!1,alpha:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,stencil:!1,depth:!1,devicePixelRatio:null},a.prototype.constructor=a,avp.Viewer3DImpl=a}();var avp=Autodesk.Viewing.Private;avp.Autocam=avp.Autocam||function(a,b){function c(b){t=!0,a.target.copy(q.center),a.pivot.copy(q.pivot),a.worldup?a.worldup.copy(q.sceneUpDirection):a.up.copy(q.sceneUpDirection),q.cameraChangedCallback&&q.cameraChangedCallback(b),t=!1}function d(a,b){var c=a.clone();return Math.abs(c.clone().dot(b))<Number.MIN_VALUE?(c.normalize(),c):(c=e(a,b),c.length()<Number.MIN_VALUE&&(c=f(b)),c.normalize(),c)}function e(a,b){b.normalize();var c=a.clone().dot(b),d=b.clone().multiplyScalar(c);return d=a.clone().sub(d)}function f(a){for(var b=new THREE.Vector3(0,0,0),c=[new THREE.Vector3(0,1,0),new THREE.Vector3(1,0,0),new THREE.Vector3(0,0,1),new THREE.Vector3(0,1,1),new THREE.Vector3(1,0,1),new THREE.Vector3(1,1,0),new THREE.Vector3(1,1,1)],d=0;d<7;d++)if(Math.abs(c[d].dot(a))<Number.MIN_VALUE){b=c[d];break}return b}function g(a,b){var c=new THREE.Vector2(0,0);return c.x=a/window.innerWidth,c.y=b/window.innerHeight,c}function h(b){b.y=Math.abs(b.y-window.innerHeight);var c,d,e=a.position,f=q.center,g=f.clone().sub(e),h=a.up,i=g.clone().cross(h),j=g.clone().length(),k=j*Math.tan(THREE.Math.degToRad(a.leftFov)),l=j*Math.tan(THREE.Math.degToRad(a.rightFov)),m=j*Math.tan(THREE.Math.degToRad(a.topFov)),n=j*Math.tan(THREE.Math.degToRad(a.bottomFov)),o=k+l,p=m+n,r=b.x*o/window.innerWidth,s=r-k,t=b.y*p/window.innerHeight,u=t-n;return h=h.clone().normalize().clone().multiplyScalar(u),i=i.clone().normalize().clone().multiplyScalar(s),q.ortho?(c=e.clone().add(i).clone().add(h),d=g):(c=e,d=g.clone().add(h).clone().add(i)),{rayO:c,rayD:d}}function i(a,b,c){var d,e,f,g;d=e=f=g=0;var h=0,i=null,j=null,k=q.snapOrbitDeadZone,l=q.orbitMultiplier;return"h"==a?(d=q.snapOrbitThresholdH,e=q.snapOrbitAccelerationAX,f=q.snapOrbitAccelerationBX,g=1-q.snapOrbitAccelerationPointX,j=q.lockDeltaX,i=q.lockedX):(d=q.snapOrbitThresholdV,e=q.snapOrbitAccelerationAY,f=q.snapOrbitAccelerationBY,g=1-q.snapOrbitAccelerationPointY,j=q.lockDeltaY,i=q.lockedY),i?(j+=c,j<-k?(h=(j+k)*l*1/f,i=!1):j>k&&(h=(j-k)*l*1/f,i=!1)):(h=Math.abs(b)>d?c*l:Math.abs(b)>g*d?c*b>0?c*l*e:c*l*1/e:c*b>0?c*l*f:c*l*1/f,h*b>0&&Math.abs(h)>Math.abs(b)&&(this.lockDeltaX=this.lockDeltaY=0,i=!0,h=b)),h}function j(){return q.combined}function k(a,b){var c=30,d=!1,e=window.innerWidth,f=a.x%e,g=window.innerHeight,h=a.y%g,i=f>0?f-b.x:e+f-b.x,j=h>0?h-b.y:g+h-b.y;return Math.abs(i)<c&&Math.abs(j)<c&&(d=!0),d}function l(a,b,c){c.x=(a.x-b.x)/window.innerWidth,a.x=b.x+(a.x-b.x)%window.innerWidth,c.y=(a.y-b.y)/window.innerHeight,a.y=b.y+(a.y-b.y)%window.innerHeight}function m(a,b,c){if(!O||!a){if(a){var d=30,e=new THREE.Vector2,f=b.x,g=b.y;l(b,c,e),M=window.innerWidth*e.x,N=window.innerHeight*e.y,f<c.x?f-=2*d:f+=2*d,g<c.y?g-=2*d:g+=2*d}O=a}}function n(a,b,c){if(0===b)return 0;var d=a,e=q.saveEye.clone().sub(worldUp.clone().multiplyScalar(c+d)),f=q.saveEye.clone().sub(worldUp.clone().multiplyScalar(c)),g=0,h=(q.maxSceneBound-q.minSceneBound)/1e3;q.topLimit&&b>0?(g=q.maxSceneBound-h,q.topLimit=!1):q.bottomLimit&&b<0?(g=q.minSceneBound+h,q.bottomLimit=!1):g=e.dot(worldUp);var i=f.dot(worldUp);return g<q.minSceneBound?i<q.minSceneBound&&(q.bottomLimit=!0,d=0):g>q.maxSceneBound&&i>q.maxSceneBound&&(q.topLimit=!0,d=0),d}function o(a){var b=Math.pow(a,2);a<0&&(b=-b);var c=g(0,b),d=q.maxSceneBound-q.minSceneBound,e=.01*d;c.y*=e;var f=q.userHeightSpeed*c.y;return f=n(f,a,q.m_amount)}function p(a){var b=q.sceneFrontDirection.clone().cross(q.sceneUpDirection),c=Math.abs(Math.abs(a.dot(q.sceneUpDirection))-1),d=Math.abs(Math.abs(a.dot(q.sceneFrontDirection))-1),e=Math.abs(Math.abs(a.dot(b))-1);return c<1e-5||d<1e-5||e<1e-5}var q=this,r=null,s=null,t=!1;this.cube=null,this.camera=a,this.renderer="WEBGL",this.startState={},this.navApi=b,this.orthographicFaces=!1,this.cameraChangedCallback=null,this.pivotDisplayCallback=null,this.canvas=null;var u,v=Date.now(),w=!1;this.dtor=function(){this.cube=null,this.cameraChangedCallback=null,this.pivotDisplayCallback=null,this.canvas=null},this.showPivot=function(a){this.pivotDisplayCallback&&this.pivotDisplayCallback(a)},this.setWorldUpVector=function(a){t||a&&a.lengthSq()>0&&!a.normalize().equals(this.sceneUpDirection)&&(this.sceneUpDirection.copy(a),this.sceneFrontDirection.copy(this.getWorldFrontVector()),this.cubeFront.copy(this.sceneFrontDirection).cross(this.sceneUpDirection).normalize(),this.cube&&requestAnimationFrame(this.cube.render))},this.getWorldUpVector=function(){return this.sceneUpDirection.clone()},this.getWorldRightVector=function(){var a=this.sceneUpDirection.clone();return Math.abs(a.z)<=Math.abs(a.y)?a.set(a.y,-a.x,0):a.z>=0?a.set(a.z,0,-a.x):a.set(-a.z,0,a.x),a.normalize()},this.getWorldFrontVector=function(){var a=this.getWorldUpVector();return a.cross(this.getWorldRightVector()).normalize()},this.goToView=function(a){if(this.navApi.isActionEnabled("gotoview")){var b={position:a.position.clone(),up:a.up.clone(),center:a.center.clone(),pivot:a.pivot.clone(),fov:a.fov,worldUp:a.worldUp.clone(),isOrtho:a.isOrtho};q.elapsedTime=0,this.animateTransition(b)}},this.getCurrentView=function(){return{position:a.position.clone(),up:a.up.clone(),center:this.center.clone(),pivot:this.pivot.clone(),fov:a.fov,worldUp:this.sceneUpDirection.clone(),isOrtho:a.isPerspective===!1}},this.setCurrentViewAsHome=function(a){a?(this.navApi.setRequestFitToView(!0),w=!0):this.homeVector=this.getCurrentView()},this.setHomeViewFrom=function(a){var b=a.pivot?a.pivot:this.center,c=a.target?a.target:this.pivot,d=a.worldup?a.worldup:this.sceneUpDirection;this.homeVector={position:a.position.clone(),up:a.up.clone(),center:c.clone(),pivot:b.clone(),fov:a.fov,worldUp:d.clone(),isOrtho:a.isPerspective===!1},this.originalHomeVector={position:a.position.clone(),up:a.up.clone(),center:c.clone(),pivot:b.clone(),fov:a.fov,worldUp:d.clone(),worldFront:this.sceneFrontDirection.clone(),isOrtho:a.isPerspective===!1}},this.toPerspective=function(){a.isPerspective||(a.toPerspective(),c(!1))},this.toOrthographic=function(){a.isPerspective&&(a.toOrthographic(),c(!1))},this.setOrthographicFaces=function(a){this.orthographicFaces=a},this.goHome=function(){this.navApi.isActionEnabled("gotoview")&&(this.navApi.setPivotSetFlag(!1),this.goToView(this.homeVector))},this.resetHome=function(){this.homeVector.position.copy(this.originalHomeVector.position),this.homeVector.up.copy(this.originalHomeVector.up),this.homeVector.center.copy(this.originalHomeVector.center),this.homeVector.pivot.copy(this.originalHomeVector.pivot),this.homeVector.fov=this.originalHomeVector.fov,this.homeVector.worldUp.copy(this.originalHomeVector.worldUp),this.homeVector.isOrtho=this.originalHomeVector.isOrtho,this.goHome()},this.getView=function(){return this.center.clone().sub(a.position)},this.setCameraUp=function(b){var c=this.dir.clone(),d=c.cross(b).normalize();0===d.lengthSq()&&(c.copy(this.dir),b.z>b.y?c.y+=1e-4:c.z+=1e-4,d=c.cross(b).normalize()),a.up.copy(d).cross(this.dir).normalize()},function a(){requestAnimationFrame(a);var b=Date.now();u=b-v,v=b}(),this.ortho=!1,this.center=a.target?a.target.clone():new THREE.Vector3(0,0,0),this.pivot=a.pivot?a.pivot.clone():this.center.clone(),this.sceneUpDirection=a.worldup?a.worldup.clone():a.up.clone(),this.sceneFrontDirection=this.getWorldFrontVector(),this.dir=this.getView(),this.setCameraUp(a.up),this.saveCenter=this.center.clone(),this.savePivot=this.pivot.clone(),this.saveEye=a.position.clone(),this.saveUp=a.up.clone();var z,A,B,C;this.cubeFront=this.sceneFrontDirection.clone().cross(this.sceneUpDirection).normalize(),this.setHomeViewFrom(a);var D,E,F=new THREE.Quaternion,G=new THREE.Quaternion,H=new THREE.Quaternion,I=new THREE.Quaternion;this.userPanSpeed=.5,this.userLookSpeed=2,this.userHeightSpeed=5,this.walkMultiplier=1,this.userZoomSpeed=1.015,this.orbitMultiplier=5,this.currentlyAnimating=!1,a.keepSceneUpright=!0,this.preserveOrbitUpDirection=!0,this.alignOrbitUpDirection=!0,this.constrainOrbitHorizontal=!1,this.constrainOrbitVertical=!1,this.doCustomOrbit=!1,this.snapOrbitDeadZone=.045,this.snapOrbitThresholdH=this.snapOrbitThresholdV=THREE.Math.degToRad(15),this.snapOrbitAccelerationAX=this.snapOrbitAccelerationAY=1.5,this.snapOrbitAccelerationBX=this.snapOrbitAccelerationBY=2,this.snapOrbitAccelerationPointX=this.snapOrbitAccelerationPointY=.5,this.alignDirTable=new Array(26),this.alignDirTable[0]=new THREE.Vector3(-1,0,0),this.alignDirTable[1]=new THREE.Vector3(1,0,0),this.alignDirTable[2]=new THREE.Vector3(0,-1,0),this.alignDirTable[3]=new THREE.Vector3(0,1,0),this.alignDirTable[4]=new THREE.Vector3(0,0,-1),this.alignDirTable[5]=new THREE.Vector3(0,0,1),this.alignDirTable[6]=new THREE.Vector3(-1,-1,0),this.alignDirTable[7]=new THREE.Vector3(-1,1,0),this.alignDirTable[8]=new THREE.Vector3(1,-1,0),this.alignDirTable[9]=new THREE.Vector3(1,1,0),this.alignDirTable[10]=new THREE.Vector3(0,-1,-1),this.alignDirTable[11]=new THREE.Vector3(0,-1,1),this.alignDirTable[12]=new THREE.Vector3(0,1,-1),this.alignDirTable[13]=new THREE.Vector3(0,1,1),this.alignDirTable[14]=new THREE.Vector3(-1,0,-1),this.alignDirTable[15]=new THREE.Vector3(1,0,-1),this.alignDirTable[16]=new THREE.Vector3(-1,0,1),this.alignDirTable[17]=new THREE.Vector3(1,0,1),this.alignDirTable[18]=new THREE.Vector3(-1,-1,-1),this.alignDirTable[19]=new THREE.Vector3(-1,-1,1),this.alignDirTable[20]=new THREE.Vector3(-1,1,-1),this.alignDirTable[21]=new THREE.Vector3(-1,1,1),this.alignDirTable[22]=new THREE.Vector3(1,-1,-1),this.alignDirTable[23]=new THREE.Vector3(1,-1,1),this.alignDirTable[24]=new THREE.Vector3(1,1,-1),this.alignDirTable[25]=new THREE.Vector3(1,1,1),this.combined=!1,this.useSnap=!1,this.lockDeltaX=0,this.lockedX=!1,this.lastSnapRotateX=0,this.lockDeltaY=0,this.lockedY=!1,this.lastSnapRotateY=0,this.lastSnapDir=new THREE.Vector3(0,0,0),this.topLimit=!1,this.bottomLimit=!1,this.minSceneBound=0,this.maxSceneBound=0;var J={destinationPercent:1,duration:1,zoomToFitScene:!0,useOffAxis:!1};this.shotParams=J;var K,L;this.zoomDelta=new THREE.Vector2;var M,N,O,P=0,Q=new THREE.Vector3,R=new THREE.Vector3;this.rewindParams={history:[],startTime:void 0,thumbnailSize:56,thumbnailGapSize:12,maxHistorySize:25,snappingEnabled:!0,timelineIndex:0,timelineIndexSlide:0,open:!1,openLocation:new THREE.Vector2(0,0),openBracket:new THREE.Vector2(0,0),openBracketA:new THREE.Vector2(0,0),openBracketB:new THREE.Vector2(0,0),openLocationOrigin:new THREE.Vector2(0,0),locationOffset:new THREE.Vector2(0,0),snapOffset:new THREE.Vector2(0,0),slideOffset:new THREE.Vector2(0,0),snapped:!0,resetWeights:!1,recordEnabled:!1,elementIsRecording:!1},this.viewCubeMenuOpen=!1,this.menuSize=new THREE.Vector2(0,0),this.menuOrigin=new THREE.Vector2(0,0),a.lookAt(this.center),this.setCube=function(a){this.cube=a},this.loadObject=function(a,b,c){loader=new THREE.JSONLoader,loader.load(a,function(a,d){var e=new THREE.MeshPhongMaterial(d);mesh=new THREE.Mesh(a,e),mesh.scale=b,mesh.position.copy(c),mesh.geometry.computeBoundingBox();var f=mesh.geometry.boundingBox.clone();R.set(f.max.x,f.max.y,f.max.z),Q.set(f.min.x,f.min.y,f.min.z),R.multiply(b),Q.multiply(b),scene.add(mesh),objects.push(mesh)})},this.sync=function(b){b.isPerspective!==a.isPerspective&&(b.isPerspective?a.toPerspective():(a.toOrthographic(),b.saveFov&&(a.saveFov=b.saveFov))),a.fov=b.fov,a.position.copy(b.position),b.target&&(this.center.copy(b.target),a.target.copy(b.target)),b.pivot&&(this.pivot.copy(b.pivot),a.pivot.copy(b.pivot)),this.dir.copy(this.center).sub(a.position),this.setCameraUp(b.up);var c=b.worldup?b.worldup:b.up;c.distanceToSquared(this.sceneUpDirection)>1e-4&&this.setWorldUpVector(c),w&&!this.navApi.getTransitionActive()&&(w=!1,this.setCurrentViewAsHome(!1)),this.cube&&requestAnimationFrame(this.cube.render)},this.refresh=function(){this.cube&&this.cube.refreshCube()},THREE.Box2.prototype.setCenter=function(a){var b=new THREE.Vector2(Math.abs(this.max.x-this.min.x)/2,Math.abs(this.max.y-this.min.y)/2);return this.min.copy(a).sub(b),this.max.copy(a).add(b),this},THREE.Box2.prototype.getIcon2DCoords=function(a,b){var c=this.center;b.set((a.x-c.x)/(this.size().x/2),(a.y-c.y)/(this.size().y/2))},THREE.Matrix3.prototype.makeRotationFromQuaternion=function(a){var b=this.elements,c=a.x,d=a.y,e=a.z,f=a.w,g=c+c,h=d+d,i=e+e,j=c*g,k=c*h,l=c*i,m=d*h,n=d*i,o=e*i,p=f*g,q=f*h,r=f*i;return b[0]=1-(m+o),b[3]=k-r,b[6]=l+q,b[1]=k+r,b[4]=1-(j+o),b[7]=n-p,b[2]=l-q,b[5]=n+p,b[8]=1-(j+m),this},THREE.Quaternion.prototype.setFromRotationMatrix3=function(a){var b,c=a.elements,d=c[0],e=c[3],f=c[6],g=c[1],h=c[4],i=c[7],j=c[2],k=c[5],l=c[8],m=d+h+l;return m>0?(b=.5/Math.sqrt(m+1),this.w=.25/b,this.x=(k-i)*b,this.y=(f-j)*b,this.z=(g-e)*b):d>h&&d>l?(b=2*Math.sqrt(1+d-h-l),this.w=(k-i)/b,this.x=.25*b,this.y=(e+g)/b,this.z=(f+j)/b):h>l?(b=2*Math.sqrt(1+h-d-l),this.w=(f-j)/b,this.x=(e+g)/b,this.y=.25*b,this.z=(i+k)/b):(b=2*Math.sqrt(1+l-d-h),this.w=(g-e)/b,this.x=(f+j)/b,this.y=(i+k)/b,this.z=.25*b),this},THREE.Quaternion.prototype.rotate=function(a){var b=(new THREE.Matrix4).makeRotationFromQuaternion(this),c=b.elements,d=(new THREE.Matrix3).set(c[0],c[1],c[2],c[4],c[5],c[6],c[8],c[9],c[10]);return a.applyMatrix3(d)},THREE.Vector3.prototype.findAngleWith=function(a,b){var c=0,d=this.clone().normalize().clone().dot(a.clone().normalize()),e=this.clone().cross(a).clone().normalize();if(e.clone().length()<Number.MIN_VALUE)c=d>0?0:180;else{var f=e.clone().dot(b.clone().normalize());b=f>0?e:-e;var g=(new THREE.Quaternion).setFromAxisAngle(b,90*THREE.Math.degToRad);g=g.clone().rotate(a).clone().normalize().clone().dot(this),c=Math.acos(d)*THREE.Math.radToDeg,Math.abs(c-90)<Number.MIN_VALUE&&(c=90),(c<90&&d*g>0||c>90&&d*g<0||90==c&&g>0)&&(c*=-1)}return c=THREE.Math.degToRad(c)},"contains"in String.prototype||(String.prototype.contains=function(a,b){return-1!==String.prototype.indexOf.call(this,a,b)}),Math.linearClamp=function(a,b,c){return a<=b?0:a>=c?1:(a-b)/(c-b)},Math.easeClamp=function(a,b,c){if(a<=b)return 0;if(a>=c)return 1;var d=(a-b)/(c-b);return.5*(Math.sin((d-.5)*Math.PI)+1)},Math.linearInterp=function(a,b,c){return b*(1-a)+c*a},Math.equalityClamp=function(a,b,c){return a<=b?b:a>=c?c:a},Math.round2=function(a){return Math.round(100*a)/100},Math.round1=function(a){return Math.round(10*a)/10},this.animateTransition=function(b){if(b){var d=!1,e=0;if(this.setCameraOrtho(b.isOrtho),q.elapsedTime>=J.duration)return e=1,q.center.copy(b.center),q.pivot.copy(b.pivot),a.position.copy(b.position),a.up.copy(b.up),a.target.copy(b.center),b.isOrtho||(a.fov=b.fov),a.dirty=!0,d=!b.worldUp.equals(this.sceneUpDirection),d&&this.setWorldUpVector(b.worldUp),this.currentlyAnimating=!1,c(d),this.showPivot(!1),this.cube&&requestAnimationFrame(this.cube.render),this.addHistoryElement(),void this.navApi.setTransitionActive(!1);this.currentlyAnimating=!0,this.showPivot(!0),this.navApi.setTransitionActive(!0);var f=J.destinationPercent;e=Math.easeClamp(q.elapsedTime/J.duration,0,f);var g=1-e;q.elapsedTime+=u/500;var h=q.center.clone().multiplyScalar(g).add(b.center.clone().multiplyScalar(e)),i=a.position.clone().multiplyScalar(g).add(b.position.clone().multiplyScalar(e)),j=a.up.clone().multiplyScalar(g).add(b.up.clone().multiplyScalar(e)),k=a.pivot.clone().multiplyScalar(g).add(b.pivot.clone().multiplyScalar(e)),l=this.sceneUpDirection.clone().multiplyScalar(g).add(b.worldUp.clone().multiplyScalar(e)),m=a.fov*g+b.fov*e;q.center.copy(h),q.pivot.copy(k),a.position.copy(i),a.up.copy(j),a.target.copy(h),b.isOrtho||(a.fov=m),a.dirty=!0,d=l.distanceToSquared(this.sceneUpDirection)>1e-4,d&&this.setWorldUpVector(l),a.lookAt(q.center),c(d),this.cube&&requestAnimationFrame(this.cube.render),requestAnimationFrame(function(){q.animateTransition(b)})}},this.sphericallyInterpolateTransition=function(b){var d,e,f,g=0;if(this.currentlyAnimating=!0,this.navApi.setTransitionActive(!0),q.elapsedTime>=J.duration)g=1,this.currentlyAnimating=!1;else{var h=J.destinationPercent;g=Math.easeClamp(q.elapsedTime/J.duration,0,h),q.elapsedTime+=u/500}if(1===g)e=L.position,d=L.center,f=L.up;else{var i=new THREE.Matrix3,j=F.clone();j.slerp(G,g),i.makeRotationFromQuaternion(j);var k=Math.linearInterp(g,D,E),l=i.elements;d=K.center.clone().multiplyScalar(1-g).add(L.center.clone().multiplyScalar(g)),e=d.clone().sub(new THREE.Vector3(l[0],l[1],l[2]).multiplyScalar(k)),f=new THREE.Vector3(l[3],l[4],l[5])}q.center.copy(d),a.position.copy(e),a.up.copy(f),q.navApi.getUsePivotAlways()||q.pivot.copy(d),a.lookAt(q.center),this.currentlyAnimating===!0?(this.showPivot(!0),requestAnimationFrame(function(){q.sphericallyInterpolateTransition(b)})):(this.navApi.setTransitionActive(!1),this.showPivot(!1),this.addHistoryElement(),this.orthographicFaces&&this.isFaceView()&&this.setCameraOrtho(!0),b&&b()),c(!1),this.cube&&requestAnimationFrame(this.cube.render)},this.getOrientation=function(){if(this.cube){var b=Math.round1(a.up.x),c=Math.round1(a.up.y),d=Math.round1(a.up.z),e=this.sceneFrontDirection.clone(),f=this.sceneUpDirection.clone(),g=this.sceneFrontDirection.clone().cross(this.sceneUpDirection).normalize();e.x=Math.round1(e.x),e.y=Math.round1(e.y),e.z=Math.round1(e.z),f.x=Math.round1(f.x),f.y=Math.round1(f.y),f.z=Math.round1(f.z),g.x=Math.round1(g.x),g.y=Math.round1(g.y),g.z=Math.round1(g.z);var h=g.clone().multiplyScalar(-1),i=f.clone().multiplyScalar(-1),j=e.clone().multiplyScalar(-1);switch(this.cube.currentFace){case"front":if(f.x==b&&f.y==c&&f.z==d)return"up";if(i.x==b&&i.y==c&&i.z==d)return"down";if(g.x==b&&g.y==c&&g.z==d)return"right";if(h.x==b&&h.y==c&&h.z==d)return"left";break;case"right":if(f.x==b&&f.y==c&&f.z==d)return"up";if(i.x==b&&i.y==c&&i.z==d)return"down";if(j.x==b&&j.y==c&&j.z==d)return"left";if(e.x==b&&e.y==c&&e.z==d)return"right";break;case"left":if(f.x==b&&f.y==c&&f.z==d)return"up";if(i.x==b&&i.y==c&&i.z==d)return"down";if(e.x==b&&e.y==c&&e.z==d)return"left";if(j.x==b&&j.y==c&&j.z==d)return"right";break;case"back":if(f.x==b&&f.y==c&&f.z==d)return"up";if(i.x==b&&i.y==c&&i.z==d)return"down";if(h.x==b&&h.y==c&&h.z==d)return"right";if(g.x==b&&g.y==c&&g.z==d)return"left";break;case"top":if(j.x==b&&j.y==c&&j.z==d)return"down";if(e.x==b&&e.y==c&&e.z==d)return"up";if(g.x==b&&g.y==c&&g.z==d)return"right";if(h.x==b&&h.y==c&&h.z==d)return"left";break;case"bottom":if(e.x==b&&e.y==c&&e.z==d)return"down";if(j.x==b&&j.y==c&&j.z==d)return"up";if(g.x==b&&g.y==c&&g.z==d)return"right";if(h.x==b&&h.y==c&&h.z==d)return"left"}}},this.setCameraOrtho=function(b){b&&a.isPerspective&&a.toOrthographic(),b||a.isPerspective||a.toPerspective()},this.resetOrientation=function(){this.setCameraOrtho(this.originalHomeVector.isOrtho),this.sceneUpDirection.copy(this.originalHomeVector.worldUp),this.sceneFrontDirection.copy(this.originalHomeVector.worldFront),this.cubeFront.copy(this.sceneFrontDirection).cross(this.sceneUpDirection).normalize(),this.setCameraUp(this.sceneUpDirection),c(!0)},this.setCurrentViewAsFront=function(){this.cube&&(this.cube.currentFace="front"),this.sceneUpDirection.copy(a.up.clone()),this.sceneFrontDirection.copy(this.getView()).normalize(),this.cubeFront.copy(this.sceneFrontDirection).cross(this.sceneUpDirection).normalize(),this.orthographicFaces&&this.setCameraOrtho(!0),c(!0)},this.setCurrentViewAsTop=function(){this.cube&&(this.cube.currentFace="top"),this.sceneUpDirection.copy(this.getView()).multiplyScalar(-1).normalize(),this.sceneFrontDirection.copy(a.up),this.cubeFront.copy(this.sceneFrontDirection).cross(this.sceneUpDirection).normalize(),c(!0)},this.calculateCubeTransform=function(b){var c=this.sceneUpDirection.clone(),d=this.sceneFrontDirection.clone(),e=this.sceneFrontDirection.clone().cross(this.sceneUpDirection).normalize();K=a.clone(),K.center=q.center.clone(),K.pivot=q.pivot.clone(),L=a.clone(),L.center=q.center.clone(),L.pivot=q.pivot.clone();var f=new THREE.Vector3(0,0,0);b.contains("back")&&(f=f.add(d)),b.contains("front")&&(f=f.sub(d)),b.contains("top")&&(f=f.add(c)),b.contains("bottom")&&(f=f.sub(c)),b.contains("right")&&(f=f.add(e)),b.contains("left")&&(f=f.sub(e));var g=c,h=f.clone().normalize();if(1-Math.abs(h.dot(c))<Number.MIN_VALUE)for(var i=this.getView().normalize(),j=[d.clone(),d.clone().negate(),e.clone(),e.clone().negate()],k=h.dot(c)>0?1:-1,l=i.clone().add(a.up.clone().multiplyScalar(k)).normalize(),m=-2,n=0;n<4;n++){var o=l.dot(j[n]);o>m&&(m=o,g=j[n].multiplyScalar(k))}E=D=this.getView().length(),L.position.copy(L.center.clone().add(f.multiplyScalar(E/f.length()))),L.up.copy(g);var p=K.center.clone().sub(K.position).normalize(),r=p.clone().cross(K.up).normalize(),s=r.clone().cross(p).normalize(),t=new THREE.Matrix3;t.set(p.x,s.x,r.x,p.y,s.y,r.y,p.z,s.z,r.z),F.setFromRotationMatrix3(t),p=L.center.clone().sub(L.position).normalize(),r=p.clone().cross(L.up).normalize(),s=r.clone().cross(p).normalize(),t.set(p.x,s.x,r.x,p.y,s.y,r.y,p.z,s.z,r.z),H.setFromAxisAngle(p,0),I.setFromAxisAngle(s,0),G.setFromRotationMatrix3(t),G.multiply(H).multiply(I).normalize()},this.centerShot=function(b){K&&!b||(q.elapsedTime=0,K=L=a.clone(),K.center=q.center);var d=q.pivot.clone(),e=d.clone().sub(K.position),f=K.center.clone().sub(K.position).normalize(),g=K.up.clone(),h=f.clone().cross(g).normalize();g=h.clone().cross(f).normalize();var i=h.clone().multiplyScalar(h.dot(e)),j=g.clone().multiplyScalar(g.dot(e)),k=i.clone().add(j);L.position.copy(K.position.clone().add(k)),L.center=d,L.pivot=d;var l=0;if(q.elapsedTime>=J.duration)l=1;else{var m=J.destinationPercent;l=Math.easeClamp(q.elapsedTime/J.duration,0,m),q.elapsedTime+=u/2e3}var n=a.position.clone().multiplyScalar(1-l).add(L.position.clone().multiplyScalar(l)),o=q.center.clone().multiplyScalar(1-l).add(L.center.clone().multiplyScalar(l)),p=q.pivot.clone().multiplyScalar(1-l).add(L.pivot.clone().multiplyScalar(l));a.position.copy(n),q.center.copy(o),q.pivot.copy(p),a.lookAt(q.center),c(!1),1===l?this.addHistoryElement():requestAnimationFrame(function(){q.centerShot(!1)})},this.levelShot=function(){var b=this.getView(),c=b.length(),d=this.sceneUpDirection.clone(),e=a.up.clone().normalize(),f=b.normalize(),g=f.dot(d);if(1-Math.abs(g)>Number.MIN_VALUE){var h=f.clone().cross(d);f=d.clone().cross(h),f.normalize()}else f=e.clone();f.multiplyScalar(c);var i={center:f.add(a.position),up:d,position:a.position,pivot:q.center.clone().add(f),fov:a.fov,worldUp:d};q.elapsedTime=0,q.animateTransition(i)},this.fitToWindow=function(){var b=this.getView(),c=a.up.clone();b.normalize(),c.normalize(),L=a.clone(),L.center=q.center,c=d(c,b),c.normalize(),L.up.copy(c);var e=b.clone().cross(c);e.normalize();var f=Q.clone(),g=R.clone(),h=[f,g],i=new THREE.Vector3(g.x-f.x,g.y-f.y,g.z-f.z);h[2]=new THREE.Vector3(g.x,f.y,g.z),h[3]=new THREE.Vector3(g.x,f.y,f.z),h[4]=new THREE.Vector3(g.x,g.y,f.z),h[5]=new THREE.Vector3(f.x,g.y,g.z),h[6]=new THREE.Vector3(f.x,g.y,f.z),h[7]=new THREE.Vector3(f.x,f.y,g.z);for(var j=0;j<8;j++){var k=h[j].clone().sub(a.position);h[j].setX(k.clone().dot(e)),h[j].setY(k.clone().dot(c)),h[j].setZ(k.clone().dot(b))}var l,m,n,o,p=THREE.Math.degToRad(a.topFov),r=THREE.Math.degToRad(a.bottomFov),s=THREE.Math.degToRad(a.leftFov),t=THREE.Math.degToRad(a.rightFov);l=s>=0?Number.MAX_VALUE:Number.MIN_VALUE,m=t>=0?Number.MAX_VALUE:Number.MIN_VALUE,n=p>=0?Number.MAX_VALUE:Number.MIN_VALUE,o=r>=0?Number.MAX_VALUE:Number.MIN_VALUE;for(var u=1/Math.tan(t),v=-1/Math.tan(s),w=1/Math.tan(p),x=-1/Math.tan(r),y=0;y<8;y++){var z=h[y].clone(),A=z.z-v*z.x;l=s>=0?Math.min(l,A):Math.max(l,A),A=z.z-u*z.x,m=t>=0?Math.min(m,A):Math.max(m,A),A=z.z-w*z.y,n=p>=0?Math.min(n,A):Math.max(n,A),A=z.z-x*z.y,o=r>=0?Math.min(o,A):Math.max(o,A)}var B=(m-l)/(v-u),C=v*B+l,D=(o-n)/(w-x),E=w*D+n,F=0;if(C<=E){var G=(p-r)/2;if(Math.abs(G)>Number.MIN_VALUE){var H=1/Math.tan(G);D=D-E/H+C/H}F=C}else{var I=(t-s)/2;if(Math.abs(I)>Number.MIN_VALUE){var J=1/Math.tan(I);B=B-C/J+E/J}F=E}var K=new THREE.Vector3(B,D,F),M=e.clone().multiplyScalar(K.x),N=c.clone().multiplyScalar(K.y),O=b.clone().multiplyScalar(K.z);K=M.clone().add(N.clone().add(O)),L.position.add(K);var P=i.clone().sub(L.position).dot(b);L.center=L.position.clone().add(b.multiplyScalar(P)),L.pivot=i.clone();var S={
center:L.center,up:L.up,position:L.position,pivot:L.pivot,fov:a.fov,worldUp:q.sceneUpDirection.clone()};q.elapsedTime=0,q.animateTransition(S)},this.updatePivotPosition=function(b){var c,d,e=new THREE.Vector3(b.x/window.innerWidth*2-1,2*-(b.y/window.innerHeight)+1,.5);if(e=e.unproject(a),c=new THREE.Raycaster(a.position,e.sub(a.position).normalize()),d=c.intersectObjects(objects),"zoom"==q.mode)if(void 0!==d[0]){var f=d[0].point;q.pivot.copy(f)}else{var g=h(b);q.pivot.copy(g.rayO.clone().add(g.rayD))}else if(void 0!==d[0]){wheel.cursorImage("pivot");var f=d[0].point;q.isMouseDown||q.pivot.copy(f)}else wheel.cursorImage("SWInvalidArea")},this.onDrawHeight=function(b,c,d,e,f){var g=86,h=new THREE.Vector3(0,1,0),i=a.position.clone().dot(h),j=Math.linearClamp(i,q.minSceneBound,q.maxSceneBound),k=j-.5;s&&(s.find("img#updownImageA").remove(),s.prepend('<img src="'+f+'SWheighthandleA.png" id="updownImageA" style="position:fixed; z-index:9999; top:'+(d-g*k)+"px; left:"+c+'px;"/>'),e||s.prepend('<img src="'+f+'SWheighthandleI.png" id="updownImageI" style="position:fixed; z-index:9998; top:'+(d-g*k)+"px; left:"+c+'px;"/>'))},this.drawDropdownMenu=function(a,b,c,d,e,f,g){var h=0;if(r)f.appendChild(r);else{r=document.createElement("div"),r.className="dropDownMenu",r.style.top="100px",r.style.left="-400px";for(var i=0,j=0,k=0;k<a.length;k++){var l;if(null===a[k])l=document.createElement("li"),l.style.height="1px",i+=1,l.style.backgroundColor="#E0E0E0";else{var m=Autodesk.Viewing.i18n.translate(a[k]);if(j=m.length>j?m.length:j,c[k]){l=document.createElement("div");var n=document.createElement("input"),o=document.createElement("label");n.type="radio",n.className="dropDownMenuCheck",o.innerHTML=m,o.className="dropDownMenuCheckText",l.appendChild(n),l.appendChild(o),l.className="dropDownMenuCheckbox"}else l=document.createElement("li"),l.textContent=m,l.className=b[k]?"dropDownMenuItem":"dropDownMenuItemDisabled";l.id="menuItem"+h,h++,i+=25,l.setAttribute("data-i18n",a[k])}r.appendChild(l)}f.appendChild(r),r.style.minWidth=Math.max(256,7.4*j)+"px";var p=r.getBoundingClientRect().width;this.menuSize.x=p,this.menuSize.y=i}h=0;for(var k=0;k<a.length;k++)if(null!==a[k]){if(c[k]){var q="menuItem"+h,s=document.getElementById(q);s&&(s.children[0].checked=c[k]())}h++}var t=e-15,u=d+1,v=this.canvas.getBoundingClientRect();u+this.menuSize.x>v.right&&(u=d-this.menuSize.x-1),t+this.menuSize.y>v.bottom&&(t=v.bottom-this.menuSize.y),t-=g.y,u-=g.x,r.style.top=t+"px",r.style.left=u+"px",this.menuOrigin.x=u,this.menuOrigin.y=t},this.removeDropdownMenu=function(a){a.removeChild(r)},this.isFaceView=function(){var b=this.center.clone().sub(a.position).normalize();return p(b)&&p(a.up)},this.startInteraction=function(a,b){this.startCursor=new THREE.Vector2(a,b),this.startState={saveCenter:this.center.clone(),saveEye:this.camera.position.clone(),savePivot:this.pivot.clone(),saveUp:this.camera.up.clone()},this.lockDeltaX=0,this.lockedX=!1,this.lastSnapRotateX=0,this.lockDeltaY=0,this.lockedY=!1,this.lastSnapRotateY=0,this.lastSnapDir=new THREE.Vector3(0,0,0),this.navApi.setTransitionActive(!0)},this.orbit=function(b,d,e,f){if(this.navApi.isActionEnabled("orbit")&&this.currentlyAnimating!==!0){var h="wheel";if(q.orthographicFaces&&!a.isPerspective&&(a.toPerspective(),f&&f.saveEye.copy(this.camera.position)),f&&(h="cube"),"cube"==h?(this.saveCenter.copy(f.saveCenter),this.saveEye.copy(f.saveEye),this.savePivot.copy(f.savePivot),this.saveUp.copy(f.saveUp),this.useSnap=!0,this.doCustomOrbit=!0):(this.saveCenter.copy(this.center),this.savePivot.copy(this.pivot),this.saveEye.copy(a.position),this.saveUp.copy(a.up),this.useSnap=!1,this.doCustomOrbit=!1),j()&&void 0==A&&(A=this.saveCenter.clone(),z=this.saveEye.clone(),C=this.savePivot.clone(),B=this.saveUp.clone()),this.preserveOrbitUpDirection){var k=g(b.x-d.x,b.y-d.y),l=g(e.x,e.y),m=this.sceneUpDirection.clone(),n=this.sceneFrontDirection.clone(),o=this.sceneFrontDirection.clone().cross(this.sceneUpDirection).normalize(),p=j()?C:this.savePivot,r=j()?z:this.saveEye,s=j()?A:this.saveCenter,t=j()?B:this.saveUp,u=p.clone().sub(r).normalize(),v=s.clone().sub(r).normalize(),w=v.clone().cross(t),x=r.clone().sub(p).length(),y=r.clone().sub(s).length(),D=u.clone().multiplyScalar(-1),E=v.clone().multiplyScalar(-1),F=w,G=t.clone(),H=0,I=0;if(!this.constrainOrbitHorizontal){var J=m.dot(this.saveUp),K=.009;J<-K&&(k.x=-k.x,l.x=-l.x);var L=0;L=j()?l.x*this.orbitMultiplier:this.useSnap?this.lastSnapRotateX+i("h",H,-l.x):k.x*this.orbitMultiplier,this.lastSnapRotateX=L;var M=(new THREE.Quaternion).setFromAxisAngle(m,-L);D.applyQuaternion(M),E.applyQuaternion(M),F.applyQuaternion(M),G.applyQuaternion(M)}if(!this.constrainOrbitVertical){var N=n.clone().multiplyScalar(n.dot(F)),O=o.clone().multiplyScalar(o.dot(F)),P=N.clone().add(O);P.clone().normalize();var Q=0;if(j())Q=l.y*this.orbitMultiplier;else{var R=i("v",I,l.y);Q=this.useSnap?this.lastSnapRotateY+R:k.y*this.orbitMultiplier}var S=(new THREE.Quaternion).setFromAxisAngle(P,-Q);if(this.navApi.getOrbitPastWorldPoles())D.applyQuaternion(S).normalize(),E.applyQuaternion(S).normalize(),G.applyQuaternion(S).normalize();else{var T=G.clone();T.applyQuaternion(S).normalize();var U=m.dot(T);if(U<0){var V=E.clone();V.applyQuaternion(S).normalize();var W=V.angleTo(m);Math.abs(W)>.5*Math.PI&&(W-=W>0?Math.PI:-Math.PI),Q-=W,S.setFromAxisAngle(P,-Q),D.applyQuaternion(S).normalize(),E.applyQuaternion(S).normalize(),G.applyQuaternion(S).normalize()}else D.applyQuaternion(S).normalize(),E.applyQuaternion(S).normalize(),G.applyQuaternion(S).normalize()}this.lastSnapRotateY=Q}var X=D.multiplyScalar(x).add(p);a.position.copy(X),a.up.copy(G),this.center.copy(X),this.center.sub(E.multiplyScalar(y)),j()&&(A.copy(this.center),z.copy(a.position),C.copy(this.pivot),B.copy(a.up))}a.lookAt(this.center),c(!1)}},this.endInteraction=function(){this.navApi.setTransitionActive(!1)},this.look=function(b){if(this.navApi.isActionEnabled("walk")){var d=g(b.x,b.y),e=this.userLookSpeed,f=this.getView(),h=a.up,i=f.clone().cross(h).normalize(),j=this.sceneUpDirection.clone(),k=d.clone();k.x*=Math.PI,k.y*=Math.PI/a.aspect,k.multiplyScalar(e);var l=(new THREE.Quaternion).setFromAxisAngle(i,-k.y);if(a.keepSceneUpright&&!this.navApi.getOrbitPastWorldPoles()){var m=h.clone();if(m.applyQuaternion(l).normalize(),m.dot(j)<0){var n=f.clone();n.applyQuaternion(l);var o=n.angleTo(j);Math.abs(o)>.5*Math.PI&&(o-=o>0?Math.PI:-Math.PI),k.y-=o,l.setFromAxisAngle(i,-k.y)}}f=l.clone().rotate(f),h=l.clone().rotate(h),h.normalize();var p=a.keepSceneUpright?j:h,q=(new THREE.Quaternion).setFromAxisAngle(p,-k.x);f=q.clone().rotate(f),h=q.clone().rotate(h),this.center.copy(f.add(a.position)),a.up.copy(h),a.lookAt(this.center),c(!1)}},this.pan=function(b){if(this.navApi.isActionEnabled("pan")){b=g(b.x,b.y);var d=this.getView(),e=a.up.clone().cross(d),f=d.clone().cross(e);e.normalize(),f.normalize(),d.normalize();var h=this.pivot.clone().sub(a.position),i=d.clone().dot(h),j=i*(Math.tan(THREE.Math.degToRad(a.leftFov))+Math.tan(THREE.Math.degToRad(a.rightFov))),k=i*(Math.tan(THREE.Math.degToRad(a.topFov))+Math.tan(THREE.Math.degToRad(a.bottomFov))),l=b.x*Math.abs(j),m=b.y*Math.abs(k),n=new THREE.Vector3,o=e.clone().multiplyScalar(l),p=f.clone().multiplyScalar(m);n=o.clone().add(p).clone().multiplyScalar(this.userPanSpeed),a.position.add(n),this.center.add(n),a.lookAt(this.center),c(!1)}},this.zoom=function(b){if(this.navApi.isActionEnabled("zoom")){var d=this.userZoomSpeed,e=Number.MAX_VALUE,f=b.x+b.y,g=Math.pow(d,f),h=this.pivot.clone().sub(this.pivot.clone().sub(this.saveEye).clone().multiplyScalar(g)),i=h.clone().add(q.D.clone().multiplyScalar(q.D.clone().dot(this.pivot.clone().sub(h).clone())));if(!(g>=e)){if(f>0){var j=0;Math.pow(d,f-j);if(f<j)return void(P=0);a.position.copy(h),this.center.copy(i);var k=h.clone().sub(this.saveEye).dot(q.D);k>e?(a.position.copy(this.saveEye.sub(q.D).clone().multiplyScalar(e)),P=e>0?-1:0):P=-(k/e)}else a.position.copy(h),this.center.copy(i);a.lookAt(this.center),c(!1)}}},this.walk=function(b,d,e,f,h){if(this.navApi.isActionEnabled("walk")){var i=this.sceneUpDirection.clone(),j=this.sceneFrontDirection.clone(),l=this.sceneFrontDirection.clone().cross(this.sceneUpDirection),n=!0,o=.01;k(b,d)?(wheel.cursorImage("SWWalk"),m(!0,b,d),x=d.x,y=d.y):m(!1,b,d),x=b.x,y=b.y;var p=g(x-d.x,y-d.y),q=-p.x,r=-p.y,s=q<0?-1:1,t=r<0?-1:1,u=Math.abs(q),v=Math.abs(r),w=new THREE.Vector2(30,30);w=g(w.x,w.y),u=k(b,d)?0:Math.abs(q)-w.x,v=k(b,d)?0:Math.abs(r)-w.y;var z=.25;u/=z,v/=z,u=u<1?Math.easeClamp(u,0,1):Math.pow(u,1),v=v<1?Math.easeClamp(v,0,1):Math.pow(v,1);var A=u>0?u*s:0,B=v>0?v*t:0,C=this.getView(),D=C.length();C.normalize();var E=C.clone().cross(a.up);E.normalize();var F=l.clone().multiplyScalar(l.clone().dot(C)),G=j.clone().multiplyScalar(j.clone().dot(C)),H=G.clone().add(F);H=H.clone().length()>Number.MIN_VALUE?H.normalize():a.up;var I=1,J=B*(this.walkMultiplier*I),K=n?H:C;if(n){var L=Math.cos(.65);1!=L&&(i.clone().dot(a.up)<-Number.MIN_VALUE&&i.clone().dot(C)<-L||i.clone().dot(a.up)>Number.MIN_VALUE&&i.clone().dot(C)>L)&&(K=-K)}var M=-A*this.walkMultiplier*.05,N=a.up;n&&((i.clone().dot(a.up)<-Number.MIN_VALUE||Math.abs(i.clone().dot(a.up))<Number.MIN_VALUE&&i.clone().dot(C)>Number.MIN_VALUE)&&(M=-M),N=i);var O=(new THREE.Quaternion).setFromAxisAngle(N,M);O.normalize(),C=O.clone().rotate(C),C.normalize(),a.up.copy(O.clone().rotate(a.up)),a.up.normalize(),a.position.add(K.clone().multiplyScalar(J)),this.center.copy(a.position.clone().add(C.clone().multiplyScalar(D))),K=n?i:a.up,K.normalize(),0===J&&(J=o),a.lookAt(this.center),c(!1)}},this.updown=function(b){if(!this.navApi.getIsLocked()){var d=b,e=o(d);q.m_amount+=e;var f=new THREE.Vector3(0,1,0),g=q.saveEye.clone().sub(f.clone().multiplyScalar(q.m_amount)),h=g.clone().dot(f);a.position.copy(g),h<q.minSceneBound&&a.position.add(f.clone().multiplyScalar(q.minSceneBound-h)),h>q.maxSceneBound&&a.position.add(f.clone().multiplyScalar(q.maxSceneBound-h)),this.center.copy(a.position.clone().add(q.saveCenter.clone().sub(q.saveEye))),a.lookAt(this.center),c(!1)}},this.addHistoryElement=function(){},this.addIntermediateHistoryElement=function(){this.rewindParams.snapped?this.rewindParams.history=this.rewindParams.history.slice(0,this.rewindParams.timelineIndex):this.rewindParams.slideOffset.x>0?this.rewindParams.history=this.rewindParams.history.slice(0,this.rewindParams.timelineIndex):this.rewindParams.history=this.rewindParams.history.slice(0,this.rewindParams.timelineIndex+1),this.addHistoryElement()},this.clearHistory=function(){this.rewindParams.history.length=0,this.rewindParams.timelineIndex=0,this.rewindParams.timelineIndexSlide=0,this.rewindParams.resetWeights=!0},this.openTimeline=function(a){this.rewindParams.timelineIndexSlide=this.rewindParams.timelineIndex,this.rewindParams.resetWeights&&(this.rewindParams.slideOffset.x=0,this.rewindParams.snapped=this.rewindParams.snappingEnabled),0===this.rewindParams.history.length&&this.addHistoryElement();for(var b=0;b<this.rewindParams.history.length;b++){var c=b-this.rewindParams.timelineIndex,d=this.rewindParams.thumbnailGapSize+this.rewindParams.thumbnailSize;this.rewindParams.history[b].thumbnailBounds.setCenter(new THREE.Vector2(a.x+c*d,a.y).add(this.rewindParams.slideOffset)),this.rewindParams.resetWeights&&(this.rewindParams.history[b].weight=b==this.rewindParams.timelineIndex?1:0)}this.rewindParams.resetWeights&&(this.rewindParams.resetWeights=!1);var d=2*(this.rewindParams.thumbnailGapSize+this.rewindParams.thumbnailSize);if(this.rewindParams.open=!0,this.rewindParams.openLocation=a.clone(),this.rewindParams.openLocationOrigin=a.clone(),this.rewindParams.openBracket=a.clone(),this.rewindParams.openBracketA=new THREE.Vector2(d,a.y),this.rewindParams.openBracketB=new THREE.Vector2(window.innerWidth-d,a.y),this.rewindParams.openBracketA.x>this.rewindParams.openBracketB.x){var e=this.rewindParams.openBracketA.x;this.rewindParams.openBracketA.x=this.rewindParams.openBracketB.x,this.rewindParams.openBracketB.x=e}this.rewindParams.locationOffset=new THREE.Vector2(0,0),this.rewindParams.snapOffset=new THREE.Vector2(0,0)},this.slideTimeline=function(a){if(this.rewindParams.open&&0!==this.rewindParams.history.length){var b=a.clone().add(this.rewindParams.locationOffset),c=2*(this.rewindParams.thumbnailGapSize+this.rewindParams.thumbnailSize),d=c,e=window.innerWidth-c,f=this.rewindParams.history[0].thumbnailBounds.center().x,g=this.rewindParams.history[this.rewindParams.history.length-1].thumbnailBounds.center().x,h=0;if(b.x<this.rewindParams.openBracketA.x){h=b.x-this.rewindParams.openBracketA.x;var i=f-h;d<i&&(h=Math.min(h+(i-d),0))}if(b.x>this.rewindParams.openBracketB.x){h=b.x-this.rewindParams.openBracketB.x;var j=g-h;e>j&&(h=Math.max(h+(j-e),0))}this.rewindParams.openLocation.x+=h,this.rewindParams.openBracketA.x+=h,this.rewindParams.openBracketB.x+=h,this.rewindParams.openBracket.x=b.x-(this.rewindParams.openLocation.x-this.rewindParams.openLocationOrigin.x);var k=new THREE.Vector2(-h,0),l=b.clone().sub(this.rewindParams.openLocation.clone().sub(this.rewindParams.openLocationOrigin));k.x+=this.rewindParams.snapOffset.x,this.rewindParams.snapOffset.x=0;var m=!1;if(this.rewindParams.snappingEnabled)for(var n=4,o=16,p=0;p<this.rewindParams.history.length;p++){var q=this.rewindParams.history[p].thumbnailBounds.center().add(k);if(Math.abs(q.x-l.x)<n||this.rewindParams.snapped&&Math.abs(q.x-l.x)<o){m=!0,0!==h?(this.rewindParams.snapOffset.x=q.x-l.x,k.x-=this.rewindParams.snapOffset.x):this.rewindParams.openBracket.x+=q.x-l.x,l.x=q.x;break}}this.rewindParams.snapped=m;for(var r=-1,s=0,t=0;t<this.rewindParams.history.length;t++){var u=this.rewindParams.history[t].thumbnailBounds.clone();if(this.rewindParams.history[t].thumbnailBounds.setCenter(this.rewindParams.history[t].thumbnailBounds.center().add(k)),this.rewindParams.history[t].thumbnail){var v=this.rewindParams.history[t].thumbnailBounds.center().x-this.rewindParams.thumbnailSize/2;$("#rewindFrame"+t).css("left",v),$("#rewindBorder"+t).css("left",v-4)}var w=new THREE.Vector2(2*(this.rewindParams.thumbnailGapSize+this.rewindParams.thumbnailSize),2*(this.rewindParams.thumbnailGapSize+this.rewindParams.thumbnailSize));u.setFromCenterAndSize(u.center(),w);var x=new THREE.Vector2(0,0);u.getIcon2DCoords(l,x);var y=1-Math.abs(Math.equalityClamp(x.x,-1,1));this.rewindParams.history[t].weight=y,0===t&&l.x<u.center().x&&(this.rewindParams.history[t].weight=1),t===this.rewindParams.history.length-1&&l.x>u.center().x&&(this.rewindParams.history[t].weight=1),s+=this.rewindParams.history[t].weight,this.rewindParams.history[t].weight>r&&(r=this.rewindParams.history[t].weight,this.rewindParams.snappingEnabled&&1==this.rewindParams.history[t].weight?(this.rewindParams.slideOffset.x=0,this.rewindParams.snapped=!0):this.rewindParams.slideOffset.x=this.rewindParams.history[t].thumbnailBounds.center().x-l.x,this.rewindParams.timelineIndexSlide=t)}for(var z=0;z<this.rewindParams.history.length;z++)this.rewindParams.history[z].weight=this.rewindParams.history[z].weight/s;var A=this.rewindParams.history[0].thumbnailBounds.center().x,B=this.rewindParams.history[this.rewindParams.history.length-1].thumbnailBounds.center().x;this.rewindParams.openBracket.x<A?(this.rewindParams.locationOffset.x+=A-this.rewindParams.openBracket.x,this.rewindParams.openBracket.x=A):this.rewindParams.openBracket.x>B&&(this.rewindParams.locationOffset.x+=B-this.rewindParams.openBracket.x,this.rewindParams.openBracket.x=B)}},this.shiftBackOneElement=function(){0!==this.rewindParams.history.length&&(this.rewindParams.timelineIndex>0||0!==this.rewindParams.slideOffset.x)&&((this.rewindParams.snapped||this.rewindParams.slideOffset.x>0)&&this.rewindParams.timelineIndex--,this.rewindParams.timelineIndexSlide=this.rewindParams.timelineIndex,this.rewindParams.resetWeights=!0,q.elapsedTime=0,this.animateToRewindIndex())},this.animateToRewindIndex=function(){var b=this.rewindParams.timelineIndex,d=0;if(q.elapsedTime>=J.duration)d=1;else{var e=J.destinationPercent;d=Math.easeClamp(q.elapsedTime/J.duration,0,e),q.elapsedTime+=u/500}q.center.copy(q.center.clone().multiplyScalar(1-d).clone().add(this.rewindParams.history[b].camera.center.clone().multiplyScalar(d))),a.position.copy(a.position.clone().multiplyScalar(1-d).clone().add(this.rewindParams.history[b].camera.position.clone().multiplyScalar(d))),a.up.copy(this.rewindParams.history[b].camera.up),q.pivot.copy(q.center),a.lookAt(q.center),c(!1),this.cube&&requestAnimationFrame(this.cube.render),1!==d&&requestAnimationFrame(function(){q.animateToRewindIndex()})},this.closeTimeline=function(){this.rewindParams.timelineIndex!=this.rewindParams.timelineIndexSlide&&(this.rewindParams.timelineIndex=this.rewindParams.timelineIndexSlide),this.rewindParams.open=!1},this.getInterpolatedCamera=function(){var b=new THREE.PerspectiveCamera(70,window.innerWidth/window.innerHeight,1,1e4);b.center=new THREE.Vector3(0,0,0),b.pivot=new THREE.Vector3(0,0,0),b.leftFov=0,b.rightFov=0,b.topFov=0,b.bottomFov=0,b.up.set(0,0,0);for(var d=0;d<this.rewindParams.history.length;d++){var e=this.rewindParams.history[d].camera,f=this.rewindParams.history[d].weight;b.center.add(e.center.clone().multiplyScalar(f)),b.position.add(e.position.clone().multiplyScalar(f)),b.up.add(e.up.clone().multiplyScalar(f)),b.rotation.add(e.rotation.clone().multiplyScalar(f)),b.pivot.add(e.pivot.clone().multiplyScalar(f)),b.leftFov+=e.leftFov*f,b.rightFov+=e.rightFov*f,b.topFov+=e.topFov*f,b.bottomFov+=e.bottomFov*f}a.position.copy(b.position),a.up.copy(b.up),a.rotation=b.rotation,a.leftFov=b.leftFov,a.rightFov=b.rightFov,a.topFov=b.topFov,a.bottomFov=b.bottomFov,q.center.copy(b.center),q.pivot.copy(b.pivot),a.lookAt(q.center),a.up.normalize(),c(!1)}};var avp=Autodesk.Viewing.Private;avp.Autocam.ViewCube=function(a,b,c,d){function e(a,b){var c={};return 0===a.type.indexOf("touch")?a.touches.length>0?(c.clientX=a.touches[0].clientX,c.clientY=a.touches[0].clientY,c.pageX=a.touches[0].pageX,c.pageY=a.touches[0].pageY,c.screenX=a.touches[0].screenX,c.screenY=a.touches[0].screenY,c.movementX=c.screenX-b.prevX,c.movementY=c.screenY-b.prevY,c.which=g.navApi.getUseLeftHandedInput()?3:1):c=b.prevCoords:(c.clientX=a.clientX,c.clientY=a.clientY,c.pageX=a.pageX,c.pageY=a.pageY,c.screenX=a.screenX,c.screenY=a.screenY,c.which=a.which,S?(c.movementX=a.movementX||a.mozMovementX||a.webkitMovementX||0,c.movementY=a.movementY||a.mozMovementY||a.webkitMovementY||0):(c.movementX=c.screenX-b.prevX,c.movementY=c.screenY-b.prevY)),b.prevX=c.screenX,b.prevY=c.screenY,b.prevCoords=c,c}var f=this,g=b,h=b.camera;b.setCube(this),f.currentFace="front";var i,j,k,l,m,n,o=["top,front","top right","top,left","top,back","bottom,front","bottom,right","bottom,left","bottom,back","left,front","front,right","right,back","back,left"],p=["front,top,right","back,top,right","front,top,left","back,top,left","front,bottom,right","back,bottom,right","front,bottom,left","back,bottom,left"],q=["Go Home",null,"Orthographic","Perspective","Perspective with Ortho Faces",null,"Set current view as Home","Focus and set as Home","Reset Home",null,"Set current view as Front","Set current view as Top","Reset orientation"],r=[!0,null,!0,!0,!0,null,!0,!0,!0,null,!0,!0,!0],s=[null,null,function(){return!g.orthographicFaces&&!h.isPerspective},function(){return!g.orthographicFaces&&h.isPerspective},function(){return g.orthographicFaces},null,null,null,null,null,null,null,null];f.camera=new THREE.PerspectiveCamera(45,window.innerWidth/window.innerHeight,1,2e3),f.camera.position.copy(h.position),f.center=new THREE.Vector3(0,0,0),f.camera.lookAt(f.center);var t,u,v,w,x,y,z,A,B,C,D,E,F,G,H=[],I=[],J=[],K=[],L=[],M=null,N=null,O=null,P=0,Q=0,R=!0,S=!1,T=!1,U=!1,V=navigator.userAgent.search("Chrome")!=-1,W=navigator.platform.search("Win32")!=-1,X=!1,Y=!1,Z=[];this.width=0,this.height=0,this.animSpeed=500,this.animate=!0,this.compass=!1,this.viewScaleFactorCompass=1.5,this.viewScale=1,this.draggable=!0,this.wantHomeButton=!1,this.wantRollArrows=!0,this.wantContextMenu=!0,this.inactiveOpacity=.5;var $=function(a){var b=a.getBoundingClientRect();return{x:b.left,y:b.top,w:b.width,h:b.height}},_=function(a){a.preventDefault(),a.stopPropagation(),T=document.pointerLockElement===c||document.mozPointerLockElement===c||document.webkitPointerLockElement===c},aa=function(){var a=c.getBoundingClientRect();f.width=a.width,f.height=a.height,G=$(c),z=f.width/2,A=f.height/2,n=new THREE.PerspectiveCamera(70,f.height/f.width,1,1e4),n.position.set(0,0,500),i=new THREE.Scene,j=new THREE.Scene,k=new THREE.Scene,l=new THREE.Scene,m=new THREE.Scene,R=!0,P=200,f.viewScale=3.5*P;var b=THREE.LinearFilter,e=Autodesk.Viewing.Private.getResourceUrl,h="res/textures/",o=d||h,p=(new THREE.DDSLoader).load(e(o+"VCcrossRGBA8small.dds"));p.minFilter=p.maxFilter=b;var q=THREE.ShaderLib.cube,r=Autodesk.Viewing.Shaders.createShaderMaterial(q);r.depthWrite=!1,r.uniforms.tCube.value=p;var s=new THREE.BoxGeometry(P,P,P,4,4,4),H=new THREE.BoxGeometry(P+1,P+1,P+1,4,4,4);t=new THREE.Mesh(s,r),t.position.set(0,0,0),j.add(t);var J=ea(e(h+"VCedge1.png"));J.minFilter=J.maxFilter=b,u=new THREE.Mesh(H,new THREE.MeshBasicMaterial({map:J,overdraw:!1,transparent:!0,shading:THREE.SmoothShading})),u.position.set(0,0,0),l.add(u);var L=P,M=new THREE.Geometry,N=new THREE.Vector3(-30,0,0),O=new THREE.Vector3(30,0,0),Q=new THREE.Vector3(0,-30,0);M.vertices.push(N),M.vertices.push(O),M.vertices.push(Q),M.faces.push(new THREE.Face3(1,0,2)),M.computeFaceNormals();var T=new THREE.MeshBasicMaterial({overdraw:!0,color:14540253,transparent:!1,opacity:1,shading:THREE.FlatShading}),U=new THREE.MeshBasicMaterial({overdraw:!0,color:14540253,transparent:!1,opacity:1,shading:THREE.FlatShading}),V=new THREE.MeshBasicMaterial({overdraw:!0,color:14540253,transparent:!1,opacity:1,shading:THREE.FlatShading}),W=new THREE.MeshBasicMaterial({overdraw:!0,color:14540253,transparent:!1,opacity:1,shading:THREE.FlatShading}),X=new THREE.PlaneBufferGeometry(.5*P,.3*P,2,2),Y=new THREE.MeshBasicMaterial({transparent:!0,opacity:0}),aa=new THREE.Mesh(M,T),ba=new THREE.Mesh(X,Y);aa.position.set(0,L,0),ba.position.set(0,.9*L,.1);var ca=new THREE.Mesh(M,U),da=new THREE.Mesh(X,Y);ca.position.set(0,-L,0),da.position.set(0,.9*-L,.1),ca.rotation.z+=Math.PI,da.rotation.z+=Math.PI;var ga=new THREE.Mesh(M,V),ha=new THREE.Mesh(X,Y);ga.position.set(L,0,0),ha.position.set(.9*L,0,.1),ga.rotation.z-=Math.PI/2,ha.rotation.z-=Math.PI/2;var ja=new THREE.Mesh(M,W),ka=new THREE.Mesh(X,Y);ja.position.set(-L,0,0),ka.position.set(.9*-L,0,.1),ja.rotation.z+=Math.PI/2,ka.rotation.z+=Math.PI/2,y=new THREE.Object3D,y.position.set(0,0,0),y.add(aa),y.add(ca),y.add(ga),y.add(ja),m.add(ba),m.add(da),m.add(ha),m.add(ka),m.add(y),I.push(ba),I.push(da),I.push(ha),I.push(ka);var la=new THREE.PlaneBufferGeometry(P/3,P/3,2,2),na=new THREE.MeshBasicMaterial({map:ea(e(h+"VChome.png")),transparent:!0,shading:THREE.FlatShading});v=new THREE.Mesh(la,na),v.position.set(-P,P,0),E=K.length,m.add(v),K.push(v);var oa=new THREE.PlaneBufferGeometry(1.5*P,1.5*P,2,2),pa=new THREE.MeshBasicMaterial({map:ea(e(h+"VCarrows.png")),shading:THREE.FlatShading,transparent:!0}),qa=new THREE.Mesh(oa,pa);qa.position.set(.5*P+20,.5*P+20,0);var ra=new THREE.PlaneBufferGeometry(.6*P,.45*P,2,2),sa=new THREE.MeshBasicMaterial({transparent:!0,opacity:0}),ta=new THREE.Mesh(ra,sa);ta.position.set(.5*P+20,P+20,.1);var ua=new THREE.PlaneBufferGeometry(.45*P,.6*P,2,2),va=new THREE.MeshBasicMaterial({transparent:!0,opacity:0}),wa=new THREE.Mesh(ua,va);wa.position.set(P+20,.5*P+20,.1),m.add(qa),m.add(ta),m.add(wa),B=K.length,K.push(ta),C=K.length,K.push(wa),D=K.length,K.push(qa);var xa=new THREE.PlaneBufferGeometry(P/2.3,P/2.3,2,2),ya=new THREE.MeshBasicMaterial({map:ea(e(h+"VCcontext.png")),transparent:!0,shading:THREE.FlatShading});x=new THREE.Mesh(xa,ya),x.position.set(P,-P,0),F=K.length,m.add(x),K.push(x);var za=new THREE.Geometry;za.vertices.push(new THREE.Vector3(0,0,0)),za.vertices.push(new THREE.Vector3(-P/2,-P/2-20,-P/2)),za.vertices.push(new THREE.Vector3(P/2,-P/2-20,-P/2)),za.vertices.push(new THREE.Vector3(P/2,-P/2-20,P/2)),za.vertices.push(new THREE.Vector3(-P/2,-P/2-20,P/2)),za.faces.push(new THREE.Face3(4,3,2)),za.faces.push(new THREE.Face3(4,2,1));var Aa;Aa=new THREE.MeshBasicMaterial({color:0,transparent:!0,opacity:.5}),w=new THREE.Mesh(za,Aa),i.add(w),fa(),"CANVAS"===g.renderer.toUpperCase()?f.renderer=new THREE.CanvasRenderer:"WEBGL"===g.renderer.toUpperCase()?f.renderer=new avp.FireflyWebGLRenderer({alpha:!0,antialias:!1}):(avp.logger.warn("Incorrect use of Autocam.renderer property"),f.renderer=new THREE.CanvasRenderer),f.useTransparency(!0),f.setSize(f.width,f.height),f.camera.topFov=f.camera.bottomFov=f.camera.fov/2,f.camera.leftFov=f.camera.rightFov=f.camera.aspect*f.camera.fov/2,f.renderer.autoClear=!1,f.renderer.setSize(f.width,f.height),f.renderer.sortObjects=!1,c.appendChild(f.renderer.domElement),c.addEventListener("touchstart",ia,!1),c.addEventListener("mousedown",ia,!1),c.addEventListener("mousemove",ma,!1),S=!1,S&&(document.exitPointerLock=document.exitPointerLock||document.mozExitPointerLock||document.webkitExitPointerLock,c.requestPointerLock=c.requestPointerLock||c.mozRequestPointerLock||c.webkitRequestPointerLock,document.addEventListener("pointerlockchange",_,!1),document.addEventListener("mozpointerlockchange",_,!1),document.addEventListener("webkitpointerlockchange",_,!1)),Z.push(ea(e(h+"VChomeS.png"))),Z.push(ea(e(h+"VCarrowsS0.png"))),Z.push(ea(e(h+"VCarrowsS1.png"))),Z.push(ea(e(h+"VChome.png"))),Z.push(ea(e(h+"VCarrows.png"))),Z.push(ea(e(h+"VCcontext.png"))),Z.push(ea(e(h+"VCcontextS.png")))},ba=function(){g.navApi.isActionEnabled("orbit")&&(c.style.opacity="1.0",Y=!1),requestAnimationFrame(f.render)},ca=function(a){if(Y||g.viewCubeMenuOpen||!g.navApi.isActionEnabled("orbit"))g.navApi.isActionEnabled("orbit")&&(c.style.opacity=1);else{var b=Math.max(4*Math.abs((a.clientX-G.x)/G.w-.5)-1,0),d=Math.max(4*Math.abs((a.clientY-G.y)/G.h-.5)-1,0),e=Math.max(0,Math.min(Math.sqrt(b*b+d*d),1));c.style.opacity=1-e*(1-f.inactiveOpacity)}},da=function(){g.viewCubeMenuOpen||(c.style.opacity=f.inactiveOpacity,Y=!0,requestAnimationFrame(f.render))},ea=function(a){var b=new Image,c=av.getUseCredentials()&&(a.indexOf("://")===-1||a.indexOf(window.location.host)!==-1);c?b.crossOrigin="use-credentials":b.crossOrigin="anonymous";var d=new THREE.Texture(b);return b.onload=function(){d.needsUpdate=!0,Q++,Q>=11&&requestAnimationFrame(f.render)},b.src=a,d},fa=function(){var a,b=[],c=[];b[0]=qa(0,0),b[1]=qa(0,Math.PI/2),b[2]=qa(0,-Math.PI/2),b[3]=qa(0,Math.PI),b[4]=qa(Math.PI/2,0),b[5]=qa(Math.PI/2,Math.PI/2),b[6]=qa(Math.PI/2,-Math.PI/2),b[7]=qa(Math.PI/2,Math.PI),c[0]=pa(0,0,0),c[1]=pa(0,Math.PI/2,0),c[2]=pa(0,-Math.PI/2,0),c[3]=pa(0,Math.PI,0),c[4]=pa(Math.PI/2,0,0),c[5]=pa(Math.PI/2,Math.PI/2,0),c[6]=pa(Math.PI/2,-Math.PI/2,0),c[7]=pa(Math.PI/2,Math.PI,0),c[8]=pa(0,0,Math.PI/2),c[9]=pa(0,0,-Math.PI/2),c[10]=pa(-Math.PI/2,0,-Math.PI/2),c[11]=pa(-Math.PI,0,-Math.PI/2),H.push(oa(0,0)),H[0].name="front",J.push(H[0]),L.push(H[0]),k.add(H[0]),H.push(oa(0,Math.PI/2)),H[1].name="right",J.push(H[1]),L.push(H[1]),k.add(H[1]),H.push(oa(0,Math.PI)),H[2].name="back",J.push(H[2]),L.push(H[2]),k.add(H[2]),H.push(oa(0,-Math.PI/2)),H[3].name="left",J.push(H[3]),L.push(H[3]),k.add(H[3]),H.push(oa(Math.PI/2,0)),H[4].name="bottom",J.push(H[4]),L.push(H[4]),k.add(H[4]),H.push(oa(-Math.PI/2,0)),H[5].name="top",J.push(H[5]),L.push(H[5]),k.add(H[5]),a=H.length;var d;for(d=0;d<b.length;d++)H.push(b[d]),H[a+d].name=p[d],k.add(H[a+d]),J.push(H[a+d]),L.push(H[a+d]);for(a=H.length,d=0;d<c.length;d++)H.push(c[d]),H[a+d].name=o[d],k.add(H[a+d]),J.push(H[a+d]),L.push(H[a+d])},ga=function(a,b,c){var d,e,f=new THREE.Vector3;return f.copy(a),f=f.unproject(b),d=new THREE.Raycaster(b.position,f.sub(b.position).normalize()),e=d.intersectObjects(c)},ha=function(a,b){var c=a.clientX-b.x,d=a.clientY-b.y;return c=c/b.w*2-1,d=(b.h-d)/b.h*2-1,new THREE.Vector3(c,d,.5)},ia=function(a){if(a.preventDefault(),a.stopPropagation(),g.navApi.isActionEnabled("orbit")&&!g.currentlyAnimating){var b=e(a,f);G=$(c),c.removeEventListener("mousemove",ma,!1),document.addEventListener("mouseup",la,!1),document.addEventListener("touchend",la,!1),g.navApi.getUsePivotAlways()||(g.pivot.copy(g.center),g.navApi.setPivotPoint(g.center),g.navApi.setPivotSetFlag(!1)),g.startInteraction(b.pageX,b.pageY);var d,h;0==g.rewindParams.history.length&&g.addHistoryElement(),g.rewindParams.snapped&&g.rewindParams.timelineIndex+1==g.rewindParams.history.length||g.addIntermediateHistoryElement();var i=g.navApi.getUseLeftHandedInput()?1:3;if(b.which!==i){if(f.animSpeed<=0)return void avp.logger.error("animSpeed cannot be 0 or less, use ViewCube.animate flag to turn on and off animation");h=ha(b,G),d=ga(h,f.camera,L),d.length>0&&(ta(),f.draggable&&(document.addEventListener("mousemove",ja,!1),document.addEventListener("touchmove",ja,!1),S&&(c.requestPointerLock(),U=V&&W)))}}},ja=function(a){if(a.preventDefault(),a.stopPropagation(),f.animSpeed<=0)return document.removeEventListener("mousemove",ja,!1),document.removeEventListener("touchmove",ja,!1),void avp.logger.error("animSpeed cannot be 0 or less");if(!g.currentlyAnimating){var b=e(a,f);if(S&&U&&(U=!1,b.movementX=b.movementY=0),T&&(b.movementX>300||b.movementY>300)&&(b.movementX=0,b.movementY=0),b.movementX===b.movementY&&0===b.movementX)return void(g.currentlyAnimating=!1);R=!1,X=!0,g.showPivot(!0),g.currentCursor=new THREE.Vector2(b.pageX,b.pageY),g.orbit(g.currentCursor,g.startCursor,new THREE.Vector3(-b.movementX,b.movementY,0),g.startState),f.camera.lookAt(f.center),requestAnimationFrame(f.render)}},ka=function(a){a||(document.removeEventListener("mouseup",la,!1),document.removeEventListener("touchend",la,!1)),document.removeEventListener("mousemove",ja,!1),document.removeEventListener("touchmove",ja,!1),c.addEventListener("mousemove",ma,!1),T&&document.exitPointerLock()},la=function(a){a.preventDefault(),a.stopPropagation();var b,d,i;if(g.currentlyAnimating||X)return g.endInteraction(),g.showPivot(!1),X=!1,void ka(!1);var j=e(a,f);if(g.viewCubeMenuOpen){var k=j.clientX-G.x,l=j.clientY-G.y;if(g.menuOrigin.x<=k&&k<=g.menuOrigin.x+g.menuSize.x&&g.menuOrigin.y<=l&&l<=g.menuOrigin.y+g.menuSize.y){var m=Math.floor((l-5-g.menuOrigin.y)/25),o=function(a){avp.logger.track({name:"navigation/"+a,aggregate:"count"})};switch(m){case 0:o("home"),g.goHome();break;case 1:o("setortho"),g.setOrthographicFaces(!1),g.toOrthographic();break;case 2:o("setpersp"),g.setOrthographicFaces(!1),g.toPerspective();break;case 3:g.setOrthographicFaces(!0),R?g.toOrthographic():g.toPerspective();break;case 4:o("sethome"),g.setCurrentViewAsHome(!1);break;case 5:o("focushome"),g.setCurrentViewAsHome(!0);break;case 6:o("resethome"),g.resetHome();break;case 7:o("setfront"),g.setCurrentViewAsFront();break;case 8:o("settop"),g.setCurrentViewAsTop();break;case 9:g.resetOrientation()}}return g.viewCubeMenuOpen=!1,g.removeDropdownMenu(c),(j.clientX<G.x||j.clientX>G.w+G.x||j.clientY<G.y||j.clientY>G.h+G.y)&&da(),f.mouseMoveSave&&f.processMouseMove(f.mouseMoveSave),void ka(!1)}var p=g.navApi.getUseLeftHandedInput()?1:3;if(j.which===p)return g.viewCubeMenuOpen=!0,g.drawDropdownMenu(q,r,s,j.clientX,j.clientY,c,G),void ka(!0);var t=ha(j,G);if(b=ga(t,f.camera,L),d=ga(t,n,I),i=ga(t,n,K),d.length>0&&R){var u=g.getOrientation();switch(f.currentFace){case"front":switch(u){case"up":d[0].object===I[0]?(g.calculateCubeTransform("top"),f.currentFace="top"):d[0].object===I[1]?(g.calculateCubeTransform("bottom"),f.currentFace="bottom"):d[0].object===I[2]?(g.calculateCubeTransform("right"),f.currentFace="right"):d[0].object===I[3]&&(g.calculateCubeTransform("left"),f.currentFace="left");break;case"right":d[0].object===I[0]?(g.calculateCubeTransform("right"),f.currentFace="right"):d[0].object===I[1]?(g.calculateCubeTransform("left"),f.currentFace="left"):d[0].object===I[2]?(g.calculateCubeTransform("bottom"),
f.currentFace="bottom"):d[0].object===I[3]&&(g.calculateCubeTransform("top"),f.currentFace="top");break;case"down":d[0].object===I[0]?(g.calculateCubeTransform("bottom"),f.currentFace="bottom"):d[0].object===I[1]?(g.calculateCubeTransform("top"),f.currentFace="top"):d[0].object===I[2]?(g.calculateCubeTransform("left"),f.currentFace="left"):d[0].object===I[3]&&(g.calculateCubeTransform("right"),f.currentFace="right");break;case"left":d[0].object===I[0]?(g.calculateCubeTransform("left"),f.currentFace="left"):d[0].object===I[1]?(g.calculateCubeTransform("right"),f.currentFace="right"):d[0].object===I[2]?(g.calculateCubeTransform("top"),f.currentFace="top"):d[0].object===I[3]&&(g.calculateCubeTransform("bottom"),f.currentFace="bottom")}break;case"right":switch(u){case"up":d[0].object===I[0]?(g.calculateCubeTransform("top"),f.currentFace="top"):d[0].object===I[1]?(g.calculateCubeTransform("bottom"),f.currentFace="bottom"):d[0].object===I[2]?(g.calculateCubeTransform("back"),f.currentFace="back"):d[0].object===I[3]&&(g.calculateCubeTransform("front"),f.currentFace="front");break;case"right":d[0].object===I[0]?(g.calculateCubeTransform("back"),f.currentFace="back"):d[0].object===I[1]?(g.calculateCubeTransform("front"),f.currentFace="front"):d[0].object===I[2]?(g.calculateCubeTransform("bottom"),f.currentFace="bottom"):d[0].object===I[3]&&(g.calculateCubeTransform("top"),f.currentFace="top");break;case"down":d[0].object===I[0]?(g.calculateCubeTransform("bottom"),f.currentFace="bottom"):d[0].object===I[1]?(g.calculateCubeTransform("top"),f.currentFace="top"):d[0].object===I[2]?(g.calculateCubeTransform("front"),f.currentFace="front"):d[0].object===I[3]&&(g.calculateCubeTransform("back"),f.currentFace="back");break;case"left":d[0].object===I[0]?(g.calculateCubeTransform("front"),f.currentFace="front"):d[0].object===I[1]?(g.calculateCubeTransform("back"),f.currentFace="back"):d[0].object===I[2]?(g.calculateCubeTransform("top"),f.currentFace="top"):d[0].object===I[3]&&(g.calculateCubeTransform("bottom"),f.currentFace="bottom")}break;case"left":switch(u){case"up":d[0].object===I[0]?(g.calculateCubeTransform("top"),f.currentFace="top"):d[0].object===I[1]?(g.calculateCubeTransform("bottom"),f.currentFace="bottom"):d[0].object===I[2]?(g.calculateCubeTransform("front"),f.currentFace="front"):d[0].object===I[3]&&(g.calculateCubeTransform("back"),f.currentFace="back");break;case"right":d[0].object===I[0]?(g.calculateCubeTransform("front"),f.currentFace="front"):d[0].object===I[1]?(g.calculateCubeTransform("back"),f.currentFace="back"):d[0].object===I[2]?(g.calculateCubeTransform("bottom"),f.currentFace="bottom"):d[0].object===I[3]&&(g.calculateCubeTransform("top"),f.currentFace="top");break;case"down":d[0].object===I[0]?(g.calculateCubeTransform("bottom"),f.currentFace="bottom"):d[0].object===I[1]?(g.calculateCubeTransform("top"),f.currentFace="top"):d[0].object===I[2]?(g.calculateCubeTransform("back"),f.currentFace="back"):d[0].object===I[3]&&(g.calculateCubeTransform("front"),f.currentFace="front");break;case"left":d[0].object===I[0]?(g.calculateCubeTransform("back"),f.currentFace="back"):d[0].object===I[1]?(g.calculateCubeTransform("front"),f.currentFace="front"):d[0].object===I[2]?(g.calculateCubeTransform("top"),f.currentFace="top"):d[0].object===I[3]&&(g.calculateCubeTransform("bottom"),f.currentFace="bottom")}break;case"back":switch(u){case"up":d[0].object===I[0]?(g.calculateCubeTransform("top"),f.currentFace="top"):d[0].object===I[1]?(g.calculateCubeTransform("bottom"),f.currentFace="bottom"):d[0].object===I[2]?(g.calculateCubeTransform("left"),f.currentFace="left"):d[0].object===I[3]&&(g.calculateCubeTransform("right"),f.currentFace="right");break;case"right":d[0].object===I[0]?(g.calculateCubeTransform("left"),f.currentFace="left"):d[0].object===I[1]?(g.calculateCubeTransform("right"),f.currentFace="right"):d[0].object===I[2]?(g.calculateCubeTransform("bottom"),f.currentFace="bottom"):d[0].object===I[3]&&(g.calculateCubeTransform("top"),f.currentFace="top");break;case"down":d[0].object===I[0]?(g.calculateCubeTransform("bottom"),f.currentFace="bottom"):d[0].object===I[1]?(g.calculateCubeTransform("top"),f.currentFace="top"):d[0].object===I[2]?(g.calculateCubeTransform("right"),f.currentFace="right"):d[0].object===I[3]&&(g.calculateCubeTransform("left"),f.currentFace="left");break;case"left":d[0].object===I[0]?(g.calculateCubeTransform("right"),f.currentFace="right"):d[0].object===I[1]?(g.calculateCubeTransform("left"),f.currentFace="left"):d[0].object===I[2]?(g.calculateCubeTransform("top"),f.currentFace="top"):d[0].object===I[3]&&(g.calculateCubeTransform("bottom"),f.currentFace="bottom")}break;case"top":switch(u){case"up":d[0].object===I[0]?(g.calculateCubeTransform("back"),f.currentFace="back"):d[0].object===I[1]?(g.calculateCubeTransform("front"),f.currentFace="front"):d[0].object===I[2]?(g.calculateCubeTransform("right"),f.currentFace="right"):d[0].object===I[3]&&(g.calculateCubeTransform("left"),f.currentFace="left");break;case"right":d[0].object===I[0]?(g.calculateCubeTransform("right"),f.currentFace="right"):d[0].object===I[1]?(g.calculateCubeTransform("left"),f.currentFace="left"):d[0].object===I[2]?(g.calculateCubeTransform("front"),f.currentFace="front"):d[0].object===I[3]&&(g.calculateCubeTransform("back"),f.currentFace="back");break;case"down":d[0].object===I[0]?(g.calculateCubeTransform("front"),f.currentFace="front"):d[0].object===I[1]?(g.calculateCubeTransform("back"),f.currentFace="back"):d[0].object===I[2]?(g.calculateCubeTransform("left"),f.currentFace="left"):d[0].object===I[3]&&(g.calculateCubeTransform("right"),f.currentFace="right");break;case"left":d[0].object===I[0]?(g.calculateCubeTransform("left"),f.currentFace="left"):d[0].object===I[1]?(g.calculateCubeTransform("right"),f.currentFace="right"):d[0].object===I[2]?(g.calculateCubeTransform("back"),f.currentFace="back"):d[0].object===I[3]&&(g.calculateCubeTransform("front"),f.currentFace="front")}break;case"bottom":switch(u){case"up":d[0].object===I[0]?(g.calculateCubeTransform("front"),f.currentFace="front"):d[0].object===I[1]?(g.calculateCubeTransform("back"),f.currentFace="back"):d[0].object===I[2]?(g.calculateCubeTransform("right"),f.currentFace="right"):d[0].object===I[3]&&(g.calculateCubeTransform("left"),f.currentFace="left");break;case"right":d[0].object===I[0]?(g.calculateCubeTransform("right"),f.currentFace="right"):d[0].object===I[1]?(g.calculateCubeTransform("left"),f.currentFace="left"):d[0].object===I[2]?(g.calculateCubeTransform("back"),f.currentFace="back"):d[0].object===I[3]&&(g.calculateCubeTransform("front"),f.currentFace="front");break;case"down":d[0].object===I[0]?(g.calculateCubeTransform("back"),f.currentFace="back"):d[0].object===I[1]?(g.calculateCubeTransform("front"),f.currentFace="front"):d[0].object===I[2]?(g.calculateCubeTransform("left"),f.currentFace="left"):d[0].object===I[3]&&(g.calculateCubeTransform("right"),f.currentFace="right");break;case"left":d[0].object===I[0]?(g.calculateCubeTransform("left"),f.currentFace="left"):d[0].object===I[1]?(g.calculateCubeTransform("right"),f.currentFace="right"):d[0].object===I[2]?(g.calculateCubeTransform("front"),f.currentFace="front"):d[0].object===I[3]&&(g.calculateCubeTransform("back"),f.currentFace="back")}}g.elapsedTime=0,g.sphericallyInterpolateTransition()}if(i.length>0){if(g.elapsedTime=0,f.wantHomeButton&&i[0].object===K[E])return g.goHome(),void ka(!1);if(f.wantContextMenu&&i[0].object===K[F])return g.viewCubeMenuOpen=!0,g.drawDropdownMenu(q,r,s,j.clientX,j.clientY,c,G),void ka(!0);if(f.wantRollArrows&&R&&(i[0].object===K[B]||i[0].object===K[C])){var v=i[0].object===K[C],w={center:g.center.clone(),position:h.position.clone(),pivot:h.pivot.clone(),fov:h.fov,worldUp:g.sceneUpDirection.clone(),isOrtho:h.isPerspective===!1},x=g.center.clone().sub(h.position).normalize();v?w.up=h.up.clone().cross(x):(w.up=h.up.clone().multiplyScalar(-1),w.up.cross(x)),w.up.normalize(),g.elapsedTime=0,g.animateTransition(w)}}if(b.length>0){var y=b[0].object.name;f.mouseMoveSave=a,f.cubeRotateTo(y)}ka(!1)};this.cubeRotateTo=function(a){f.currentFace=a,g.orthographicFaces&&f.currentFace.indexOf(",")!==-1&&g.setCameraOrtho(!1),g.calculateCubeTransform(f.currentFace),g.elapsedTime=0,g.sphericallyInterpolateTransition(function(){f.mouseMoveSave&&f.processMouseMove(f.mouseMoveSave)})},this.processMouseMove=function(a){var b,c,d;if(g.viewCubeMenuOpen||g.currentlyAnimating)return void(f.mouseMoveSave=a);f.mouseMoveSave=null;var h=e(a,f),i=ha(h,G);if(b=ga(i,f.camera,J),c=ga(i,n,I),d=ga(i,n,K),M&&!X&&(M.material.color.setHex(14540253),M=null,requestAnimationFrame(f.render)),c.length>0&&!X){M=c[0].object;for(var j=y.children.length;--j>=0;)if(M===I[j]){M=y.children[j],M.material.color.setHex(45055);break}requestAnimationFrame(f.render)}N&&!X&&(N.material.opacity=0,N=null,requestAnimationFrame(f.render)),b.length>0&&!X&&(N=b[0].object,N.material.opacity=.3,requestAnimationFrame(f.render)),d.length>0&&!X?O!==d[0].object&&(f.wantHomeButton&&d[0].object===K[E]?(O=d[0].object,K[E].material.map=Z[0]):f.wantRollArrows&&d[0].object===K[B]?(O=d[0].object,K[D].material.map=Z[1]):f.wantRollArrows&&d[0].object===K[C]?(O=d[0].object,K[D].material.map=Z[2]):f.wantContextMenu&&d[0].object===K[F]?(O=d[0].object,K[F].material.map=Z[6]):f.wantHomeButton&&O===K[E]?(O=null,K[E].material.map=Z[3]):!f.wantRollArrows||O!==K[B]&&O!==K[C]&&O!==K[D]?f.wantContextMenu&&O===K[F]&&(O=null,K[F].material.map=Z[5]):(O=null,K[D].material.map=Z[4]),requestAnimationFrame(f.render)):null===O||X||(f.wantHomeButton&&O===K[E]?(O=null,K[E].material.map=Z[3]):!f.wantRollArrows||O!==K[B]&&O!==K[C]&&O!==K[D]?f.wantContextMenu&&O===K[F]&&(O=null,K[F].material.map=Z[5]):(O=null,K[D].material.map=Z[4]),requestAnimationFrame(f.render))};var ma=function(a){g.navApi.isActionEnabled("orbit")&&f.processMouseMove(a)},na=function(){G=$(c),f.width=c.offsetWidth,f.height=c.offsetHeight,z=f.width/2,A=f.height/2,f.camera.aspect=f.width/f.height,f.camera.updateProjectionMatrix(),f.camera.topFov=f.camera.bottomFov=f.camera.fov/2,f.camera.leftFov=f.camera.rightFov=f.camera.aspect*f.camera.fov/2,f.renderer.setSize(f.width,f.height),requestAnimationFrame(f.render)},oa=function(a,b){var c,d=45,e=60,f=d+e,g=new THREE.Geometry,h=new THREE.Vector3(0,0,0),i=new THREE.Vector3(e,-e,f),j=new THREE.Vector3(e,e,f),k=new THREE.Vector3(-e,e,f),l=new THREE.Vector3(-e,-e,f);return g.vertices.push(h),g.vertices.push(i),g.vertices.push(j),g.vertices.push(k),g.vertices.push(l),g.faces.push(new THREE.Face3(1,2,3)),g.faces.push(new THREE.Face3(1,3,4)),g.applyMatrix((new THREE.Matrix4).makeRotationX(a)),g.applyMatrix((new THREE.Matrix4).makeRotationY(b)),g.computeFaceNormals(),g.computeVertexNormals(),c=new THREE.MeshBasicMaterial({overdraw:!0,opacity:0,color:45055,transparent:!0}),new THREE.Mesh(g,c)},pa=function(a,b,c){var d,e,f=45,g=60,h=f+g,i=new THREE.Geometry,j=new THREE.Vector3(g,h,h),k=new THREE.Vector3(-g,h,h),l=new THREE.Vector3(-g,g,h),m=new THREE.Vector3(g,g,h),n=new THREE.Vector3(g,h,g),o=new THREE.Vector3(-g,h,g),p=new THREE.Vector3(-g,h,h),q=new THREE.Vector3(g,h,h);return i.vertices.push(j),i.vertices.push(k),i.vertices.push(l),i.vertices.push(m),i.vertices.push(n),i.vertices.push(o),i.vertices.push(p),i.vertices.push(q),i.faces.push(new THREE.Face3(0,1,2)),i.faces.push(new THREE.Face3(0,2,3)),i.faces.push(new THREE.Face3(4,5,6)),i.faces.push(new THREE.Face3(4,6,7)),i.applyMatrix((new THREE.Matrix4).makeRotationX(a)),i.applyMatrix((new THREE.Matrix4).makeRotationY(b)),i.applyMatrix((new THREE.Matrix4).makeRotationZ(c)),i.computeFaceNormals(),i.computeVertexNormals(),d=new THREE.MeshBasicMaterial({overdraw:!0,opacity:0,color:45055,transparent:!0}),e=new THREE.Mesh(i,d)},qa=function(a,b){var c,d,e=45,f=60,g=e+f,h=new THREE.Geometry,i=new THREE.Vector3(g,g,g),j=new THREE.Vector3(f,g,g),k=new THREE.Vector3(f,f,g),l=new THREE.Vector3(g,f,g),m=new THREE.Vector3(g,g,f),n=new THREE.Vector3(g,g,g),o=new THREE.Vector3(g,f,g),p=new THREE.Vector3(g,f,f),q=new THREE.Vector3(g,g,g),r=new THREE.Vector3(g,g,f),s=new THREE.Vector3(f,g,f),t=new THREE.Vector3(f,g,g);return h.vertices.push(i),h.vertices.push(j),h.vertices.push(k),h.vertices.push(l),h.vertices.push(m),h.vertices.push(n),h.vertices.push(o),h.vertices.push(p),h.vertices.push(q),h.vertices.push(r),h.vertices.push(s),h.vertices.push(t),h.faces.push(new THREE.Face3(0,1,2)),h.faces.push(new THREE.Face3(0,2,3)),h.faces.push(new THREE.Face3(4,5,6)),h.faces.push(new THREE.Face3(4,6,7)),h.faces.push(new THREE.Face3(8,9,10)),h.faces.push(new THREE.Face3(8,10,11)),h.applyMatrix((new THREE.Matrix4).makeRotationX(a)),h.applyMatrix((new THREE.Matrix4).makeRotationY(b)),h.computeFaceNormals(),h.computeVertexNormals(),c=new THREE.MeshBasicMaterial({overdraw:!0,opacity:0,color:45055,transparent:!0}),d=new THREE.Mesh(h,c)},ra=function(a){var b=g.cubeFront.clone(),c=g.sceneUpDirection.clone(),d=b.clone().cross(c);c.copy(d).cross(b),b.normalize(),c.normalize(),d.normalize();var e=new THREE.Vector3(b.x,c.x,d.x).multiplyScalar(a.x);return e.add(new THREE.Vector3(b.y,c.y,d.y).multiplyScalar(a.y)),e.add(new THREE.Vector3(b.z,c.z,d.z).multiplyScalar(a.z)),e};this.render=function(){var a=f.compass?f.viewScaleFactorCompass*f.viewScale:f.viewScale,b=g.center.clone().sub(h.position).normalize(),c=h.up.normalize();b=ra(b),c=ra(c),f.camera.position.copy(b),f.camera.position.multiplyScalar(-a/f.camera.position.length()),f.camera.up=c.normalize(),f.camera.lookAt(f.center),sa();var d=f.renderer;d&&(d.clear(),d.render(i,f.camera),d.render(j,f.camera),d.render(l,f.camera),d.render(k,f.camera),d.render(m,n))};var sa=function(){R=g.isFaceView(),!R||Y||g.currentlyAnimating?ta():ua(),Y?va():wa(),Y?xa():ya()},ta=function(){m.remove(y),K[D].material.opacity=0,K[F].material.opacity=0},ua=function(){m.add(y);var a=f.wantRollArrows?1:0;K[D].material.opacity=a,K[F].material.opacity=a},va=function(){x.material.opacity=av.isMobileDevice()?1:0},wa=function(){x.material.opacity=f.wantContextMenu?1:0},xa=function(){v.material.opacity=0},ya=function(){v.material.opacity=f.wantHomeButton?1:0};this.refreshCube=function(){na()},this.setSize=function(a,b){if(f.width=a,f.height=b,c.children.length>1)for(var d=1;d<c.children.length;d++)c.children[d].style.bottom=(f.height/5).toString()+"px";na()},this.useTransparency=function(a){Y=a,a?(c.onmouseover=ba,c.onmousemove=ca,c.onmouseout=da,da()):(c.onmouseover=null,c.onmouseout=null,c.onmousemove=null,c.style.opacity="1.0")},this.dtor=function(){this.renderer=null},aa()},function(){"use strict";function a(a,b){function e(){return b.getData().instanceTree}function f(){}function g(c){var d=e();if(n[c]>0)n[c]--,0==n[c]&&a.highlightObjectNode(b,c,!1);else if(n[c]<0)throw"Selection State machine broken. Negatively selected object!";d&&d.enumNodeChildren(c,function(a){g(a)},!1)}function h(c,d){var f=e();n[c]?n[c]++:(a.highlightObjectNode(b,c,!0,d),n[c]=1),f&&f.enumNodeChildren(c,function(a){h(a,!0)},!1)}function i(a){if(void 0!==a&&m.selectedObjectIds[a])return!0}function j(a){var b=e();if(!b||(a=b.findNodeForSelection(a,m.selectionMode),b.isNodeSelectable(a))){var c=i(a);c||(m.selectedObjectIds[a]=a,m.selectionCount++,h(a))}}function k(a){var b=i(a);b&&(g(a),m.selectedObjectIds[a]=0,m.selectionCount--)}function l(a){if(m.selectionCount!==a.length)return!1;for(var b=0;b<a.length;b++)if(!i(a[b]))return!1;return!0}var m=this;this.selectedObjectIds={},this.selectionCount=0,this.selectionMode=c.SelectionMode.LEAF_OBJECT;var n={};this.getInstanceTree=e,this.getSelectionLength=function(){return m.selectionCount},this.getSelection=function(){var a=[],b=m.selectedObjectIds;for(var c in b)if(b[c]){var d=parseInt(c);a.push(d)}return a},this.clearSelection=function(a){if(this.selectionCount>0){var b=m.selectedObjectIds;for(var c in b){var d=parseInt(c);void 0!==d&&g(d)}m.selectedObjectIds={},m.selectionCount=0,a||f()}},this.deselectInvisible=function(){var c=!1,d=m.selectedObjectIds,g=(e(),a.visibilityManager);for(var h in d){var i=parseInt(h);i&&!g.isNodeVisible(b,i)&&(k(i),c=!0)}return c&&f(),c},this.toggleSelection=function(a){return a?(i(a)?k(a):j(a),void f()):void d.logger.error("Attempting to select node 0.")},this.setSelectionMode=function(a){this.clearSelection(!0),this.selectionMode=a},this.setSelection=function(a){if(!l(a)&&(this.clearSelection(!0),null!=a&&0!==a.length)){for(var b=0;b<a.length;b++)j(a[b]);f()}},this.getSelectionBounds=function(){var a=new THREE.Box3,c=new THREE.Box3,d=e(),f=b.getFragmentList(),g=m.selectedObjectIds;for(var h in g){var i=parseInt(h);d.enumNodeFragments(i,function(b){f.getWorldBounds(b,c),a.union(c)},!0)}return a},this.getSelectionVisibility=function(){var a=!1,b=!1,c=m.selectedObjectIds;for(var d in c){var f=parseInt(d);if(f){var g=e();if(g&&g.isNodeHidden(f)?b=!0:a=!0,a&&b)break}}return{hasVisible:a,hasHidden:b}},this.dtor=function(){this.selectedObjectIds=null}}function b(b){function e(){h.length>1&&d.logger.warn("This selection call does not yet support multiple models.")}function f(){for(var a=[],d=0;d<h.length;d++){var e=[],f=[],g=h[d].selector.selectedObjectIds,i=h[d].selector.getInstanceTree();for(var j in g)if(g[j]){var k=parseInt(j);k&&(e.push(k),i&&i.enumNodeFragments(k,function(a){f.push(a)},!1))}e.length&&a.push({fragIdsArray:f,dbIdArray:e,nodeArray:e,model:h[d]})}var l;1===h.length&&(l={type:c.SELECTION_CHANGED_EVENT,fragIdsArray:a[0]?a[0].fragIdsArray:[],dbIdArray:a[0]?a[0].dbIdArray:[],nodeArray:a[0]?a[0].dbIdArray:[],model:h[0]},b.api.fireEvent(l)),l={type:c.AGGREGATE_SELECTION_CHANGED_EVENT,selections:a},b.api.fireEvent(l)}function g(){for(var a=!1,b=0;b<h.length;b++)a=h[b].selector.deselectInvisible()||a;a&&f()}var h=[];this.addModel=function(c){h.indexOf(c)==-1&&(c.selector=new a(b,c),h.push(c))},this.removeModel=function(a){var b=h.indexOf(a);a.selector.getSelection();a.selector.clearSelection(),a.selector=null,h.splice(b,1)},this.getSelectionLength=function(){for(var a=0,b=0;b<h.length;b++)a+=h[b].selector.getSelectionLength();return a},this.getSelection=function(){return e(),h.length>1&&d.logger.warn("Use getAggregateSelection instead of getSelection when there are multiple models in the scene."),h[0].selector.getSelection()},this.getAggregateSelection=function(){for(var a=[],b=0;b<h.length;b++){var c=h[b].selector.getSelection();c&&c.length&&a.push({model:h[b],selection:c})}return a},this.clearSelection=function(a){for(var b=0;b<h.length;b++)h[b].selector.clearSelection(a);a||f()},this.toggleSelection=function(a,b){b||(e(),b=h[0]),b.selector.toggleSelection(a),f()},this.setSelectionMode=function(a){for(var b=0;b<h.length;b++)h[b].selector.setSelectionMode(a)},this.setSelection=function(a,b){if(a&&0!==a.length){if(b)for(var c=0;c<h.length;c++)h[c]!==b&&h[c].selector.clearSelection();else e(),b=h[0];b.selector.setSelection(a)}else this.clearSelection();f()},this.getSelectionBounds=function(){if(1==h.length)return h[0].selector.getSelectionBounds();for(var a=new THREE.Box3,b=0;b<h.length;b++){var c=h[b].selector.getSelectionBounds();a.union(c)}return a},this.getSelectionVisibility=function(){return e(),h[0].selector.getSelectionVisibility()},this.dtor=function(){for(var a=0;a<h.length;a++)h[a].selector.dtor()},b.api.addEventListener(c.ISOLATE_EVENT,function(a){g()}),b.api.addEventListener(c.HIDE_EVENT,function(a){g()})}var c=Autodesk.Viewing,d=c.Private;d.Selector=a,d.MultiModelSelector=b}(),function(){"use strict";function a(a){this.viewer=a,this.models=[]}var b=Autodesk.Viewing,c=b.Private,d=function(a,b){this.viewerImpl=a,this.model=b,this.isolatedNodes=[],this.hiddenNodes=[]};d.prototype.getInstanceTree=function(){return this.model?this.model.getData().instanceTree:null},d.prototype.getIsolatedNodes=function(){return this.isolatedNodes.slice(0)},d.prototype.getHiddenNodes=function(){return this.hiddenNodes.slice(0)},d.prototype.setAllVisibility=function(a){var b=this.model?this.model.getRootId():null;b&&this.setVisibilityOnNode(b,a);var c=this.model.getData().is2d;c&&this.model.setAllVisibility(a)},d.prototype.isNodeVisible=function(a){var b=this.getInstanceTree();return b?!b.isNodeHidden(a):this.hiddenNodes.indexOf(a)==-1&&(0==this.isolatedNodes.length||this.isolatedNodes.indexOf(a)!=-1)},d.prototype.isolate=function(a){var b=this.getInstanceTree(),c=b?b.getRootId():null,d="number"==typeof a&&a===c||"object"==typeof a&&a.dbId===c;a&&!d?this.isolateMultiple(Array.isArray(a)?a:[a]):this.isolateNone()},d.prototype.isolateNone=function(){this.model.setAllVisibility(!0),this.viewerImpl.sceneUpdated(!0),this.setAllVisibility(!0),this.hiddenNodes=[],this.isolatedNodes=[],this.viewerImpl.invalidate(!0);var a={type:b.ISOLATE_EVENT,nodeIdArray:[],model:this.model};this.viewerImpl.api.fireEvent(a)},d.prototype.isolateMultiple=function(a){if(a&&0!=a.length){this.setAllVisibility(!1),this.model.getData().is2d||(this.model.setAllVisibility(!1),this.viewerImpl.sceneUpdated(!0)),this.isolatedNodes=a.slice(0),this.hiddenNodes=[];for(var c=0;c<a.length;c++)this.setVisibilityOnNode(a[c],!0);var d={type:b.ISOLATE_EVENT,nodeIdArray:a,model:this.model};this.viewerImpl.api.fireEvent(d)}else this.isolateNone();this.viewerImpl.invalidate(!0)},d.prototype.hide=function(a){var c;if(Array.isArray(a)){for(var d=0;d<a.length;++d)this.setVisibilityOnNode(a[d],!1);a.length>0&&(c={type:b.HIDE_EVENT,nodeIdArray:a})}else this.setVisibilityOnNode(a,!1),c={type:b.HIDE_EVENT,nodeIdArray:[a]};c&&this.viewerImpl.api.fireEvent(c)},d.prototype.show=function(a){var c;if(Array.isArray(a)){for(var d=0;d<a.length;++d)this.setVisibilityOnNode(a[d],!0);a.length>0&&(c={type:b.SHOW_EVENT,nodeIdArray:a})}else this.setVisibilityOnNode(a,!0),c={type:b.SHOW_EVENT,nodeIdArray:[a]};c&&this.viewerImpl.api.fireEvent(c)},d.prototype.toggleVisibility=function(a){var c=this.getInstanceTree().isNodeHidden(a);this.setVisibilityOnNode(a,c);var d={type:c?b.SHOW_EVENT:b.HIDE_EVENT,nodeIdArray:[a]};this.viewerImpl.api.fireEvent(d)},d.prototype.setVisibilityOnNode=function(a,b){var c=this.viewerImpl,d=this.model,e=this.getInstanceTree(),f=!b,g=d.getData().is2d;this.viewerImpl.matman();e?e.enumNodeChildren(a,function(a){e.setNodeHidden(a,f),g?d.getFragmentList().setObject2DGhosted(a,!b):e.enumNodeFragments(a,function(a){d.setVisibility(a,b)},!1)},!0):g?d.getFragmentList().setObject2DGhosted(a,!b):d.setVisibility(a,b),c.sceneUpdated(!0),this.updateNodeVisibilityTracking(a,b)},d.prototype.updateNodeVisibilityTracking=function(a,b){var c=b;if(this.isolatedNodes.length>0){var d=this.isolatedNodes.indexOf(a);c&&d===-1?this.isolatedNodes.push(a):c||d===-1||this.isolatedNodes.splice(d,1)}else{var e=this.hiddenNodes.indexOf(a);c||e!==-1?c&&e!==-1&&this.hiddenNodes.splice(e,1):this.hiddenNodes.push(a)}var f=this.getInstanceTree();f&&f.root&&f.root.dbId===a&&(b?(this.isolatedNodes=[],this.hiddenNodes=[]):(this.isolatedNodes=[],this.hiddenNodes=[a]))},d.prototype.setNodeOff=function(a,b){var c=this.viewerImpl,d=this.model,e=this.getInstanceTree(),f=d.getData().is2d;e?e.enumNodeChildren(a,function(a){e.setNodeOff(a,b),f?d.getFragmentList().setObject2DVisible(a,!b):e.enumNodeFragments(a,function(a){d.getFragmentList().setFragOff(a,b)},!1)},!0):f?d.getFragmentList().setObject2DVisible(a,!b):d.getFragmentList().setFragOff(a,b),c.sceneUpdated(!0)},b.Private.VisibilityManager=d,a.prototype.addModel=function(a){this.models.indexOf(a)==-1&&(a.visibilityManager=new d(this.viewer,a),this.models.push(a))},a.prototype.removeModel=function(a){var b=this.models.indexOf(a);a.visibilityManager.isolateNone(),a.visibilityManager=null,this.models.splice(b,1)},a.prototype.warn=function(){this.models.length>1&&c.logger.warn("This selection call does not yet support multiple models.")},a.prototype.getIsolatedNodes=function(a){return a||(this.warn(),a=this.models[0]),a.visibilityManager.getIsolatedNodes()},a.prototype.getHiddenNodes=function(a){return a||(this.warn(),a=this.models[0]),a.visibilityManager.getHiddenNodes()},a.prototype.isNodeVisible=function(a,b){return a||(this.warn(),a=this.models[0]),a.visibilityManager.isNodeVisible(b)},a.prototype.isolate=function(a,b){b||(this.warn(),b=this.models[0]),b.visibilityManager.isolate(a)},a.prototype.hide=function(a,b){b||(this.warn(),b=this.models[0]),b.visibilityManager.hide(a)},a.prototype.show=function(a,b){b||(this.warn(),b=this.models[0]),b.visibilityManager.show(a)},a.prototype.toggleVisibility=function(a,b){b||(this.warn(),b=this.models[0]),b.visibilityManager.toggleVisibility(a)},a.prototype.setVisibilityOnNode=function(a,b,c){c||(this.warn(),c=this.models[0]),c.visibilityManager.setVisibilityOnNode(a,b)},a.prototype.setNodeOff=function(a,b,c){c||(this.warn(),c=this.models[0]),c.visibilityManager.setNodeOff(a,b)},b.Private.MultiModelVisibilityManager=a}(),AutodeskNamespace("Autodesk.Viewing"),Autodesk.Viewing.KeyCode={BACKSPACE:8,TAB:9,ENTER:13,SHIFT:16,CONTROL:17,ALT:18,ESCAPE:27,SPACE:32,PAGEUP:33,PAGEDOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,INSERT:45,DELETE:46,ZERO:48,SEMICOLONMOZ:59,EQUALSMOZ:61,a:65,b:66,c:67,d:68,e:69,f:70,g:71,h:72,i:73,j:74,k:75,l:76,m:77,n:78,o:79,p:80,q:81,r:82,s:83,t:84,u:85,v:86,w:87,x:88,y:89,z:90,LCOMMAND:91,RCOMMAND:93,DASHMOZ:109,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,DASHMOZNEW:173,SEMICOLON:186,EQUALS:187,COMMA:188,DASH:189,PERIOD:190,SLASH:191,LBRACKET:219,RBRACKET:221,SINGLEQUOTE:222,COMMANDMOZ:224},Autodesk.Viewing.ToolController=function(a,b,c,d,e){function f(a,c){return b.navigation.getUseLeftHandedInput()&&0===a||j&&1===a||i&&!l&&0===a&&c.ctrlKey}var g=Autodesk.Viewing,h=Autodesk.Viewing.Private;this.domElement=b.canvasWrap,this.selector=a.selector,this.autocam=c,this.lastClickX=-1,this.lastClickY=-1,this.scrollInputEnabled=!0;var i=navigator.userAgent.search("Mac OS")!=-1,j=navigator.userAgent.search("Firefox")!=-1,k=navigator.userAgent.search("Chrome")!==-1,l=navigator.userAgent.search("Safari")!==-1&&!k,m=0,n=2,o=2,p=500,q={},r=[],s=!1,t=-1,u=-1,v=!1,w=null,x=void 0,y=!1,z={},A=this,B=Autodesk.Viewing.KeyCode;this.__registerToolByName=function(a,b){q[b]=a},this.registerTool=function(a){var b=a.getNames();if(!b||0==b.length)return h.logger.warn("Cannot register tool with no name."),!1;for(var c=!1,e=0;e<b.length;++e)"default"!==b[e]&&(this.__registerToolByName(a,b[e]),c=!0);return a.utilities=d,a.controller=this,a.register&&a.register(),c},this.deregisterTool=function(a){this.deactivateTool(a.getName());var b=a.getNames();if(!b||0==b.length)return!1;for(var c=b.length;--c>=0;)this.__deregisterToolName(b[c]);return a.deregister&&a.deregister(),a.utilities=null,a.controller=null,!0},this.__deregisterToolName=function(a){function b(a){for(var b=r.length;--b>=0;)r[b].activeName===a&&(q[a].deactivate(a),r.splice(b,1))}a in q&&(b(a),delete q[a])},this.getTool=function(a){return q[a]},this.getActiveToolName=function(){var a=r.length;return a>0?r[a-1].activeName:"default"},this.getActiveTool=function(){var a=r.length;return a>0?r[a-1]:q.default},this.isToolActivated=function(a){for(var b=0;b<r.length;b++)if(r[b].activeName===a)return!0;return!1},this.setToolActiveName=function(a){var b=q[a];b&&(b.activeName=a)},this.activateTool=function(c){if(s)return!1;var d=q[c];if(d){void 0===d.count&&(d.count=0);var e=null;r.length&&"intercept"===r[r.length-1].activeName&&(e=r.pop());for(var f=0;f<r.length;f++)r[f]===d&&d.count++;return d.activeName=c,0===d.count&&(d.count++,r.push(d)),d.activate(c,b),e&&r.push(e),b.fireEvent({type:Autodesk.Viewing.TOOL_CHANGE_EVENT,toolName:c,tool:d,active:!0}),a.track({category:"tool_changed",name:c}),!0}return h.logger.warn("activateTool not found: "+c),!1},this.deactivateTool=function(a){if(s)return!1;for(var c=r.length;--c>=0;)if(r[c].activeName===a)return 1===q[a].count&&r.splice(c,1),q[a].count--,q[a].deactivate(a),b.fireEvent({type:Autodesk.Viewing.TOOL_CHANGE_EVENT,toolName:a,tool:r[c],active:!1}),!0;return h.logger.warn("deactivateTool not found: "+a),!1},this.getToolNames=function(){return Object.keys(q)},this.setDefaultTool=function(a){var b=this.getDefaultTool();return!(!a||a===b)&&(this.__registerToolByName(a,"default"),b&&b.deactivate("default"),a.activate("default"),!0)},this.getDefaultTool=function(){return q.default},this.setDefaultTool(e),this.setIsLocked=function(a){var b=s;return s=!!a,b},this.getIsLocked=function(){return s},this.__checkCursor=function(){for(var a=null,c=r.length;--c>=0;){var d=r[c];if(d.getCursor&&(a=d.getCursor()))break}a||(a="auto"),w!=a&&(b.canvas.style.cursor=a,w=a)},this.update=function(a){this.__checkCursor();var c=!1;d&&d.update()&&(c=!0);for(var e=r.length;--e>=0;){var f=r[e];f.update&&f.update(a)&&(c=!0)}if(b.navigation.getCamera().dirty?(b.navigation.updateCamera(),c=!0,this.cameraUpdated=!0):this.cameraUpdated=!1,c)b.navigation.updateCamera(),this.moveDelay=Date.now()+150;else if(0!==this.moveDelay){var g=this.moveDelay-Date.now();g>0?c=!0:this.moveDelay=0}return c},this.__clientToCanvasCoords=function(b,c,d){var e=a.canvas.getBoundingClientRect(),f=e.width,g=e.height,h=b.clientX-e.left,i=b.clientY-e.top;b.canvasX=h,b.canvasY=i,b.normalizedX=h/f*2-1,b.normalizedY=(g-i)/g*2-1,c&&c.set(h/f,i/g,0),d&&d.set(h,i)},this.__invokeStack=function(a,b,c){for(var d=r.length;--d>=0;){var e=r[d];if(e[a]&&e[a](b,c))return!0}var f=this.getDefaultTool();return!(!f[a]||!f[a](b,c))},this.distributeEvent=function(a,b,c){return this.__invokeStack(a,b,c)},this.handleResize=function(){b.navigation.setScreenViewport(b.container.getBoundingClientRect());for(var a=r.length;--a>=0;){var c=r[a];c.handleResize&&c.handleResize()}},this.handleSingleClick=function(a){var b=this.applyButtonMappings(a);this.lastClickX=a.clientX,this.lastClickY=a.clientY,this.__invokeStack("handleSingleClick",a,b)&&(a.preventDefault(),a.stopPropagation())},this.handleDoubleClick=function(a){var b=this.applyButtonMappings(a);this.__invokeStack("handleDoubleClick",a,b)&&(a.preventDefault(),a.stopPropagation())},this.handleSingleTap=function(a){this.lastClickX=a.canvasX,this.lastClickY=a.canvasY,this.__invokeStack("handleSingleTap",a)&&(a.preventDefault(),a.stopPropagation())},this.handleDoubleTap=function(a){this.lastClickX=a.canvasX,this.lastClickY=a.canvasY,this.__invokeStack("handleDoubleTap",a)&&(a.preventDefault(),a.stopPropagation())},this.handleWheelInput=function(a,b){this.__invokeStack("handleWheelInput",a)&&(b.preventDefault(),b.stopPropagation())},this.applyButtonMappings=function(a){var c=a.button;return"buttons"in a&&(a.firefoxSpoof?c=m:!v||1&a.buttons?c===n&&1&a.buttons&&(c=m,a.firefoxSpoof=v=!0):(a.firefoxSpoof=!0,v=!1,c=m)),b.navigation.getUseLeftHandedInput()&&(c=c===m?n:c===n?m:c),c},this.applyKeyMappings=function(a,b){switch(a.keyCode){case B.LCOMMAND:case B.RCOMMAND:case B.COMMANDMOZ:return i&&a.metaKey&&a.shiftKey?null:B.CONTROL;case B.SHIFT:return b&&i&&a.metaKey?null:B.SHIFT;case B.EQUALSMOZ:return B.EQUALS;case B.DASHMOZNEW:case B.DASHMOZ:return B.DASH}return a.keyCode},this.handleKeyDown=function(a){var b=this.applyKeyMappings(a,!0);b&&this.__invokeStack("handleKeyDown",a,b)&&(a.preventDefault(),a.stopPropagation())},this.handleKeyUp=function(a){var b=this.applyKeyMappings(a,!0);b&&this.__invokeStack("handleKeyUp",a,b)&&(a.preventDefault(),a.stopPropagation())},this.handleButtonDown=function(a,b){this.__invokeStack("handleButtonDown",a,b)&&(a.preventDefault(),a.stopPropagation())},this.handleButtonUp=function(a,b){this.__invokeStack("handleButtonUp",a,b)&&(a.preventDefault(),a.stopPropagation())},this.handleMouseMove=function(a){this.__invokeStack("handleMouseMove",a)&&(a.preventDefault(),a.stopPropagation())},this.handleBlur=function(a){this.__invokeStack("handleBlur",a)&&(a.preventDefault(),a.stopPropagation())},this.keydown=function(a){if(!(!A.domElement.contains(x)||document.activeElement instanceof HTMLInputElement||document.activeElement instanceof HTMLTextAreaElement||document.activeElement instanceof HTMLSelectElement)){if(document.activeElement){var b=document.activeElement.getAttribute("contenteditable");if("true"===b||""===b)return}i&&a.metaKey&&a.keyCode!=B.LCOMMAND&&a.keyCode!=B.RCOMMAND||A.handleKeyDown(a);
}},this.keyup=function(a){i&&a.metaKey&&a.keyCode!=B.LCOMMAND&&a.keyCode!=B.RCOMMAND||A.handleKeyUp(a)},this.mousedown=function(a){function b(a){var d=A.applyButtonMappings(a);d===c&&(document.removeEventListener("mouseup",b),A.mouseup(a))}g.isIE11&&g.inFullscreen()||document.activeElement&&document.activeElement.blur(),A.__clientToCanvasCoords(a);var c=A.applyButtonMappings(a);if(A.handleButtonDown(a,c),t=a.canvasX,u=a.canvasY,f(c,a)){var d=z,e=void 0!==d.time&&a.timeStamp-d.time<p,h=void 0!==d.x&&void 0!==d.y&&Math.abs(d.x-a.canvasX)<=o&&Math.abs(d.y-a.canvasY)<=o;(!e||!h||d.clickCount&&2<=d.clickCount)&&(d.clickCount=0),d.clickCount?1===d.clickCount&&(d.clickCount=2):(d.clickCount=1,d.x=a.canvasX,d.y=a.canvasY,d.time=a.timeStamp)}document.addEventListener("mouseup",b,!1),A.registerWindowMouseMove()},this.mousemove=function(a){A.__clientToCanvasCoords(a);var b=t-a.canvasX,c=u-a.canvasY;(Math.abs(b)>o||Math.abs(c)>o)&&(t=-1,u=-1),A.handleMouseMove(a)},this.mouseup=function(a){A.__clientToCanvasCoords(a);var b=A.applyButtonMappings(a);A.handleButtonUp(a,b);var c=t-a.canvasX,d=u-a.canvasY;if(t=-1,u=-1,Math.abs(c)<=o&&Math.abs(d)<=o&&A.handleSingleClick(a),f(b,a)){var e=z;2===e.clickCount&&(A.handleDoubleClick(a),e.clickCount=0,e.x=void 0,e.y=void 0,e.time=void 0)}A.unregisterWindowMouseMove()},this.doubleclick=function(a){A.__clientToCanvasCoords(a),t=a.canvasX,u=a.canvasY,A.handleDoubleClick(a)},this.mousewheel=function(a){if(A.scrollInputEnabled){var b=0;a.wheelDelta?b=a.wheelDelta/40:a.detail&&(b=-a.detail),A.handleWheelInput(b,a)}},this.blur=function(a){A.handleBlur(a)},this.mouseover=function(a){x=a.target},this.registerWindowMouseMove=function(){window.addEventListener("mousemove",A.mousemove),window.addEventListener("mouseover",A.mouseover),A.domElement.removeEventListener("mousemove",A.mousemove),A.domElement.removeEventListener("mouseover",A.mouseover)},this.unregisterWindowMouseMove=function(){window.removeEventListener("mousemove",A.mousemove),window.removeEventListener("mouseover",A.mouseover),A.domElement.addEventListener("mousemove",A.mousemove),A.domElement.addEventListener("mouseover",A.mouseover)},this.enableMouseButtons=function(a){a&&!y?(this.domElement.addEventListener("mousedown",this.mousedown),this.domElement.addEventListener("dblclick",this.doubleclick),this.domElement.addEventListener("mousemove",this.mousemove),this.domElement.addEventListener("mouseover",this.mouseover)):!a&&y&&(this.domElement.removeEventListener("mousedown",this.mousedown),this.domElement.removeEventListener("dblclick",this.doubleclick),this.domElement.removeEventListener("mousemove",this.mousemove),this.domElement.removeEventListener("mouseover",this.mouseover));var b=y;return y=a,b},this.enableMouseButtons(!0),this.domElement.addEventListener("mousewheel",this.mousewheel,!1),this.domElement.addEventListener("DOMMouseScroll",this.mousewheel,!1),window.addEventListener("keydown",this.keydown,!1),window.addEventListener("keyup",this.keyup,!1),window.addEventListener("blur",this.blur,!1),this.uninitialize=function(){for(y&&(this.domElement.removeEventListener("mousemove",this.mousemove),this.domElement.removeEventListener("mouseover",this.mouseover),window.removeEventListener("mousemove",A.mousemove),window.removeEventListener("mouseover",A.mouseover)),window.removeEventListener("keydown",this.keydown),window.removeEventListener("keyup",this.keyup),window.removeEventListener("blur",this.blur),this.domElement=null,this.selector=null,this.autocam=null;r.length>0;)this.deactivateTool(r[r.length-1].activeName);q=null,r=null,A=null,d=null,b=null,a=null,x=null},this.set2DMode=function(a){},this.setAutocam=function(a){},this.syncCamera=function(){},this.recordHomeView=function(){var a=b.navigation.getCamera();c.sync(a),c.setHomeViewFrom(a)},this.setMouseWheelInputEnabled=function(a){this.scrollInputEnabled=a}},AutodeskNamespace("Autodesk.Viewing"),Autodesk.Viewing.ViewingUtilities=function(a,b,c){function d(a){var b=500,c=32512,d=.6,e=0,f=new THREE.SphereGeometry(1),g=new THREE.MeshPhongMaterial({color:c,ambient:c,opacity:d,transparent:!0}),h=new THREE.Mesh(f,g),i=a;i.createOverlayScene("pivot"),h.visible=!1,this.shown=function(){return h.visible},this.show=function(a,c,f){h.scale.x=c,h.scale.y=c,h.scale.z=c,h.position.set(a.x,a.y,a.z),g.opacity=d,h.visible=!0,i.addOverlay("pivot",h),i.invalidate(!1,!1,!0),e=f?Date.now()+b:0},this.hide=function(){h.visible&&(h.visible=!1,i.removeOverlay("pivot",h),i.invalidate(!1,!1,!0),e=0)},this.fade=function(){if(e>0){var a=e-Date.now();if(a<=0)return this.hide(),!0;var c=a/b*d;return g.opacity=c,!0}return!1},this.fading=function(){return e>0}}function e(a,b,c){var d=b.clone().sub(a);if(0===d.lengthSq())return d.copy(c);var e=d.clone().cross(c);return 0===e.lengthSq()&&(c.z>c.y?d.y-=1e-4:d.z-=1e-4,e.crossVectors(d,c)),e.cross(d).normalize()}this.autocam=b,this.viewerImpl=a;var f=5,g=c.getCamera(),h={},i={},j=new d(this.viewerImpl);this.transitionView=function(a,d,f,h,i,j,k){i=i||c.getWorldUpVector();var l=j?e(a,d,i):h;l||(l=g.up),k=k||d;var m={position:a,center:d,pivot:k,fov:f,up:l,worldUp:i,isOrtho:g.isPerspective===!1};b.goToView(m)},this.goHome=function(){this.viewerImpl.track({name:"navigation/home",aggregate:"count"}),b.goHome()},this.getHitPoint=function(a,b){b=1-b,a=2*a-1,b=2*b-1;var c=new THREE.Vector3(a,b,1),d=this.viewerImpl.hitTestViewport(c,!1);return d?d.intersectPoint:null},this.activatePivot=function(a){var b=g.isPerspective?c.getPivotPlaneDistance():c.getEyeVector().length(),d=c.getVerticalFov(),e=2*b*Math.tan(THREE.Math.degToRad(.5*d)),h=c.getScreenViewport(),i=window.devicePixelRatio||1,k=f*e/(h.height*i);j.show(c.getPivotPoint(),k,a)},this.pivotActive=function(a,b){return a=a&&!c.getIs2D(),b=b||!1,!a&&j.shown()?void j.hide():void(a&&this.activatePivot(b))},this.pivotUpdate=function(){j.shown()&&j.fade()&&this.viewerImpl.invalidate(!1,!1,!0)},this.setPivotPoint=function(a,b,d){c.setPivotPoint(a),b||c.setTarget(a),d&&c.setPivotSetFlag(!0),this.setTemporaryPivot(null),c.getIs2D()||j.shown()&&this.activatePivot(j.fading())},this.savePivot=function(a){a||(a="default"),h[a]=c.getPivotPoint(),i[a]=c.getPivotSetFlag()},this.restorePivot=function(a){if(a||(a="default"),h[a]){var b=i[a];this.setPivotPoint(h[a],!0,b),b||c.setPivotSetFlag(!1),delete h[a],delete i[a]}},this.setTemporaryPivot=function(a){if(a){var b=c.getPivotPoint(),d=c.getPivotSetFlag();this.setPivotPoint(a,!0,d),h.TEMP=b,i.TEMP=d}else delete h.TEMP,delete i.TEMP},this.removeTemporaryPivot=function(){this.restorePivot("TEMP")},this.getBoundingBox=function(a){return this.viewerImpl.getFitBounds(a)},this.fitToView=function(a){this.viewerImpl.track({name:"navigation/fit",aggregate:"count"});var b=c.fitBounds(a,this.viewerImpl.getFitBounds(!1));return this.activatePivot(!0),b},this.update=function(){c.getRequestFitToView()&&!c.getTransitionActive()&&(c.setRequestFitToView(!1),this.fitToView()),c.getRequestHomeView()&&!c.getTransitionActive()&&(c.setRequestHomeView(!1),this.goHome());var a=c.getRequestTransition();return a&&!c.getTransitionActive()&&(c.setRequestTransition(!1),this.transitionView(a.position,a.coi,a.fov,a.up,a.worldUp,a.reorient,a.pivot)),!1}},AutodeskNamespace("Autodesk.Viewing"),Autodesk.Viewing.DefaultHandler=function(a,b,c){this.clickConfig=null,this.getNames=function(){return["default"]},this.getName=function(){return this.getNames()[0]},this.setClickBehavior=function(a){this.clickConfig=a},this.getClickBehavior=function(){return this.clickConfig},this.activate=function(a){},this.deactivate=function(a){},this.handleAction=function(b,d){for(var e=0;e<b.length;++e)switch(b[e]){case"selectOnly":a.selector&&d&&a.selector.setSelection([d.dbId],d.model);break;case"deselectAll":a.selector&&a.selector.setSelection([]);break;case"selectToggle":a.selector&&d&&a.selector.toggleSelection(d.dbId,d.model);break;case"isolate":d&&a.isolate(d.dbId);break;case"showAll":a.showAll();break;case"setCOI":d&&d.intersectPoint&&(c.setPivotPoint(d.intersectPoint,!0,!0),c.pivotActive(!0,!0));break;case"hide":d&&a.hide(d.dbId);break;case"show":d&&a.show(d.dbId);break;case"toggleVisibility":d&&a.toggleVisibility(d.dbId);break;case"focus":a.selector&&(d?a.selector.setSelection([d.dbId],d.model):a.selector.setSelection([]),c.fitToView())}},this.handleSingleClick=function(b,d){var e=b.ctrlKey||b.metaKey,f=b.shiftKey,g=b.altKey;if(0===d){var h=new THREE.Vector3(b.normalizedX,b.normalizedY,1),i=a.hitTestViewport(h,!1),j="click";e&&(j+="Ctrl"),f&&(j+="Shift"),g&&(j+="Alt");var k=i?"onObject":"offObject";if(this.clickConfig&&this.clickConfig[j]&&this.clickConfig[j][k])return this.handleAction(this.clickConfig[j][k],i),!0}else if(1===d&&f&&!g&&!e){var h=new THREE.Vector3(b.normalizedX,b.normalizedY,1),i=a.hitTestViewport(h,!1);if(i&&i.intersectPoint)return c.setPivotPoint(i.intersectPoint,!0,!0),c.pivotActive(!0,!0),!0}return!1},this.handleDoubleClick=function(d,e){if(a.selector&&0===e){var f=new THREE.Vector3(d.normalizedX,d.normalizedY,1),g=a.hitTestViewport(f,!1);return g?a.selector.setSelection([g.dbId],g.model):a.selector.clearSelection(),c.fitToView(),!0}return 1===e&&(b.fitBounds(!1,c.getBoundingBox(!0)),b.setPivotSetFlag(!1),!0)},this.handleSingleTap=function(c){if(c.clientX=c.pointers[0].clientX,c.clientY=c.pointers[0].clientY,a.api.triggerSingleTapCallback(c),c.hasOwnProperty("pointers")&&2===c.pointers.length)return b.setRequestHomeView(!0),!0;if(a.selector){var d=new THREE.Vector3(c.normalizedX,c.normalizedY,1),e=a.hitTestViewport(d,!1);return e?(a.selector.setSelection([e.dbId],e.model),a.api.triggerSelectionChanged([e.dbId])):(a.selector.clearSelection(),a.api.triggerSelectionChanged(null)),!0}return!1},this.handleDoubleTap=function(b){b.clientX=b.pointers[0].clientX,b.clientY=b.pointers[0].clientY,a.api.triggerDoubleTapCallback(b);var d=this.handleSingleTap(b,0);return c.fitToView(),d},this.handlePressHold=function(b){return"press"===b.type&&(b.clientX=b.pointers[0].clientX,b.clientY=b.pointers[0].clientY,a.api.triggerContextMenu(b))}},AutodeskNamespace("Autodesk.Viewing"),Autodesk.Viewing.GestureHandler=function(a){var b=Autodesk.Viewing,c=a.navigation,d=["gestures"],e=this,f=!0,g=!0,h=null,i=b.isTouchDevice();c.setIsTouchDevice(i),i&&(h=new Hammer.Manager(a.canvasWrap,{recognizers:[[Hammer.Pan,{event:"drag",pointers:1}],[Hammer.Tap,{event:"doubletap",taps:2,interval:300,threshold:6,posThreshold:30}],[Hammer.Tap,{event:"doubletap2",pointers:2,taps:2,interval:300,threshold:6,posThreshold:40}],[Hammer.Tap,{event:"singletap2",pointers:2,threshold:3}],[Hammer.Tap,{event:"singletap",threshold:2}],[Hammer.Press,{event:"press",time:500}],[Hammer.Pan,{event:"drag3",pointers:3,threshold:15}],[Hammer.Pan,{event:"pan",pointers:2,threshold:20}],[Hammer.Pinch,{enable:!0,threshold:.05}],[Hammer.Rotate,{enable:!0,threshold:7}]],inputClass:Hammer.TouchInput}),a.canvasWrap.addEventListener("touchstart",this.onTouchStart,!1)),this.onTouchStart=function(a){a.preventDefault()},this.getNames=function(){return d},this.getName=function(){return d[0]},this.__clientToCanvasCoords=function(b){var c,d,e=a.impl.canvas.getBoundingClientRect(),f=e.width,g=e.height;b.hasOwnProperty("center")?(c=b.center.x-e.left,d=b.center.y-e.top):(c=b.pointers[0].clientX-e.left,d=b.pointers[0].clientY-e.top),b.canvasX=c,b.canvasY=d,b.normalizedX=c/f*2-1,b.normalizedY=(g-d)/g*2-1},this.distributeGesture=function(a){function b(a,b){return a.indexOf(b,a.length-b.length)!==-1}e.__clientToCanvasCoords(a),e.controller.distributeEvent("handleGesture",a)&&a.preventDefault(),b(a.type,"end")&&h.stop()},this.onSingleTap=function(a){e.__clientToCanvasCoords(a),e.controller.distributeEvent("handleSingleTap",a)&&a.preventDefault()},this.onDoubleTap=function(a){e.__clientToCanvasCoords(a),e.controller.distributeEvent("handleDoubleTap",a)&&a.preventDefault()},this.onPressHold=function(a){e.__clientToCanvasCoords(a),"press"===a.type?f=e.controller.enableMouseButtons(!1):e.controller.enableMouseButtons(f),e.controller.distributeEvent("handlePressHold",a)&&a.preventDefault()},this.activate=function(a){h&&(h.on("dragstart dragmove dragend",this.distributeGesture),h.on("singletap",this.onSingleTap),h.on("singletap2",this.onSingleTap),h.on("doubletap",this.onDoubleTap),h.on("doubletap2",this.onDoubleTap),h.on("press pressup",this.onPressHold),h.on("drag3start drag3move drag3end",this.distributeGesture),g&&(h.on("panstart panmove panend",this.distributeGesture),h.on("pinchstart pinchmove pinchend",this.distributeGesture),h.on("rotatestart rotatemove rotateend",this.distributeGesture)),h.get("doubletap2").recognizeWith("doubletap"),h.get("singletap2").recognizeWith("singletap"),h.get("singletap").requireFailure("doubletap"))},this.deactivate=function(a){h&&(h.off("dragstart dragmove dragend",this.distributeGesture),h.off("singletap",this.onSingleTap),h.off("singletap2",this.onSingleTap),h.off("doubletap",this.onDoubleTap),h.off("doubletap2",this.onDoubleTap),h.off("press pressup",this.onPressHold),h.off("drag3start drag3move drag3end",this.distributeGesture),g&&(h.off("panstart panmove panend",this.distributeGesture),h.off("pinchstart pinchmove pinchend",this.distributeGesture),h.off("rotatestart rotatemove rotateend",this.distributeGesture)))},this.update=function(){return!1},this.handleBlur=function(a){return!1},this.disableTwoFingerSwipe=function(){g=!1,h&&(h.remove(Hammer.Pan),h.remove(Hammer.Pinch),h.remove(Hammer.Rotate),h.off("panstart panmove panend",this.distributeGesture),h.off("pinchstart pinchmove pinchend",this.distributeGesture),h.off("rotatestart rotatemove rotateend",this.distributeGesture))}},AutodeskNamespace("Autodesk.Viewing"),Autodesk.Viewing.OrbitDollyPanTool=function(a,b){function c(){var a=ma;return T===R&&!a.SHIFT&&!(a.ALT^a.CONTROL)||T===R&&a.SHIFT&&a.CONTROL||T===Q&&!a.SHIFT&&!a.CONTROL||T===Q&&a.ALT||T===Q&&a.CONTROL&&!a.ALT||T===P&&a.SHIFT&&!a.CONTROL&&!a.ALT||"pan"===A&&T!==Q&&!a.ALT&&!("pinch"===B)||a.SPACE}function d(){var a=ma;return T===R&&a.SHIFT&&!a.ALT&&!a.CONTROL||T===R&&a.ALT&&!a.SHIFT&&!a.CONTROL||"dolly"===A&&!a.ALT&&!("pinch"===B)}function e(){var a=ma;return!(a.CONTROL||a.ALT||a.SHIFT||T!==R&&T!==Q)}function f(){var a=v.getPivotPoint().sub(v.getPosition());return a.dot(v.getEyeVector())<=0}function g(a,b){var c={left:0,top:0,width:window.innerWidth,height:window.innerHeight};fa.set((a-.5*c.width-c.left)/(.5*c.width),(.5*c.height+c.top-b)/(.5*c.height),0);var d=fa.length();return ia?d<Math.SQRT1_2?fa.z=Math.sqrt(1-d*d):fa.z=.5/d:d>1?fa.normalize():fa.z=Math.sqrt(1-d*d),ba.copy(w.position).sub(w.pivot),da.copy(w.up).setLength(fa.y),da.add(ea.copy(w.up).cross(ba).setLength(fa.x)),da.add(ba.setLength(fa.z)),da}function h(){if(v.isActionEnabled("orbit")){ba.subVectors(w.position,w.pivot),ca.subVectors(w.position,w.target);var a=ca.length();ca.normalize();var b=Math.acos(_.dot(aa)/_.length()/aa.length());b&&(b*=t,ga.crossVectors(_,aa).normalize(),ha.setFromAxisAngle(ga,-b),ba.applyQuaternion(ha),w.up.applyQuaternion(ha),aa.applyQuaternion(ha),ca.applyQuaternion(ha),ja?_.copy(aa):(ha.setFromAxisAngle(ga,b*(ka-1)),_.applyQuaternion(ha))),w.position.addVectors(w.pivot,ba),w.target.subVectors(w.position,ca.multiplyScalar(a)),w.dirty=!0}}function i(a,b){return a.indexOf(b,a.length-b.length)!==-1}function j(a){var b=a.pointers[1].clientX-a.pointers[0].clientX,c=a.pointers[1].clientY-a.pointers[0].clientY;return Math.sqrt(b*b+c*c)}var k,l,m=(Autodesk.Viewing.Private,this),n=.001,o=1e-5,p=1.5,q=.01,r=20,s=100,t=2,u=navigator.userAgent.search("Mac OS")!=-1,v=b.navigation,w=v.getCamera(),x=["orbit","freeorbit","dolly","pan"],y=x[0],z=[y],A=y,B=null,C=1,D=1,E=0,F=0,G=0,H=0,I=!1,J=null,K=!1,L={SHIFT:16,CONTROL:17,ALT:18,SPACE:32,PAGEUP:33,PAGEDOWN:34,LEFT:37,UP:38,RIGHT:39,DOWN:40,ZERO:48,EQUALS:187,DASH:189},M=-5,N=-4,O=-1,P=0,Q=1,R=2,S=3,T=M,U=new THREE.Vector3,V=new THREE.Vector3,W=new THREE.Vector2,X=new THREE.Vector2,Y=new THREE.Vector2,Z=new THREE.Vector2,$=new THREE.Vector3,_=new THREE.Vector3,aa=new THREE.Vector3,ba=new THREE.Vector3,ca=new THREE.Vector3,da=new THREE.Vector3,ea=new THREE.Vector3,fa=new THREE.Vector3,ga=new THREE.Vector3,ha=new THREE.Quaternion,ia=!1,ja=!0,ka=.2,la=[!1,!1,!1,!1,!1,!1],ma={SHIFT:0,ALT:0,CONTROL:0,SPACE:0},na=.6,oa=5,pa=.025,qa=.01,ra=.6,sa=1,ta=oa,ua=pa;this.getNames=function(){return x},this.getName=function(){return x[0]},this.activate=function(a){z.push(a),A=a},this.deactivate=function(a){var b=z.length-1;b>0&&z[b]===a&&(z.pop(),A=z[b-1])},this.adjustDollyLookSpeed=function(a){0===a?(ua=pa,ta=oa):(ua*=a>0?1.1:.9,ta*=a>0?1.1:.9,ua<1e-6&&(ua=1e-6),ta<1e-6&&(ta=1e-6))},this.getDollySpeed=function(a){var b=v.getEyeVector(),c=v.getPosition(),d=a.clone().sub(c).dot(b.normalize()),e=d*ua;return Math.abs(e)<qa?e<0?-qa:qa:e},this.getLookSpeed=function(){return ta},this.coiIsActive=function(){return v.getPivotSetFlag()&&v.isPointVisible(v.getPivotPoint())},this.adjustSpeed=function(a){this.adjustDollyLookSpeed(a),this.utilities.autocam&&(this.utilities.autocam.orbitMultiplier=this.getLookSpeed())},this.getTriggeredMode=function(){return T===Q&&ma.SHIFT?z[1]:d()||0!==$.z?e()?"pan":"dolly":c()?"pan":"pan"===B||"pinch"===B?"dollypan":A},this.initTracking=function(a,b){var c;if(w.isPerspective){c=.5*(w.near+w.far);var d=this.utilities.getHitPoint(a,b),e=v.getPosition();if(d&&d.sub){var f=d.sub(e),g=v.getEyeVector().normalize();c=Math.abs(g.dot(f))}else{var h=v.getPivotSetFlag()&&v.isPointVisible(v.getPivotPoint());if(h){var i=v.getPivotPlaneDistance();i>o&&(c=i)}}}else c=v.getEyeVector().length();sa=c},this.initOrbit=function(){this.utilities.setTemporaryPivot(f()?v.getTarget():null)},this.getCursor=function(){switch(y){case"freeorbit":case"orbit":return"url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAMAAADXqc3KAAAAt1BMVEUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD///8AAAAzMzP6+vri4uISEhKKioqtra2dnZ2EhIR9fX10dHRkZGQdHR3t7e3Hx8e5ubm1tbWoqKhWVlZKSko4ODgICAjv7+/o6OjMzMyxsbFOTk4pKSkXFxcEBAT29vbW1tZ6enpISEgLCwvhzeX+AAAAGXRSTlMANRO0nHRJHfnskIxQRKh89syDVwTWZjEJxPFEswAAAOFJREFUKM+1j+lygkAQhIflEAJe0Rw9u4CCeKKoSTTX+z9XoMJWWeX+ssrvZ3f19DQ5zOw/0DUMQPlmQ72bE2adBp8/Rp3CQUi3ILx+bxj4fjDs9T1Bmo6bbPPN8aDU4bjJt4nb+de789kSFyxn826jW3ICLNZZKU8nWWbrBTCRVm04U8TpjquRFf1Go0d7l8aYOrUR7FGEFr1S9LGymwthgX2gE/Kl0cHPOtF2xOWZ5QpIC93RflW4InkDoPRXesd5LJIMQPzV7tCMa7f6BvhJL79AVDmYTNQ1NhnxbI/uwB8H5Bjd4zQPBAAAAABJRU5ErkJggg==), auto";case"dolly":return"url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAMAAADXqc3KAAAAgVBMVEUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD///8mJiYAAADNzc2/v7+fn59paWlPT08MDAwICAj6+vqpqak7Ozv29vby8vLp6em2traAgIBkZGRZWVlAQEAaGhpISEgkS7tbAAAAFHRSTlMAOvhpZD8mkQWegMy9qY1YVE01EYiqlE0AAADZSURBVCjPbY9ZloMgEAAbEbfsmRZZXbJn7n/AAX2RQVN/VD26AXLOeZLDGo6IbfI9tHq8cdxuj1HwvgCoaiHqKoRk+M3hB9jueUW8PnfsE/bJ3vms7nCkq7NoE3s99AXxoh8vFoXCpknrn5faAuJCenT0xPkYqnxQFJaU0gdZrsKm8aHZrAIffBj40mc1jsTfIJRWegq6opTMvlfqLqYg7kr1ZB7jFgeaMC59N//8O4WZ1IiPF8b5wMHcJn8zB4g4mc77zpxgAbMSUVoGK4iV0hL4wrksz+H0Bw5+E+HrniDQAAAAAElFTkSuQmCC), auto";case"pan":return"url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAMAAADXqc3KAAABHVBMVEUAAABPTk4AAAAAAAAJCQkRERE0MzQQEBAODg4QEBB4d3dbWlo9PDw/Pj4vLy8sLCwZGBgWFhYcHBwKCgoSEhIAAAAKCgoICAgKCgoQEBAODg4EBAQICAgPDw8REREMDAx2dnY0NDQvLy9QUFAaGhomJSYjIyM7OjokJCQNDA0mJiYNDQ0AAAAUFBQJCQkQEBAEBAQNDQ0PDw8VFRX///+amJkAAAD5+fnz8/PKycn9/f339vbi4eLR0dDNzMyAgIB8e3xycHH7+/vw7+/o6OjX1ta7urq4t7iwsLCnp6eioqKbmppva21OTk74+Pjl5eXc3Nzb29vLy8vDw8PDwsKrqqqdnZ2WlpaSkpKTkZKMiouEg4NkZGRISEgxLzBpgbsEAAAANHRSTlMA+fiQXgngKSYG/vX17uvBuqackpCNg3BpUkpAPBwTDvj18+vl0s/NwrOwoZZ+TDg4NBkBGrzX8QAAAP5JREFUKM99j9Vuw0AQRdeuKZyGkyZNmbnXDLHDVGb8/8/oy7paK1bO0+oc7WiGnGiaxq+QRTQAOh8f9Jv4H/Ge8PZPrCdlvkxfYluUT2WyyCq3mZ7unwlKVLcqOzA/Mf71j0TWJ/Ym6rPeca05Ni4iIevYc7yoUD2zQFhq71BdI9nvBeBabFDSPe8DswlUc1Riw3VxbH0NHBUPQ0jrbDnPYDjALQBMq9E7nkC5y7VDKTZlUg8Q0lmjvl74zlYErgvKa42GPKf3/a0kQmYCDY1SYMDosqMoiWrGwz/uAbNvc/fNon4kXRKGq+PUo2Mb96afV0iUxqGU2s4VBbKUP65NL/LKF+7ZAAAAAElFTkSuQmCC), auto"}return null},this.getMotionDelta=function(a,b){var c=v&&v.getReverseZoomDirection()?-p:p;u&&(c*=-1),la[0]&&(V.x+=q,Y.x+=r),la[1]&&(V.x-=q,Y.x-=r),la[2]&&(V.y+=q,Y.y+=r),la[3]&&(V.y-=q,Y.y-=r),la[4]&&(V.z+=c),la[5]&&(V.z-=c);var d=V.x-U.x,e=V.y-U.y,f=V.z-U.z;Math.abs(d)<n&&(d=0),Math.abs(e)<n&&(e=0),Math.abs(f)<n&&(f=0),a.set(d,e,f),b&&b.set(Y.x-X.x,Y.y-X.y)},this.stepMotionDelta=function(a,b){b?(U.x+=a.x*na,U.y+=a.y*na,U.z+=a.z*na):U.copy(V),X.copy(Y)},this.update=function(){var a,c=!1,d=!1;this.getMotionDelta($,Z);var e=$.x,f=$.y,g=$.z;if(I||this.checkInteractionMode(),I=T>O,I&&this.controller.setIsLocked(!0),0!==e||0!==f||0!==g){switch(y){case"orbit":this.utilities.autocam&&this.utilities.autocam.startState&&(Z.x=-Z.x,J&&this.utilities.autocam.orbit(Y,J,Z.multiplyScalar(t),this.utilities.autocam.startState));break;case"freeorbit":h();break;case"dolly":var i,j,m;g*=ra,T>=P?(f=-f,g=Math.abs(e)>Math.abs(f)?e:f,g*=s,e=0,f=0,j=m=.5):(a=v.getScreenViewport(),j=k/a.width,m=l/a.height),i=!v.getIs2D()&&v.getZoomTowardsPivot()?this.coiIsActive()?v.getPivotPoint():v.getWorldPoint(.5,.5):v.getWorldPoint(j,m),v.dollyFromPoint(g*this.getDollySpeed(i),i);break;case"pan":v.panRelative(-e,f,sa);break;case"dollypan":0===e&&0===f||v.panRelative(-e,f,sa),a=v.getScreenViewport(),j=k/a.width,m=l/a.height,i=v.getWorldPoint(j,m);var n=v.getPosition(),p=v.getIs2D()?n.sub(i).length():sa,q=E/F-1,r=q*p;v.dollyFromPoint(r,i);var u=new THREE.Vector3,z=new THREE.Quaternion,A=v.getCameraUpVector(),H=u.copy(w.position).sub(w.target).normalize();z.setFromAxisAngle(H,1.2*G),A.applyQuaternion(z),v.getIs2D()||v.setCameraUpVector(A),E=F,D=C,sa=p+r}d=!0}return this.stepMotionDelta($,"pan"!==y&&"dollypan"!==y),T===O&&Math.abs(g)<o&&(this.interactionEnd(O),c=!0,d=!0),(ma.SHIFT||ma.ALT)&&x.indexOf(b.getActiveNavigationTool())!==-1&&(d=!0),!K&&(c||T>M)&&(T>O&&(U.copy(V),this.utilities.removeTemporaryPivot()),this.utilities.autocam.endInteraction(),T=M,I&&this.controller.setIsLocked(!1),I=!1,J=null,B=null),d?this.utilities.pivotActive(v.getPivotSetFlag(),T<=O):this.utilities.pivotUpdate(),w.dirty},this.checkInteractionMode=function(){var a=this.getTriggeredMode();a!==y&&(y=a,("pan"===y&&T>O||"dollypan"===y)&&this.initTracking(U.x,U.y))},this.interactionStart=function(a,b){(b||a>T)&&(T=a,K=!0,a>O&&("pan"===y&&this.initTracking(U.x,U.y),"orbit"===y&&this.initOrbit()),this.utilities.pivotActive(v.getPivotSetFlag(),a===O),this.utilities.autocam&&(this.utilities.autocam.sync(w),this.utilities.autocam.startInteraction(X.x,X.y),J=X.clone()))},this.interactionCheck=function(){(la[0]||la[1]||la[2]||la[3]||la[4]||la[5]||ma.SHIFT||ma.CONTROL||ma.ALT||ma.SPACE)&&this.interactionStart(N,!0)},this.interactionEnd=function(a){a===T&&(a!==O&&this.utilities.pivotActive(!1),K=!1)},this.handleWheelInput=function(b){if(this.isDragging)return!1;if(v.getIs2D()){var c=v.getScreenViewport(),d=a.intersectGround(k+c.width,l+c.height);this.utilities.setPivotPoint(d,!0,!0)}return v.getReverseZoomDirection()&&(b*=-1),V.z+=b,0!=b&&this.interactionStart(O),!0},this.resetKeys=function(){this.autoMove(-1,!1),ma.SHIFT=0,ma.CONTROL=0,ma.ALT=0,ma.SPACE=0},this.autoMove=function(a,b){b&&this.isDragging||(a<0?la[0]=la[1]=la[2]=la[3]=la[4]=la[5]=b:la[a]=b,b||this.interactionEnd(N),this.interactionCheck())},this.updateModifierState=function(a){ma.CONTROL=u&&a.metaKey||a.ctrlKey?1:0,ma.SHIFT=a.shiftKey?1:0,ma.ALT=a.altKey?1:0},this.handleKeyDown=function(a,b){this.updateModifierState(a);var c=!1;switch(b){case L.EQUALS:this.adjustSpeed(1),c=!0;break;case L.DASH:this.adjustSpeed(-1),c=!0;break;case L.ZERO:this.adjustSpeed(0),c=!0;break;case L.LEFT:this.autoMove(0,!0),c=!0;break;case L.RIGHT:this.autoMove(1,!0),c=!0;break;case L.PAGEUP:this.autoMove(2,!0),c=!0;break;case L.PAGEDOWN:this.autoMove(3,!0),c=!0;break;case L.UP:this.autoMove(4,!0),c=!0;break;case L.DOWN:this.autoMove(5,!0),c=!0;break;default:return!1}return this.isDragging||this.interactionStart(N),c},this.handleKeyUp=function(a,b){this.updateModifierState(a);var c=!1;switch(b){case L.LEFT:this.autoMove(0,!1),c=!0;break;case L.RIGHT:this.autoMove(1,!1),c=!0;break;case L.PAGEUP:this.autoMove(2,!1),c=!0;break;case L.PAGEDOWN:this.autoMove(3,!1),c=!0;break;case L.UP:this.autoMove(4,!1),c=!0;break;case L.DOWN:this.autoMove(5,!1),c=!0;break;default:return!1}return c&&(this.interactionEnd(N),K||this.interactionCheck()),c},this.handleDollyPan=function(a){k=a.canvasX,l=a.canvasY;var b=v.getScreenViewport();Y.x=W.x+a.deltaX,Y.y=W.y+a.deltaY,V.x=Y.x/b.width,V.y=Y.y/b.height,F=j(a);var c=THREE.Math.degToRad(a.rotation);G=c-H,Math.abs(G)>1&&(G=0),H=c,i(a.type,"start")&&(E=F,D=1,G=0,H=c),C=a.scale},this.handleGesture=function(a){switch(a.type){case"dragstart":return B="drag",this.handleButtonDown(a,0);case"dragmove":return"drag"===B&&this.handleMouseMove(a);case"dragend":return"drag"===B&&(this.handleButtonUp(a,0),B=null,!0);case"panstart":return B="pan",this.isDragging=!0,U.x=.5*(a.normalizedX+1),U.y=1-.5*(a.normalizedY+1),W.set(a.canvasX,a.canvasY),X.set(a.canvasX,a.canvasY),this.interactionStart(S),this.handleDollyPan(a),!0;case"panmove":return"pan"===B&&this.handleDollyPan(a);case"panend":return"pan"===B&&(this.isDragging=!1,this.handleDollyPan(a),this.interactionEnd(S),!0);case"pinchstart":return this.isDragging=!0,B="pinch",U.x=.5*(a.normalizedX+1),U.y=1-.5*(a.normalizedY+1),W.set(a.canvasX,a.canvasY),X.set(a.canvasX,a.canvasY),this.interactionStart(S),this.handleDollyPan(a),!0;case"pinchmove":return"pinch"===B&&this.handleDollyPan(a);case"pinchend":return"pinch"===B&&(this.isDragging=!1,this.handleDollyPan(a),this.interactionEnd(S),!0)}return!1},this.handleButtonDown=function(a,b){return this.updateModifierState(a),U.x=.5*(a.normalizedX+1),U.y=1-.5*(a.normalizedY+1),X.set(a.canvasX,a.canvasY),V.copy(U),Y.copy(X),_.copy(g(a.canvasX,a.canvasY)),aa.copy(_),k=a.canvasX,l=a.canvasY,this.isDragging=!0,this.interactionStart(b),!0},this.handleButtonUp=function(a,b){return this.updateModifierState(a),V.x=.5*(a.normalizedX+1),V.y=1-.5*(a.normalizedY+1),Y.set(a.canvasX,a.canvasY),aa.copy(g(a.canvasX,a.canvasY)),_.copy(aa),k=a.canvasX,l=a.canvasY,this.interactionEnd(b),this.isDragging=!1,!0},this.handleMouseMove=function(b){return this.updateModifierState(b),this.isDragging?(V.x=.5*(b.normalizedX+1),V.y=1-.5*(b.normalizedY+1),Y.set(b.canvasX,b.canvasY),aa.copy(g(b.canvasX,b.canvasY)),k=b.canvasX,l=b.canvasY,!0):(U.x=.5*(b.normalizedX+1),U.y=1-.5*(b.normalizedY+1),X.set(b.canvasX,b.canvasY),V.x=U.x,V.y=U.y,Y.copy(X),k=b.canvasX,l=b.canvasY,a.rolloverObject(k,l),!1)},this.handleBlur=function(a){this.resetKeys(),this.interactionEnd(T)},b.addEventListener(Autodesk.Viewing.ESCAPE_EVENT,function(a){m.handleBlur(a)})},function(){"use strict";var a=Autodesk.Viewing,b=a.Private;b.init_UnifiedCamera=function(b){if("undefined"==typeof a.UnifiedCamera){var c=function(a,c){b.Camera.call(this),this.fov=45,this.near=.1,this.far=1e5,this.aspect=a/c,this.left=-a/2,this.right=a/2,this.top=c/2,this.bottom=-c/2,this.clientWidth=a,this.clientHeight=c,this.target=new b.Vector3(0,0,-1),this.worldup=new b.Vector3(0,1,0),this.orthographicCamera=new b.OrthographicCamera(this.left,this.right,this.top,this.bottom,this.near,this.far),this.perspectiveCamera=new b.PerspectiveCamera(this.fov,this.aspect,this.near,this.far),this.zoom=1,this.toPerspective()};c.ORTHO_FOV=2*Math.atan(.5)*180/Math.PI,c.prototype=Object.create(b.Camera.prototype),c.prototype.clone=function(){var a=new c(2*this.right,2*this.top);return b.Camera.prototype.clone.call(this,a),a.position.copy(this.position),a.up.copy(this.up),this.target&&(a.target=this.target.clone()),this.worldup&&(a.worldup=this.worldup.clone()),this.worldUpTransform&&(a.worldUpTransform=this.worldUpTransform.clone()),a.left=this.left,a.right=this.right,a.top=this.top,a.bottom=this.bottom,a.near=this.near,a.far=this.far,a.fov=this.fov,a.aspect=this.aspect,a.zoom=this.zoom,a.isPerspective=this.isPerspective,this.updateProjectionMatrix(),a},c.prototype.__computeFovPosition=function(a){if(Math.abs(this.fov-a)<=1e-4)return this.position.clone();var c=this.target.clone().sub(this.position),d=b.Math.degToRad(this.fov),e=b.Math.degToRad(a),f=c.length()*Math.tan(.5*d)/Math.tan(.5*e),g=c.normalize().multiplyScalar(-f);return this.target.clone().add(g)},c.prototype.toPerspective=function(){!this.isPerspective&&this.saveFov&&(this.position.copy(this.__computeFovPosition(this.saveFov)),this.fov=this.saveFov),this.perspectiveCamera.aspect=this.aspect,this.perspectiveCamera.near=this.near,this.perspectiveCamera.far=this.far,this.perspectiveCamera.fov=this.fov/this.zoom,this.perspectiveCamera.updateProjectionMatrix(),this.projectionMatrix=this.perspectiveCamera.projectionMatrix,this.isPerspective=!0},c.prototype.toOrthographic=function(){if(this.isPerspective){this.saveFov=this.fov;var a=c.ORTHO_FOV;this.position.copy(this.__computeFovPosition(a)),this.fov=a}this.orthoScale=this.target.clone().sub(this.position).length();var b=.5*this.orthoScale,d=b*this.aspect;this.left=this.orthographicCamera.left=-d,this.right=this.orthographicCamera.right=d,this.top=this.orthographicCamera.top=b,this.bottom=this.orthographicCamera.bottom=-b,this.orthographicCamera.near=this.near,this.orthographicCamera.far=this.far,this.orthographicCamera.updateProjectionMatrix(),this.projectionMatrix=this.orthographicCamera.projectionMatrix,this.isPerspective=!1},c.prototype.updateProjectionMatrix=function(){this.isPerspective?this.toPerspective():this.toOrthographic()},c.prototype.setSize=function(a,b){this.aspect=a/b,this.left=-a/2,this.right=a/2,this.top=b/2,this.bottom=-b/2},c.prototype.setFov=function(a){this.fov=a,this.updateProjectionMatrix()},c.prototype.setLens=function(a,c){void 0===c&&(c=24);var d=2*b.Math.radToDeg(Math.atan(c/(2*a)));return this.setFov(d),d},c.prototype.getCameraChangedEvent=function(){return{type:a.CAMERA_CHANGE_EVENT,camera:this}},a.UnifiedCamera=c}}}(),function(){"use strict";function a(a){function b(){var a=g.size(),b=i.aspect,c=a.x/b,d=a.y;return Math.max(c,d)}var c=6.88,d=100,e=1e-6,f=1e-5;this.__options={dollyToPivot:!1,orbitPastPoles:!0,reverseDolly:!1,reverseHorizontalLook:!1,reverseVerticalLook:!1,useLeftHandedInput:!1,usePivotAlways:!1,lockNavigation:!1},this.__lockSettings={orbit:!1,pan:!1,zoom:!1,roll:!1,fov:!1,gotoview:!1,walk:!1},this.__pivotIsSetFlag=!1,this.__fitToViewRequested=!1,this.__homeViewRequested=!1,this.__transitionActive=!1,this.__destinationView=null,this.__is2D=!1,this.__isTouchDevice=!1,this.__kEpsilon=e,this.__minDistance=f;var g=void 0,h=void 0,i=null,j={left:0,top:0,width:1,height:1};this.uninitialize=function(){this.setCamera(null)},this.setCamera=function(a){a!==i&&(i=a,a&&(a.hasOwnProperty("target")||(a.target=new THREE.Vector3(0,0,0)),a.hasOwnProperty("pivot")||(a.pivot=new THREE.Vector3(0,0,0)),a.worldup=a.up.clone(),a.dirty=!0))},this.getCamera=function(){return i},this.setScreenViewport=function(a){j=a},this.getScreenViewport=function(){return j},this.__setUp=function(a){if(a&&i){var b=a.clone().normalize(),c=b.sub(i.worldup);if(0!==c.lengthSq())return i.worldup.copy(a).normalize(),i.dirty=!0,!0}return!1},this.__getUp=function(){return i?i.worldup:new THREE.Vector3(0,1,0)},this.setView=function(a,b){i&&a&&b&&(i.position.copy(a),i.target.copy(b),i.dirty=!0)},this.orientCameraUp=function(){i&&this.isActionEnabled("roll")&&(i.up.copy(this.getAlignedUpVector()),i.dirty=!0)},this.getPivotPoint=function(){return i?i.pivot.clone():new THREE.Vector3(0,0,0)},this.setPivotPoint=function(a){i&&a&&(i.pivot.copy(a),i.dirty=!0)},this.getPosition=function(){return i?i.position.clone():new THREE.Vector3(0,0,1)},this.setPosition=function(a){i&&a&&(i.position.copy(a),i.dirty=!0)},this.setTarget=function(a){i&&a&&(i.target.copy(a),i.dirty=!0)},this.getTarget=function(){return i?i.target.clone():new THREE.Vector3(0,0,0)},this.getEyeVector=function(){return i?i.target.clone().sub(i.position):new THREE.Vector3(0,0,-1)},this.getFovMin=function(){return c},this.getFovMax=function(){return d},this.isPointVisible=function(a){
var b=(new THREE.Frustum).setFromMatrix(i.projectionMatrix.clone().multiply(i.matrixWorldInverse));return b.containsPoint(a)},this.setVerticalFov=function(a,b){if((!i||i.isPerspective)&&(a<c?a=c:a>d&&(a=d),i&&this.isActionEnabled("fov"))){if(Math.abs(i.fov-a)<=e)return;if(b){var f=this.__pivotIsSetFlag&&this.isPointVisible(this.getPivotPoint()),g=this.getPosition(),h=this.getEyeVector(),j=THREE.Math.degToRad(i.fov),k=THREE.Math.degToRad(a),l=f?this.getPivotPlaneDistance():h.length(),m=l*Math.tan(.5*j)/Math.tan(.5*k),n=h.normalize().multiplyScalar(l-m);this.setPosition(g.add(n)),f&&this.setTarget(this.getTarget().add(n))}i.setFov(a),i.dirty=!0}},this.computeFit=function(a,b,c,e){if(!e||e.empty())return{position:a,target:b};var f=e.center(),g=e.size(),h=.5*Math.sqrt(g.x*g.x+g.y*g.y+g.z*g.z);if(0===h&&(h=1),!this.getIs2D()){var i=Math.max(1,.9+c/d*.5);h*=i}var j=a.clone().sub(b).normalize(),k=h/Math.tan(THREE.Math.degToRad(.5*c));j.multiplyScalar(k);var l=f.clone().add(j);return{position:l,target:f}},this.computeOrthogonalUp=function(a,b){var c=this.__getUp(),d=b.clone().sub(a);if(0===d.lengthSq())return d.copy(c);var e=d.clone().cross(c);return 0===e.lengthSq()&&(c.z>c.y?d.y-=1e-4:d.z-=1e-4,e.crossVectors(d,c)),e.cross(d).normalize()},this.fitBounds=function(a,b,c){var d=this.getTarget(),e=this.getPosition();if(!this.isActionEnabled("gotoview")||!b||b.empty())return{position:e,target:d};var f=this.getVerticalFov(),g=this.computeFit(e,d,f,b),h=c?this.computeOrthogonalUp(e,d):i.up;return a?(i.up.copy(h),this.setView(g.position,g.target)):this.setRequestTransitionWithUp(!0,g.position,g.target,f,h),this.setPivotPoint(g.target),this.setPivotSetFlag(!0),g},this.applyDollyConstraint2D=function(a){if(!this.__is2D||!g&&!h)return a;var c=a;if(g){var d=this.getEyeVector(),e=2*b(),f=e/-d.z;f=Math.max(f,1),c=Math.min(c,f)}if(h){var j=i.clientHeight/h,k=j/-d.z;k=Math.min(k,1),c=Math.max(c,k)}return c},this.applyPanningConstraint2D=function(a){if(this.__is2D&&g){var b=i.position.x+a.x,c=i.position.y+a.y;b=THREE.Math.clamp(b,g.min.x,g.max.x),c=THREE.Math.clamp(c,g.min.y,g.max.y);var d=b-i.position.x,e=c-i.position.y,f=Math.min(a.x,0),h=Math.min(a.y,0),j=Math.max(a.x,0),k=Math.max(a.y,0);d=THREE.Math.clamp(d,f,j),e=THREE.Math.clamp(e,h,k),a.x=d,a.y=e}},this.updateCamera=function(){i&&(i.updateProjectionMatrix(),this.orient(i,i.target,i.position,i.up),i.dirty=!1)},this.setCamera(a),this.setConstraints2D=function(a,b){g=a,h=b}}var b=Autodesk.Viewing,c=b.Private;a.prototype.constructor=a,a.prototype.setIs2D=function(a){this.__is2D=!!a},a.prototype.getIs2D=function(){return this.__is2D},a.prototype.setIsTouchDevice=function(a){this.__isTouchDevice=!!a},a.prototype.getIsTouchDevice=function(){return this.__isTouchDevice},a.prototype.orient=function(){function a(){b||(b=new THREE.Matrix4,c=new THREE.Vector3,d=new THREE.Vector3,e=new THREE.Vector3)}var b,c,d,e;return function(f,g,h,i){a();var j=b.elements;e.subVectors(h,g).normalize(),0===e.lengthSq()&&(e.z=1),c.crossVectors(i,e).normalize(),0===c.lengthSq()&&(i.z>i.y?e.y-=1e-4:e.z+=1e-4,c.crossVectors(i,e).normalize()),d.crossVectors(e,c),j[0]=c.x,j[4]=d.x,j[8]=e.x,j[1]=c.y,j[5]=d.y,j[9]=e.y,j[2]=c.z,j[6]=d.z,j[10]=e.z,f.setRotationFromMatrix(b)}}(),a.prototype.fov2fl=function(a){var b=12,c=THREE.Math.degToRad(a);return c<=0&&(c=1e-4),Math.round(b/Math.tan(.5*c))},a.prototype.fl2fov=function(a){var b=12;a<=0&&(a=1e-4);var c=2*Math.atan(b/a);return THREE.Math.radToDeg(c)},a.prototype.setCameraUpVector=function(a){if(this.isActionEnabled("roll")){var b=this.getCamera();b.up.copy(a),b.dirty=!0}},a.prototype.getCameraUpVector=function(){var a=this.getCameraRightVector(!1),b=this.getEyeVector();return a.cross(b).normalize()},a.prototype.getAlignedUpVector=function(){var a=this.getCameraRightVector(!0),b=this.getEyeVector();return a.cross(b).normalize()},a.prototype.getCameraRightVector=function(a){var b=new THREE.Vector3,c=a?this.getWorldUpVector():this.getCamera().up,d=this.getEyeVector();return b.crossVectors(d,c),0===b.lengthSq()&&(c.z>c.y?d.y-=1e-4:d.z+=1e-4,b.crossVectors(d,c)),b.normalize()},a.prototype.setWorldUpVector=function(a,b){this.isActionEnabled("roll")&&(this.__setUp(a),b&&this.orientCameraUp())},a.prototype.getWorldUpVector=function(){return this.__getUp().clone()},a.prototype.getWorldRightVector=function(){var a=new THREE.Vector3;return a.copy(this.__getUp()),Math.abs(a.z)<=Math.abs(a.y)?a.set(a.y,-a.x,0):a.z>=0?a.set(a.z,0,-a.x):a.set(-a.z,0,a.x),a.normalize()},a.prototype.getVerticalFov=function(){return this.getCamera().fov},a.prototype.getHorizontalFov=function(){var a=this.getScreenViewport();return this.getCamera().fov*(a.width/a.height)},a.prototype.getFocalLength=function(){return this.fov2fl(this.getVerticalFov())},a.prototype.setFocalLength=function(a,b){this.setVerticalFov(this.fl2fov(a),b)},a.prototype.setReverseZoomDirection=function(a){this.__options.reverseDolly=!!a},a.prototype.setReverseHorizontalLookDirection=function(a){return this.getIs2D()?void c.logger.warn("Autodesk.Viewing.Navigation.setReverseHorizontalLookDirection is not applicable to 2D"):void(this.__options.reverseHorizontalLookDirection=!!a)},a.prototype.setReverseVerticalLookDirection=function(a){return this.getIs2D()?void c.logger.warn("Autodesk.Viewing.Navigation.setReverseVerticalLookDirection is not applicable to 2D"):void(this.__options.reverseVerticalLookDirection=!!a)},a.prototype.getReverseZoomDirection=function(){return this.__options.reverseDolly},a.prototype.getReverseHorizontalLookDirection=function(){return this.getIs2D()?(c.logger.warn("Autodesk.Viewing.Navigation.getReverseHorizontalLookDirection is not applicable to 2D"),!1):this.__options.reverseHorizontalLookDirection},a.prototype.getReverseVerticalLookDirection=function(){return this.getIs2D()?(c.logger.warn("Autodesk.Viewing.Navigation.getReverseVerticalLookDirection is not applicable to 2D"),!1):this.__options.reverseVerticalLookDirection},a.prototype.setZoomTowardsPivot=function(a){this.__options.dollyToPivot=!!a},a.prototype.getZoomTowardsPivot=function(){return this.__options.dollyToPivot},a.prototype.setOrbitPastWorldPoles=function(a){return this.getIs2D()?void c.logger.warn("Autodesk.Viewing.Navigation.setOrbitPastWorldPoles is not applicable to 2D"):void(this.__options.orbitPastPoles=!!a)},a.prototype.getOrbitPastWorldPoles=function(){return this.getIs2D()?(c.logger.warn("Autodesk.Viewing.Navigation.orbitPastWorldPoles is not applicable to 2D"),!1):this.__options.orbitPastPoles},a.prototype.setUsePivotAlways=function(a){this.__options.usePivotAlways=!!a},a.prototype.getUsePivotAlways=function(){return this.__options.usePivotAlways},a.prototype.setUseLeftHandedInput=function(a){this.__options.useLeftHandedInput=!!a},a.prototype.getUseLeftHandedInput=function(){return this.__options.useLeftHandedInput},a.prototype.setIsLocked=function(a){this.__options.lockNavigation=!!a},a.prototype.getIsLocked=function(){return this.__options.lockNavigation},a.prototype.setLockSettings=function(a){for(var b in this.__lockSettings)a.hasOwnProperty(b)&&(this.__lockSettings[b]=a[b])},a.prototype.getLockSettings=function(){var a={};for(var b in this.__lockSettings)a[b]=this.__lockSettings[b];return a},a.prototype.isActionEnabled=function(a){return!this.__options.lockNavigation||this.__lockSettings[a]===!0},a.prototype.setPivotSetFlag=function(a){this.__pivotIsSetFlag=!!a},a.prototype.getPivotSetFlag=function(){return this.__pivotIsSetFlag},a.prototype.setRequestFitToView=function(a){this.isActionEnabled("gotoview")&&(this.__fitToViewRequested=!!a)},a.prototype.getRequestFitToView=function(){return this.__fitToViewRequested},a.prototype.setRequestHomeView=function(a){this.isActionEnabled("gotoview")&&(this.__homeViewRequested=!!a)},a.prototype.getRequestHomeView=function(){return this.__homeViewRequested},a.prototype.setRequestTransition=function(a,b,c,d,e,f){a?this.__destinationView={position:b.clone(),coi:c.clone(),fov:d,up:this.getCamera().up.clone(),worldUp:this.getWorldUpVector(),reorient:e,pivot:f?f.clone():c.clone()}:this.__destinationView=null},a.prototype.setRequestTransitionWithUp=function(a,b,c,d,e,f,g){a?this.__destinationView={position:b.clone(),coi:c.clone(),fov:d,up:e.clone(),worldUp:f?f:this.getWorldUpVector(),reorient:!1,pivot:g?g.clone():c.clone()}:this.__destinationView=null},a.prototype.getRequestTransition=function(){return this.__destinationView},a.prototype.setTransitionActive=function(a){this.__transitionActive=!!a},a.prototype.getTransitionActive=function(){return this.__transitionActive},a.prototype.getWorldSize=function(a){var b=this.getScreenViewport(),c=b.width/b.height,d=2*a*Math.tan(THREE.Math.degToRad(.5*this.getCamera().fov)),e=d*c;return new THREE.Vector2(e,d)},a.prototype.getWorldPoint=function(a,b){b=1-b,a=2*a-1,b=2*b-1;var c,d=this.getCamera();d.isPerspective&&(c=new THREE.Vector3(a,b,1),c=c.unproject(d));var e,f,g=this.getEyeVector(),h=this.getPosition();if(!d.isPerspective||isNaN(c.x)){var i=this.getWorldSize(g.length()),j=this.getCameraRightVector(!1).multiplyScalar(.5*a*i.x),k=this.getCameraUpVector().multiplyScalar(.5*b*i.y);e=g.clone().add(j).add(k).normalize()}else e=c.sub(h).normalize();var l=this.getPivotPoint(),m=this.__pivotIsSetFlag&&(this.getIs2D()||d.isPerspective&&this.isPointVisible(l));if(m){var n=e.dot(g);f=0!==n?Math.abs(l.sub(h).dot(g))/n:l.sub(h).length()}else f=d.isPerspective?.5*(d.near+d.far):d.orthoScale;return e.multiplyScalar(f).add(h)},a.prototype.getPivotPlaneDistance=function(){var a=this.getPivotPoint(),b=this.getEyeVector(),c=this.getPosition();return a.sub(c).dot(b.normalize())},a.prototype.panRelative=function(a,b,c){if(this.isActionEnabled("pan")){var d=this.getWorldSize(c),e=a*d.x,f=b*d.y,g=this.getCameraRightVector(!1).multiplyScalar(e),h=this.getCameraUpVector().multiplyScalar(f),i=g.add(h);this.applyPanningConstraint2D(i),this.setView(this.getPosition().add(i),this.getTarget().add(i))}},a.prototype.dollyFromPoint=function(a,b){if(this.isActionEnabled("zoom")&&!(Math.abs(a)<=this.__kEpsilon)){var c=this.getPosition(),d=b.clone().sub(c),e=d.length(),f=e+a;f<this.__minDistance&&(f=this.__minDistance);var g=f/e;if(g=this.applyDollyConstraint2D(g),Math.abs(g-1)>this.__kEpsilon){d.multiplyScalar(g),d.set(-d.x,-d.y,-d.z);var h=d.add(b),i=this.getEyeVector();this.getCamera().isPerspective||i.multiplyScalar(g),this.setView(h,i.add(h))}}},a.prototype.toPerspective=function(){if(this.getIs2D())return void c.logger.warn("Autodesk.Viewing.Navigation.toPerspective is not applicable to 2D");var a=this.getCamera();a.isPerspective||(a.toPerspective(),a.dirty=!0)},a.prototype.toOrthographic=function(){var a=this.getCamera();a.isPerspective&&(a.toOrthographic(),a.dirty=!0)},a.snapToAxis=function(a){var b=new THREE.Vector3(Math.abs(a.x),Math.abs(a.y),Math.abs(a.z));return b.x>b.y&&b.x>b.z?a.set(a.x>0?1:-1,0,0):b.y>b.x&&b.y>b.z?a.set(0,a.y>0?1:-1,0):a.set(0,0,a.z>0?1:-1),a},Autodesk.Viewing.Navigation=a}(),AutodeskNamespace("Autodesk.Viewing"),Autodesk.Viewing.HotGestureTool=function(a){var b=(navigator.userAgent.search("Mac OS")!=-1,a.navigation),c=(b.getCamera(),["hottouch"]),d={SHIFT:0,ALT:0,CONTROL:0},e=null,f=null,g=!1,h=!1,i=null,j={SHIFT:16,CONTROL:17,ALT:18,ESCAPE:27,LCOMMAND:91,RCOMMAND:93,COMMANDMOZ:224},k="worldup",l="fov";this.getNames=function(){return c},this.getName=function(){return c[0]},this.activate=function(a){},this.deactivate=function(a){},this.__checkStart=function(){i&&(this.controller.distributeEvent("handleGesture",i),i=null)},this.update=function(){if(this.controller.getIsLocked())return!1;var b=a.getActiveNavigationTool(),c=g===!1&&h===!0,d=g===!0&&h===!1;if(c||d){var i=c?k:l;if(b===i)return!1;if(b===e)return a.setActiveNavigationTool(i),e=i,this.__checkStart(),!1;f=b,a.setActiveNavigationTool(i),e=i,this.__checkStart()}else e&&(a.setActiveNavigationTool(f),e=null,f=null);return!1},this.resetKeys=function(){d.SHIFT=0,d.CONTROL=0,d.ALT=0},this.updateModifierState=function(a){d.CONTROL=a.ctrlKey?1:0,d.SHIFT=a.shiftKey?1:0,d.ALT=a.altKey?1:0},this.handleGesture=function(b){if(b===i)return!1;switch(b.type){case"drag3start":a.navigation.isActionEnabled("fov")&&(i=b,g=!0);break;case"drag3move":break;case"drag3end":g=!1;break;case"rotatestart":a.navigation.isActionEnabled("roll")&&(i=b,h=!0);break;case"rotatemove":break;case"rotateend":h=!1}return!1},this.handleKeyDown=function(a,b){switch(this.updateModifierState(a),b){case j.SHIFT:d.SHIFT=1;break;case j.CONTROL:d.CONTROL=1;break;case j.ALT:d.ALT=1}return!1},this.handleKeyUp=function(a,b){switch(this.updateModifierState(a),b){case j.SHIFT:d.SHIFT=0;break;case j.CONTROL:d.CONTROL=0;break;case j.ALT:d.ALT=0}return!1},this.handleButtonDown=function(a,b){return this.updateModifierState(a),!1},this.handleButtonUp=function(a,b){return this.updateModifierState(a),!1},this.handleMouseMove=function(a){return this.updateModifierState(a),!1},this.handleBlur=function(a){return this.resetKeys(),!1}},AutodeskNamespace("Autodesk.Viewing.Private"),Autodesk.Viewing.HotkeyManager=function(){function a(){return p}function b(){return p[0]}function c(a,b){return a-b}function d(a,b,d){var e=k.some(function(b){return b.id===a});if(e)return!1;for(var f=0;f<b.length;f++)k.push({id:a,keys:b[f].keycodes.sort(c).join(),onPress:b[f].onPress,onRelease:b[f].onRelease,options:d||{}});return!0}function e(a){for(var b=!1,c=k.length-1;c>=0;c--)k[c].id===a&&(k.splice(c,1),b=!0);return b}function f(){var a,b,c=l.join();for(b=0;b<n.length;)a=n[b],a.keys===c?n.splice(b,1):b++;for(b=0;b<m.length;)a=m[b],a.keys!==c?m.splice(b,1):b++}function g(a,b){if(l.indexOf(b)===-1){for(var c=l.join(),d=l.slice(0),e=0;e<l.length&&l[e]<b;)e++;l.splice(e,0,b);var g=l.join(),h=l.slice(0);f();var i,j=[],o=[];for(e=k.length-1;e>=0;e--)i=k[e],i.keys===c&&i.onRelease?j.unshift(i):i.keys===g&&i.onPress&&o.unshift(i);for(e=j.length-1;e>=0&&(i=j[e],!i.onRelease(d));e--)i.options.tryUntilSuccess&&n.unshift(i);for(e=o.length-1;e>=0&&(i=o[e],!i.onPress(h));e--)i.options.tryUntilSuccess&&m.unshift(i)}}function h(a,b){var c=l.join(),d=l.slice(0),e=l.indexOf(b);e>-1&&l.splice(e,1);var g=l.join(),h=l.slice(0);f();var i,j=[],o=[];for(e=k.length-1;e>=0;e--)i=k[e],i.keys===c&&i.onRelease?j.unshift(i):i.keys===g&&i.onPress&&o.unshift(i);for(e=j.length-1;e>=0&&(i=j[e],!i.onRelease(d));e--)i.options.tryUntilSuccess&&n.unshift(i);for(e=o.length-1;e>=0&&(i=o[e],!i.onPress(h));e--)i.options.tryUntilSuccess&&m.unshift(i)}function i(){var a,b;for(b=0;b<n.length;)a=n[b],a.onRelease(a.keys.split())===!0?n.splice(b,1):b++;for(b=0;b<m.length;)a=m[b],a.onPress(a.keys.split())===!0?m.splice(b,1):b++;return!1}function j(){for(var a=l.length-1;a>=0;a--)h(null,l[a])}var k=[],l=[],m=[],n=[],o=Autodesk.Viewing.KeyCode,p=["hotkeys"];return{pushHotkeys:d,popHotkeys:e,handleKeyDown:g,handleKeyUp:h,handleBlur:j,getName:b,getNames:a,activate:function(){},deactivate:function(){},update:i,KEYCODES:o}},Autodesk.Viewing.theHotkeyManager=new Autodesk.Viewing.HotkeyManager,AutodeskNamespace("Autodesk.Viewing"),Autodesk.Viewing.FovTool=function(a){function b(a){return a<0&&a>-3?-3:a>0&&a<3?3:a}var c=.001,d=1e-5,e=-1,f=.6,g=100,h=a.navigation,i=h.getCamera(),j=["fov"],k=!1,l=0,m=null,n=null,o=!1,p=0,q=-5,r=-1,s=0,t=2,u=q,v=new THREE.Vector3,w=new THREE.Vector3,x=new THREE.Vector3,y=null;this.getNames=function(){return j},this.getName=function(){return j[0]},this.activate=function(a){p=0},this.deactivate=function(a){u=q},this.getCursor=function(){return 0!==p&&u===q?null:"url(data:image/x-icon;base64,AAACAAEAGBgAAAAAAACICQAAFgAAACgAAAAYAAAAMAAAAAEAIAAAAAAAYAkAABMLAAATCwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAlgAAAP8AAAD/AAAAlgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAACEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA////////////AAAA/wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAnAwMD/yEhIf8AAABmAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA////////////AAAA/wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAGknJyf/goKC/8/Pz/8aGhr/AAAALQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA////////////AAAA/wAAAAAAAAAAAAAAAAAAAAAAAABTFBQU/2lpaf/MzMz///////////+Wlpb/AAAAlgAAAAAAAAAAAAAAAAAAAAAAAAAKAAAAAAAAAAAAAAAAAAAAlgAAAP8AAAD/AAAAlgAAAAAAAAAAAAAAOAAAAKFTU1P/t7e3////////////8PDw////////////AQEB/wAAAAEAAAAAAAAAFAAAAH0KCgr/AAAAYwAAAAAAAAAAAAAAlgAAAP8AAAD/AAAAlgAAAAAAAAAjCwsL/6Ghof/t7e3///////Dw8P9MTEz/LS0t//Pz8///////Ghoa/wAAABoAAAANDQ0N/319ff+rq6v/Y2Nj/wAAAK8AAABGAAAA////////////AAAA/wAAAF0hISH/jIyM////////////sLCw/xEREf8AAACHAAAArKysrP//////V1dX/wAAAFcAAABSUlJS//f39///////8PDw/6+vr/86Ojr/LS0t////////////FRUV/1xcXP/Gxsb/+Pj4//Hx8f9MTEz/AAAAsAAAAEcAAAAAAAAAZ2dnZ///////pKSk/wAAAKQAAACtra2t///////////////////////m5ub/kZGR/wAAAP8AAAD/q6ur//Hx8f//////vb29/x0dHf8AAACIAAAAAAAAAAAAAAAAAAAAOjo6Ov//////5+fn/wAAAOcAAADd3d3d////////////////////////////+/v7/9bW1v/i4uL//v7+//Pz8/9hYWH/AAAAvQAAAFQAAAAAAAAAAAAAAAAAAAAAAAAAJycnJ//6+vr//////wMDA/8AAADv7+/v/////////////////////////////////////////////////7y8vP8ODg7/AAAAKwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAJiYmJv/6+vr//////wkJCf8AAADv7+/v//////////////////////////////////f39//9/f3//////+np6f+UlJT/GBgY/wAAAH0AAAACAAAAAAAAAAAAAAAAAAAAKSkpKf///////v7+/w0NDf8AAADd3d3d////////////////////////////29vb/39/f/+Xl5f/5+fn////////////5ubm/1RUVP8CAgL/AAAAPwAAAAAAAAAAAAAAOTk5Of//////8PDw/wgICP8AAAChoaGh/////////////////+np6f+YmJj/QkJC/wAAAP8AAAD/UFBQ/7e3t//39/f///////////+oqKj/EBAQ/wAAAIgAAAAAAAAAZ2dnZ///////29vb/wEBAf8AAAA4NTU1/9zc3P/t7e3/tbW1/01NTf8AAACYAAAA////////////AwMD/wsLC/9oaGj/y8vL////////////8fHx/zg4OP8AAACWAAAApaWlpf//////n5+f/wAAAJ8AAAAAAAAAczg4OP9LS0v/EhIS/wAAAE0AAAAAAAAA////////////FRUV/wAAABUAAABoJSUl/4GBgf/i4uL///////////9+fn7/Pz8///b29v//////SkpK/wAAAEoAAAAAAAAAAAAAADgAAABLAAAAEgAAAAAAAAAAAAAAlgAAAP8AAAD/AAAAlgAAAAAAAAAAAAAAJQAAAIE8PDz/np6e//z8/P/////////////////8/Pz/CQkJ/wAAAAkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAlgAAAP8AAAD/AAAAlgAAAAAAAAAAAAAAAAAAAAAAAAA8DAwM/09PT/+7u7v///////////+QkJD/AAAAkwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA////////////Dw8P/wAAAA8AAAAAAAAAAAAAAAAAAAAAAAAADAAAAFIYGBj/aGho/729vf8WFhb/AAAAJwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA////////////FRUV/wAAABUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAYAQEB/w8PD/8AAABUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA////////////DAwM/wAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAA8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAlgAAAP8AAAD/AAAAlgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD///8x/h/nO/4fw1D+HwFy/h4BRu4YAHOGEABkAAAAXAAAIFwAAOBnAAHgIAAD4GUAAOB4AABgXAAAIGMAAABtggAAVMYYAHT+HgE7/g8BcP4Pw2/+D+dc/h//XP///2c=), auto"},this.getMotionDelta=function(a){var b=w.x-v.x,d=w.y-v.y,e=w.z-v.z;Math.abs(b)<c&&(b=0),Math.abs(d)<c&&(d=0),Math.abs(e)<c&&(e=0),a.set(b,d,e)},this.stepMotionDelta=function(a,b){b?(v.x+=a.x*f,v.y+=a.y*f,v.z+=a.z*f):v.copy(w)},this.getAccumulatedWheelDelta=function(){var a=Date.now(),c=0;return n&&a-n>g?(c=b(l),l=0,m=null,n=null,o=!1):m&&a-m>g&&(o?Math.abs(l)>=3&&(c=l,l=0):(c=b(l),o=!0,l=0)),c},this.update=function(){var a=!1,b=u>q;if(u>q){this.controller.setIsLocked(!0),this.getMotionDelta(x);var c=x.x,f=x.y,g=x.z;if(0!==c||0!==f||0!==g)if(b=!0,u>=s)f=-f,g=Math.abs(c)>Math.abs(f)?c:f,0!==g&&(g*=e,h.setVerticalFov(h.getVerticalFov()*(1+g),!0));else{var j=this.getAccumulatedWheelDelta()/3;0!==j&&h.setFocalLength(h.getFocalLength()+j,!0)}this.stepMotionDelta(x,!0),u===r&&Math.abs(g)<d&&(this.interactionEnd(r),a=!0)}return b?this.utilities.pivotActive(h.getPivotSetFlag(),!0):this.utilities.pivotUpdate(),!k&&(a||u>q)&&(u>r&&v.copy(w),u=q,this.controller.setIsLocked(!1)),i.dirty},this.interactionStart=function(a,b){(b||a>u)&&(u=a,k=!0),h.toPerspective()},this.interactionEnd=function(a){a===u&&(a!==r&&this.utilities.pivotActive(!1),k=!1)},this.handleWheelInput=function(a){if(u>r)return!1;h.getReverseZoomDirection()&&(a*=-1),w.z+=a,l+=a;var b=Date.now();return m||(m=b),n=b,0!=a&&this.interactionStart(r),!0},this.handleGesture=function(a){switch(a.type){case"dragstart":return this.handleButtonDown(a,0);case"dragmove":return this.handleMouseMove(a);case"dragend":return this.handleButtonUp(a,0);case"drag3start":return y="drag",this.handleButtonDown(a,0);case"drag3move":return"drag"===y&&this.handleMouseMove(a);case"drag3end":return"drag"===y&&this.handleButtonUp(a,0),y=null,!1}return!1},this.handleButtonDown=function(a,b){return p+=1<<b,b!==t&&(v.x=.5*(a.normalizedX+1),v.y=1-.5*(a.normalizedY+1),w.copy(v),this.interactionStart(b),!0)},this.handleButtonUp=function(a,b){return p-=1<<b,b!==t&&(w.x=.5*(a.normalizedX+1),w.y=1-.5*(a.normalizedY+1),this.interactionEnd(b),!0)},this.handleMouseMove=function(a){return w.x=.5*(a.normalizedX+1),w.y=1-.5*(a.normalizedY+1),u>r},this.handleBlur=function(a){return this.interactionEnd(u),!1}},AutodeskNamespace("Autodesk.Viewing"),Autodesk.Viewing.WorldUpTool=function(a,b){function c(a,b){function c(a,b){var c=Math.abs(a-b);return c>m?c:Math.min(m-c,c)}function d(a,b){var c=p(a);return c.distanceToSquared(b)<o||(D.set(-b.x,-b.y,-b.z),c.distanceToSquared(D)<o)}function g(a,b){for(var e=Y+Z+2*Math.PI/180,f=0;f<6;++f)if(S[f]!==_)for(var g=f+1;g<6;++g)if(S[g]!==_){var h=c(S[f],S[g]);if(h<e){if(a[f]<a[g]&&!d(f,b)||d(g,b)){S[f]=_;break}S[g]=_}}}function i(a){return a>m?a:a<=0?a+Math.PI:a-Math.PI}function j(a,b,c){var d=a.clone().normalize(),e=new Array(3),f=new Array(6);e[0]=l(1,0,0,d),e[1]=l(0,1,0,d),e[2]=l(0,0,1,d);var h,j=b.clone().cross(d).normalize();for(h=0;h<3;++h){var k=e[h];f[h]=k.length(),f[h]<aa?S[h]=_:(k.multiplyScalar(1/f[h]),S[h]=Math.atan2(j.dot(k),b.dot(k)))}for(S[3]=i(S[0]),S[4]=i(S[1]),S[5]=i(S[2]),f[3]=f[0],f[4]=f[1],f[5]=f[2],g(f,c),h=0;h<6;++h)if(S[h]!==_){var m=D.set(0,0,1);E.setFromAxisAngle(m,S[h]);var n=D.set(0,.54,0);n.applyQuaternion(E),Q[h].position.copy(n),Q[h].visible=!0}else Q[h].visible=!1}function k(){O=new THREE.Object3D;var a=new THREE.RingGeometry(.5-.01*H,.5,60),b=new THREE.Mesh(a,B);K=b;var c=.007*H,d=new THREE.BoxGeometry(.93,c,c),e=new THREE.BoxGeometry(c,.93,c),f=new THREE.BoxGeometry(c,c,.93);L=new THREE.Mesh(d,B),M=new THREE.Mesh(e,B),N=new THREE.Mesh(f,B),O.add(L),O.add(M),O.add(N),P=new THREE.Mesh(new THREE.CircleGeometry(.005),B),O.add(P),Q=new Array(6),R=new Array(6);for(var g=0;g<6;++g){var h=.005*H,i=.0025*H;Q[g]=new THREE.Mesh(new THREE.CircleGeometry(h,16),B),R[g]=new THREE.Mesh(new THREE.CircleGeometry(i,16),B),R[g].visible=!1,Q[g].add(R[g]),b.add(Q[g])}return O.add(b),O}function n(a,b,c,d,e){return O||(O=k()),h.orient(K,b,F.position,d),j(c,e,d),O.scale.x=a,O.scale.y=a,O.scale.z=a,O.position.copy(b),O}function p(a){if(C.set(0,0,0),a>=0){var b=a>=3?-1:1;a%=3,0===a&&(C.x=b),1===a&&(C.y=b),2===a&&(C.z=b)}return V&&C.multiplyScalar(-1),C}function q(a,b){for(var d=c(S[0],a),e=0,f=1;f<6;++f){var g=c(S[f],a);g<d&&(d=g,e=f)}return T=d,d<b?e:-1}function r(a){h.setWorldUpVector(a,!0)}function s(a){if(0!==a){var b=30*Math.PI/180,c=D.copy(F.position).sub(J).normalize();E.setFromAxisAngle(c,a);var d=h.getWorldUpVector(),e=Math.abs(c.angleTo(d));(e<b||Math.PI-e<b)&&d.copy(h.getCameraUpVector()),d.applyQuaternion(E),r(d)}}function t(){if(!W){var a=q(U,Y);if(a>=0)return T=0,W=!0,U=S[a],p(a)}return!1}function u(){if(W){var a=q(U,Z);if(a<0)return W=!1,!0;T=0}return!1}function v(a,b,c,d){var e=a<b;if(e){var f=p(c);return f.distanceToSquared(d)<o}return!1}function w(a,b){var d=a.dot(b),e=d<0;e&&(b=b.clone().multiplyScalar(-1)),h.orient(P,J,F.position,b),P.position.copy(b.multiplyScalar(.495));for(var f=!1,g=W?Z:Y,i=0;i<6;++i){var j=c(S[i],U),k=v(j,g,i,a);k&&(f=!0);var l=k?4:3*(1-3*j/Math.PI);l<1&&(l=1),l*=H,R[i].visible=k;var m=Q[i];m.scale.x=l,m.scale.y=l,m.scale.z=l}return L.visible=f,M.visible=f,N.visible=f,f}function x(a){U+=a,U>Math.PI?U-=m:U<=-Math.PI&&(U=m+U);var b=t();if(b)X=U,r(b);else if(u()){var c=U-X;s(c),X=0}else{if(W)return!1;s(a)}return!0}var y=12303291,z=30,A=2*Math.tan(THREE.Math.degToRad(.5*z)),B=new THREE.MeshPhongMaterial({color:y,ambient:y,opacity:.5,transparent:!0,depthTest:!1,depthWrite:!1}),C=new THREE.Vector3,D=new THREE.Vector3,E=new THREE.Quaternion,F=new THREE.PerspectiveCamera(z,b.aspect,b.near,b.far),G=b,H=1,I=1,J=null,K=null,L=null,M=null,N=null,O=null,P=null,Q=null,R=null,S=new Array(6),T=0,U=0,V=!1,W=!0,X=0,Y=5*Math.PI/180,Z=7*Math.PI/180,$=1,_=1e3,aa=.1;a.createOverlayScene("roll",null,null,F),this.updateRollCamera=function(a,b){F.position.copy(G.position),F.quaternion.copy(G.quaternion),F.up.copy(G.up),F.aspect=G.aspect,a&&b&&(F.near=b-a,F.far=b+a),F.updateProjectionMatrix()},this.isSnapped=function(){return W},this.resize=function(){var a=$*A,b=a*G.aspect,c=(G.aspect<1?b:a)*I;O.scale.x=c,O.scale.y=c,O.scale.z=c},this.start=function(b,c){this.updateHUD(b,c),a.addOverlay("roll",O)},this.updateHUD=function(a,b){J=a,b<e?b=e:b>f&&(b=f),I=b,H=f/b;var c=C.copy(a).sub(G.position);$=c.length();var d=$*A,g=d*G.aspect,i=(G.aspect<1?g:d)*b;this.updateRollCamera(i,$);var j=h.getWorldUpVector(),k=h.getCameraUpVector();n(i,a,c,j,k),U=0,X=0;var l=j.dot(k);V=l<0,W=w(j,k)},this.handleRoll=function(a,b,c){if(this.updateRollCamera(),w(h.getWorldUpVector(),h.getCameraUpVector()),0!==a||0!==b){var d=c.x-a-.5,e=c.y-b-.5,f=c.x-.5,g=c.y-.5;return x(Math.atan2(g,f)-Math.atan2(e,d))}return!1},this.handleRollTouch=function(a){this.updateRollCamera(),w(h.getWorldUpVector(),h.getCameraUpVector());var b=a-U;return Math.abs(b)>.001&&x(b)},this.end=function(){a.removeOverlay("roll",O)}}function d(a){var b=a.pointers[1].clientX-a.pointers[0].clientX,c=a.pointers[1].clientY-a.pointers[0].clientY,d=Math.sqrt(b*b+c*c),e=h.getScreenViewport();return d/Math.min(e.width,e.height)}var e=.35,f=.8,g=.65,h=b.navigation,i=h.getCamera(),j=["worldup"],k=this,l=function(){var a=new THREE.Vector3;return function(b,c,d,e){var f=new THREE.Vector3(b,c,d),g=e.dot(f);return a.copy(e),a.multiplyScalar(g),f.sub(a)}}(),m=2*Math.PI,n=.001,o=1e-5,p=!1,q=!1,r=!1,s=new c(a,i),t=new THREE.Vector3,u=new THREE.Vector3,v=new THREE.Vector3,w=null,x=0,y={x:.5,y:.5},z=1;this.getNames=function(){return j},this.getName=function(){return j[0]},this.activate=function(a){b.addEventListener(Autodesk.Viewing.CAMERA_CHANGE_EVENT,this.handleCameraChange),r=!1},this.deactivate=function(a){s.end(),b.removeEventListener(Autodesk.Viewing.CAMERA_CHANGE_EVENT,this.handleCameraChange),this.utilities.restorePivot(),w=null,p=!1,r=!1},this.getCursor=function(){return"auto"},this.getMotionDelta=function(a){var b=u.x-t.x,c=u.y-t.y,d=u.z-t.z;Math.abs(b)<n&&(b=0),Math.abs(c)<n&&(c=0),Math.abs(d)<n&&(d=0),a.set(b,c,d)},this.stepMotionDelta=function(){t.copy(u)},this.update=function(){if(!r){var a=h.getEyeVector(),b=.5*(i.near+i.far);a.normalize().multiplyScalar(b);var c=a.add(i.position);this.utilities.savePivot(),this.utilities.setPivotPoint(c,!0,!0),this.utilities.pivotActive(!0);var d=g;s.start(c,d),r=!0}var e=q;this.getMotionDelta(v);var f=v.x,j=v.y,k=v.z;return(q||"roll"===w||p&&(0!==f||0!==j||0!==k))&&(q="roll"===w?s.handleRollTouch(x):s.handleRoll(f,j,u)),this.stepMotionDelta(),i.dirty&&(e=!0),e},this.handleResize=function(){s.resize(),q=!0},this.handleGesture=function(a){switch(a.type){case"dragstart":return w="drag",this.handleButtonDown(a,0);case"dragmove":return this.handleMouseMove(a);case"dragend":return w=null,this.handleButtonUp(a,0);case"rotatestart":return b.removeEventListener(Autodesk.Viewing.CAMERA_CHANGE_EVENT,this.handleCameraChange),w="roll",x=THREE.Math.degToRad(a.rotation),y={x:.5*(a.normalizedX+1),y:1-.5*(a.normalizedY+1)},z=d(a),!0;case"rotatemove":return x=THREE.Math.degToRad(a.rotation),"roll"===w;case"rotateend":return b.addEventListener(Autodesk.Viewing.CAMERA_CHANGE_EVENT,this.handleCameraChange),x=THREE.Math.degToRad(a.rotation),w=null,!1}return!1},this.handleWheelInput=function(a){return!0},this.handleCameraChange=function(){var a=h.getEyeVector(),b=.5*(i.near+i.far);a.normalize().multiplyScalar(b);var c=a.add(i.position);s.updateHUD(c,g)},this.handleButtonDown=function(a,c){return t.x=.5*(a.normalizedX+1),t.y=1-.5*(a.normalizedY+1),u.copy(t),p=!0,w=null,this.controller.setIsLocked(!0),b.removeEventListener(Autodesk.Viewing.CAMERA_CHANGE_EVENT,k.handleCameraChange),!0},this.handleButtonUp=function(a,c){return u.x=.5*(a.normalizedX+1),u.y=1-.5*(a.normalizedY+1),p=!1,q=!0,this.controller.setIsLocked(!1),b.addEventListener(Autodesk.Viewing.CAMERA_CHANGE_EVENT,k.handleCameraChange),!0},this.handleMouseMove=function(a){return u.x=.5*(a.normalizedX+1),u.y=1-.5*(a.normalizedY+1),!0},this.handleBlur=function(a){return p=!1,w=null,!1}},AutodeskNamespace("Autodesk.Viewing"),Autodesk.Viewing.ToolInterface=function(){this.names=["unnamed"],this.getNames=function(){return this.names},this.getName=function(){return this.names[0]},this.register=function(){},this.deregister=function(){},this.activate=function(a,b){},this.deactivate=function(a){},this.update=function(a){return!1},this.handleSingleClick=function(a,b){return!1},this.handleDoubleClick=function(a,b){return!1},this.handleSingleTap=function(a){return!1},this.handleDoubleTap=function(a){return!1},this.handleKeyDown=function(a,b){return!1},this.handleKeyUp=function(a,b){return!1},this.handleWheelInput=function(a){return!1},this.handleButtonDown=function(a,b){return!1},this.handleButtonUp=function(a,b){return!1},this.handleMouseMove=function(a){return!1},this.handleGesture=function(a){return!1},this.handleBlur=function(a){return!1},this.handleResize=function(){}},AutodeskNamespace("Autodesk.Viewing");var proto=MobileCallbacks.prototype;proto.animationReady=function(){this.ios?this.iosSend("animationReady"):this.android&&this.androidSend.animationReady()},proto.onSelectionChanged=function(a){this.ios?this.iosSend("selectionChanged",a):this.android&&this.androidSend.onSelectionChanged(a)},proto.onLongTap=function(a,b){this.ios?this.iosSend("onLongTap",[a,b]):this.android&&this.androidSend.onLongTap(a,b)},proto.onSingleTap=function(a,b){this.ios?this.iosSend("onSingleTap",[a,b]):this.android&&this.androidSend.onSingleTap(a,b)},proto.onDoubleTap=function(a,b){this.ios?this.iosSend("onDoubleTap",[a,b]):this.android&&this.androidSend.onDoubleTap(a,b)},proto.setRTCSession=function(a){this.ios?this.iosSend("setRTCSession",{id:a}):this.android&&this.androidSend.setRTCSessionID(a)},proto.putProperties=function(a,b){this.ios?this.iosSend("putProperties",{name:a,value:b}):this.android&&this.androidSend.putProperties(a,b)},proto.onPropertyRetrievedSuccess=function(){this.ios?this.iosSend("onPropertyRetrievedSuccess"):this.android&&this.androidSend.onPropertyRetrievedSuccess()},proto.onPropertyRetrievedFailOrEmptyProperties=function(){this.ios?this.iosSend("onPropertyRetrievedFailOrEmptyProperties"):this.android&&this.androidSend.onPropertyRetrievedFailOrEmptyProperties()},proto.resetAnimationStatus=function(){this.ios?this.iosSend("resetAnimationStatus"):this.android&&this.androidSend.resetAnimationStatus()},proto.setPauseUI=function(){this.ios?this.iosSend("setPauseUI"):this.android&&this.androidSend.setToPaused()},proto.updateAnimationTime=function(a){this.ios?this.iosSend("updateAnimationTime",a):this.android&&this.androidSend.updateAnimationTime(a)},proto.setLoadingProgress=function(a){this.ios?this.iosSend("setLoadingProgress",a):this.android&&this.androidSend.setLoadingProgress(a)},proto.objectTreeCreated=function(){this.ios?this.iosSend("objectTreeCreated"):this.android&&this.androidSend.objectTreeCreated()},proto.geometryLoaded=function(){this.ios?this.iosSend("geometryLoaded"):this.android&&this.androidSend.geometryLoaded()},proto.putSheets=function(a,b){this.ios?this.iosSend("putSheets",[a,b]):this.android&&this.androidSend.putSheets(a,b)},proto.hideLoadingView=function(){this.android&&this.androidSend.hideLoadingView()},AutodeskNamespace("Autodesk.Viewing.Private"),Autodesk.Viewing.Private.formatValueWithUnits=function(a,b,c,d){function e(a){var b=0<=a?Math.floor(a):Math.ceil(a),c=a-b;return{intPart:b,
fracPart:c}}function f(a,b,c){var d="";return c&&0===a&&(d+="-"),d+=0<b?a.toFixed(b):a.toFixed(0)}function g(a,b,c){for(var d="",g=12,h=1,i=a<0,j=0;j<b;++j)h*=2;a>0?a+=.5/h:a-=.5/h;var k,l;c?l=a:(k=e(a/g).intPart,d+=f(k,0,i)+"' ",l=a-k*g,l<0&&(l=-l));var m=e(l).intPart,n=e((l-m)*h).intPart;if(0!==n&&0===m||(d+=f(m,0)),0!==n){for(m<0&&n<0&&(n=-n);n%2===0;)n/=2,h/=2;0!==m&&(d+="-"),d+=f(n,0)+"/"+f(h,0)}return d+='"'}function h(a,b){var c="";a<0&&(c="-",a=Math.abs(a));var d=e(a),g=d.intPart,h=100*d.fracPart;return c+f(g,0)+" m "+f(h,b)+" cm"}function i(a,b){var c="";a<0&&(c="-",a=Math.abs(a));var d=e(a),g=d.intPart,h=12*d.fracPart;return c+f(g,0)+"' "+f(h,b)+'"'}var j;void 0===d&&(d=3);try{if(1===c)j=Autodesk.Viewing.i18n.translate(a?"Yes":"No");else if(24===c){var k=a.split(" ");j=[];for(var l=0;l<k.length;++l)j.push(Autodesk.Viewing.Private.formatValueWithUnits(parseFloat(k[l]),b,3,d));j=j.join(", ")}else 2!==c&&3!==c||!isNaN(a)?"ft-and-fractional-in"===b?j=g(12*a,d):"ft-and-fractional-in^2"===b?j=g(12*a,d)+" "+String.fromCharCode(178):"ft-and-decimal-in"===b?j=i(a,d):"ft-and-decimal-in^2"===b?j=i(a,d)+" "+String.fromCharCode(178):"decimal-in"===b||"in"===b||"inch"===b?j=f(a,d)+'"':"decimal-in^2"===b||"in^2"===b||"inch^2"===b?j=f(a,d)+'" '+String.fromCharCode(178):"decimal-ft"===b||"ft"===b||"feet"===b||"foot"===b?j=f(a,d)+"'":"decimal-ft^2"===b||"ft^2"===b||"feet^2"===b||"foot^2"===b?j=f(a,d)+"' "+String.fromCharCode(178):"fractional-in"===b?j=g(a,d,!0):"fractional-in^2"===b?j=g(a,d,!0)+" "+String.fromCharCode(178):"m-and-cm"===b?j=h(a,d):"m-and-cm^2"===b?j=h(a,d)+" "+String.fromCharCode(178):3===c&&b?(b=b.replace("^2",String.fromCharCode(178)),b=b.replace("^3",String.fromCharCode(179)),j=f(a,d)+" "+b):j=b?a+" "+b:3===c?f(a,d):a:j="NaN"}catch(c){j=b?a+" "+b:a}return j},Autodesk.Viewing.Private.convertUnits=function(a,b,c,d){if(a===b)return c;var e=1;switch(b){case"mm":e=1e3;break;case"cm":e=100;break;case"m":e=1;break;case"in":e=39.37007874;break;case"ft":e=3.280839895;break;case"ft-and-fractional-in":e=3.280839895;break;case"ft-and-decimal-in":e=3.280839895;break;case"decimal-in":e=39.37007874;break;case"decimal-ft":e=3.280839895;break;case"fractional-in":e=39.37007874;break;case"m-and-cm":e=1}var f=1;switch(a){case"mm":f=.001;break;case"cm":f=.01;break;case"m":f=1;break;case"in":f=.0254;break;case"ft":f=.3048;break;case"ft-and-fractional-in":f=.3048;break;case"ft-and-decimal-in":f=.3048;break;case"decimal-in":f=.0254;break;case"decimal-ft":f=.3048;break;case"fractional-in":f=.0254;break;case"m-and-cm":f=1}return"square"===d?c*Math.pow(e*f,2):c*e*f},Autodesk.Viewing.Private.ViewerState=function(a){var b=Autodesk.Viewing.Private,c=!0;this.getState=function(d){var e=a.navigation,f={};f.seedURN=this.getSeedUrn();var g=f.objectSet;Array.isArray(g)||(f.objectSet=g=[]),a.model&&!a.model.is2d()&&(g[0]={id:this.getSelectedNodes(),isolated:a.getIsolatedNodes(),hidden:a.getHiddenNodes(),explodeScale:a.getExplodeScale(),idType:"lmv"}),a.model&&a.model.is2d()&&(g[0]={id:this.getSelectedNodes(),isolated:this.getVisibleLayers2d(),hidden:[],idType:"lmv"});var h=f.viewport;h||(h=f.viewport={});var i=e.getCamera().isPerspective;h.name="",h.eye=e.getPosition().toArray(),h.target=e.getTarget().toArray(),h.up=e.getCamera().up.toArray(),h.worldUpVector=e.getWorldUpVector().toArray(),h.pivotPoint=e.getPivotPoint().toArray(),h.distanceToOrbit=e.getPivotPlaneDistance(),h.aspectRatio=this.getAspectRatio(),h.projection=i?"perspective":"orthographic",h.isOrthographic=!i,i?h.fieldOfView=e.getVerticalFov():h.orthographicHeight=this.getOrthographicHeight();var j=f.renderOptions;if(j||(j=f.renderOptions={}),j.environment=b.LightPresets[a.impl.currentLightPreset()].name,j.ambientOcclusion={enabled:a.impl.renderer().getAOEnabled(),radius:a.impl.renderer().getAORadius(),intensity:a.impl.renderer().getAOIntensity()},j.toneMap={method:a.impl.renderer().getToneMapMethod(),exposure:a.impl.renderer().getExposureBias(),lightMultiplier:this.getToneMapIntensity()},j.appearance={ghostHidden:a.impl.showGhosting,ambientShadow:a.prefs.ambientShadows,antiAliasing:a.impl.renderer().settings.antialias,progressiveDisplay:a.prefs.progressiveRendering,swapBlackAndWhite:a.prefs.swapBlackAndWhite,displayLines:a.prefs.lineRendering},a.model&&!a.model.is2d())for(var k=f.cutplanes=[],l=a.getCutPlanes(),m=0;m<l.length;m++)k.push(l[m].toArray());for(var n in a.loadedExtensions){var o=a.loadedExtensions[n];o.getState&&o.getState(f)}return d&&d!==c&&this.applyFilter(f,d),f},this.restoreState=function(d,e,f){if(!d)return b.logger.warn("restoreState has no viewer state to restore from."),!1;if(!a||!a.model)return b.logger.warn("restoreState has no viewer or model to restore."),!1;e&&e!==c&&(d=JSON.parse(JSON.stringify(d)),this.applyFilter(d,e));var g=a.navigation,h=a.model.is2d(),i=!h;if(Array.isArray(d.objectSet)&&d.objectSet.length>0){var j=d.objectSet[0],k=j.id;if(k&&(k=this.toIntArray(k),a.select(k)),h){var l=j.isolated;Array.isArray(l)&&l.length>0?(a.setLayerVisible(null,!1),a.impl.setLayerVisible(l,!0)):a.setLayerVisible(null,!0)}else{var m=j.isolated||[];if(m=this.toIntArray(m),a.isolate(m),0===m.length){var n=j.hidden||null;n&&n.length>0&&(n=this.toIntArray(n),a.hide(n))}}if("explodeScale"in j){var o=parseFloat(j.explodeScale);a.explode&&a.explode(o)}}var p=d.viewport;if(p){var q=this.getVector3FromArray(p.eye,g.getPosition()),r=this.getVector3FromArray(p.up,g.getCamera().up),s=this.getVector3FromArray(p.target,g.getTarget()),t="fieldOfView"in p?parseFloat(p.fieldOfView):g.getVerticalFov(),u=this.getVector3FromArray(p.worldUpVector,null);if(!u){var v=a.model?a.model.getUpVector():null;u=v?(new THREE.Vector3).fromArray(v):new THREE.Vector3(0,1,0)}var w=this.getVector3FromArray(p.pivotPoint,g.getPivotPoint()),x=g.getCamera().isPerspective;"isOrthographic"in p&&(x=!p.isOrthographic);var y=this.getOrthographicHeight();"orthographicHeight"in p&&(y=Number(p.orthographicHeight));var z={position:q,target:s,up:r,worldup:u,aspect:a.impl.camera.aspect,fov:t,orthoScale:y,isPerspective:x,pivot:w};this.restoreCameraState(z,f)}var A=d.renderOptions;if(A){var B=a.impl.renderer(),C=a.prefs,D=C.ambientShadows,E=C.antialiasing,F=A.ambientOcclusion;if(F){"enabled"in F&&(D=F.enabled);var G="radius"in F?F.radius:null,H="intensity"in F?F.intensity:null;null!==G&&null!==H&&(G===B.getAORadius()&&H===B.getAOIntensity()||(B.setAOOptions(G,H),B.composeFinalFrame()))}if("environment"in A){var I=this.getLightPresetIndex(A.environment);I!==-1&&I!==C.get("lightPreset")&&i&&a.setLightPreset(I)}var J=A.toneMap;if(J){var K=!1,L="exposure"in J?J.exposure:null,M="lightMultiplier"in J?J.lightMultiplier:null;null!==L&&L!==B.getExposureBias()&&(B.setTonemapExposureBias(L),K=!0),null!==M&&a.impl.dir_light1&&M!==this.getToneMapIntensity()&&(a.impl.dir_light1.intensity=Math.pow(2,M),K=!0),K&&a.impl.invalidate(!0)}var N=A.appearance;N&&("antiAliasing"in N&&(E=N.antiAliasing),"progressiveDisplay"in N&&N.progressiveDisplay!==C.get("progressiveRendering")&&a.setProgressiveRendering(N.progressiveDisplay),"swapBlackAndWhite"in N&&N.swapBlackAndWhite!==C.get("swapBlackAndWhite")&&a.setSwapBlackAndWhite(N.swapBlackAndWhite),"ghostHidden"in N&&N.ghostHidden!==C.get("ghosting")&&i&&a.setGhosting(N.ghostHidden),"displayLines"in N&&N.displayLines!==C.get("lineRendering")&&a.hideLines(!N.displayLines)),i&&D!==C.ambientShadows&&E!==C.antialiasing&&a.setQualityLevel(D,E)}if(Array.isArray(d.cutplanes)&&a.model&&i){for(var O=[],P=0;P<d.cutplanes.length;P++){var Q=d.cutplanes[P];Array.isArray(Q)&&Q.length>=4&&O.push(new THREE.Vector4(Q[0],Q[1],Q[2],Q[3]))}a.setCutPlanes(O)}for(var R in a.loadedExtensions){var S=a.loadedExtensions[R];S.restoreState&&S.restoreState(d,f)}return!0},this.restoreCameraState=function(b,c){a.impl.adjustOrthoCamera(b);var d=a.navigation;c?(b.isPerspective?d.toPerspective():d.toOrthographic(),d.setCameraUpVector(b.up),d.setWorldUpVector(b.worldup),d.setView(b.position,b.target),d.setPivotPoint(b.pivot),d.setVerticalFov(b.fov,!1),a.impl.syncCamera(!0)):(a.impl.camera.isPerspective=b.isPerspective,d.setRequestTransitionWithUp(!0,b.position,b.target,b.fov,b.up,b.worldup,b.pivot))},this.areEqual=function(a,b,c){function d(a,b){if(a=a||[],b=b||[],a.length!==b.length)return!1;for(var c=0;c<a.length;++c)if(a[c]!==b[c])return!1;return!0}function e(a,b,c){return a=a||[],b=b||[],a.length===b.length&&(0!==a.length&&(f(a[0],b[0],c)||f(a[1],b[1],c)||f(a[2],b[2],c)))}function f(a,b,c){var d=a?parseFloat(a):null,e=a?parseFloat(b):null,f=typeof d,g=typeof e;return"number"===f&&"number"===g?Math.abs(a-b)<c:(a=a?a:null,b=b?b:null,a===b)}var g=a,h=b,i=1e-9;if(c&&c!==!0&&(g=this.applyFilter(g,c),h=this.applyFilter(h,c)),g.seedURN!==h.seedURN)return!1;var j=g.objectSet||[],k=h.objectSet||[];if(j.length!==k.length)return!1;var l=j[0]||{},m=k[0]||{};if(!(l.idType===m.idType&&f(l.explodeScale,m.explodeScale,i)&&d(l.id,m.id)&&d(l.isolated,m.isolated)&&d(l.hidden,m.hidden)))return!1;var n=g.viewport||{},o=h.viewport||{};return!!(n.name===o.name&&n.projection===o.projection&&n.isOrthographic===o.isOrthographic&&f(n.distanceToOrbit,o.distanceToOrbit,i)&&f(n.aspectRatio,o.aspectRatio,i)&&f(n.fieldOfView,o.fieldOfView,i)&&f(n.orthographicHeight,o.orthographicHeight,i)&&e(n.eye,o.eye,i)&&e(n.target,o.target,i)&&e(n.up,o.up,i)&&e(n.worldUpVector,o.worldUpVector,i)&&e(n.pivotPoint,o.pivotPoint,i))},this.toIntArray=function(a){var b=[];if(Array.isArray(a))for(var c=0,d=a.length;c<d;++c)b.push(parseInt(a[c]));return b},this.extractSelectedNodeIds=function(a){if(a&&Array.isArray(a.objectSet)&&a.objectSet.length>0){var b=a.objectSet[0];return this.toIntArray(b.id)}return[]},this.extractIsolatedNodeIds=function(a){if(a&&Array.isArray(a.objectSet)&&a.objectSet.length>0){var b=a.objectSet[0];return this.toIntArray(b.isolated)}return[]},this.getVector3FromArray=function(a,b){return a instanceof Array&&a.length>2?(a[0]=parseFloat(a[0]),a[1]=parseFloat(a[1]),a[2]=parseFloat(a[2]),(new THREE.Vector3).fromArray(a)):b},this.getSelectedNodes=function(){return a.impl&&a.impl.selector?a.impl.selector.getSelection():[]},this.getVisibleLayers2d=function(){var b=[],c=a.impl.matman(),d=c.layersMap;for(var e in d)d.hasOwnProperty(e)&&c.isLayerVisible(e)&&b.push(e);return b},this.getAspectRatio=function(){var b=a.navigation.getScreenViewport(),c=b.width/b.height;return c},this.getOrthographicHeight=function(){var b=a.navigation.getCamera();return b.isPerspective?0:Math.abs(2*b.orthographicCamera.top)},this.getSeedUrn=function(){return a.model&&a.model.loader?a.model.loader.svfUrn||"":""},this.getToneMapIntensity=function(){var b=0;return a.impl.dir_light1&&(b=0!=a.impl.dir_light1.intensity?Math.log(a.impl.dir_light1.intensity)/Math.log(2):-1e-20),b},this.getLightPresetIndex=function(a){for(var c=0;c<b.LightPresets.length;c++)if(b.LightPresets[c].name===a)return c;return-1},this.applyFilter=function(a,c){if(c!==!0)for(var d in a)if(a.hasOwnProperty(d)){var e=c[d];void 0===e?(delete a[d],b.logger.log("[applyFilter] C - skipping key ["+d+"] from viewerState; unspecified in filter.")):"boolean"==typeof e?e===!1&&(delete a[d],b.logger.log("[applyFilter] D - skipping key ["+d+"] from viewerState; explicit filtering.")):e instanceof Object?a[d]instanceof Object?this.applyFilter(a[d],c[d]):b.logger.warn("[applyFilter] A - Invalid filter Object for key ["+d+"]"):b.logger.warn("[applyFilter] B - Invalid filter value for key ["+d+"]")}}},Autodesk.Viewing.Private.ViewerState.prototype.constructor=Autodesk.Viewing.Private.ViewerState,Autodesk.Viewing.Private.Preferences=function(a,b){function c(){var a=b.prefix+"test";try{var c=window.localStorage;return c.setItem(a,"1"),c.removeItem(a),!0}catch(a){return!1}}function d(a,c){if(l){if(m.hasTag(a,"no-storage"))return;var d=b.prefix+a;return"undefined"!=typeof c?localStorage[d]=c:c=localStorage[d],c}}function e(a,b){if("string"!=typeof a||"function"==typeof m[a])return void h.logger.log("Preferences: invalid name="+a);var c=d(a),e=!1;if(void 0!==c)try{c=JSON.parse(c),e=!0}catch(a){}m[a]=e?c:b,k[a]={}}function f(a){l&&(a=b.prefix+a,delete localStorage[a])}"string"==typeof b&&(b={prefix:b}),b||(b={}),b.prefix||(b.prefix="Autodesk.Viewing.Preferences."),b.hasOwnProperty("localStorage")||(b.localStorage=!0);var g=Autodesk.Viewing,h=Autodesk.Viewing.Private,i={},j={},k={},l=b.localStorage&&c(),m=this;a.addEventListener(g.PREF_CHANGED_EVENT,function(a){var b=j[a.name];if(b){var c=b.changed;c&&c(a.value)}}),a.addEventListener(g.PREF_RESET_EVENT,function(a){var b=j[a.name];if(b){var c=b.reset;c&&c(a.value)}}),this.load=function(a){i=a;for(var b in i)i.hasOwnProperty(b)&&e(b,i[b])},this.tag=function(a,b){if(a){b?Array.isArray(b)||(b=[b]):b=Object.keys(i);for(var c=0;c<b.length;++c)k[b[c]][a]=!0}},this.untag=function(a,b){if(a){b?Array.isArray(b)||(b=[b]):b=Object.keys(i);for(var c=0;c<b.length;++c)k[b[c]][a]=!1}},this.hasTag=function(a,b){var c=k[a];return!!c&&c[b]===!0},this.add=function(a,b,c){if(!i.hasOwnProperty(a)){if(i[a]=b,e(a,b),c){Array.isArray(c)||(c=[c]);for(var d=0;d<c.length;++d)this.tag(c[d],a)}return!0}return h.logger.log("Preferences: "+a+" already exists"),!1},this.remove=function(a,b){return!!i.hasOwnProperty(a)&&(delete i[a],delete k[a],delete this[a],b&&f(a),!0)},this.reset=function(b,c){b&&void 0===c&&(c=!0);for(var d in i)if(i.hasOwnProperty(d)){if(b){var e=!!k[d][b];if(c&&!e||!c&&e)continue}this.set(d,i[d],!1)&&a.fireEvent({type:g.PREF_RESET_EVENT,name:d,value:this[d]}),f(d)}},this.get=function(a){return this[a]},this.set=function(b,c,e){return this[b]!==c&&(this[b]=c,d(b,c),(void 0===e||e)&&a.fireEvent({type:g.PREF_CHANGED_EVENT,name:b,value:c}),h.logger.track({category:"pref_changed",name:b,value:c}),!0)},this.addListeners=function(a,b,c){j[a]={changed:b,reset:c}},this.removeListeners=function(a){void 0!==j[a]&&delete j[a]}},function(){"use strict";var a=function(a,b){this.viewer=a,this.options=b,this.id=""};a.prototype.load=function(){return!0},a.prototype.unload=function(){return!0},a.prototype.getState=function(a){},a.prototype.restoreState=function(a,b){return!0},a.prototype.getCache=function(){this.viewer.extensionCache||(this.viewer.extensionCache={},Autodesk.Viewing.Private.logger.warn("Extension cache runtime creation; missing ViewingApplication context."));var a=this.viewer.extensionCache[this.id];return a||(a=this.viewer.extensionCache[this.id]={}),a},Autodesk.Viewing.Extension=a}(),function(){"use strict";var a=Autodesk.Viewing,b=a.Private,c=function(){function a(a,b){return!d.hasOwnProperty(a)&&(d[a]=b,!0)}function b(a){return d.hasOwnProperty(a)?d[a]:null}function c(a){return!!d.hasOwnProperty(a)&&(delete d[a],!0)}var d={};return{registerExtension:a,getExtension:b,unregisterExtension:c}},d=new c,e=function(){};e.prototype={loadExtension:function(c,e){this.loadedExtensions||(this.loadedExtensions={});var f=!1;if(this.getExtension(c))b.logger.info("Extension already loaded: "+c);else{var g=d.getExtension(c);if(g){var h=new g(this,e);h.id=c,f=h.load(),f&&(this.loadedExtensions[c]=h,b.logger.info("Extension loaded: "+c),this.fireEvent({type:a.EXTENSION_LOADED_EVENT,extensionId:c}))}else b.logger.warn("Extension not found: "+c)}return f},getExtension:function(a){return this.loadedExtensions&&a in this.loadedExtensions?this.loadedExtensions[a]:null},unloadExtension:function(c){var d=!1,e=this.getExtension(c);return e?(d=e.unload(),b.logger.info("Extension unloaded: "+c),delete this.loadedExtensions[c],this.fireEvent({type:a.EXTENSION_UNLOADED_EVENT,extensionId:c})):b.logger.warn("Extension not found: "+c),d},apply:function(a){var b=e.prototype;a.loadExtension=b.loadExtension,a.getExtension=b.getExtension,a.unloadExtension=b.unloadExtension}},Autodesk.Viewing.theExtensionManager=d,Autodesk.Viewing.ExtensionMixin=e}(),function(){"use strict";function a(a,e,f){if(a.urlPattern=f.urn,a.tileSize=f.tileSize?f.tileSize:512,a.texWidth=f.resolution[0],a.texHeight=f.resolution[1],a.paperWidth=f.paperWidth,a.paperHeight=f.paperHeight,a.paperUnits=f.paperUnits,a.levelOffset=c.LeafletLoader.computeLevelOffset(a.tileSize),c.offline&&b.isMobileDevice()){var g=d.getSubItemsWithProperties(e,{role:"leaflet-zip"},!1);g.length>0&&(a.maxLevel=g[0].max_level-a.levelOffset)}}var b=Autodesk.Viewing,c=Autodesk.Viewing.Private,d=function(a,b,d){function e(a){if(a){var b,d=a.children?a.children.length:0;if("geometry"===a.type&&d){var f=0;for(b=0;b<d;b++){var h=a.children[b];h&&"view"===h.type&&(g.myViewGeometry[h.guid]=a,f++)}g.myNumViews[a.guid]=f}else if("application/autodesk-db"==a.mime&&a.urn)0===a.urn.indexOf(c.ViewingService.OSS_PREFIX)?g.myPropertyDb=a.urn.substr(0,a.urn.lastIndexOf("%2F")+3):g.myPropertyDb=a.urn.substr(0,a.urn.lastIndexOf("/")+1);else if(0<d)for(b=0;b<d;b++)e(a.children[b])}}function f(a){if(a)for(var b=a.children?a.children.length:0,c=0;c<b;c++)a.children[c].parent=a,f(a.children[c])}this.myPath=b,this.myData=a,this.myViewGeometry={},this.myNumViews={},this.myPropertyDb=null,this.acmSessionId=d;var g=this;e(a),f(this.myData)};d.prototype.constructor=d,d.load=function(a,e,f,g){function h(a){if(a.indexOf("urn:")===-1){if(a.indexOf("://")!==-1)return a;var b=a;return"undefined"!=typeof window?(0!==b.indexOf("/")&&(b="/"+b),window.location.protocol+"//"+window.location.host+b):b}return a}function i(a){var b=d.getSubItemsWithProperties(a.getRootItem(),{type:"folder",role:"viewable"},!0),c=b[0],e=d.getSubItemsWithProperties(c,{type:"geometry"},!0);return e.length}function j(a,b){var c=[],d=0,e=0;b=b||"children";var f=function(a){var g=a[b]||[],h=a.messages||[],i=h.filter(function(a){return"error"===a.type});i.length>0&&(d+=1),"inprogress"===a.status&&(e+=1),Array.prototype.push.apply(c,h.slice(0));for(var j=g.length;j--;f(g[j]));};f(a);var g="translated";g=d>0?"failed":g,g=e>0?"processing":g;for(var h=c.length;h--;c[h].$translation=g);return c}function k(g){function l(a){var c=/<[^>]*script/;if(c.test(a))return void(f&&f(b.ErrorCodes.BAD_DATA,"Malicious document content detected Abort loading"));var h="string"==typeof a?JSON.parse(a):a,k=new d(h,o,g),l=i(k);if(l>0)n=j(k.getRootItem()),e&&e(k,n);else if(f){n=j(k.getRootItem());var m=b.ErrorCodes.BAD_DATA_NO_VIEWABLE_CONTENT,p="No viewable content";f(m,p,n)}}function m(a,d,e){if(401===a&&void 0===LMV_THIRD_PARTY_COOKIE)LMV_THIRD_PARTY_COOKIE=!1,c.refreshRequestHeader(c.token.accessToken),k(g);else{var h=j(e);if(f){var i="Error: "+a+" ("+d+")",l=b.Private.ErrorHandler.getErrorCode(a);f(l,i,a,d,h)}}}var n,o=h(a),p={queryParams:g?"acmsession="+g:""};c.ViewingService.getManifest(c.initLoadContext(p),o,l,m)}"function"!=typeof arguments[1]&&(c.logger.warn("Document.load called with deprecated (auth) parameter"),"function"==typeof arguments[2]&&(e=arguments[2]),"function"==typeof arguments[3]&&(f=arguments[3])),g?c.ViewingService.getACMSession(b.getApiEndpoint(),g,k,f):k()},d.requestThumbnailWithSecurity=function(a,b){var d=function(a){b(null,a)},e=function(){b("error",null)},f={responseType:"blob",skipAssetCallback:!0,size:a.width,guid:a.guid},g="urn:"+a.urn;c.ViewingService.getThumbnail(c.initLoadContext(),g,d,e,f)},d.prototype.getFullPath=function(a){if(!a)return a;var d=a;return c.offline?d=decodeURIComponent(b.Private.offlineResourcePrefix)+d.substr(d.indexOf("/")):0===a.indexOf("urn")?d=b.getItemApi()+a:0===a.indexOf("$file$")&&this.myPath.indexOf("/bubble.json")!==-1&&(d=this.myPath.replace("/bubble.json","")+a.replace("$file$","")),d},d.prototype.getThumbnailOptions=function(a,b,c){var d=b?b:200,e=c?c:200;return{urn:this.myData.urn,width:d,height:e,guid:encodeURIComponent(a.guid),acmsession:this.acmSessionId}},d.prototype.getThumbnailPath=function(a,c,d){var e=this.getThumbnailOptions(a,c,d),f=b.getThumbnailApi()+e.urn+"?guid="+e.guid+"&width="+e.width+"&height="+e.height;return e.acmsession&&(f+="&acmsession="+e.acmsession),f},d.prototype.getViewablePath=function(b,c){if("geometry"===b.type){var e=[];if("3d"===b.role?e=d.getSubItemsWithProperties(b,{mime:"application/autodesk-svf"},!1):"2d"===b.role&&(e=d.getSubItemsWithProperties(b,{role:"leaflet"},!1),e.length>0&&c&&a(c,b,e[0]),0===e.length&&(e=d.getSubItemsWithProperties(b,{mime:"application/autodesk-f2d"},!1)),0===e.length&&(e=d.getSubItemsWithProperties(b,{role:"tileRoot"},!0))),e.length>0)return this.getFullPath(e[0].urn)}else if("view"===b.type){var f=this.getViewGeometry(b);if(f)return this.getViewablePath(f)}return""},d.prototype.getPropertyDbPath=function(){return this.myPropertyDb},d.prototype.getRootItem=function(){return this.myData},d.prototype.getPath=function(){return this.myPath},d.prototype.getItemById=function(a){function b(c){if(!c)return null;for(var d in c){var e=c[d];if("guid"===d&&e===a)return c;if(null!==e&&"object"==typeof e&&"parent"!==d){var f=b(e);if(f)return f}}return null}return b(this.myData)},d.getSubItemsWithProperties=function(a,b,c){function e(a,b){for(var c in b)if(!(c in a)||b[c]!==a[c])return!1;return!0}var f=[];if(!a)return[];for(var g=a.children?a.children.length:0,h=0;h<g;h++){var i=a.children[h];e(i,b)&&f.push(i),c&&f.push.apply(f,d.getSubItemsWithProperties(i,b,c))}return f},d.prototype.getViewGeometry=function(a){return this.myViewGeometry[a.guid]},d.prototype.getNumViews=function(a){return this.myNumViews[a.guid]||0},d.prototype.getParentId=function(a){var b=this.getItemById(a);if(!b)return null;var c=b.parent;return c?c.guid:null},d.prototype.getMessages=function(a,b){var c=[];if(!a)return c;var d=null;b&&(d=this.getRootItem());for(var e=a;e&&(!b||parent!==d);){if(e.messages)for(var f=0;f<e.messages.length;f++)c.push(e.messages[f]);e=e.parent}return c},b.Document=d}(),function(){"use strict";function a(a){for(var b=0;b<f.length;++b)document.addEventListener(f[b],a,!1)}function b(a){for(var b=0;b<f.length;++b)document.removeEventListener(f[b],a,!1)}function c(b){this.viewer=b,this.bindFullscreenEventListener=this.fullscreenEventListener.bind(this),this.getMode()===d.ScreenMode.kFullScreen&&a(this.bindFullscreenEventListener)}var d=Autodesk.Viewing,e=d.Private,f=["fullscreenchange","mozfullscreenchange","webkitfullscreenchange","MSFullscreenChange"];d.ScreenMode={kNormal:0,kFullBrowser:1,kFullScreen:2},d.ScreenModeDelegate=c,c.prototype.uninitialize=function(){b(this.bindFullscreenEventListener),this.viewer=null},c.prototype.isModeSupported=function(a){return!0},c.prototype.setMode=function(a){var b=this.getMode();return!(a===b||!this.isModeSupported(a))&&(this.doScreenModeChange(b,a),this.onScreenModeChanged(b,a),!0)},c.prototype.getMode=function(){throw"Implement getMode() in derived class"},c.prototype.getNextMode=function(){var a,b=this.getMode(),c=d.ScreenMode;return b===c.kNormal&&this.isModeSupported(c.kFullBrowser)?a=c.kFullBrowser:b===c.kNormal&&this.isModeSupported(c.kFullScreen)?a=c.kFullScreen:b===c.kFullBrowser&&this.isModeSupported(c.kFullScreen)?a=c.kFullScreen:b===c.kFullBrowser&&this.isModeSupported(c.kNormal)?a=c.kNormal:b===c.kFullScreen&&this.isModeSupported(c.kNormal)?a=c.kNormal:b===c.kFullScreen&&this.isModeSupported(c.kFullBrowser)&&(a=c.kFullBrowser),a},c.prototype.getEscapeMode=function(){return this.getMode()!==d.ScreenMode.kNormal?d.ScreenMode.kNormal:void 0},c.prototype.fullscreenEventListener=function(){if(d.inFullscreen())this.viewer.resize();else{var a=d.ScreenMode;this.doScreenModeChange(a.kFullScreen,a.kNormal),this.onScreenModeChanged(a.kFullScreen,a.kNormal)}},c.prototype.doScreenModeChange=function(a,b){throw"Implement doScreenModeChange() in derived class"},c.prototype.onScreenModeChanged=function(c,e){c===d.ScreenMode.kFullScreen?b(this.bindFullscreenEventListener):e===d.ScreenMode.kFullScreen&&a(this.bindFullscreenEventListener),this.viewer.resize(),this.viewer.fireEvent({type:d.FULLSCREEN_MODE_EVENT,mode:e})},d.AppScreenModeDelegate=function(a){d.ScreenModeDelegate.call(this,a)},d.AppScreenModeDelegate.prototype=Object.create(d.ScreenModeDelegate.prototype),d.AppScreenModeDelegate.prototype.constructor=d.AppScreenModeDelegate,d.AppScreenModeDelegate.prototype.isModeSupported=function(a){return a!==d.ScreenMode.kFullBrowser},d.AppScreenModeDelegate.prototype.getMode=function(){return d.inFullscreen()?d.ScreenMode.kFullScreen:d.ScreenMode.kNormal},d.AppScreenModeDelegate.prototype.doScreenModeChange=function(a,b){var c=this.viewer.container;b===d.ScreenMode.kNormal?(c.classList.remove("viewer-fill-browser"),d.exitFullscreen()):b===d.ScreenMode.kFullScreen&&(c.classList.add("viewer-fill-browser"),d.launchFullscreen(c))},d.ApplicationScreenModeDelegate=d.AppScreenModeDelegate,d.NullScreenModeDelegate=function(a){d.ScreenModeDelegate.call(this,a)},d.NullScreenModeDelegate.prototype=Object.create(d.ScreenModeDelegate.prototype),d.NullScreenModeDelegate.prototype.constructor=d.ScreenModeDelegate,d.NullScreenModeDelegate.prototype.isModeSupported=function(a){return!1},d.NullScreenModeDelegate.prototype.getMode=function(){return d.ScreenMode.kNormal},d.ScreenModeMixin=function(){},d.ScreenModeMixin.prototype={setScreenModeDelegate:function(a){this.screenModeDelegate&&(this.screenModeDelegate.uninitialize(),this.screenModeDelegate=null),a?this.screenModeDelegateClass=a:null===a?this.screenModeDelegateClass=d.NullScreenModeDelegate:this.screenModeDelegateClass=d.AppScreenModeDelegate},getScreenModeDelegate:function(){return this.screenModeDelegate||(this.screenModeDelegate=new this.screenModeDelegateClass(this)),this.screenModeDelegate},isScreenModeSupported:function(a){return this.getScreenModeDelegate().isModeSupported(a)},canChangeScreenMode:function(){return this.isScreenModeSupported(Autodesk.Viewing.ScreenMode.kNormal)},setScreenMode:function(a){var b={category:"screen_mode",value:a};return e.logger.track(b),this.getScreenModeDelegate().setMode(a)},getScreenMode:function(){return this.getScreenModeDelegate().getMode()},nextScreenMode:function(){var a=this.getScreenModeDelegate().getNextMode();return void 0!==a&&this.setScreenMode(a)},escapeScreenMode:function(){var a=this.getScreenModeDelegate().getEscapeMode();return void 0!==a&&this.setScreenMode(a)},apply:function(a){var b=d.ScreenModeMixin.prototype;a.setScreenModeDelegate=b.setScreenModeDelegate,a.getScreenModeDelegate=b.getScreenModeDelegate,a.isScreenModeSupported=b.isScreenModeSupported,a.canChangeScreenMode=b.canChangeScreenMode,a.setScreenMode=b.setScreenMode,a.getScreenMode=b.getScreenMode,a.nextScreenMode=b.nextScreenMode,a.escapeScreenMode=b.escapeScreenMode}}}(),function(){"use strict";var a=Autodesk.Viewing,b=a.Private;a.ESCAPE_EVENT="escape",a.PROGRESS_UPDATE_EVENT="progress",a.FULLSCREEN_MODE_EVENT="fullScreenMode",a.NAVIGATION_MODE_CHANGED_EVENT="navmode",a.VIEWER_STATE_RESTORED_EVENT="viewerStateRestored",a.VIEWER_RESIZE_EVENT="viewerResize",a.VIEWER_INITIALIZED="viewerInitialized",a.VIEWER_UNINITIALIZED="viewerUninitialized",a.MODEL_ROOT_LOADED_EVENT="svfLoaded",a.GEOMETRY_LOADED_EVENT="geometryLoaded",a.OBJECT_TREE_CREATED_EVENT="propertyDbLoaded",a.OBJECT_TREE_UNAVAILABLE_EVENT="propertyDbUnavailable",a.MODEL_UNLOADED_EVENT="modelUnloaded",a.EXTENSION_LOADED_EVENT="extensionLoaded",a.EXTENSION_UNLOADED_EVENT="extensionUnloaded",a.SELECTION_CHANGED_EVENT="selection",a.AGGREGATE_SELECTION_CHANGED_EVENT="aggregateSelection",a.ISOLATE_EVENT="isolate",a.HIDE_EVENT="hide",a.SHOW_EVENT="show",a.CAMERA_CHANGE_EVENT="cameraChanged",a.EXPLODE_CHANGE_EVENT="explodeChanged",a.CUTPLANES_CHANGE_EVENT="cutplanesChanged",a.TOOL_CHANGE_EVENT="toolChanged",a.RENDER_OPTION_CHANGED_EVENT="renderOptionChanged",a.LAYER_VISIBILITY_CHANGED_EVENT="layerVisibility",a.RESET_EVENT="reset",a.PREF_CHANGED_EVENT="PrefChanged",a.PREF_RESET_EVENT="PrefReset",a.ANIMATION_READY_EVENT="animationReady",a.HYPERLINK_EVENT="hyperlink",a.LOAD_GEOMETRY_EVENT="load_geometry",a.NAVIGATION_MODE={ORBIT:0,PAN:1,DOLLY:2,ROLL:3,FOV:4,TOUCH_PAN_DOLLY:5,TOUCH_ROLL:6,OTHER:7};var c=a.isMobileDevice(),d=0;a.DefaultSettings={ambientShadows:!0,antialiasing:!c,groundShadow:!0,groundReflection:!1,progressiveRendering:!0,swapBlackAndWhite:!1,openPropertiesOnSelect:!1,ghosting:!0,viewCube:!c,lineRendering:!0,lightPreset:b.DefaultLightPreset,backgroundColorPreset:null,reverseMouseZoomDir:!1,reverseHorizontalLookDirection:!1,reverseVerticalLookDirection:!1,alwaysUsePivot:!1,zoomTowardsPivot:!1,orbitPastWorldPoles:!0,leftHandedMouseSetup:!1,clickToSetCOI:!1,optimizeNavigation:c,fusionOrbit:!0,fusionOrbitConstrained:!0,useFirstPersonNavigation:!0,envMapBackground:!1,renderPrism:!0,firstPersonToolPopup:!0};var e=function(c,e){if("undefined"==typeof THREE&&b.logger.warn("Initializing LMV without the THREE.js dependency is not supported.","Call Autodesk.Viewing.Initializer() first or preload the dependencies manually."),c){if(this.clientContainer=c,this.container=document.createElement("div"),this.container.className="adsk-viewing-viewer",this.container.style.height="100%",this.container.style.width="100%",this.container.style.overflow="hidden",this.container.classList.add(a.isTouchDevice()?"touch":"notouch"),this.clientContainer.appendChild(this.container),this.config=e,this.contextMenu=null,this.contextMenuCallbacks={},this.__firefoxLMBfix=!1,this.started=!1,"CANVAS"===this.container.nodeName)throw"Viewer must be initialized on a div [temporary]";this.canvasWrap=document.createElement("div"),this.canvasWrap.classList.add("canvas-wrap"),this.canvas=document.createElement("canvas"),this.canvas.tabIndex=0,this.canvasWrap.appendChild(this.canvas),this.container.appendChild(this.canvasWrap),this.canvas.viewer=this;var f={prefix:"Autodesk.Viewing.Private.GuiViewer3D.SavedSettings.",localStorage:!0};this.prefs=new b.Preferences(this,f)}this.extensionCache=null,this.running=!1,this._pushedTool="",this._defaultNavigationTool="",this.id=d++,this.impl=new b.Viewer3DImpl(this.canvas,this)};e.prototype.constructor=e,a.EventDispatcher.prototype.apply(e.prototype),a.ScreenModeMixin.prototype.apply(e.prototype),a.ExtensionMixin.prototype.apply(e.prototype),e.ScreenMode=a.ScreenMode,e.kDefaultCanvasConfig={click:{onObject:["selectOnly"],offObject:["deselectAll"]},clickAlt:{onObject:["setCOI"],offObject:["setCOI"]},clickCtrl:{onObject:["selectToggle"],offObject:["deselectAll"]},clickShift:{onObject:["selectToggle"],offObject:["deselectAll"]},disableSpinner:!1,disableMouseWheel:!1,disableTwoFingerSwipe:!1},e.prototype.start=function(a,b,c,d){if(this.started)return 0;this.started=!0;var e=this,f=e.initialize();return 0!==f?(d&&setTimeout(function(){d(f)},1),f):(setTimeout(function(){e.setUp(e.config)},1),a&&this.loadModel(a,b,c,d),0)},e.prototype.registerUniversalHotkeys=function(){var b,c,d,e=this,f=a.theHotkeyManager.KEYCODES;b=function(){return e.navigation.setRequestFitToView(!0),!0},a.theHotkeyManager.pushHotkeys("Autodesk.FitToView",[{keycodes:[f.f],onPress:b}]),b=function(){return e.navigation.setRequestHomeView(!0),!0},a.theHotkeyManager.pushHotkeys("Autodesk.Home",[{keycodes:[f.h],onPress:b},{keycodes:[f.HOME],onPress:b}]),c=function(){return!(!e.objectContextMenu||!e.objectContextMenu.hide())||(e.fireEvent({type:a.ESCAPE_EVENT}),!0)},a.theHotkeyManager.pushHotkeys("Autodesk.Escape",[{keycodes:[f.ESCAPE],onRelease:c}]),b=function(){return d=e.getActiveNavigationTool(),e.setActiveNavigationTool("pan")},c=function(){return e.setActiveNavigationTool(d)};var g=[{keycodes:[f.SHIFT],onPress:b,onRelease:c},{keycodes:[f.SPACE],onPress:b,onRelease:c}];a.theHotkeyManager.pushHotkeys("Autodesk.Pan",g,{tryUntilSuccess:!0})},e.prototype.createControls=function(){var b=this,c=b.impl;return b.navigation=new a.Navigation(c.camera),b.__initAutoCam(c),b.utilities=new a.ViewingUtilities(c,b.autocam,b.navigation),b.clickHandler=new a.DefaultHandler(c,b.navigation,b.utilities),b.toolController=new a.ToolController(c,b,b.autocam,b.utilities,b.clickHandler),b.toolController.registerTool(new a.GestureHandler(b)),b.toolController.registerTool(a.theHotkeyManager),b.toolController.activateTool(a.theHotkeyManager.getName()),b.registerUniversalHotkeys(),b.toolController.registerTool(new a.OrbitDollyPanTool(c,b)),b.toolController.activateTool("gestures"),b.toolController},e.prototype.initialize=function(){this.setScreenModeDelegate(this.config?this.config.screenModeDelegate:void 0);
var c=this.getDimensions();if(this.canvas.width=c.width,this.canvas.height=c.height,a.isIOSDevice()&&window.devicePixelRatio&&(this.canvas.width/=window.devicePixelRatio,this.canvas.height/=window.devicePixelRatio),this.impl.initialize(),!this.impl.glrenderer()){var d=a.detectWebGL();if(d<=0)return d===-1?a.ErrorCodes.BROWSER_WEBGL_NOT_SUPPORTED:a.ErrorCodes.BROWSER_WEBGL_DISABLED}var f=this;this.onResizeCallback=function(a){f.resize()},window.addEventListener("resize",this.onResizeCallback,!1),this.initContextMenu(),this.localize(),this.impl.controls=this.createControls(),this.setDefaultNavigationTool("orbit"),this.model=null,this.impl.controls&&this.impl.controls.setAutocam(this.autocam);var g=this.config&&this.config.canvasConfig?this.config.canvasConfig:e.kDefaultCanvasConfig;if(this.setCanvasClickBehavior(g),!g.disableSpinner){this.loadSpinner=document.createElement("div"),this.loadSpinner.className="spinner",this.container.appendChild(this.loadSpinner);for(var h=1;h<=3;h++){var i=document.createElement("div");i.className="bounce"+h,this.loadSpinner.appendChild(i)}}return this.initSettings(),this.viewerState=new b.ViewerState(this),this.config&&this.config.hasOwnProperty("startOnInitialize")&&!this.config.startOnInitialize||this.run(),window.NOP_VIEWER=this,this.fireEvent(a.VIEWER_INITIALIZED),0},e.prototype.setUp=function(a){if(this.config=a,this.config&&this.config.hasOwnProperty("extensions"))for(var b=this.config.extensions,c=0;c<b.length;++c)this.loadExtension(b[c],this.config);var d=this.config&&this.config.canvasConfig?this.config.canvasConfig:e.kDefaultCanvasConfig;this.setCanvasClickBehavior(d)},e.prototype.tearDown=function(){if(this.clearSelection(),this.loadedExtensions){for(var a in this.loadedExtensions)try{this.unloadExtension(a)}catch(c){b.logger.error("Failed to unload extension: "+a,c),b.logger.track({category:"error_unload_extension",extensionId:a,error_message:c.message,call_stack:c.stack})}this.loadedExtensions=null}b.logger.reportRuntimeStats(!0),this.loadSpinner&&(this.loadSpinner.style.display="block"),this.model=null,this.liveReviewClient&&(this.liveReviewClient.destroy(),this.liveReviewClient=null),this.impl.unloadCurrentModel()},e.prototype.run=function(){this.running||(this.resize(),this.running=!0,this.impl.run())},e.prototype.localize=function(){a.i18n.localize()},e.prototype.__initAutoCam=function(a){function c(a){e.autocamCamera.isPerspective!==f.isPerspective&&(e.autocamCamera.isPerspective?e.navigation.toPerspective():e.navigation.toOrthographic()),e.navigation.setVerticalFov(e.autocamCamera.fov,!1),e.navigation.setView(e.autocamCamera.position,e.autocamCamera.target),e.navigation.setPivotPoint(e.autocamCamera.pivot),e.navigation.setCameraUpVector(e.autocamCamera.up),a&&e.navigation.setWorldUpVector(e.autocamCamera.worldup),e.impl.syncCamera(a)}function d(a){e.utilities?e.utilities.pivotActive(a,!1):e.impl.controls.pivotActive(a,!1)}var e=this,f=a.camera;f.pivot||(f.pivot=new THREE.Vector3(0,0,0)),f.target||(f.target=new THREE.Vector3(0,0,0)),f.worldup||(f.worldup=f.up.clone()),e.autocamCamera=f.clone(),e.autocamCamera.target=f.target.clone(),e.autocamCamera.pivot=f.pivot.clone(),e.autocamCamera.worldup=f.worldup.clone(),e.autocam=new b.Autocam(e.autocamCamera,e.navigation),e.autocam.cameraChangedCallback=c,e.autocam.pivotDisplayCallback=d,e.autocam.canvas=e.canvas,e.addEventListener("cameraChanged",function(a){var b=a.camera;e.autocam.sync(b)}),e.autocam.sync(f)},e.prototype.uninitialize=function(){window.removeEventListener("resize",this.onResizeCallback,!1),this.onResizeCallback=null,this.canvas.parentNode.removeChild(this.canvas),this.canvas.viewer=null,this.canvas=null,this.canvasWrap=null,this.viewerState=null,b.logger.reportRuntimeStats(),b.logger.track({category:"viewer_destroy"},!0),this.toolController&&(this.toolController.uninitialize(),this.toolController=null,this.clickHandler=null,this.utilities=null),this.navigation&&(this.navigation.uninitialize(),this.navigation=null),this.impl&&(this.impl.dtor(),this.impl=null),this.loadSpinner=null,this.model=null,this.prefs=null,this.autocam.dtor(),this.autocam=null,this.autocamCamera=null,a.theHotkeyManager.popHotkeys("Autodesk.FitToView"),a.theHotkeyManager.popHotkeys("Autodesk.Home"),a.theHotkeyManager.popHotkeys("Autodesk.Escape"),a.theHotkeyManager.popHotkeys("Autodesk.Pan"),a.theHotkeyManager.popHotkeys("Autodesk.Orbit"),this.onDefaultContextMenu&&(this.container.removeEventListener("contextmenu",this.onDefaultContextMenu,!1),this.onDefaultContextMenu=null),this.screenModeDelegate&&(this.screenModeDelegate.uninitialize(),this.screenModeDelegate=null),this.extensionCache=null,this.clientContainer=null,this.config=null,this.listeners={},this.contextMenu=null,this.contextMenuCallbacks=null,this.viewCubeUi&&(this.viewCubeUi.uninitialize(),this.viewCubeUi=null),this.container&&this.container.parentNode&&this.container.parentNode.removeChild(this.container),this.container=null,this.fireEvent(a.VIEWER_UNINITIALIZED),this.listeners={},b.logger.log("viewer destroy")},e.prototype.finish=function(){this.tearDown(),this.uninitialize()},e.prototype.load=function(a,b,c,d,e,f){var g={ids:null,sharedPropertyDbPath:b,acmSessionId:e,loadOptions:f};return this.loadModel(a,g,c,d)},e.prototype.loadModel=function(b,c,d,e,f){function g(){if(a.theHotkeyManager)if(k.model.is2d())a.theHotkeyManager.popHotkeys("Autodesk.Orbit");else{var b,c=function(){return b=k.getActiveNavigationTool(),k.setActiveNavigationTool("orbit")},d=function(){return k.setActiveNavigationTool(b)},e=[{keycodes:[a.theHotkeyManager.KEYCODES.ALT],onPress:c,onRelease:d}];a.theHotkeyManager.pushHotkeys("Autodesk.Orbit",e,{tryUntilSuccess:!0})}}function h(a){k.model=a,k.impl.addModel(k.model),k.loadSpinner&&(k.loadSpinner.style.display="None"),k.model.is2d()&&k.activateLayerState("Initial"),g(),d&&d(k.model)}function i(a,b,c,d){k.loadSpinner&&(k.loadSpinner.style.display="None"),e&&e(a,b,c,d)}function j(){k.impl.needsRender=!0,k.removeEventListener(a.GEOMETRY_LOADED_EVENT,j)}var k=this;c=c||{},this.addEventListener(a.GEOMETRY_LOADED_EVENT,j);var l,m=b.toLowerCase().match(/\.([a-z0-9]+)(\?|$)/),n=m?m[1]:null;return l=c&&c.fileLoader?c.fileLoader:a.FileLoaderManager.getFileLoaderForExtension(n),new l(this.impl).loadFile(b,c,h,i,f)},e.prototype.getDimensions=function(){if(this.container){var b={};return this.getScreenMode()===a.ScreenMode.kFullScreen?(b.width=screen.width,b.height=screen.height):b=this.container.getBoundingClientRect(),{width:b.width,height:b.height}}return null},e.prototype.resize=function(){return this.impl.resize(this.container.clientWidth,this.container.clientHeight)},e.prototype.getCamera=function(){return this.impl.camera},e.prototype.getState=function(a){return this.viewerState.getState(a)},e.prototype.restoreState=function(b,c,d){var e=this.viewerState.restoreState(b,c,d);return e&&this.fireEvent({type:a.VIEWER_STATE_RESTORED_EVENT,value:e}),e},e.prototype.setViewFromArray=function(a,b){this.setActiveNavigationTool("orbit");var c=this.model?this.model.getData().globalOffset:{x:0,y:0,z:0},d={position:new THREE.Vector3(a[0]-c.x,a[1]-c.y,a[2]-c.z),target:new THREE.Vector3(a[3]-c.x,a[4]-c.y,a[5]-c.z),up:new THREE.Vector3(a[6],a[7],a[8]),aspect:a[9],fov:THREE.Math.radToDeg(a[10]),orthoScale:a[11],isPerspective:!a[12]};this.impl.setViewFromCamera(d)},e.prototype.setViewFromViewBox=function(a,c){var d=this.model;if(d&&!d.is2d())return void b.logger.warn("Viewer3D.setViewFromViewBox is not applicable to 3D");if(c&&c.length){var e,f=d.getData().metadata,g=f.views;for(e=0;e<g.length&&g[e].name!=c;e++);if(e<g.length){var h=g[e].layer_state;h&&this.activateLayerState(h)}}this.impl.setViewFromViewBox(this.model,a,c,!1)},e.prototype.activateLayerState=function(b){if(b&&b.length){var c=this.model.getData().metadata,d=c?c.layer_states:null;if(!d)return;var e;for(e=0;e<d.length&&d[e].name!=b;e++);if(e<d.length){var f=d[e],g=f.visible_layers,h={};if(g&&0<g.length)for(var i=0;i<g.length;i++)h[g[i]]=1;var j=[],k=[];for(var l in c.layers){var m=c.layers[l].name;1===h[m]?j.push(l):k.push(l)}this.impl.setLayerVisible(j,!0),this.impl.setLayerVisible(k,!1),this.fireEvent({type:a.LAYER_VISIBILITY_CHANGED_EVENT})}}},e.prototype.getLayerStates=function(){function a(a,b){var c=Object.getOwnPropertyNames(a),d=Object.getOwnPropertyNames(b);if(c.length!==d.length)return!1;for(var e=0;e<c.length;++e){var f=c[e];if(a[f]!==b[f])return!1}return!0}var b=this.model,c=b?b.getData().metadata:null,d=c?c.layers:null,e=c?c.layer_states:null;if(!d||!e)return null;var f,g={},h={};for(var i in d)if(d.hasOwnProperty(i)){var j=parseInt(i),k=d[i];f="string"==typeof k?k:k.name,g[f]=!0,this.impl.isLayerVisible(j)&&(h[f]=!0)}var l,m,n=[];for(l=0;l<e.length;++l){var o=e[l],p=o.visible_layers,q={};if(!o.hidden){if(p&&0<p.length)for(m=0;m<p.length;++m)f=p[m],g.hasOwnProperty(f)&&(q[f]=!0);n.push({name:o.name,description:o.description,active:a(h,q)})}}return 0<n.length?n:null},e.prototype.setViewFromFile=function(){this.setActiveNavigationTool(),this.impl.setViewFromFile(this.model)},e.prototype.getProperties=function(c,d,e){b.logger.track({name:"get_props_count",aggregate:"count"}),this.model?this.model.getProperties(c,d,e):e&&e(a.ErrorCodes.BAD_DATA,"Properties failed to load since model does not exist")},e.prototype.getObjectTree=function(b,c){this.model?this.model.getObjectTree(b,c):c&&c(a.ErrorCodes.BAD_DATA,"ObjectTree failed to load since model does not exist")},e.prototype.setCanvasClickBehavior=function(a){if(this.impl.controls.hasOwnProperty("setClickBehavior")&&this.impl.controls.setClickBehavior(a),this.clickHandler&&this.clickHandler.setClickBehavior(a),a&&a.disableMouseWheel&&this.toolController.setMouseWheelInputEnabled(!1),a&&a.disableTwoFingerSwipe){var b=this.toolController.getTool("gestures");b&&b.disableTwoFingerSwipe()}},e.prototype.search=function(b,c,d,e,f){this.searchText=b,this.model?this.model.search(b,c,d,e,f):d&&d(a.ErrorCodes.BAD_DATA,"Search failed since model does not exist")},e.prototype.getHiddenNodes=function(){return this.impl.visibilityManager.getHiddenNodes()},e.prototype.getIsolatedNodes=function(){return this.model&&this.model.is2d()?(b.logger.warn("Viewer3D.getIsolatedNodes is not yet implemented for 2D"),[]):this.impl.visibilityManager.getIsolatedNodes()},e.prototype.isolate=function(a){if(this.model){var c=this.model.getData();if(c&&c.is2d&&c.loadDone&&"hasObjectProperties"in c)this.impl.visibilityManager.isolate(a);else{var d=this;this.model.getObjectTree(function(){b.logger.track({name:"isolate_count",aggregate:"count"}),d.impl.visibilityManager.isolate(a)})}}},e.prototype.isolateById=function(a){return b.logger.warn("isolateById() is deprecated. Use isolate() instead."),this.isolate(a)},e.prototype.setBackgroundColor=function(a,b,c,d,e,f){this.impl.setClearColors(a,b,c,d,e,f)},e.prototype.toggleSelect=function(a){return this.model&&this.model.is2d()?void b.logger.warn("Viewer3D.toggleSelect is not yet implemented for 2D"):void this.impl.selector.toggleSelection(a)},e.prototype.select=function(a){"number"==typeof a&&(a=[a]),this.impl.selector.setSelection(a)},e.prototype.clearSelection=function(){this.impl.selector.clearSelection(),b.logger.track({name:"clearselection",aggregate:"count"})},e.prototype.getSelectionVisibility=function(){return this.impl.selector.getSelectionVisibility()},e.prototype.getSelectionCount=function(){return this.impl.selector.getSelectionLength()},e.prototype.setSelectionMode=function(a){this.impl.selector.setSelectionMode(a)},e.prototype.getSelection=function(){return this.impl.selector.getSelection()},e.prototype.getAggregateSelection=function(a){var b=this.impl.selector.getAggregateSelection();if(a)for(var c=0;c<b.length;c++)for(var d=0;d<b[c].selection.length;d++)a(b[c].model,b[c].selection[d]);return b},e.prototype.hide=function(a){b.logger.track({name:"hide",aggregate:"count"}),this.impl.visibilityManager.hide(a)},e.prototype.hideById=function(a){this.hide(a)},e.prototype.show=function(a){this.impl.visibilityManager.show(a)},e.prototype.showAll=function(){this.impl.visibilityManager.isolate(),this.model.is2d()&&this.setLayerVisible(null,!0),b.logger.track({name:"showall",aggregate:"count"})},e.prototype.toggleVisibility=function(a){this.impl.visibilityManager.toggleVisibility(a)},e.prototype.areAllVisible=function(){return this.impl.isWholeModelVisible(this.model)},e.prototype.explode=function(a){return this.model&&this.model.is2d()?void b.logger.warn("Viewer3D.explode is not applicable to 2D"):(b.logger.track({name:"explode_count",aggregate:"count"}),void this.impl.explode(a))},e.prototype.getExplodeScale=function(){return this.model&&this.model.is2d()?(b.logger.warn("Viewer3D.getExplodeScale is not applicable to 2D"),0):this.impl.getExplodeScale()},e.prototype.setQualityLevel=function(a,c){return this.model&&this.model.is2d()?void b.logger.warn("Viewer3D.setQualityLevel is not applicable to 2D"):(this.prefs.set("ambientShadows",a),this.prefs.set("antialiasing",c),void this.impl.togglePostProcess(a,c))},e.prototype.setGhosting=function(a){return this.model&&this.model.is2d()?void b.logger.warn("Viewer3D.setGhosting is not applicable to 2D"):(this.prefs.set("ghosting",a),void this.impl.toggleGhosting(a))},e.prototype.setGroundShadow=function(a){return this.model&&this.model.is2d()?void b.logger.warn("Viewer3D.setGroundShadow is not applicable to 2D"):(this.prefs.set("groundShadow",a),void this.impl.toggleGroundShadow(a))},e.prototype.setGroundReflection=function(a){return this.model&&this.model.is2d()?void b.logger.warn("Viewer3D.setGroundReflection is not applicable to 2D"):(this.prefs.set("groundReflection",a),void this.impl.toggleGroundReflection(a))},e.prototype.setEnvMapBackground=function(a){return this.model&&this.model.is2d()?void b.logger.warn("Viewer3D.setEnvMapBackground is not applicable to 2D"):(this.prefs.set("envMapBackground",a),void this.impl.toggleEnvMapBackground(a))},e.prototype.setRenderPrism=function(a){return this.model&&this.model.is2d()?void b.logger.warn("Viewer3D.setRenderPrism is not applicable to 2D"):(this.prefs.set("renderPrism",a),void this.impl.toggleRenderPrism(a))},e.prototype.setFirstPersonToolPopup=function(a){return this.model&&this.model.is2d()?void b.logger.warn("Viewer3D.setFirstPersonToolPopup is not applicable to 2D"):void this.prefs.set("firstPersonToolPopup",a)},e.prototype.getFirstPersonToolPopup=function(){return this.model&&this.model.is2d()?void b.logger.warn("Viewer3D.getFirstPersonToolPopup is not applicable to 2D"):this.prefs.firstPersonToolPopup},e.prototype.setProgressiveRendering=function(a){this.prefs.set("progressiveRendering",a),this.impl.toggleProgressive(a)},e.prototype.setSwapBlackAndWhite=function(a){this.prefs.set("swapBlackAndWhite",a),this.impl.toggleSwapBlackAndWhite(a)},e.prototype.setOptimizeNavigation=function(a){return this.model&&this.model.is2d()?void b.logger.warn("Viewer3D.setOptimizeNaviation is not applicable to 2D"):(this.prefs.set("optimizeNavigation",a),void this.impl.setOptimizeNavigation(a))},e.prototype.setNavigationLock=function(b){this.navigation.getIsLocked()!==b&&(this.navigation.setIsLocked(b),this.fireEvent({type:a.NAVIGATION_MODE_CHANGED_EVENT,id:this.getActiveNavigationTool()}))},e.prototype.getNavigationLock=function(){return this.navigation.getIsLocked()},e.prototype.setNavigationLockSettings=function(b){this.navigation.setLockSettings(b),this.fireEvent({type:a.NAVIGATION_MODE_CHANGED_EVENT,id:this.getActiveNavigationTool()})},e.prototype.getNavigationLockSettings=function(){return this.navigation.getLockSettings()},e.prototype.setActiveNavigationTool=function(b){if(b===this._pushedTool||!b&&!this._pushedTool)return!0;if(this._pushedTool){if(!this.impl.controls.deactivateTool(this._pushedTool))return!1;this.impl.controls.setToolActiveName(this.getDefaultNavigationToolName()),this._pushedTool=null}var c=!b||b===this.getDefaultNavigationToolName();return c&&null===this._pushedTool?(this.fireEvent({type:a.NAVIGATION_MODE_CHANGED_EVENT,id:this.getDefaultNavigationToolName()}),!0):!!this.impl.controls.activateTool(b)&&(this._pushedTool=b,this.fireEvent({type:a.NAVIGATION_MODE_CHANGED_EVENT,id:this._pushedTool}),!0)},e.prototype.getActiveNavigationTool=function(){return this._pushedTool?this._pushedTool:this._defaultNavigationTool},e.prototype.setDefaultNavigationTool=function(a){this._defaultNavigationTool&&this.impl.controls.deactivateTool(this._defaultNavigationTool),this._pushedTool&&this.impl.controls.deactivateTool(this._pushedTool),this.impl.controls.activateTool(a),this._defaultNavigationTool=a,this._pushedTool&&this.impl.controls.activateTool(this._pushedTool)},e.prototype.getDefaultNavigationToolName=function(){return this._defaultNavigationTool},e.prototype.getFOV=function(){return this.navigation.getVerticalFov()},e.prototype.setFOV=function(a){this.navigation.setVerticalFov(a,!0)},e.prototype.getFocalLength=function(){return this.navigation.getFocalLength()},e.prototype.setFocalLength=function(a){this.navigation.setFocalLength(a,!0)},e.prototype.hideLines=function(b){function c(){d.impl.hideLines(b),d.removeEventListener(a.GEOMETRY_LOADED_EVENT,c)}this.prefs.set("lineRendering",!b);var d=this;this.impl.hideLines(b)||this.addEventListener(a.GEOMETRY_LOADED_EVENT,c)},e.prototype.applyCamera=function(a,b){this.impl.setViewFromCamera(a,!0),b&&this.fitToView()},e.prototype.fitToView=function(c){var d=this,e=!0,f=d.model,g=function(){var b=null;if(Array.isArray(c)&&c.length>0){for(var i=new THREE.Box3,j=new THREE.Box3,k=f.getData().instanceTree,l=f.getFragmentList(),m=0;m<c.length;m++)k.enumNodeFragments(c[m],function(a){l.getWorldBounds(a,j),i.union(j)},!0);i.empty()||(b=i)}return b&&!b.empty()||(b=d.impl.getFitBounds()),d.navigation.fitBounds(!1,b),d.removeEventListener(a.OBJECT_TREE_CREATED_EVENT,h),d.removeEventListener(a.GEOMETRY_LOADED_EVENT,g),e},h=function(){f&&f.isLoadDone()?g():(e=!1,d.addEventListener(a.GEOMETRY_LOADED_EVENT,g))},i=f.getData().propertydb,j=i&&i.attrs.length>0;b.logger.track({name:"fittoview",aggregate:"count"}),!f.is2d()&&j&&null!==c&&void 0!==c?f&&f.isObjectTreeCreated()?h():(e=!1,this.addEventListener(a.OBJECT_TREE_CREATED_EVENT,h)):this.navigation.fitBounds(!1,this.impl.getFitBounds(!0))},e.prototype.setClickConfig=function(a,b,c){var d=this.clickHandler?this.clickHandler.getClickBehavior():this.impl.controls.getClickBehavior();if(a in d){var e=d[a];if(b in e)return e[b]=c,!0}return!1},e.prototype.getClickConfig=function(a,b){var c=this.clickHandler?this.clickHandler.getClickBehavior():this.impl.controls.getClickBehavior();if(a in c){var d=c[a];if(b in d)return d[b]}return null},e.prototype.setClickToSetCOI=function(a,b){b!==!1&&this.prefs.set("clickToSetCOI",a);var c=this.getClickConfig("click","onObject");a?c.indexOf("setCOI")===-1&&this.setClickConfig("click","onObject",["setCOI"]):c.indexOf("setCOI")>=0&&this.setClickConfig("click","onObject",["selectOnly"])},e.prototype.initSettings=function(){this.prefs.load(a.DefaultSettings),this.prefs.tag("3d"),this.prefs.tag("2d"),this.prefs.untag("2d",["viewCube","alwaysUsePivot","zoomTowardsPivot","reverseHorizontalLookDirection","reverseVerticalLookDirection","orbitPastWorldPoles","clickToSetCOI","ghosting","optimizeNavigation","ambientShadows","antialiasing","groundShadow","groundReflection","lineRendering","lightPreset","envMapBackground","renderPrism","firstPersonToolPopup"]),this.prefs.untag("3d",["swapBlackAndWhite"]),this.setQualityLevel(this.prefs.ambientShadows,this.prefs.antialiasing),this.setGroundShadow(this.prefs.groundShadow),this.setGroundReflection(this.prefs.groundReflection),this.setGhosting(this.prefs.ghosting),this.setProgressiveRendering(this.prefs.progressiveRendering),this.setSwapBlackAndWhite(this.prefs.swapBlackAndWhite),this.setClickToSetCOI(this.prefs.clickToSetCOI),this.setOptimizeNavigation(this.prefs.optimizeNavigation),this.hideLines(!this.prefs.lineRendering),this.setEnvMapBackground(this.prefs.envMapBackground),this.setRenderPrism(this.prefs.renderPrism),this.setFirstPersonToolPopup(this.prefs.firstPersonToolPopup),this.navigation.setUsePivotAlways(this.prefs.alwaysUsePivot),this.navigation.setReverseZoomDirection(this.prefs.reverseMouseZoomDir),this.navigation.setReverseHorizontalLookDirection(this.prefs.reverseHorizontalLookDirection),this.navigation.setReverseVerticalLookDirection(this.prefs.reverseVerticalLookDirection),this.navigation.setZoomTowardsPivot(this.prefs.zoomTowardsPivot),this.navigation.setOrbitPastWorldPoles(this.prefs.orbitPastWorldPoles),this.navigation.setUseLeftHandedInput(this.prefs.leftHandedMouseSetup);var b=this.prefs.backgroundColorPreset;if(b)try{var c=JSON.parse(b);this.impl.setClearColors(c[0],c[1],c[2],c[3],c[4],c[5])}catch(a){this.prefs.set("backgroundColorPreset",null)}var d=this.prefs.lightPreset;this.impl.setLightPreset(d)},e.prototype.setLightPreset=function(a){return this.model&&this.model.is2d()?void b.logger.warn("Viewer3D.setLightPreset is not applicable to 2D"):(this.prefs.set("lightPreset",a),void this.impl.setLightPreset(a))},e.prototype.setUsePivotAlways=function(a){this.prefs.set("alwaysUsePivot",a),this.navigation.setUsePivotAlways(a)},e.prototype.setReverseZoomDirection=function(a){this.prefs.set("reverseMouseZoomDir",a),this.navigation.setReverseZoomDirection(a)},e.prototype.setReverseHorizontalLookDirection=function(a){return this.model&&this.model.is2d()?void b.logger.warn("Viewer3D.setReverseHorizontalLookDirection is not applicable to 2D"):(this.prefs.set("reverseHorizontalLookDirection",a),void this.navigation.setReverseHorizontalLookDirection(a))},e.prototype.setReverseVerticalLookDirection=function(a){return this.model&&this.model.is2d()?void b.logger.warn("Viewer3D.setReverseVerticalLookDirection is not applicable to 2D"):(this.prefs.set("reverseVerticalLookDirection",a),void this.navigation.setReverseVerticalLookDirection(a))},e.prototype.setZoomTowardsPivot=function(a){this.prefs.set("zoomTowardsPivot",a),this.navigation.setZoomTowardsPivot(a)},e.prototype.setOrbitPastWorldPoles=function(a){return this.model&&this.model.is2d()?void b.logger.warn("Viewer3D.setOrbitPastWorldPoles is not applicable to 2D"):(this.prefs.set("orbitPastWorldPoles",a),void this.navigation.setOrbitPastWorldPoles(a))},e.prototype.setUseLeftHandedInput=function(a){this.prefs.set("leftHandedMouseSetup",a),this.navigation.setUseLeftHandedInput(a)},e.prototype.setLayerVisible=function(c,d,e){function f(a,b){var c=[];if(a.isLayer)c.push(a.index);else if(a.children)for(var d=a.children,e=0;e<d.length;++e)c=c.concat(f(d[e]));return c}if(this.model&&!this.model.is2d())return void b.logger.warn("Viewer3D.setLayerVisible is not yet implemented for 3D");var g=this,h=g.model.getLayersRoot();if(h&&0!==h.childCount){null===c&&(c=[h]),Array.isArray(c)||(c=[c]),e&&(g.impl.setLayerVisible(f(h),!1),d=!0);for(var i=[],j=0;j<c.length;++j)i=i.concat(f(c[j]));g.impl.setLayerVisible(i,d),g.fireEvent({type:a.LAYER_VISIBILITY_CHANGED_EVENT})}},e.prototype.isLayerVisible=function(a){return this.model&&!this.model.is2d()?(b.logger.warn("Viewer3D.isLayerVisible is not yet implemented for 3D"),!1):!!(a&&a.isLayer&&this.impl.isLayerVisible(a.index))},e.prototype.anyLayerHidden=function(){function a(b){if(b.isLayer)return!c.impl.isLayerVisible(b.index);for(var d=b.children,e=0;e<d.length;++e)if(a(d[e]))return!0;return!1}if(this.model&&!this.model.is2d())return b.logger.warn("Viewer3D.anyLayerHidden is not yet implemented for 3D"),!1;var c=this,d=c.model.getLayersRoot();return!(!d||!a(d))},e.prototype.setGroundShadowColor=function(a){return this.model&&this.model.is2d()?void b.logger.warn("Viewer3D.setGroundShadowColor is not applicable to 2D"):void this.impl.setGroundShadowColor(a)},e.prototype.setGroundShadowAlpha=function(a){return this.model&&this.model.is2d()?void b.logger.warn("Viewer3D.setGroundShadowAlpha is not applicable to 2D"):void this.impl.setGroundShadowAlpha(a)},e.prototype.setGroundReflectionColor=function(a){return this.model&&this.model.is2d()?void b.logger.warn("Viewer3D.setGroundReflectionColor is not applicable to 2D"):void this.impl.setGroundReflectionColor(a)},e.prototype.setGroundReflectionAlpha=function(a){return this.model&&this.model.is2d()?void b.logger.warn("Viewer3D.setGroundReflectionAlpha is not applicable to 2D"):void this.impl.setGroundReflectionAlpha(a)},e.prototype.getCutPlanes=function(){return this.model&&this.model.is2d()?(b.logger.warn("Viewer3D.getCutPlanes is not applicable to 2D"),[]):this.impl.getCutPlanes()},e.prototype.setCutPlanes=function(a){return this.model&&this.model.is2d()?void b.logger.warn("Viewer3D.getCutPlanes is not applicable to 2D"):void this.impl.setCutPlanes(a)},e.prototype.getScreenShot=function(a,b,c){return this.impl.getScreenShot(a,b,c)},e.prototype.getScreenShotBuffer=function(a,b,c){return this.impl.getScreenShotBuffer(a,b,c)},e.prototype.setContextMenu=function(a){this.contextMenu&&this.contextMenu.hide(),this.contextMenu=a||null},e.prototype.setDefaultContextMenu=function(){var a=Autodesk.Viewing.Extensions;return!(!a||!a.ViewerObjectContextMenu)&&(this.setContextMenu(new a.ViewerObjectContextMenu(this)),!0)},e.prototype.triggerContextMenu=function(a){return this.config&&this.config.onTriggerContextMenuCallback&&this.config.onTriggerContextMenuCallback(a),!!this.contextMenu&&(this.contextMenu.show(a),!0)},e.prototype.triggerSelectionChanged=function(a){this.config&&this.config.onTriggerSelectionChangedCallback&&this.config.onTriggerSelectionChangedCallback(a)},e.prototype.triggerDoubleTapCallback=function(a){this.config&&this.config.onTriggerDoubleTapCallback&&this.config.onTriggerDoubleTapCallback(a)},e.prototype.triggerSingleTapCallback=function(a){this.config&&this.config.onTriggerSingleTapCallback&&this.config.onTriggerSingleTapCallback(a)},e.prototype.initContextMenu=function(){function a(a){var b=a.button;"buttons"in a&&(!c.__firefoxLMBfix||1&a.buttons?2===b&&1&a.buttons&&(b=0,c.__firefoxLMBfix=!0):(c.__firefoxLMBfix=!1,b=0));var d=!!c.navigation&&c.navigation.getUseLeftHandedInput(),e=d?0:2;return b===e}var b=!this.config||!this.config.hasOwnProperty("disableBrowserContextMenu")||this.config.disableBrowserContextMenu;b&&(this.onDefaultContextMenu=function(a){a.preventDefault()},this.container.addEventListener("contextmenu",this.onDefaultContextMenu,!1));var c=this,d=this.canvas||this.container;d.addEventListener("mousedown",function(b){a(b)&&(c.startX=b.clientX,c.startY=b.clientY)}),d.addEventListener("mouseup",function(b){return a(b)&&b.clientX===c.startX&&b.clientY===c.startY&&c.triggerContextMenu(b),!0},!1)},e.prototype.registerContextMenuCallback=function(a,b){this.contextMenuCallbacks[a]=b},e.prototype.unregisterContextMenuCallback=function(a){return a in this.contextMenuCallbacks&&(delete this.contextMenuCallbacks[a],!0)},e.prototype.runContextMenuCallbacks=function(a,b){for(var c in this.contextMenuCallbacks)this.contextMenuCallbacks.hasOwnProperty(c)&&this.contextMenuCallbacks[c](a,b)},e.prototype.playAnimation=function(a){var b=this.impl.keyFrameAnimator;b&&b.play(0,a)},e.prototype.joinLiveReview=function(a){this.liveReviewClient||(this.liveReviewClient=new b.LiveReviewClient(this));var c=this.liveReviewClient;b.loadDependency("lmv_io","socket.io-1.3.5.js",function(){c.joinLiveReviewSession(a)})},e.prototype.leaveLiveReview=function(){this.liveReviewClient&&this.liveReviewClient.leaveLiveReviewSession()},e.prototype.setModelUnits=function(a){this.model&&(this.model.getData().overriddenUnits=a)},e.prototype.worldToClient=function(a){return this.impl.worldToClient(a)},e.prototype.clientToWorld=function(a,b,c){return this.impl.clientToWorld(a,b,c)},e.prototype.modelHasTopology=function(){return!(!this.model||!this.model.getData().topology)},e.prototype.setSelectionColor=function(a){this.impl.setSelectionColor(a)},e.prototype.createViewCube=function(){this.viewCubeUi||(this.viewCubeUi=new b.ViewCubeUi(this)),this.viewCubeUi.create()},e.prototype.displayViewCube=function(a){this.viewCubeUi&&this.viewCubeUi.displayViewCube(a,!1)},e.prototype.displayViewCubeUI=function(a){this.viewCubeUi&&this.viewCubeUi.display(a)},e.prototype.setViewCube=function(a){this.viewCubeUi&&this.viewCubeUi.cube&&this.viewCubeUi.cube.cubeRotateTo(a)},e.prototype.setThemingColor=function(a,b,c){c=c||this.model,c.setThemingColor(a,b),this.impl.invalidate(!0)},e.prototype.clearThemingColors=function(a){a=a||this.model,a.clearThemingColors(),this.impl.invalidate(!0)},e.prototype.transferModel=function(a,b){var c=this.impl.findModel(a);if(c){var d=[];this.getAggregateSelection(function(b,c){b.id==a&&d.push(c)});var e=this.impl.visibilityManager.getIsolatedNodes(c),f=this.impl.visibilityManager.getHiddenNodes(c),g=this.impl.matman().exportModelMaterials(c);this.impl.removeModel(c),b.model=c,b.impl.addModel(c),b.impl.matman().importModelMaterials(g),b.loadSpinner&&(b.loadSpinner.style.display="None"),c.loader&&c.loader.viewer3DImpl===this.impl&&(c.loader.viewer3DImpl=b.impl),c.getData().loadDone&&b.impl.onLoadComplete(c),b.impl.selector.setSelection(d,c),0!=e.length?b.impl.visibilityManager.isolate(e,c):0!=f.length&&b.impl.visibilityManager.hide(f,c)}},Autodesk.Viewing.Viewer3D=e}();var av=Autodesk.Viewing;av.ErrorCodes={UNKNOWN_FAILURE:1,BAD_DATA:2,NETWORK_FAILURE:3,NETWORK_ACCESS_DENIED:4,NETWORK_FILE_NOT_FOUND:5,NETWORK_SERVER_ERROR:6,NETWORK_UNHANDLED_RESPONSE_CODE:7,BROWSER_WEBGL_NOT_SUPPORTED:8,BAD_DATA_NO_VIEWABLE_CONTENT:9,BROWSER_WEBGL_DISABLED:10,BAD_DATA_MODEL_IS_EMPTY:11,RTC_ERROR:12},function(){"use strict";function a(a,b){function c(a,b,c,d,e,f,g){var h=.5*(c-a),i=.5*(d-b);return(2*(b-c)+h+i)*g+(-3*(b-c)-2*h-i)*f+h*e+b}var d,e,f,g,h,i,j,k,l,m=[],n=[];return d=(a.length-1)*b,e=Math.floor(d),f=d-e,m[0]=0===e?e:e-1,m[1]=e,m[2]=e>a.length-2?e:e+1,m[3]=e>a.length-3?e:e+2,i=a[m[0]],j=a[m[1]],k=a[m[2]],l=a[m[3]],g=f*f,h=f*g,n[0]=c(i[0],j[0],k[0],l[0],f,g,h),n[1]=c(i[1],j[1],k[1],l[1],f,g,h),n[2]=c(i[2],j[2],k[2],l[2],f,g,h),n}var b=Autodesk.Viewing.Private,c={LINEAR:0,CATMULLROM:1,CATMULLROM_FORWARD:2},d=function(){this.animations=[]};d.prototype.init=function(a){if(a.initialized===!0)return a;for(var b=0;b<a.hierarchy.length;b++){for(var c=0;c<a.hierarchy[b].keys.length;c++)if(a.hierarchy[b].keys[c].time<0&&(a.hierarchy[b].keys[c].time=0),void 0!==a.hierarchy[b].keys[c].rot&&!(a.hierarchy[b].keys[c].rot instanceof THREE.Quaternion)){var d=a.hierarchy[b].keys[c].rot;Array.isArray(d)||(d=[d._x,d._y,d._z,d._w]),a.hierarchy[b].keys[c].rot=(new THREE.Quaternion).fromArray(d)}for(var c=1;c<a.hierarchy[b].keys.length;c++)a.hierarchy[b].keys[c].time===a.hierarchy[b].keys[c-1].time&&(a.hierarchy[b].keys.splice(c,1),c--);for(var c=0;c<a.hierarchy[b].keys.length;c++)a.hierarchy[b].keys[c].index=c}return a.initialized=!0,a},d.prototype.parse=function(a){function b(a,c){if(c.push(a),a.children&&!(a instanceof THREE.Camera))for(var d=0;d<a.children.length;d++)b(a.children[d],c)}var c=[];return b(a,c),c},d.prototype.play=function(a){this.animations.indexOf(a)===-1&&this.animations.push(a)},d.prototype.stop=function(a){var b=this.animations.indexOf(a);b!==-1&&this.animations.splice(b,1)},d.prototype.update=function(a){for(var b=0;b<this.animations.length;b++)this.animations[b].update(a)};var e=function(a,b,d){this.root=a,this.handler=d.animationHandler,this.data=this.handler.init(b),this.hierarchy=this.handler.parse(a),this.viewer=d.viewer,this.animator=d,this.currentTime=0,this.timeScale=1,this.isPlaying=!1,this.isPaused=!0,this.loop=!1,this.delta=.5,this.interpolationType=c.LINEAR,this.setStartAndEndKeyTime()};e.prototype.setStartAndEndKeyTime=function(){if(this.data.hierarchy.length>0){var a=this.data.hierarchy[0].keys;this.startKeyTime=a[0].time,this.endKeyTime=a[a.length-1].time}else this.startKeyTime=this.endKeyTime=0},e.prototype.keyTypes=[],e.prototype.defaultKey={},e.prototype.play=function(a){this.currentTime=void 0!==a?a:0,this.isPlaying=!0,this.isPaused=!1,this.reset(),this.handler.play(this)},e.prototype.pause=function(){this.isPaused===!0?this.handler.play(this):this.handler.stop(this),
this.isPaused=!this.isPaused},e.prototype.stop=function(){this.isPlaying=!1,this.isPaused=!1,this.handler.stop(this)},e.prototype.goto=function(a){this.isPlaying||this.play(),this.isPaused||this.pause();var b=a-this.currentTime;this.update(b)},e.prototype.reset=function(){for(var a=0,b=this.hierarchy.length;a<b;a++){var c=this.hierarchy[a];void 0===c.animationCache&&(c.animationCache={}),void 0===c.animationCache[this.data.name]&&(c.animationCache[this.data.name]={prevKey:this.defaultKey,nextKey:this.defaultKey,originalMatrix:c.matrix});for(var d=c.animationCache[this.data.name],e=0;e<this.keyTypes.length;e++){for(var f=this.keyTypes[e],g=this.data.hierarchy[a].keys[0],h=this.getNextKeyWith(f,a,1);h.time<this.currentTime&&h.index>g.index;)g=h,h=this.getNextKeyWith(f,a,h.index+1);d.prevKey[f]=g,d.nextKey[f]=h}}this.setStartAndEndKeyTime()},e.prototype.getNextKeyWith=function(a,b,d){var e=this.data.hierarchy[b].keys;for(this.interpolationType===c.CATMULLROM||this.interpolationType===c.CATMULLROM_FORWARD?d=d<e.length-1?d:e.length-1:d%=e.length;d<e.length;d++)if(void 0!==e[d][a])return e[d];return this.data.hierarchy[b].keys[0]},e.prototype.getPrevKeyWith=function(a,b,d){var e=this.data.hierarchy[b].keys;for(d=this.interpolationType===c.CATMULLROM||this.interpolationType===c.CATMULLROM_FORWARD?d>0?d:0:d>=0?d:d+e.length;d>=0;d--)if(void 0!==e[d][a])return e[d];return this.data.hierarchy[b].keys[e.length-1]},e.prototype.isPlayingOutOfRange=function(){return this.isPaused===!1&&(this.currentTime<this.startKeyTime-this.delta||this.currentTime>this.endKeyTime+this.delta)},e.prototype.resetIfLooped=function(){this.loop===!0&&this.currentTime>this.endKeyTime&&(this.currentTime%=this.endKeyTime,this.reset())};var f=function(a,b,c){e.call(this,a,b,c),this.localMatrix=new THREE.Matrix4,this.root.getAnimTransform(),this.relativeTransform=!b.custom||!b.custom.transform||"abs"!==b.custom.transform};f.prototype=Object.create(e.prototype),f.prototype.constructor=f,f.prototype.keyTypes=["pos","rot","scl"],f.prototype.defaultKey={pos:0,rot:0,scl:0},f.prototype.update=function(){function b(){d||(d=new THREE.Vector3,e=new THREE.Vector3,f=new THREE.Quaternion,g=new THREE.Matrix4,h=new THREE.Matrix4)}var d,e,f,g,h,i=[];return function(j){if(this.isPlaying!==!1&&(this.currentTime+=j*this.timeScale,b(),this.resetIfLooped(),!this.isPlayingOutOfRange()))for(var k=0,l=this.hierarchy.length;k<l;k++){for(var m=this.hierarchy[k],n=m.animationCache[this.data.name],o=0;o<this.keyTypes.length;o++){var p=this.keyTypes[o],q=n.prevKey[p],r=n.nextKey[p];if(r.time<=this.currentTime||q.time>=this.currentTime){for(q=this.data.hierarchy[k].keys[0],r=this.getNextKeyWith(p,k,1);r.time<this.currentTime&&r.index>q.index;)q=r,r=this.getNextKeyWith(p,k,r.index+1);n.prevKey[p]=q,n.nextKey[p]=r}var s=q[p],t=r[p];if(r.time!==q.time&&void 0!==s&&void 0!==t){var u=(this.currentTime-q.time)/(r.time-q.time);if(u<0&&(u=0),u>1&&(u=1),"pos"===p)if(this.interpolationType===c.LINEAR)e.x=s[0]+(t[0]-s[0])*u,e.y=s[1]+(t[1]-s[1])*u,e.z=s[2]+(t[2]-s[2])*u,m.position.copy(e);else{i[0]=this.getPrevKeyWith("pos",k,q.index-1).pos,i[1]=s,i[2]=t,i[3]=this.getNextKeyWith("pos",k,r.index+1).pos,u=.33*u+.33;var v=a(i,u);if(e.x=v[0],e.y=v[1],e.z=v[2],m.position.copy(e),this.interpolationType===c.CATMULLROM_FORWARD){var w=a(i,1.01*u);d.set(w[0],w[1],w[2]),d.sub(vector),d.y=0,d.normalize();var x=Math.atan2(d.x,d.z);m.rotation.set(0,x,0)}}else"rot"===p?(THREE.Quaternion.slerp(s,t,f,u),m.quaternion.copy(f)):"scl"===p&&(e.x=s[0]+(t[0]-s[0])*u,e.y=s[1]+(t[1]-s[1])*u,e.z=s[2]+(t[2]-s[2])*u,m.scale.copy(e))}}if(!this.relativeTransform){var y=g.compose(m.position,m.quaternion,m.scale),z=h;m.getOriginalWorldMatrix(z),z.getInverse(z);var A=g.multiplyMatrices(y,z);A.decompose(m.position,m.quaternion,m.scale)}m.updateAnimTransform()}}}();var g=function(a,b,c){e.call(this,a,b,c)};g.prototype=Object.create(e.prototype),g.prototype.constructor=g,g.prototype.keyTypes=["pos","up","target","fov","perspective"],g.prototype.defaultKey={pos:0,up:0,target:0,fov:0,perspective:0},g.prototype.update=function(){function b(){d||(d=new THREE.Vector3,e=new THREE.Vector3)}var d,e,f=[];return function(g){if(this.isPlaying!==!1&&(this.currentTime+=g*this.timeScale,b(),this.resetIfLooped(),!this.isPlayingOutOfRange())){for(var h=0,i=this.hierarchy.length;h<i;h++){for(var j=this.hierarchy[h],k=j.animationCache[this.data.name],l=0;l<this.keyTypes.length;l++){var m=this.keyTypes[l],n=k.prevKey[m],o=k.nextKey[m];if(o.time<=this.currentTime||n.time>=this.currentTime){for(n=this.data.hierarchy[h].keys[0],o=this.getNextKeyWith(m,h,1);o.time<this.currentTime&&o.index>n.index;)n=o,o=this.getNextKeyWith(m,h,o.index+1);k.prevKey[m]=n,k.nextKey[m]=o}var p=n[m],q=o[m];if(o.time!==n.time&&void 0!==p&&void 0!==q){var r=(this.currentTime-n.time)/(o.time-n.time);r<0&&(r=0),r>1&&(r=1);var s;if("pos"===m)s=j.position;else if("up"===m)s=j.up;else if("target"===m)s=j.target;else{if("fov"===m){j.setFov(p+(q-p)*r);continue}if("perspective"===m){var t=r>.5?q:p;t?j.toPerspective():j.toOrthographic();continue}}if(this.interpolationType===c.LINEAR)e.x=p[0]+(q[0]-p[0])*r,e.y=p[1]+(q[1]-p[1])*r,e.z=p[2]+(q[2]-p[2])*r,s.copy(e);else{f[0]=this.getPrevKeyWith(m,h,n.index-1)[m],f[1]=p,f[2]=q,f[3]=this.getNextKeyWith(m,h,o.index+1)[m],r=.33*r+.33;var u=a(f,r);if(e.x=u[0],e.y=u[1],e.z=u[2],s.copy(e),this.interpolationType===c.CATMULLROM_FORWARD){var v=a(f,1.01*r);d.set(v[0],v[1],v[2]),d.sub(s),d.y=0,d.normalize();var w=Math.atan2(d.x,d.z);j.rotation.set(0,w,0)}}}}j.matrixAutoUpdate=!0,j.matrixWorldNeedsUpdate=!0}j.lookAt(j.target),this.animator.updateFlag|=this.animator.UPDATE_CAMERA}}}();var h=function(a,b,c,d){e.call(this,a,b,d),this.nodeId=c,this.epsilon=.1,this.root.setMaterial(this.viewer.matman().cloneMaterial(a.getMaterial()))};h.prototype=Object.create(e.prototype),h.prototype.constructor=h,h.prototype.keyTypes=["vis","opa"],h.prototype.defaultKey={viz:1,opa:1},h.prototype.update=function(){return function(a){if(this.isPlaying!==!1&&(this.currentTime+=a*this.timeScale,this.resetIfLooped(),!this.isPlayingOutOfRange()))for(var b=0,c=this.hierarchy.length;b<c;b++)for(var d=this.hierarchy[b],e=d.animationCache[this.data.name],f=0;f<this.keyTypes.length;f++){var g=this.keyTypes[f],h=e.prevKey[g],i=e.nextKey[g];if(i.time<=this.currentTime||h.time>=this.currentTime){for(h=this.data.hierarchy[b].keys[0],i=this.getNextKeyWith(g,b,1);i.time<this.currentTime&&i.index>h.index;)h=i,i=this.getNextKeyWith(g,b,i.index+1);e.prevKey[g]=h,e.nextKey[g]=i}var j=h[g],k=i[g];if(i.time!==h.time&&void 0!==j&&void 0!==k){var l=d.getMaterial();if("vis"===g){var m=Math.abs(this.currentTime-i.time)<this.epsilon,n=m?k:j;this.viewer.visibilityManager.setNodeOff(this.nodeId,!n)}else if("opa"===g){var o=(this.currentTime-h.time)/(i.time-h.time);o<0&&(o=0),o>1&&(o=1);var p=j+(k-j)*o;l.transparent=1!==p,l.opacity=p,p>0&&this.viewer.visibilityManager.setNodeOff(this.nodeId,!1)}}}}}();var i=function(a,b,c){function d(a,b,c){var d=f.container=document.createElement("div"),e=a.name;d.id=e,d.style.cursor="pointer",d.style.visibility=c;var g=document.createElement("div");g.id=e+"-txt",g.style.cssText="display: none;position: absolute;z-index: 1;",d.appendChild(g);var h=document.createElement("img"),i=a.custom&&a.custom.att&&1===a.custom.att;h.src=i?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAABv1BMVEUAAAAAAAAAAAAAAAABAwEAAAAAAAAjSRkAAAAFDASJqnZhg1IqTyAjSRkpTx8hRxggRRcAAAAhRRcKFwgAAACau4R9mnFmiFUhSBgbOhMZNhIAAAAECQMgQxcAAAAAAAAAAAAHDwXB2q2jw4yfvoivyJ6fuI6mv5eSr4KAoWu2trZpiV3Nzc0wVSUhRxhNT01vb28AAAAgRBcAAAAAAAAAAAAhRxgeQBYAAAAAAAAAAAAfQRbP5MC0zqCqyJKpyJJBYje3z6WxyKOFpXF9nmkrTiG+wb5xkGVcf0xYfEg1WSpNTU0hRhgfQhYfQhZVVVVAQEAXMREcOhQcHBwSJw0AAAAAAAAWLxAVLQ8AAAAAAAAfQhYIEgYAAACbvn+DsGCGsmSUunaItGXc6dStypelxY2ZvX2Ntm2JtGnS48fB17G40aWNuWucxH6ny4mUvnPF27aPuHCEsGHV5czI3Lq52KGvzJqz1JmqyJOqzY6ew4OYwHiGs2OEsWHb29vL4LvM5bnD3q2+3KWkyoaLtWuKtmfOzs7IyMi21pyawXqPuG/g4ODX68fI4rTG4LCu0ZKszJKlx4qZwHuBnXR2iXENcZskAAAAXnRSTlMAEAIBCAsF6BUn+vPu7erjsZyBEwP99/TRk3JgRUQ1IxwO/v79/Pv6+fn09PPq08q7sqWDe2xrY01AMBj+/v7+/v37+fn59fXz8u/c1cbFxLWonZiIcm1lYVdSQT8de/EoFwAAAgVJREFUOMutklVz21AQRiNFlswYs+M6DTdN0kCDZWZmuAKDZFtgiO2YYm6TlOEHV53ptGs5j93Xc+a7e3d36P/W9prdZ/PZ17aPxphz3mR0x91G07wTG8TDo5R3HLGH3S6fGPdSo8Na/to6W2HZBEqwPCNULlu1BkFdQSyKx4qxOMoyDDJSRB/HnTcqWbSbTmVS6V3E57hvXicOBZd1gmfj6Z1kPrmTjrMMfRizumDA+k3UTcRSyWg0mkzFEgLNlU3rIIJcns0KqJjJq0I+U0SqUJlZJv8JugU3J/QnHEwu6MCMqPN1pq+H3sFxCgOC7RyT48Ev6qLUL/gmeJrJ/p0DzSnyxTtAGLMbv9dohv8zSbomSqUpOxB0AdNXsUbnGEEQmJzKq3JrLgCaJAzms5LI1enfVefEamc/YzYQYFB6/1xBUsQex3E9UZHkUvO6X48PwQjLTKEjVRVFqUqd8v6naQsMUCNcL8xTrVJZluXyl1K7OW1+7sL71x15cvVH43O7UGi3mmc8lkCE0ByMbvXazwueycbHxiXPrUdv3hLDGiF8au/d4sO7Novtnj9k0BO45uRGTp98f2JlK/RqYzN8TK8bGTjZLTXgfvDp6rMNA0ZADAOWHI6VTYwE4WAZjz/s3V5yvIxADosIPlh0BNXHSdA8LFIfDgE8WDg5hmmx9h/40fgXth2SDk3yjP4AAAAASUVORK5CYII=":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAABvFBMVEUAAAAAAAADAAAAAAAAAAACAAAAAAAAAAC5PznHVE8BAAAAAADbc27NXVeUDQaZDQaRBwAAAAAAAACHBgDuhoHVa2W9RD2QCAKYCAGPBgB0BQAAAAAAAACMBgAAAAADAAD2jonWb2n2jYjYbWfmeXPNzc3RYFqzODKfFA1RUVGKBgCVBwBvb2+WBwCBBgCFBgCWBwCLBgAAAAAAAACMBgCTBwByBQCTBwBbBACEBgAAAAAAAAAoAgBSBADgeHOoOzXmfnnofnjieHPGvr63t7e0tLTidW/ebmnba2XWZWDAT0qRHBfBSkRNTU2aFxGOBgBYTEsAAACNBgBAQEAAAABbBQAcHBxyBQBKBAAAAABfBAAAAAAAAAAsAgAkAgCJBgDZRT3MOTHQPDTVQjrlUkrjUEjRPjbOOjP/bGTvXFTqV0/fTETNOjL5Zl7eS0PzYFjxXlbiT0fUQTn0e3T7aGDWXFXbSEDTRj/PQTrOPjbb29vgamTxY1zoVE3STETTQjvSPzfOzs7IyMj5g3zzaWLXY13XYVrsXlbbU0zg4OD8lZD4gXq0eHXqd3HscWv2b2jrZmDQZWDdWVLkV1C5y9+5AAAAYHRSTlMAAgUBDggMEeDsIBj+8NHJxpxAEP754tDDtIFsYDkvI/78+/j08/DfycfHxbuvr5mTjYN0bWxkWVZTTDUjEfz8+/n59fT08vHw8PDw5NzV0Mq5uLWrm5iLfX1hV0g/ODZEwKduAAACAklEQVQ4y62SVXPbQBzEa1mWZYaY49ihBhtmKjMzw92JLLBsyxxT2mCZvnCVmU59VpO37Ms97G929nb+p05WXUvTE5GJ6aWuY+yFEdoVdAZd9MjCEYi5J0L3FZutSqVZdIYiPWaj/85j2yszAACGVyq7Lo+RIMZtxRaQOZaTwZZSLbrGLR2+aX54twVykpgVpRzgYbVGz5twYMPTV2ZkKZMupDOSzAiwfNazgQesDO9VASemU6lUWuQAgnyNXsEiiBlbEwE2W9CBQpbVAfRraIZoA5ZosII6EpB6MYrVpLxOQejowKsBL9UGSK+zCnnsF4omB7wkBkQHylDZ+rcDROD3hYcYQE0NHQhQ4f8uCQVG/XF9isJKLtI1TYBQQAgdPlqJzYcWMYBYd58/YJACD6UgpsTVA+51AhvKGgt9zQGN1xN4Dajs/vbtmBXf2mIP3/jGqiW9Q0nlGtn8tXBSnwGPWHYP5PcbLMs2JHFn+6p7WQ/ARTie3/rZm9+pZ+rfP/fawi8dhOFgqLlLX87dHOz/1D9ou/vsrcNiNgBrZzbf338yOXZvbDL2xm4ljCdn6j794cpswr/62p+wWy2m/042oQeMxudedK8mSdzGAy4/9vlm/STRtjGRTz9u3nnge2U3+O2h4o9GfXG7lcLKGWZY8ycduG3sQJCk0Tb+w3S0/Qemc4+eJchuZgAAAABJRU5ErkJggg==",h.id=e+"-img",h.style.cssText="display: block;position: absolute;z-index: 1;",d.appendChild(h),b.api.container.appendChild(d),d.addEventListener("click",function(){g.style.display="none"===g.style.display?"block":"none"});var j=32512,k=.6,l=new THREE.SphereGeometry(.01),m=new THREE.MeshPhongMaterial({color:j,ambient:j,opacity:k,transparent:!0}),n=new THREE.Mesh(l,m);return n.visible=!1,void 0===b.overlayScenes.annotation&&b.createOverlayScene("annotation"),b.addOverlay("annotation",n),n}var f=this;null===a&&(a=d(b,c.viewer,"hidden")),e.call(this,a,b,c),this.id=b.name,this.text="",this.state="hidden",this.epsilon=.1,this.viewer.api.addEventListener(Autodesk.Viewing.CAMERA_CHANGE_EVENT,function(b){f.updateText(a.position,f.text)})};i.prototype=Object.create(e.prototype),i.prototype.constructor=i,i.prototype.keyTypes=["pos","text","vis"],i.prototype.defaultKey={pos:0,text:"",vis:1},i.prototype.stop=function(){e.prototype.stop.call(this),this.container.parentNode.removeChild(this.container),this.viewer.removeOverlay("annotation",this.root),this.root=null},i.prototype.updateText=function(a,b){function c(a,b,c){var d=a.clone(),e=new THREE.Matrix4;return b.updateMatrixWorld(),b.matrixWorldInverse.getInverse(b.matrixWorld),e.multiplyMatrices(b.projectionMatrix,b.matrixWorldInverse),d.applyProjection(e),{x:(d.x+1)*c.width/2+c.offsetLeft,y:(-d.y+1)*c.height/2+c.offsetTop}}var d=c(a,this.viewer.camera,this.viewer.canvas),e=document.getElementById(this.id+"-txt");e&&(e.innerHTML=b,e.style.left=d.x+"px",e.style.top=d.y+"px",this.text=b),e=document.getElementById(this.id+"-img"),e&&(e.style.left=d.x+"px",e.style.top=d.y-24+"px")},i.prototype.update=function(){function b(){d||(d=new THREE.Vector3,e=new THREE.Vector3)}var d,e,f=[];return function(g){if(this.isPlaying!==!1&&(this.currentTime+=g*this.timeScale,b(),this.resetIfLooped(),!this.isPlayingOutOfRange())){if(this.isPaused&&this.currentTime<this.startKeyTime){var h=document.getElementById(this.id);return void(h&&(h.style.visibility=this.state))}for(var i=0,j=this.hierarchy.length;i<j;i++){for(var k=this.hierarchy[i],l=k.animationCache[this.data.name],m=0;m<this.keyTypes.length;m++){var n=this.keyTypes[m],o=l.prevKey[n],p=l.nextKey[n];if(p.time<=this.currentTime||o.time>=this.currentTime){for(o=this.data.hierarchy[i].keys[0],p=this.getNextKeyWith(n,i,1);p.time<this.currentTime&&p.index>o.index;)o=p,p=this.getNextKeyWith(n,i,p.index+1);l.prevKey[n]=o,l.nextKey[n]=p}var q=o[n],r=p[n];if(p.time!==o.time&&void 0!==q&&void 0!==r){var s=(this.currentTime-o.time)/(p.time-o.time);if(s<0&&(s=0),s>1&&(s=1),"pos"===n){if(this.interpolationType===c.LINEAR)e.x=q[0]+(r[0]-q[0])*s,e.y=q[1]+(r[1]-q[1])*s,e.z=q[2]+(r[2]-q[2])*s,k.position.copy(e);else if(this.interpolationType===c.CATMULLROM||this.interpolationType===c.CATMULLROM_FORWARD){f[0]=this.getPrevKeyWith("pos",i,o.index-1).pos,f[1]=q,f[2]=r,f[3]=this.getNextKeyWith("pos",i,p.index+1).pos,s=.33*s+.33;var t=a(f,s);if(e.x=t[0],e.y=t[1],e.z=t[2],k.position.copy(e),this.interpolationType===c.CATMULLROM_FORWARD){var u=a(f,1.01*s);d.set(u[0],u[1],u[2]),d.sub(vector),d.y=0,d.normalize();var v=Math.atan2(d.x,d.z);k.rotation.set(0,v,0)}}}else if("text"===n){var w=Math.abs(this.currentTime-p.time)<this.epsilon?r:q;this.updateText(k.position,w)}else if("vis"===n){var h=document.getElementById(this.id);if(h){var x=Math.abs(this.currentTime-p.time)<this.epsilon?r:q;h.style.visibility=x?"visible":"hidden"}}}}k.matrixAutoUpdate=!0,k.matrixWorldNeedsUpdate=!0}}}}();var j=function(a,b,c){this.viewer=c.viewer,null===a&&(a=this.createPolyline([])),e.call(this,a,b,c),this.epsilon=.1};j.prototype=Object.create(e.prototype),j.prototype.constructor=j,j.prototype.keyTypes=["points","vis"],j.prototype.defaultKey={points:[],vis:1},j.prototype.stop=function(){e.prototype.stop.call(this),this.viewer.removeOverlay("polyline",this.root),this.root=null},j.prototype.update=function(){function a(a){a.root&&(a.viewer.removeOverlay("polyline",a.root),a.root=null)}return function(b){if(this.isPlaying!==!1&&(this.currentTime+=b*this.timeScale,this.resetIfLooped(),!this.isPlayingOutOfRange())){if(this.isPaused&&this.currentTime<this.startKeyTime)return void a(this);for(var c=0,d=this.hierarchy.length;c<d;c++)for(var e=this.hierarchy[c],f=e.animationCache[this.data.name],g=0;g<this.keyTypes.length;g++){var h=this.keyTypes[g],i=f.prevKey[h],j=f.nextKey[h];if(j.time<=this.currentTime||i.time>=this.currentTime){for(i=this.data.hierarchy[c].keys[0],j=this.getNextKeyWith(h,c,1);j.time<this.currentTime&&j.index>i.index;)i=j,j=this.getNextKeyWith(h,c,j.index+1);f.prevKey[h]=i,f.nextKey[h]=j}var k=i[h],l=j[h];if(j.time!==i.time&&void 0!==k&&void 0!==l){var m=(this.currentTime-i.time)/(j.time-i.time);if(m<0&&(m=0),m>1&&(m=1),"points"===h){var n=m<.5?k:l;this.viewer.removeOverlay("polyline",this.root),this.root=null;for(var o=[],p=0;p<n.length;p++){var q=n[p].slice();if(0===p)q[0]=k[p][0]+(l[p][0]-k[p][0])*m,q[1]=k[p][1]+(l[p][1]-k[p][1])*m,q[2]=k[p][2]+(l[p][2]-k[p][2])*m;else if(p===n.length-1){var r=k.length-1,s=l.length-1;q[0]=k[r][0]+(l[s][0]-k[r][0])*m,q[1]=k[r][1]+(l[s][1]-k[r][1])*m,q[2]=k[r][2]+(l[s][2]-k[r][2])*m}var t=new THREE.Vector3(q[0],q[1],q[2]);o.push(t)}this.root=this.createPolyline(o)}else if("vis"===h){var u=Math.abs(this.currentTime-j.time)<this.epsilon?l:k;this.root.visible=u,u||a(this)}}}}}}(),j.prototype.createPolyline=function(a){for(var b=new THREE.Geometry,c=0;c<a.length;c++)b.vertices.push(a[c]);b.computeLineDistances();var d=new THREE.LineDashedMaterial({color:0,dashSize:1,gapSize:.5,linewidth:1}),e=new THREE.Line(b,d,THREE.LineStrip);return void 0===this.viewer.overlayScenes.polyline&&this.viewer.createOverlayScene("polyline"),this.viewer.addOverlay("polyline",e),e},b.Animation=e,b.AnimationHandler=d,b.MeshAnimation=f,b.CameraAnimation=g,b.PolylineAnimation=j,b.VisibilityAnimation=h,b.AnnotationAnimation=i}(),function(){"use strict";var a=Autodesk.Viewing.Private,b=function(a,b){this.animations=[],this.viewer=a,this.keys=[],this.isPlaying=!1,this.isPaused=!0,this.updateFlag=0,this.duration=b,this.currentTime=0,this.onPlayCallback=null,this.animationHandler=new Autodesk.Viewing.Private.AnimationHandler,this.areCameraAnimationsPaused=!1,this.UPDATE_SCENE=1,this.UPDATE_CAMERA=2};b.prototype.destroy=function(){this.stop(),this.viewer=null,this.keys=null,this.animations=null,this.isPlaying=!1,this.isPaused=!1,this.animationHandler=null},b.prototype.add=function(b){function c(a){function b(a,b,c){for(b=a.length;c=--b;)for(;c--;)a[b]!==a[c]||a.splice(c,1)}a.sort(function(a,b){return a-b}),b(a)}if(!(!b.hierarchy||b.hierarchy.length<1||!b.hierarchy[0].keys||b.hierarchy[0].keys.length<2)){var d=null,e=this;if("camera"===b.type?(d=new a.CameraAnimation(e.viewer.camera,b,e),e.animations.push(d)):"annotation"===b.type?(d=new a.AnnotationAnimation(null,b,e),e.animations.push(d)):"polyline"===b.type?(d=new a.PolylineAnimation(null,b,e),e.animations.push(d)):"mesh"!==b.type&&"visibility"!==b.type||e.viewer.model.getData().instanceTree.enumNodeFragments(b.id,function(c){var f=e.viewer.getFragmentProxy(e.viewer.model,c);f&&(d="mesh"===b.type?new a.MeshAnimation(f,b,e):new a.VisibilityAnimation(f,b,b.id,e),e.animations.push(d))},!0),d){for(var f=0,g=b.hierarchy.length;f<g;f++)for(var h=b.hierarchy[f].keys,i=0;i<h.length;i++)void 0===h[i].xk&&e.keys.push(h[i].time);c(e.keys)}this.updateFlag|=this.UPDATE_SCENE}},b.prototype.update=function(a){this.animationHandler.update(a);var b=this.updateFlag;return this.isPlaying&&!this.isPaused&&(this.currentTime+=a,this.currentTime=Math.min(this.currentTime,this.duration),this.onPlayCallback&&this.onPlayCallback(this.duration>0?this.currentTime/this.duration*100:0),this.currentTime>=this.duration&&this.pause(),b|=this.UPDATE_SCENE),this.updateFlag=0,b},b.prototype.play=function(a,b){if(this.onPlayCallback=b,this.currentTime>=this.duration&&this.goto(0),this.isPlaying)return void this.pause();for(var c=0;c<this.animations.length;c++){var d=this.animations[c];d.play(a)}this.isPlaying=!0,this.isPaused=!1},b.prototype.pause=function(){for(var a=0;a<this.animations.length;a++){var b=this.animations[a];b.isPaused===this.isPaused&&b.pause()}this.isPaused=!this.isPaused,this.areCameraAnimationsPaused=this.isPaused},b.prototype.pauseCameraAnimations=function(){for(var a=0;a<this.animations.length;a++){var b=this.animations[a];b instanceof Autodesk.Viewing.Private.CameraAnimation&&b.pause()}this.areCameraAnimationsPaused=!this.areCameraAnimationsPaused},b.prototype.stop=function(){for(var a=0;a<this.animations.length;a++){var b=this.animations[a];b.stop()}this.isPlaying=!1,this.isPaused=!1},b.prototype.goto=function(a){if(void 0!==a){for(var b=0;b<this.animations.length;b++){var c=this.animations[b];c.goto(a)}this.isPlaying=!0,this.isPaused=!0,this.currentTime=a,this.updateFlag|=this.UPDATE_SCENE}},b.prototype.next=function(){function a(a,b){for(var c=-1,d=0;d<b.length;d++)if(b[d]>a){c=b[d];break}return c<0?b[b.length-1]:c}var b=a(this.currentTime,this.keys);this.goto(b)},b.prototype.prev=function(){function a(a,b){for(var c=-1,d=b.length-1;d>-1;d--)if(b[d]<a){c=b[d];break}return c<0?b[0]:c}var b=a(this.currentTime,this.keys);this.goto(b)},a.KeyFrameAnimator=b}(),"undefined"!=typeof window&&!function(a,b,c,d){"use strict";function e(a,b,c){return setTimeout(k(a,c),b)}function f(a,b,c){return!!Array.isArray(a)&&(g(a,c[b],c),!0)}function g(a,b,c){var e;if(a)if(a.forEach)a.forEach(b,c);else if(a.length!==d)for(e=0;e<a.length;)b.call(c,a[e],e,a),e++;else for(e in a)a.hasOwnProperty(e)&&b.call(c,a[e],e,a)}function h(a,b,c){for(var e=Object.keys(b),f=0;f<e.length;)(!c||c&&a[e[f]]===d)&&(a[e[f]]=b[e[f]]),f++;return a}function i(a,b){return h(a,b,!0)}function j(a,b,c){var d,e=b.prototype;d=a.prototype=Object.create(e),d.constructor=a,d._super=e,c&&h(d,c)}function k(a,b){return function(){return a.apply(b,arguments)}}function l(a,b){return typeof a==ka?a.apply(b?b[0]||d:d,b):a}function m(a,b){return a===d?b:a}function n(a,b,c){g(r(b),function(b){a.addEventListener(b,c,!1)})}function o(a,b,c){g(r(b),function(b){a.removeEventListener(b,c,!1)})}function p(a,b){for(;a;){if(a==b)return!0;a=a.parentNode}return!1}function q(a,b){return a.indexOf(b)>-1}function r(a){return a.trim().split(/\s+/g)}function s(a,b,c){if(a.indexOf&&!c)return a.indexOf(b);for(var d=0;d<a.length;){if(c&&a[d][c]==b||!c&&a[d]===b)return d;d++}return-1}function t(a){return Array.prototype.slice.call(a,0)}function u(a,b,c){for(var d=[],e=[],f=0;f<a.length;){var g=b?a[f][b]:a[f];s(e,g)<0&&d.push(a[f]),e[f]=g,f++}return c&&(d=b?d.sort(function(a,c){return a[b]>c[b]}):d.sort()),d}function v(a,b){for(var c,e,f=b[0].toUpperCase()+b.slice(1),g=0;g<ia.length;){if(c=ia[g],e=c?c+f:b,e in a)return e;g++}return d}function w(){return oa++}function x(a){var b=a.ownerDocument;return b.defaultView||b.parentWindow}function y(a,b){var c=this;this.manager=a,this.callback=b,this.element=a.element,this.target=a.options.inputTarget,this.domHandler=function(b){l(a.options.enable,[a])&&c.handler(b)},this.init()}function z(a){var b,c=a.options.inputClass;return new(b=c?c:ra?N:sa?Q:qa?S:M)(a,A)}function A(a,b,c){var d=c.pointers.length,e=c.changedPointers.length,f=b&ya&&d-e===0,g=b&(Aa|Ba)&&d-e===0;c.isFirst=!!f,c.isFinal=!!g,f&&(a.session={}),c.eventType=b,B(a,c),a.emit("hammer.input",c),a.recognize(c),a.session.prevInput=c}function B(a,b){var c=a.session,d=b.pointers,e=d.length;c.firstInput||(c.firstInput=E(b)),e>1&&!c.firstMultiple?c.firstMultiple=E(b):1===e&&(c.firstMultiple=!1);var f=c.firstInput,g=c.firstMultiple,h=g?g.center:f.center,i=b.center=F(d);b.timeStamp=na(),b.deltaTime=b.timeStamp-f.timeStamp,b.angle=J(h,i),b.distance=I(h,i),C(c,b),b.offsetDirection=H(b.deltaX,b.deltaY),b.scale=g?L(g.pointers,d):1,b.rotation=g?K(g.pointers,d):0,D(c,b);var j=a.element;p(b.srcEvent.target,j)&&(j=b.srcEvent.target),b.target=j}function C(a,b){var c=b.center,d=a.offsetDelta||{},e=a.prevDelta||{},f=a.prevInput||{};(b.eventType===ya||f.eventType===Aa)&&(e=a.prevDelta={x:f.deltaX||0,y:f.deltaY||0},d=a.offsetDelta={x:c.x,y:c.y}),b.deltaX=e.x+(c.x-d.x),b.deltaY=e.y+(c.y-d.y)}function D(a,b){var c,e,f,g,h=a.lastInterval||b,i=b.timeStamp-h.timeStamp;if(b.eventType!=Ba&&(i>xa||h.velocity===d)){var j=h.deltaX-b.deltaX,k=h.deltaY-b.deltaY,l=G(i,j,k);e=l.x,f=l.y,c=ma(l.x)>ma(l.y)?l.x:l.y,g=H(j,k),a.lastInterval=b}else c=h.velocity,e=h.velocityX,f=h.velocityY,g=h.direction;b.velocity=c,b.velocityX=e,b.velocityY=f,b.direction=g}function E(a){for(var b=[],c=0;c<a.pointers.length;)b[c]={clientX:la(a.pointers[c].clientX),clientY:la(a.pointers[c].clientY)},c++;return{timeStamp:na(),pointers:b,center:F(b),deltaX:a.deltaX,deltaY:a.deltaY}}function F(a){var b=a.length;if(1===b)return{x:la(a[0].clientX),y:la(a[0].clientY)};for(var c=0,d=0,e=0;b>e;)c+=a[e].clientX,d+=a[e].clientY,e++;return{x:la(c/b),y:la(d/b)}}function G(a,b,c){return{x:b/a||0,y:c/a||0}}function H(a,b){return a===b?Ca:ma(a)>=ma(b)?a>0?Da:Ea:b>0?Fa:Ga}function I(a,b,c){c||(c=Ka);var d=b[c[0]]-a[c[0]],e=b[c[1]]-a[c[1]];return Math.sqrt(d*d+e*e)}function J(a,b,c){c||(c=Ka);var d=b[c[0]]-a[c[0]],e=b[c[1]]-a[c[1]];return 180*Math.atan2(e,d)/Math.PI}function K(a,b){return J(b[1],b[0],La)-J(a[1],a[0],La)}function L(a,b){return I(b[0],b[1],La)/I(a[0],a[1],La)}function M(){this.evEl=Na,this.evWin=Oa,this.allow=!0,this.pressed=!1,y.apply(this,arguments)}function N(){this.evEl=Ra,this.evWin=Sa,y.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}function O(){this.evTarget=Ua,this.evWin=Va,this.started=!1,y.apply(this,arguments)}function P(a,b){var c=t(a.touches),d=t(a.changedTouches);return b&(Aa|Ba)&&(c=u(c.concat(d),"identifier",!0)),[c,d]}function Q(){this.evTarget=Xa,this.targetIds={},y.apply(this,arguments)}function R(a,b){var c=t(a.touches),d=this.targetIds;if(b&(ya|za)&&1===c.length)return d[c[0].identifier]=!0,[c,c];var e,f,g=t(a.changedTouches),h=[],i=this.target;if(f=c.filter(function(a){return p(a.target,i)}),b===ya)for(e=0;e<f.length;)d[f[e].identifier]=!0,e++;for(e=0;e<g.length;)d[g[e].identifier]&&h.push(g[e]),b&(Aa|Ba)&&delete d[g[e].identifier],e++;return h.length?[u(f.concat(h),"identifier",!0),h]:void 0}function S(){y.apply(this,arguments);var a=k(this.handler,this);this.touch=new Q(this.manager,a),this.mouse=new M(this.manager,a)}function T(a,b){this.manager=a,this.set(b)}function U(a){if(q(a,bb))return bb;var b=q(a,cb),c=q(a,db);return b&&c?cb+" "+db:b||c?b?cb:db:q(a,ab)?ab:_a}function V(a){this.id=w(),this.manager=null,this.options=i(a||{},this.defaults),this.options.enable=m(this.options.enable,!0),this.state=eb,this.simultaneous={},this.requireFail=[]}function W(a){return a&jb?"cancel":a&hb?"end":a&gb?"move":a&fb?"start":""}function X(a){return a==Ga?"down":a==Fa?"up":a==Da?"left":a==Ea?"right":""}function Y(a,b){var c=b.manager;return c?c.get(a):a}function Z(){V.apply(this,arguments)}function $(){Z.apply(this,arguments),this.pX=null,this.pY=null}function _(){Z.apply(this,arguments)}function aa(){V.apply(this,arguments),this._timer=null,this._input=null}function ba(){Z.apply(this,arguments)}function ca(){Z.apply(this,arguments)}function da(){V.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function ea(a,b){return b=b||{},b.recognizers=m(b.recognizers,ea.defaults.preset),new fa(a,b)}function fa(a,b){b=b||{},this.options=i(b,ea.defaults),this.options.inputTarget=this.options.inputTarget||a,this.handlers={},this.session={},this.recognizers=[],this.element=a,this.input=z(this),this.touchAction=new T(this,this.options.touchAction),ga(this,!0),g(b.recognizers,function(a){var b=this.add(new a[0](a[1]));a[2]&&b.recognizeWith(a[2]),a[3]&&b.requireFailure(a[3])},this)}function ga(a,b){var c=a.element;g(a.options.cssProps,function(a,d){c.style[v(c.style,d)]=b?a:""})}function ha(a,c){var d=b.createEvent("Event");d.initEvent(a,!0,!0),d.gesture=c,c.target.dispatchEvent(d)}var ia=["","webkit","moz","MS","ms","o"],ja=b.createElement("div"),ka="function",la=Math.round,ma=Math.abs,na=Date.now,oa=1,pa=/mobile|tablet|ip(ad|hone|od)|android/i,qa="ontouchstart"in a,ra=v(a,"PointerEvent")!==d,sa=qa&&pa.test(navigator.userAgent),ta="touch",ua="pen",va="mouse",wa="kinect",xa=25,ya=1,za=2,Aa=4,Ba=8,Ca=1,Da=2,Ea=4,Fa=8,Ga=16,Ha=Da|Ea,Ia=Fa|Ga,Ja=Ha|Ia,Ka=["x","y"],La=["clientX","clientY"];y.prototype={handler:function(){},init:function(){this.evEl&&n(this.element,this.evEl,this.domHandler),this.evTarget&&n(this.target,this.evTarget,this.domHandler),this.evWin&&n(x(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&o(this.element,this.evEl,this.domHandler),this.evTarget&&o(this.target,this.evTarget,this.domHandler),this.evWin&&o(x(this.element),this.evWin,this.domHandler)}};var Ma={mousedown:ya,mousemove:za,mouseup:Aa},Na="mousedown",Oa="mousemove mouseup";j(M,y,{handler:function(a){var b=Ma[a.type];b&ya&&0===a.button&&(this.pressed=!0),b&za&&1!==a.which&&(b=Aa),this.pressed&&this.allow&&(b&Aa&&(this.pressed=!1),this.callback(this.manager,b,{pointers:[a],changedPointers:[a],pointerType:va,srcEvent:a}))}});var Pa={pointerdown:ya,pointermove:za,pointerup:Aa,pointercancel:Ba,pointerout:Ba},Qa={2:ta,3:ua,4:va,5:wa},Ra="pointerdown",Sa="pointermove pointerup pointercancel";a.MSPointerEvent&&(Ra="MSPointerDown",Sa="MSPointerMove MSPointerUp MSPointerCancel"),j(N,y,{handler:function(a){var b=this.store,c=!1,d=a.type.toLowerCase().replace("ms",""),e=Pa[d],f=Qa[a.pointerType]||a.pointerType,g=f==ta,h=s(b,a.pointerId,"pointerId");e&ya&&(0===a.button||g)?0>h&&(b.push(a),h=b.length-1):e&(Aa|Ba)&&(c=!0),0>h||(b[h]=a,this.callback(this.manager,e,{pointers:b,changedPointers:[a],pointerType:f,srcEvent:a}),c&&b.splice(h,1))}});var Ta={touchstart:ya,touchmove:za,touchend:Aa,touchcancel:Ba},Ua="touchstart",Va="touchstart touchmove touchend touchcancel";j(O,y,{handler:function(a){var b=Ta[a.type];if(b===ya&&(this.started=!0),this.started){var c=P.call(this,a,b);b&(Aa|Ba)&&c[0].length-c[1].length===0&&(this.started=!1),this.callback(this.manager,b,{pointers:c[0],changedPointers:c[1],pointerType:ta,srcEvent:a})}}});var Wa={touchstart:ya,touchmove:za,touchend:Aa,touchcancel:Ba},Xa="touchstart touchmove touchend touchcancel";j(Q,y,{handler:function(a){var b=Wa[a.type],c=R.call(this,a,b);c&&this.callback(this.manager,b,{pointers:c[0],changedPointers:c[1],pointerType:ta,srcEvent:a})}}),j(S,y,{handler:function(a,b,c){var d=c.pointerType==ta,e=c.pointerType==va;if(d)this.mouse.allow=!1;else if(e&&!this.mouse.allow)return;b&(Aa|Ba)&&(this.mouse.allow=!0),this.callback(a,b,c)},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var Ya=v(ja.style,"touchAction"),Za=Ya!==d,$a="compute",_a="auto",ab="manipulation",bb="none",cb="pan-x",db="pan-y";T.prototype={set:function(a){a==$a&&(a=this.compute()),Za&&(this.manager.element.style[Ya]=a),this.actions=a.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var a=[];return g(this.manager.recognizers,function(b){l(b.options.enable,[b])&&(a=a.concat(b.getTouchAction()))}),U(a.join(" "))},preventDefaults:function(a){if(!Za){var b=a.srcEvent,c=a.offsetDirection;if(this.manager.session.prevented)return void b.preventDefault();var d=this.actions,e=q(d,bb),f=q(d,db),g=q(d,cb);return e||f&&c&Ha||g&&c&Ia?this.preventSrc(b):void 0}},preventSrc:function(a){this.manager.session.prevented=!0,a.preventDefault()}};var eb=1,fb=2,gb=4,hb=8,ib=hb,jb=16,kb=32;V.prototype={defaults:{},set:function(a){return h(this.options,a),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(a){if(f(a,"recognizeWith",this))return this;var b=this.simultaneous;return a=Y(a,this),b[a.id]||(b[a.id]=a,a.recognizeWith(this)),this},dropRecognizeWith:function(a){return f(a,"dropRecognizeWith",this)?this:(a=Y(a,this),delete this.simultaneous[a.id],this)},requireFailure:function(a){if(f(a,"requireFailure",this))return this;var b=this.requireFail;return a=Y(a,this),-1===s(b,a)&&(b.push(a),a.requireFailure(this)),this},dropRequireFailure:function(a){if(f(a,"dropRequireFailure",this))return this;a=Y(a,this);var b=s(this.requireFail,a);return b>-1&&this.requireFail.splice(b,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(a){return!!this.simultaneous[a.id]},emit:function(a){function b(b){c.manager.emit(c.options.event+(b?W(d):""),a)}var c=this,d=this.state;hb>d&&b(!0),b(),d>=hb&&b(!0)},tryEmit:function(a){return this.canEmit()?this.emit(a):void(this.state=kb)},canEmit:function(){for(var a=0;a<this.requireFail.length;){if(!(this.requireFail[a].state&(kb|eb)))return!1;a++}return!0},recognize:function(a){var b=h({},a);return l(this.options.enable,[this,b])?(this.state&(ib|jb|kb)&&(this.state=eb),this.state=this.process(b),void(this.state&(fb|gb|hb|jb)&&this.tryEmit(b))):(this.reset(),void(this.state=kb))},process:function(){},getTouchAction:function(){},reset:function(){}},j(Z,V,{defaults:{pointers:1},attrTest:function(a){var b=this.options.pointers;return 0===b||a.pointers.length===b},process:function(a){var b=this.state,c=a.eventType,d=b&(fb|gb),e=this.attrTest(a);return d&&(c&Ba||!e)?b|jb:d||e?c&Aa?b|hb:b&fb?b|gb:fb:kb}}),j($,Z,{defaults:{event:"pan",threshold:10,pointers:1,direction:Ja},getTouchAction:function(){var a=this.options.direction,b=[];return a&Ha&&b.push(db),a&Ia&&b.push(cb),b},directionTest:function(a){var b=this.options,c=!0,d=a.distance,e=a.direction,f=a.deltaX,g=a.deltaY;return e&b.direction||(b.direction&Ha?(e=0===f?Ca:0>f?Da:Ea,c=f!=this.pX,d=Math.abs(a.deltaX)):(e=0===g?Ca:0>g?Fa:Ga,c=g!=this.pY,d=Math.abs(a.deltaY))),a.direction=e,c&&d>b.threshold&&e&b.direction;
},attrTest:function(a){return Z.prototype.attrTest.call(this,a)&&(this.state&fb||!(this.state&fb)&&this.directionTest(a))},emit:function(a){this.pX=a.deltaX,this.pY=a.deltaY;var b=X(a.direction);b&&this.manager.emit(this.options.event+b,a),this._super.emit.call(this,a)}}),j(_,Z,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[bb]},attrTest:function(a){return this._super.attrTest.call(this,a)&&(Math.abs(a.scale-1)>this.options.threshold||this.state&fb)},emit:function(a){if(this._super.emit.call(this,a),1!==a.scale){var b=a.scale<1?"in":"out";this.manager.emit(this.options.event+b,a)}}}),j(aa,V,{defaults:{event:"press",pointers:1,time:500,threshold:5},getTouchAction:function(){return[_a]},process:function(a){var b=this.options,c=a.pointers.length===b.pointers,d=a.distance<b.threshold,f=a.deltaTime>b.time;if(this._input=a,!d||!c||a.eventType&(Aa|Ba)&&!f)this.reset();else if(a.eventType&ya)this.reset(),this._timer=e(function(){this.state=ib,this.tryEmit()},b.time,this);else if(a.eventType&Aa)return ib;return kb},reset:function(){clearTimeout(this._timer)},emit:function(a){this.state===ib&&(a&&a.eventType&Aa?this.manager.emit(this.options.event+"up",a):(this._input.timeStamp=na(),this.manager.emit(this.options.event,this._input)))}}),j(ba,Z,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[bb]},attrTest:function(a){return this._super.attrTest.call(this,a)&&(Math.abs(a.rotation)>this.options.threshold||this.state&fb)}}),j(ca,Z,{defaults:{event:"swipe",threshold:10,velocity:.65,direction:Ha|Ia,pointers:1},getTouchAction:function(){return $.prototype.getTouchAction.call(this)},attrTest:function(a){var b,c=this.options.direction;return c&(Ha|Ia)?b=a.velocity:c&Ha?b=a.velocityX:c&Ia&&(b=a.velocityY),this._super.attrTest.call(this,a)&&c&a.direction&&a.distance>this.options.threshold&&ma(b)>this.options.velocity&&a.eventType&Aa},emit:function(a){var b=X(a.direction);b&&this.manager.emit(this.options.event+b,a),this.manager.emit(this.options.event,a)}}),j(da,V,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:2,posThreshold:10},getTouchAction:function(){return[ab]},process:function(a){var b=this.options,c=a.pointers.length===b.pointers,d=a.distance<b.threshold,f=a.deltaTime<b.time;if(this.reset(),a.eventType&ya&&0===this.count)return this.failTimeout();if(d&&f&&c){if(a.eventType!=Aa)return this.failTimeout();var g=!this.pTime||a.timeStamp-this.pTime<b.interval,h=!this.pCenter||I(this.pCenter,a.center)<b.posThreshold;this.pTime=a.timeStamp,this.pCenter=a.center,h&&g?this.count+=1:this.count=1,this._input=a;var i=this.count%b.taps;if(0===i)return this.hasRequireFailures()?(this._timer=e(function(){this.state=ib,this.tryEmit()},b.interval,this),fb):ib}return kb},failTimeout:function(){return this._timer=e(function(){this.state=kb},this.options.interval,this),kb},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==ib&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),ea.VERSION="2.0.4",ea.defaults={domEvents:!1,touchAction:$a,enable:!0,inputTarget:null,inputClass:null,preset:[[ba,{enable:!1}],[_,{enable:!1},["rotate"]],[ca,{direction:Ha}],[$,{direction:Ha},["swipe"]],[da],[da,{event:"doubletap",taps:2},["tap"]],[aa]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var lb=1,mb=2;fa.prototype={set:function(a){return h(this.options,a),a.touchAction&&this.touchAction.update(),a.inputTarget&&(this.input.destroy(),this.input.target=a.inputTarget,this.input.init()),this},stop:function(a){this.session.stopped=a?mb:lb},recognize:function(a){var b=this.session;if(!b.stopped){this.touchAction.preventDefaults(a);var c,d=this.recognizers,e=b.curRecognizer;(!e||e&&e.state&ib)&&(e=b.curRecognizer=null);for(var f=0;f<d.length;)c=d[f],b.stopped===mb||e&&c!=e&&!c.canRecognizeWith(e)?c.reset():c.recognize(a),!e&&c.state&(fb|gb|hb)&&(e=b.curRecognizer=c),f++}},get:function(a){if(a instanceof V)return a;for(var b=this.recognizers,c=0;c<b.length;c++)if(b[c].options.event==a)return b[c];return null},add:function(a){if(f(a,"add",this))return this;var b=this.get(a.options.event);return b&&this.remove(b),this.recognizers.push(a),a.manager=this,this.touchAction.update(),a},remove:function(a){if(f(a,"remove",this))return this;var b=this.recognizers;return a=this.get(a),b.splice(s(b,a),1),this.touchAction.update(),this},on:function(a,b){var c=this.handlers;return g(r(a),function(a){c[a]=c[a]||[],c[a].push(b)}),this},off:function(a,b){var c=this.handlers;return g(r(a),function(a){b?c[a].splice(s(c[a],b),1):delete c[a]}),this},emit:function(a,b){this.options.domEvents&&ha(a,b);var c=this.handlers[a]&&this.handlers[a].slice();if(c&&c.length){b.type=a,b.preventDefault=function(){b.srcEvent.preventDefault()};for(var d=0;d<c.length;)c[d](b),d++}},destroy:function(){this.element&&ga(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},h(ea,{INPUT_START:ya,INPUT_MOVE:za,INPUT_END:Aa,INPUT_CANCEL:Ba,STATE_POSSIBLE:eb,STATE_BEGAN:fb,STATE_CHANGED:gb,STATE_ENDED:hb,STATE_RECOGNIZED:ib,STATE_CANCELLED:jb,STATE_FAILED:kb,DIRECTION_NONE:Ca,DIRECTION_LEFT:Da,DIRECTION_RIGHT:Ea,DIRECTION_UP:Fa,DIRECTION_DOWN:Ga,DIRECTION_HORIZONTAL:Ha,DIRECTION_VERTICAL:Ia,DIRECTION_ALL:Ja,Manager:fa,Input:y,TouchAction:T,TouchInput:Q,MouseInput:M,PointerEventInput:N,TouchMouseInput:S,SingleTouchInput:O,Recognizer:V,AttrRecognizer:Z,Tap:da,Pan:$,Swipe:ca,Pinch:_,Rotate:ba,Press:aa,on:n,off:o,each:g,merge:i,extend:h,inherit:j,bindFn:k,prefixed:v}),"undefined"!=typeof module&&module.exports,a[c]=ea}(window,document,"Hammer"),function(){var a=Autodesk.Viewing,b=(a.Private,""),c=!1,d=!1,e=!0;a.HTTP_REQUEST_HEADERS={},a.getApiEndpoint=function(){return b},a.setApiEndpoint=function(a,c,f){b=a,d=c,e=f,e||(d=!1)},a.getViewingUrl=function(a){return e?(a||b)+"/viewingservice/v1":(a||b)+"/derivativeservice/v2"},a.getUseCredentials=function(){return c},a.setUseCredentials=function(a){c=a},a.getManifestApi=function(b){var c=a.getViewingUrl(b);return d?c+"/bubbles/":e?c+"/":c+"/manifest/"},a.getItemApi=function(b){return e?a.getViewingUrl(b)+"/items/":a.getViewingUrl(b)+"/derivatives/"},a.getThumbnailApi=function(b){return a.getViewingUrl(b)+"/thumbnails/"},a.makeOssPath=function(a,c,d){return(a||b)+"/oss/v2/buckets/"+c+"/objects/"+encodeURIComponent(decodeURIComponent(d))}}(),function(){var a=Autodesk.Viewing,b=a.Private,c=a.getGlobal();c.PROTEIN_ROOT=null,c.PRISM_ROOT=null,c.LOCALIZATION_REL_PATH="",c.LMV_VIEWER_VERSION="@build_version@",c.LMV_VIEWER_PATCH="@build_number@",c.LMV_BUILD_TYPE="@build_type@",c.LMV_RESOURCE_VERSION=null,c.LMV_RESOURCE_ROOT="",c.LMV_THIRD_PARTY_COOKIE=void 0,"v"===LMV_VIEWER_VERSION.charAt(0)&&(LMV_VIEWER_VERSION=LMV_VIEWER_VERSION.substr(1)),c.stderr=function(){console.warn('"stderr" is deprecated; please use "Autodesk.Viewing.Private.logger" instead')},b.env=null,b.docItemId=null,b.token={accessToken:null,getAccessToken:null,tokenRefreshInterval:null},b.memoryOptimizedSvfLoading=!1,b.forceMemoryOptimizedModeOnSvfLoading=!1,b.assets=[],b.offline=!1,b.offlineResourcePrefix=null;var d={local:{RTC:["https://rtc-dev.api.autodesk.com:443","https://lmv.autodesk.com:443"]},dev:{RTC:["https://rtc-dev.api.autodesk.com:443","https://lmv.autodesk.com:443"]},stg:{RTC:["https://rtc-stg.api.autodesk.com:443","https://lmv.autodesk.com:443"]},prod:{RTC:["https://rtc.api.autodesk.com:443","https://lmv.autodesk.com:443"]}},e={local:"",dev:"https://viewing-dev.api.autodesk.com",stg:"https://viewing-staging.api.autodesk.com",prod:"https://viewing.api.autodesk.com"},f={local:"",dev:"https://developer-dev.api.autodesk.com",stg:"https://developer-stg.api.autodesk.com",prod:"https://developer.api.autodesk.com"},g={stg:{CLIENT_ID:"lmv-stag",CLIENT_KEY:"kjemi1rwAgsqIqyvDUtc9etPD6MsAzbV",ENDPOINT:"https://ase-stg.autodesk.com"},prod:{CLIENT_ID:"lmv-prod",CLIENT_KEY:"iaoUM2CRGydfn703yfPq4MAogZi8I5u4",ENDPOINT:"https://ase.autodesk.com"}};b.EnvironmentConfigurations={Local:{ROOT:"",LMV:d.local},Development:{ROOT:e.dev,LMV:d.dev,bubbleManifest:!0},Staging:{ROOT:e.stg,LMV:d.stg,bubbleManifest:!0},Production:{ROOT:e.prod,LMV:d.prod,bubbleManifest:!0},AutodeskDevelopment:{ROOT:f.dev,LMV:d.dev},AutodeskStaging:{ROOT:f.stg,LMV:d.stg},AutodeskProduction:{ROOT:f.prod,LMV:d.prod}},b.initializeEnvironmentVariable=function(a){var c;if(a&&a.env&&(c=a.env),c||(c=b.getParameterByName("env")),a&&a.offlineResourcePrefix&&(b.offlineResourcePrefix=a.offlineResourcePrefix),a&&a.offline&&"true"===a.offline&&(b.offline=!0),!c)switch(window.location.hostname){case"viewing-dev.api.autodesk.com":c="Development";break;case"viewing-staging.api.autodesk.com":c="Staging";break;case"viewing.api.autodesk.com":c="Production";break;case"developer-dev.api.autodesk.com":c="AutodeskDevelopment";break;case"developer-stg.api.autodesk.com":c="AutodeskStaging";break;case"developer.api.autodesk.com":c="AutodeskProduction";break;case"localhost.autodesk.com":c="Local";break;case"":c="Local";break;case"127.0.0.1":c="Local";break;default:c="AutodeskProduction"}b.ENABLE_TRACE&&("undefined"!=typeof window&&console.log("Host name : "+window.location.hostname),console.log("Environment initialized as : "+c)),b.env=c},b.initializeServiceEndPoints=function(c){var d=c.endpoint,e=c.bubbleManifest,f=!c.useDerivativeServiceV2;if(!d){var g=b.EnvironmentConfigurations[b.env];d=g.ROOT,e=g.bubbleManifest&&f}if(a.setApiEndpoint(d,e,f),!a.isNodeJS){var h=["viewer3D.js","viewer3D.min.js","firefly.js","firefly.min.js"];c&&c.hasOwnProperty("libraryName")&&h.push(c.libraryName);for(var i,j,k=0;k<h.length;k++){var l=b.getScript(h[k]);j=l?l.src:"";var m=j.indexOf(h[k]);if(m>=0){i=j.substr(0,m);break}}LMV_RESOURCE_VERSION="v"+LMV_VIEWER_VERSION;var n=b.getParameterByNameFromPath("v",j);n&&n.length&&n!=LMV_RESOURCE_VERSION?(console.warn("Version string mismatch between requested and actual version: "+n+" vs. "+LMV_RESOURCE_VERSION+". Using "+n),LMV_RESOURCE_VERSION=n):n&&n.length||(LMV_RESOURCE_VERSION=null,console.info("No viewer version specified, will implicitly use "+LMV_VIEWER_VERSION)),LMV_RESOURCE_ROOT=i||LMV_RESOURCE_ROOT}},b.initLoadContext=function(b){b=b||{},b.auth=a.getUseCredentials(),b.endpoint=a.getApiEndpoint(),b.headers||(b.headers={});for(var c in a.HTTP_REQUEST_HEADERS)b.headers[c]=a.HTTP_REQUEST_HEADERS[c];return b},b.refreshCookie=function(c,d,e){var f=new XMLHttpRequest;if(f.onload=d,f.onerror=e,f.ontimeout=e,0===b.env.indexOf("Autodesk")){var g=b.EnvironmentConfigurations[b.env].ROOT;f.open("POST",g+"/utility/v1/settoken",!0),f.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),f.withCredentials=!0,f.send("access-token="+c),a.isIE11&&(b.accessToken=c)}else{var c={oauth:{token:c}};f.open("POST",a.getViewingUrl()+"/token",!0),f.setRequestHeader("Content-Type","application/json"),f.withCredentials=!0,f.send(JSON.stringify(c))}},b.refreshRequestHeader=function(b){a.HTTP_REQUEST_HEADERS.Authorization="Bearer "+b},b.refreshToken=function(a,c,d){function e(){LMV_THIRD_PARTY_COOKIE?b.refreshCookie(a,c,d):(b.refreshRequestHeader(a),c())}b.token.accessToken=a,void 0===LMV_THIRD_PARTY_COOKIE?b.refreshCookie(a,c,d):e()},b.initializeAuth=function(c,d){function e(a,f){h=a,b.refreshToken(h,b.token.tokenRefreshInterval?null:c);var g=f-60;g<=0&&(g=f),b.token.tokenRefreshInterval=1e3*g,setTimeout(function(){d.getAccessToken(e)},b.token.tokenRefreshInterval)}var f=d?d.shouldInitializeAuth:void 0;if(void 0===f){var g=b.getParameterByName("auth");f="false"!==g.toLowerCase()}if("Local"==b.env||!f)return setTimeout(c,0),a.setUseCredentials("undefined"!=typeof d.useCredentials&&d.useCredentials),a.getUseCredentials();a.isNodeJS&&(LMV_THIRD_PARTY_COOKIE=!1),a.setUseCredentials("undefined"==typeof d.useCredentials||d.useCredentials);var h;return d&&d.getAccessToken?(b.token.getAccessToken=d.getAccessToken,h=d.getAccessToken(e),"string"==typeof h&&h&&b.refreshToken(h,c)):d&&d.accessToken?(h=d.accessToken,b.refreshToken(h,c)):(h=b.getParameterByName("accessToken"),h||(h="9AMaRKBoPCIBy61JmQ8OLLLyRblS",b.logger.warn("Warning : no access token is provided. Use built in token : "+h)),b.refreshToken(h,c)),a.getUseCredentials()},b.initializeLogger=function(c){var d={eventCallback:c?c.eventCallback:void 0};if(b.logger.initialize(d),!(c&&c.hasOwnProperty("useADP")&&0==c.useADP||a.isNodeJS)){var e="https://ase-cdn.autodesk.com/adp/v1.0.3/js/adp-web-analytics-sdk.min.js",f=function(){if("undefined"==typeof Adp)return void b.logger.warn("Autodesk Data Platform SDK not found");var a;switch(LMV_BUILD_TYPE){case"Production":a=g.prod;break;default:a=g.stg}var c={product:{name:"LMV",line_name:"LMV",key:a.CLIENT_ID,id:a.CLIENT_KEY,id_provider:"appkey",build_id:LMV_VIEWER_VERSION+"."+LMV_VIEWER_PATCH,build_tag:LMV_BUILD_TYPE}},d={server:a.ENDPOINT,enable_geo_data:!1,enable_browser_data:!0,enable_session_messages:!0};b.logger.adp=new Adp(c,d)};"undefined"!=typeof requirejs?requirejs([e],function(a){window.Adp=a,f()}):b.loadDependency("Adp",e,f)}},b.initializeProtein=function(){if((!b.ENABLE_DEBUG||"Local"!=b.env||a.getUseCredentials())&&!b.offline){var c=new XMLHttpRequest;c.open("GET","https://raas-assets.autodesk.com/StaticContent/BaseAddress?family=protein",!0),c.responseType="json",c.onload=function(a){var d=c.response.url;d&&d.length&&(d=d.replace("http://","https://"),PROTEIN_ROOT=d+"/",b.logger.info("Protein root is: "+PROTEIN_ROOT))},c.send();var d=new XMLHttpRequest;d.open("GET","https://raas-assets.autodesk.com/StaticContent/BaseAddress?family=prism",!0),d.responseType="json",d.onload=function(a){var c=d.response.url;c&&c.length&&(c=c.replace("http://","https://"),PRISM_ROOT=c+"/",b.logger.info("Prism root is: "+PRISM_ROOT))},d.send()}},b.getParameterByName=function(a){return"undefined"==typeof window?"":b.getParameterByNameFromPath(a,window.location.href)},b.getParameterByNameFromPath=function(a,b){a=a.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var c="[\\?&]"+a+"=([^&#]*)",d=new RegExp(c),e=d.exec(b);return null==e?"":decodeURIComponent(e[1].replace(/\+/g," "))},b.urlIsApiViewingOrDev=function(a){return a.indexOf("developer.api.autodesk.com")!==-1||a.indexOf("developer-stg.api.autodesk.com")!==-1||a.indexOf("developer-dev.api.autodesk.com")!==-1||a.indexOf("viewing.api.autodesk.com")!==-1||a.indexOf("viewing-staging.api.autodesk.com")!==-1||a.indexOf("viewing-dev.api.autodesk.com")!==-1},b.getDemoDocumentURN=function(){var a;switch(b.env){case"Development":a="urn:dXJuOmFkc2suYTM2MGJldGFkZXY6ZnMuZmlsZTplbnRlcnByaXNlLmxtdnRlc3QuRFM1YTczMFFUYmYwMDIyZDA3NTFhYmE5MjZlZDZkMjJlZDY0P3ZlcnNpb249MQ==";break;case"Staging":a="urn:dXJuOmFkc2suczM6ZGVyaXZlZC5maWxlOlZpZXdpbmdTZXJ2aWNlVGVzdEFwcC91c2Vycy9NaWNoYWVsX0hhbicvTU0zNTAwQXNzZW1ibHkuZHdm";break;case"Production":a="FIXME";break;default:a="https://lmv.rocks/viewer/data/gears/output/bubble.json"}return a},b.setLanguage=function(a,b){var c={lng:a,resGetPath:"res/locales/__lng__/__ns__.json",ns:{namespaces:["allstrings"],defaultNs:"allstrings"},fallbackLng:"en",debug:!1};LOCALIZATION_REL_PATH="res/locales/"+a+"/",Autodesk.Viewing.i18n.init(c,function(a){Autodesk.Viewing.i18n.clearDebugLocString(),b&&b()})},b.initializeLocalization=function(a){var c=a&&a.language||navigator.language,d=c.split("-");c=d.length>1?d[0].toLowerCase()+"-"+d[1].toUpperCase():d[0].toLowerCase();var e=["cs","de","en","es","fr","it","ja","ko","pl","pt-BR","ru","tr","zh-HANS","zh-HANT"];e.indexOf(c)===-1&&(c=c.indexOf("zh-CN")>-1?"zh-HANS":c.indexOf("zh-TW")>-1?"zh-HANT":d.length>1&&e.indexOf(d[0])>-1?d[0]:"en"),b.setLanguage(c)},b.initializeUserInfo=function(a){a&&a.userInfo&&(b.setUserName(a.userInfo.name),a.comment2Token&&(b.comment2Token=a.comment2Token))},b.getScript=function(a){a=a.toLowerCase();var b=document.getElementsByTagName("SCRIPT");if(b&&b.length>0)for(var c=0;c<b.length;++c)if(b[c].src&&b[c].src.toLowerCase().indexOf(a)!==-1)return b[c];return null},b.getResourceUrl=function(a){var b=LMV_RESOURCE_VERSION;return LMV_RESOURCE_ROOT+a+(b?"?v="+b:"")},b.loadDependency=function(a,c,d){if("undefined"==typeof window[a]){var e=document.createElement("SCRIPT");e.src=c.indexOf("://")>0?c:b.getResourceUrl(c),document.head.appendChild(e),d&&(e.onload=d)}else d&&d()},Autodesk.Viewing.Initializer=function(c,d){function e(){b.initializeLegacyNamespaces(!1),THREE.warn=b.logger.warn.bind(b.logger),init_three_dds_loader(),init_three_pvr_loader(),b.initializeAuth(d,c),b.initializeLocalization(c),b.initializeUserInfo(c)}a.isNodeJS?(b.initializeEnvironmentVariable(c),b.initializeServiceEndPoints(c),b.initializeLogger(c),b.initializeAuth(d,c)):(b.WEBGL_HELP_LINK=c?c.webGLHelpLink:null,b.initializeEnvironmentVariable(c),b.initializeServiceEndPoints(c),b.initializeLogger(c),b.initializeProtein(),b.initWorkerScript(),b.loadDependency("THREE","three.min.js",function(){b.loadDependency("WGS","Local"===b.env?"wgs.js":"wgs.min.js",e)}))}}();