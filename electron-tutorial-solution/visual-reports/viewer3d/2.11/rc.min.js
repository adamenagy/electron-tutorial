function getGlobal(){return"undefined"!=typeof window&&null!==window?window:"undefined"!=typeof self&&null!==self?self:global}function getGlobal(){return"undefined"!=typeof window&&null!==window?window:"undefined"!=typeof self&&null!==self?self:global}function trace(a){"\n"==a[a.length-1]&&(a=a.substring(0,a.length-1)),console.log((performance.now()/1e3).toFixed(3)+": "+a)}var AutodeskNamespace=function(a){for(var b=getGlobal(),c=a.split("."),d=0;d<c.length;++d)b[c[d]]=b[c[d]]||{},b=b[c[d]];return b};AutodeskNamespace("Autodesk.Viewing.Private"),AutodeskNamespace("Autodesk.Viewing.Extensions"),AutodeskNamespace("Autodesk.Viewing.Shaders"),AutodeskNamespace("Autodesk.Viewing.UI"),AutodeskNamespace("Autodesk.LMVTK"),Autodesk.Viewing.getGlobal=getGlobal,Autodesk.Viewing.AutodeskNamespace=AutodeskNamespace;var av=Autodesk.Viewing,avp=av.Private;av.getGlobal=getGlobal;var isBrowser=av.isBrowser="undefined"!=typeof navigator,isIE11=av.isIE11=isBrowser&&!!navigator.userAgent.match(/Trident\/7\./);"undefined"!=typeof window&&isIE11&&!function(){function a(a,b){b=b||{bubbles:!1,cancelable:!1,detail:void 0};var c=document.createEvent("CustomEvent");return c.initCustomEvent(a,b.bubbles,b.cancelable,b.detail),c}a.prototype=window.CustomEvent.prototype,window.CustomEvent=a}(),ArrayBuffer.prototype.slice||(ArrayBuffer.prototype.slice=function(a,b){if(!b||b>this.byteLength?b=this.byteLength:b<0&&(b=this.byteLength+b,b<0&&(b=0)),a<0&&(a=this.byteLength+a,a<0&&(a=0)),b<=a)return new ArrayBuffer;for(var c=b-a,d=new Uint8Array(this,a,c),e=new Uint8Array(c),f=0;f<c;f++)e[f]=d[f];return e.buffer}),function(){Math.log2=Math.log2||function(a){return Math.log(a)/Math.LN2}}(),"undefined"!=typeof window&&(window.BlobBuilder=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder);var launchFullscreen=av.launchFullscreen=function(a,b){a.requestFullscreen?a.requestFullscreen(b):a.mozRequestFullScreen?a.mozRequestFullScreen(b):a.webkitRequestFullscreen?a.webkitRequestFullscreen(b):a.msRequestFullscreen&&a.msRequestFullscreen(b)},exitFullscreen=av.exitFullscreen=function(){document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen()},inFullscreen=av.inFullscreen=function(){return"webkitIsFullScreen"in document?document.webkitIsFullScreen:!!(document.mozFullScreenElement||document.msFullscreenElement||document.fullscreenEnabled||document.querySelector(".viewer-fill-browser"))},fullscreenElement=av.fullscreenElement=function(){return document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement},isFullscreenAvailable=av.isFullscreenAvailable=function(a){return a.requestFullscreen||a.mozRequestFullScreen||a.webkitRequestFullscreen||a.msRequestFullscreen},getAndroidVersion=av.getAndroidVersion=function(a){var a=a||navigator.userAgent,b=a.match(/Android\s([0-9\.]*)/);return!!b&&b[1]},isTouchDevice=av.isTouchDevice=function(){return"undefined"!=typeof window&&"ontouchstart"in window};av.isIOSDevice=function(){return!!isBrowser&&/ip(ad|hone|od)/.test(navigator.userAgent.toLowerCase())},av.isAndroidDevice=function(){return!!isBrowser&&navigator.userAgent.toLowerCase().indexOf("android")!==-1},av.isMobileDevice=function(){return!!isBrowser&&(av.isIOSDevice()||av.isAndroidDevice())},av.isSafari=function(){if(!isBrowser)return!1;var a=navigator.userAgent.toLowerCase();return a.indexOf("safari")!==-1&&a.indexOf("chrome")===-1},av.isFirefox=function(){if(!isBrowser)return!1;var a=navigator.userAgent.toLowerCase();return a.indexOf("firefox")!==-1},av.isMac=function(){if(!isBrowser)return!1;var a=navigator.userAgent.toLowerCase();return a.indexOf("mac os")!==-1},av.isWindows=function(){if(!isBrowser)return!1;var a=navigator.userAgent.toLowerCase();return a.indexOf("win32")!==-1||a.indexOf("windows")!==-1};var detectWebGL=av.detectWebGL=function(){if(window.WebGLRenderingContext){for(var a=document.createElement("canvas"),b=["webgl","experimental-webgl","moz-webgl","webkit-3d"],c=!1,d=0;d<4;d++)try{if(c=a.getContext(b[d]),c=rescueFromPolymer(c),c&&"function"==typeof c.getParameter)return 1}catch(a){}return 0}return-1},touchStartToClick=av.touchStartToClick=function(a){a.preventDefault(),a.stopPropagation(),a.target.click()};!function(){var a=getGlobal();a.performance||(a.performance=Date)}();var av=Autodesk.Viewing,avp=Autodesk.Viewing.Private;if(avp.BUILD_LMV_WORKER_URL="lmvworker.js",avp.LMV_WORKER_URL=avp.BUILD_LMV_WORKER_URL,avp.ENABLE_DEBUG=avp.ENABLE_DEBUG||!1,avp.ENABLE_TRACE=avp.ENABLE_TRACE||!1,avp.ENABLE_INLINE_WORKER=!0,"undefined"!=typeof window&&!function(a,b,c,d){"use strict";function e(a,b,c){return setTimeout(k(a,c),b)}function f(a,b,c){return!!Array.isArray(a)&&(g(a,c[b],c),!0)}function g(a,b,c){var e;if(a)if(a.forEach)a.forEach(b,c);else if(a.length!==d)for(e=0;e<a.length;)b.call(c,a[e],e,a),e++;else for(e in a)a.hasOwnProperty(e)&&b.call(c,a[e],e,a)}function h(a,b,c){for(var e=Object.keys(b),f=0;f<e.length;)(!c||c&&a[e[f]]===d)&&(a[e[f]]=b[e[f]]),f++;return a}function i(a,b){return h(a,b,!0)}function j(a,b,c){var d,e=b.prototype;d=a.prototype=Object.create(e),d.constructor=a,d._super=e,c&&h(d,c)}function k(a,b){return function(){return a.apply(b,arguments)}}function l(a,b){return typeof a==ka?a.apply(b?b[0]||d:d,b):a}function m(a,b){return a===d?b:a}function n(a,b,c){g(r(b),function(b){a.addEventListener(b,c,!1)})}function o(a,b,c){g(r(b),function(b){a.removeEventListener(b,c,!1)})}function p(a,b){for(;a;){if(a==b)return!0;a=a.parentNode}return!1}function q(a,b){return a.indexOf(b)>-1}function r(a){return a.trim().split(/\s+/g)}function s(a,b,c){if(a.indexOf&&!c)return a.indexOf(b);for(var d=0;d<a.length;){if(c&&a[d][c]==b||!c&&a[d]===b)return d;d++}return-1}function t(a){return Array.prototype.slice.call(a,0)}function u(a,b,c){for(var d=[],e=[],f=0;f<a.length;){var g=b?a[f][b]:a[f];s(e,g)<0&&d.push(a[f]),e[f]=g,f++}return c&&(d=b?d.sort(function(a,c){return a[b]>c[b]}):d.sort()),d}function v(a,b){for(var c,e,f=b[0].toUpperCase()+b.slice(1),g=0;g<ia.length;){if(c=ia[g],e=c?c+f:b,e in a)return e;g++}return d}function w(){return oa++}function x(a){var b=a.ownerDocument;return b.defaultView||b.parentWindow}function y(a,b){var c=this;this.manager=a,this.callback=b,this.element=a.element,this.target=a.options.inputTarget,this.domHandler=function(b){l(a.options.enable,[a])&&c.handler(b)},this.init()}function z(a){var b,c=a.options.inputClass;return new(b=c?c:ra?N:sa?Q:qa?S:M)(a,A)}function A(a,b,c){var d=c.pointers.length,e=c.changedPointers.length,f=b&ya&&d-e===0,g=b&(Aa|Ba)&&d-e===0;c.isFirst=!!f,c.isFinal=!!g,f&&(a.session={}),c.eventType=b,B(a,c),a.emit("hammer.input",c),a.recognize(c),a.session.prevInput=c}function B(a,b){var c=a.session,d=b.pointers,e=d.length;c.firstInput||(c.firstInput=E(b)),e>1&&!c.firstMultiple?c.firstMultiple=E(b):1===e&&(c.firstMultiple=!1);var f=c.firstInput,g=c.firstMultiple,h=g?g.center:f.center,i=b.center=F(d);b.timeStamp=na(),b.deltaTime=b.timeStamp-f.timeStamp,b.angle=J(h,i),b.distance=I(h,i),C(c,b),b.offsetDirection=H(b.deltaX,b.deltaY),b.scale=g?L(g.pointers,d):1,b.rotation=g?K(g.pointers,d):0,D(c,b);var j=a.element;p(b.srcEvent.target,j)&&(j=b.srcEvent.target),b.target=j}function C(a,b){var c=b.center,d=a.offsetDelta||{},e=a.prevDelta||{},f=a.prevInput||{};(b.eventType===ya||f.eventType===Aa)&&(e=a.prevDelta={x:f.deltaX||0,y:f.deltaY||0},d=a.offsetDelta={x:c.x,y:c.y}),b.deltaX=e.x+(c.x-d.x),b.deltaY=e.y+(c.y-d.y)}function D(a,b){var c,e,f,g,h=a.lastInterval||b,i=b.timeStamp-h.timeStamp;if(b.eventType!=Ba&&(i>xa||h.velocity===d)){var j=h.deltaX-b.deltaX,k=h.deltaY-b.deltaY,l=G(i,j,k);e=l.x,f=l.y,c=ma(l.x)>ma(l.y)?l.x:l.y,g=H(j,k),a.lastInterval=b}else c=h.velocity,e=h.velocityX,f=h.velocityY,g=h.direction;b.velocity=c,b.velocityX=e,b.velocityY=f,b.direction=g}function E(a){for(var b=[],c=0;c<a.pointers.length;)b[c]={clientX:la(a.pointers[c].clientX),clientY:la(a.pointers[c].clientY)},c++;return{timeStamp:na(),pointers:b,center:F(b),deltaX:a.deltaX,deltaY:a.deltaY}}function F(a){var b=a.length;if(1===b)return{x:la(a[0].clientX),y:la(a[0].clientY)};for(var c=0,d=0,e=0;b>e;)c+=a[e].clientX,d+=a[e].clientY,e++;return{x:la(c/b),y:la(d/b)}}function G(a,b,c){return{x:b/a||0,y:c/a||0}}function H(a,b){return a===b?Ca:ma(a)>=ma(b)?a>0?Da:Ea:b>0?Fa:Ga}function I(a,b,c){c||(c=Ka);var d=b[c[0]]-a[c[0]],e=b[c[1]]-a[c[1]];return Math.sqrt(d*d+e*e)}function J(a,b,c){c||(c=Ka);var d=b[c[0]]-a[c[0]],e=b[c[1]]-a[c[1]];return 180*Math.atan2(e,d)/Math.PI}function K(a,b){return J(b[1],b[0],La)-J(a[1],a[0],La)}function L(a,b){return I(b[0],b[1],La)/I(a[0],a[1],La)}function M(){this.evEl=Na,this.evWin=Oa,this.allow=!0,this.pressed=!1,y.apply(this,arguments)}function N(){this.evEl=Ra,this.evWin=Sa,y.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}function O(){this.evTarget=Ua,this.evWin=Va,this.started=!1,y.apply(this,arguments)}function P(a,b){var c=t(a.touches),d=t(a.changedTouches);return b&(Aa|Ba)&&(c=u(c.concat(d),"identifier",!0)),[c,d]}function Q(){this.evTarget=Xa,this.targetIds={},y.apply(this,arguments)}function R(a,b){var c=t(a.touches),d=this.targetIds;if(b&(ya|za)&&1===c.length)return d[c[0].identifier]=!0,[c,c];var e,f,g=t(a.changedTouches),h=[],i=this.target;if(f=c.filter(function(a){return p(a.target,i)}),b===ya)for(e=0;e<f.length;)d[f[e].identifier]=!0,e++;for(e=0;e<g.length;)d[g[e].identifier]&&h.push(g[e]),b&(Aa|Ba)&&delete d[g[e].identifier],e++;return h.length?[u(f.concat(h),"identifier",!0),h]:void 0}function S(){y.apply(this,arguments);var a=k(this.handler,this);this.touch=new Q(this.manager,a),this.mouse=new M(this.manager,a)}function T(a,b){this.manager=a,this.set(b)}function U(a){if(q(a,bb))return bb;var b=q(a,cb),c=q(a,db);return b&&c?cb+" "+db:b||c?b?cb:db:q(a,ab)?ab:_a}function V(a){this.id=w(),this.manager=null,this.options=i(a||{},this.defaults),this.options.enable=m(this.options.enable,!0),this.state=eb,this.simultaneous={},this.requireFail=[]}function W(a){return a&jb?"cancel":a&hb?"end":a&gb?"move":a&fb?"start":""}function X(a){return a==Ga?"down":a==Fa?"up":a==Da?"left":a==Ea?"right":""}function Y(a,b){var c=b.manager;return c?c.get(a):a}function Z(){V.apply(this,arguments)}function $(){Z.apply(this,arguments),this.pX=null,this.pY=null}function _(){Z.apply(this,arguments)}function aa(){V.apply(this,arguments),this._timer=null,this._input=null}function ba(){Z.apply(this,arguments)}function ca(){Z.apply(this,arguments)}function da(){V.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function ea(a,b){return b=b||{},b.recognizers=m(b.recognizers,ea.defaults.preset),new fa(a,b)}function fa(a,b){b=b||{},this.options=i(b,ea.defaults),this.options.inputTarget=this.options.inputTarget||a,this.handlers={},this.session={},this.recognizers=[],this.element=a,this.input=z(this),this.touchAction=new T(this,this.options.touchAction),ga(this,!0),g(b.recognizers,function(a){var b=this.add(new a[0](a[1]));a[2]&&b.recognizeWith(a[2]),a[3]&&b.requireFailure(a[3])},this)}function ga(a,b){var c=a.element;g(a.options.cssProps,function(a,d){c.style[v(c.style,d)]=b?a:""})}function ha(a,c){var d=b.createEvent("Event");d.initEvent(a,!0,!0),d.gesture=c,c.target.dispatchEvent(d)}var ia=["","webkit","moz","MS","ms","o"],ja=b.createElement("div"),ka="function",la=Math.round,ma=Math.abs,na=Date.now,oa=1,pa=/mobile|tablet|ip(ad|hone|od)|android/i,qa="ontouchstart"in a,ra=v(a,"PointerEvent")!==d,sa=qa&&pa.test(navigator.userAgent),ta="touch",ua="pen",va="mouse",wa="kinect",xa=25,ya=1,za=2,Aa=4,Ba=8,Ca=1,Da=2,Ea=4,Fa=8,Ga=16,Ha=Da|Ea,Ia=Fa|Ga,Ja=Ha|Ia,Ka=["x","y"],La=["clientX","clientY"];y.prototype={handler:function(){},init:function(){this.evEl&&n(this.element,this.evEl,this.domHandler),this.evTarget&&n(this.target,this.evTarget,this.domHandler),this.evWin&&n(x(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&o(this.element,this.evEl,this.domHandler),this.evTarget&&o(this.target,this.evTarget,this.domHandler),this.evWin&&o(x(this.element),this.evWin,this.domHandler)}};var Ma={mousedown:ya,mousemove:za,mouseup:Aa},Na="mousedown",Oa="mousemove mouseup";j(M,y,{handler:function(a){var b=Ma[a.type];b&ya&&0===a.button&&(this.pressed=!0),b&za&&1!==a.which&&(b=Aa),this.pressed&&this.allow&&(b&Aa&&(this.pressed=!1),this.callback(this.manager,b,{pointers:[a],changedPointers:[a],pointerType:va,srcEvent:a}))}});var Pa={pointerdown:ya,pointermove:za,pointerup:Aa,pointercancel:Ba,pointerout:Ba},Qa={2:ta,3:ua,4:va,5:wa},Ra="pointerdown",Sa="pointermove pointerup pointercancel";a.MSPointerEvent&&(Ra="MSPointerDown",Sa="MSPointerMove MSPointerUp MSPointerCancel"),j(N,y,{handler:function(a){var b=this.store,c=!1,d=a.type.toLowerCase().replace("ms",""),e=Pa[d],f=Qa[a.pointerType]||a.pointerType,g=f==ta,h=s(b,a.pointerId,"pointerId");e&ya&&(0===a.button||g)?0>h&&(b.push(a),h=b.length-1):e&(Aa|Ba)&&(c=!0),0>h||(b[h]=a,this.callback(this.manager,e,{pointers:b,changedPointers:[a],pointerType:f,srcEvent:a}),c&&b.splice(h,1))}});var Ta={touchstart:ya,touchmove:za,touchend:Aa,touchcancel:Ba},Ua="touchstart",Va="touchstart touchmove touchend touchcancel";j(O,y,{handler:function(a){var b=Ta[a.type];if(b===ya&&(this.started=!0),this.started){var c=P.call(this,a,b);b&(Aa|Ba)&&c[0].length-c[1].length===0&&(this.started=!1),this.callback(this.manager,b,{pointers:c[0],changedPointers:c[1],pointerType:ta,srcEvent:a})}}});var Wa={touchstart:ya,touchmove:za,touchend:Aa,touchcancel:Ba},Xa="touchstart touchmove touchend touchcancel";j(Q,y,{handler:function(a){var b=Wa[a.type],c=R.call(this,a,b);c&&this.callback(this.manager,b,{pointers:c[0],changedPointers:c[1],pointerType:ta,srcEvent:a})}}),j(S,y,{handler:function(a,b,c){var d=c.pointerType==ta,e=c.pointerType==va;if(d)this.mouse.allow=!1;else if(e&&!this.mouse.allow)return;b&(Aa|Ba)&&(this.mouse.allow=!0),this.callback(a,b,c)},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var Ya=v(ja.style,"touchAction"),Za=Ya!==d,$a="compute",_a="auto",ab="manipulation",bb="none",cb="pan-x",db="pan-y";T.prototype={set:function(a){a==$a&&(a=this.compute()),Za&&(this.manager.element.style[Ya]=a),this.actions=a.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var a=[];return g(this.manager.recognizers,function(b){l(b.options.enable,[b])&&(a=a.concat(b.getTouchAction()))}),U(a.join(" "))},preventDefaults:function(a){if(!Za){var b=a.srcEvent,c=a.offsetDirection;if(this.manager.session.prevented)return void b.preventDefault();var d=this.actions,e=q(d,bb),f=q(d,db),g=q(d,cb);return e||f&&c&Ha||g&&c&Ia?this.preventSrc(b):void 0}},preventSrc:function(a){this.manager.session.prevented=!0,a.preventDefault()}};var eb=1,fb=2,gb=4,hb=8,ib=hb,jb=16,kb=32;V.prototype={defaults:{},set:function(a){return h(this.options,a),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(a){if(f(a,"recognizeWith",this))return this;var b=this.simultaneous;return a=Y(a,this),b[a.id]||(b[a.id]=a,a.recognizeWith(this)),this},dropRecognizeWith:function(a){return f(a,"dropRecognizeWith",this)?this:(a=Y(a,this),delete this.simultaneous[a.id],this)},requireFailure:function(a){if(f(a,"requireFailure",this))return this;var b=this.requireFail;return a=Y(a,this),-1===s(b,a)&&(b.push(a),a.requireFailure(this)),this},dropRequireFailure:function(a){if(f(a,"dropRequireFailure",this))return this;a=Y(a,this);var b=s(this.requireFail,a);return b>-1&&this.requireFail.splice(b,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(a){return!!this.simultaneous[a.id]},emit:function(a){function b(b){c.manager.emit(c.options.event+(b?W(d):""),a)}var c=this,d=this.state;hb>d&&b(!0),b(),d>=hb&&b(!0)},tryEmit:function(a){return this.canEmit()?this.emit(a):void(this.state=kb)},canEmit:function(){for(var a=0;a<this.requireFail.length;){if(!(this.requireFail[a].state&(kb|eb)))return!1;a++}return!0},recognize:function(a){var b=h({},a);return l(this.options.enable,[this,b])?(this.state&(ib|jb|kb)&&(this.state=eb),this.state=this.process(b),void(this.state&(fb|gb|hb|jb)&&this.tryEmit(b))):(this.reset(),void(this.state=kb))},process:function(){},getTouchAction:function(){},reset:function(){}},j(Z,V,{defaults:{pointers:1},attrTest:function(a){var b=this.options.pointers;return 0===b||a.pointers.length===b},process:function(a){var b=this.state,c=a.eventType,d=b&(fb|gb),e=this.attrTest(a);return d&&(c&Ba||!e)?b|jb:d||e?c&Aa?b|hb:b&fb?b|gb:fb:kb}}),j($,Z,{defaults:{event:"pan",threshold:10,pointers:1,direction:Ja},getTouchAction:function(){var a=this.options.direction,b=[];return a&Ha&&b.push(db),a&Ia&&b.push(cb),b},directionTest:function(a){var b=this.options,c=!0,d=a.distance,e=a.direction,f=a.deltaX,g=a.deltaY;return e&b.direction||(b.direction&Ha?(e=0===f?Ca:0>f?Da:Ea,c=f!=this.pX,d=Math.abs(a.deltaX)):(e=0===g?Ca:0>g?Fa:Ga,c=g!=this.pY,d=Math.abs(a.deltaY))),a.direction=e,c&&d>b.threshold&&e&b.direction},attrTest:function(a){return Z.prototype.attrTest.call(this,a)&&(this.state&fb||!(this.state&fb)&&this.directionTest(a))},emit:function(a){this.pX=a.deltaX,this.pY=a.deltaY;var b=X(a.direction);b&&this.manager.emit(this.options.event+b,a),this._super.emit.call(this,a)}}),j(_,Z,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[bb]},attrTest:function(a){return this._super.attrTest.call(this,a)&&(Math.abs(a.scale-1)>this.options.threshold||this.state&fb)},emit:function(a){if(this._super.emit.call(this,a),1!==a.scale){var b=a.scale<1?"in":"out";this.manager.emit(this.options.event+b,a)}}}),j(aa,V,{defaults:{event:"press",pointers:1,time:500,threshold:5},getTouchAction:function(){return[_a]},process:function(a){var b=this.options,c=a.pointers.length===b.pointers,d=a.distance<b.threshold,f=a.deltaTime>b.time;if(this._input=a,!d||!c||a.eventType&(Aa|Ba)&&!f)this.reset();else if(a.eventType&ya)this.reset(),this._timer=e(function(){this.state=ib,this.tryEmit()},b.time,this);else if(a.eventType&Aa)return ib;return kb},reset:function(){clearTimeout(this._timer)},emit:function(a){this.state===ib&&(a&&a.eventType&Aa?this.manager.emit(this.options.event+"up",a):(this._input.timeStamp=na(),this.manager.emit(this.options.event,this._input)))}}),j(ba,Z,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[bb]},attrTest:function(a){return this._super.attrTest.call(this,a)&&(Math.abs(a.rotation)>this.options.threshold||this.state&fb)}}),j(ca,Z,{defaults:{event:"swipe",threshold:10,velocity:.65,direction:Ha|Ia,pointers:1},getTouchAction:function(){return $.prototype.getTouchAction.call(this)},attrTest:function(a){var b,c=this.options.direction;return c&(Ha|Ia)?b=a.velocity:c&Ha?b=a.velocityX:c&Ia&&(b=a.velocityY),this._super.attrTest.call(this,a)&&c&a.direction&&a.distance>this.options.threshold&&ma(b)>this.options.velocity&&a.eventType&Aa},emit:function(a){var b=X(a.direction);b&&this.manager.emit(this.options.event+b,a),this.manager.emit(this.options.event,a)}}),j(da,V,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:2,posThreshold:10},getTouchAction:function(){return[ab]},process:function(a){var b=this.options,c=a.pointers.length===b.pointers,d=a.distance<b.threshold,f=a.deltaTime<b.time;if(this.reset(),a.eventType&ya&&0===this.count)return this.failTimeout();if(d&&f&&c){if(a.eventType!=Aa)return this.failTimeout();var g=!this.pTime||a.timeStamp-this.pTime<b.interval,h=!this.pCenter||I(this.pCenter,a.center)<b.posThreshold;this.pTime=a.timeStamp,this.pCenter=a.center,h&&g?this.count+=1:this.count=1,this._input=a;var i=this.count%b.taps;if(0===i)return this.hasRequireFailures()?(this._timer=e(function(){this.state=ib,this.tryEmit()},b.interval,this),fb):ib}return kb},failTimeout:function(){return this._timer=e(function(){this.state=kb},this.options.interval,this),kb},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==ib&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),ea.VERSION="2.0.4",ea.defaults={domEvents:!1,touchAction:$a,enable:!0,inputTarget:null,inputClass:null,preset:[[ba,{enable:!1}],[_,{enable:!1},["rotate"]],[ca,{direction:Ha}],[$,{direction:Ha},["swipe"]],[da],[da,{event:"doubletap",taps:2},["tap"]],[aa]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var lb=1,mb=2;fa.prototype={set:function(a){return h(this.options,a),a.touchAction&&this.touchAction.update(),a.inputTarget&&(this.input.destroy(),this.input.target=a.inputTarget,this.input.init()),this},stop:function(a){this.session.stopped=a?mb:lb},recognize:function(a){var b=this.session;if(!b.stopped){this.touchAction.preventDefaults(a);var c,d=this.recognizers,e=b.curRecognizer;(!e||e&&e.state&ib)&&(e=b.curRecognizer=null);for(var f=0;f<d.length;)c=d[f],b.stopped===mb||e&&c!=e&&!c.canRecognizeWith(e)?c.reset():c.recognize(a),!e&&c.state&(fb|gb|hb)&&(e=b.curRecognizer=c),f++}},get:function(a){if(a instanceof V)return a;for(var b=this.recognizers,c=0;c<b.length;c++)if(b[c].options.event==a)return b[c];return null},add:function(a){if(f(a,"add",this))return this;var b=this.get(a.options.event);return b&&this.remove(b),this.recognizers.push(a),a.manager=this,this.touchAction.update(),a},remove:function(a){if(f(a,"remove",this))return this;var b=this.recognizers;return a=this.get(a),b.splice(s(b,a),1),this.touchAction.update(),this},on:function(a,b){var c=this.handlers;return g(r(a),function(a){c[a]=c[a]||[],c[a].push(b)}),this},off:function(a,b){var c=this.handlers;return g(r(a),function(a){b?c[a].splice(s(c[a],b),1):delete c[a]}),this},emit:function(a,b){this.options.domEvents&&ha(a,b);var c=this.handlers[a]&&this.handlers[a].slice();if(c&&c.length){b.type=a,b.preventDefault=function(){b.srcEvent.preventDefault()};for(var d=0;d<c.length;)c[d](b),d++}},destroy:function(){this.element&&ga(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},h(ea,{INPUT_START:ya,INPUT_MOVE:za,INPUT_END:Aa,INPUT_CANCEL:Ba,STATE_POSSIBLE:eb,STATE_BEGAN:fb,STATE_CHANGED:gb,STATE_ENDED:hb,STATE_RECOGNIZED:ib,STATE_CANCELLED:jb,STATE_FAILED:kb,DIRECTION_NONE:Ca,DIRECTION_LEFT:Da,DIRECTION_RIGHT:Ea,DIRECTION_UP:Fa,DIRECTION_DOWN:Ga,DIRECTION_HORIZONTAL:Ha,DIRECTION_VERTICAL:Ia,DIRECTION_ALL:Ja,Manager:fa,Input:y,TouchAction:T,TouchInput:Q,MouseInput:M,PointerEventInput:N,TouchMouseInput:S,SingleTouchInput:O,Recognizer:V,AttrRecognizer:Z,Tap:da,Pan:$,Swipe:ca,Pinch:_,Rotate:ba,Press:aa,on:n,off:o,each:g,merge:i,extend:h,inherit:j,bindFn:k,prefixed:v}),"undefined"!=typeof module&&module.exports,a[c]=ea}(window,document,"Hammer"),function(){"use strict";var a=Autodesk.Viewing;a.EventDispatcher=function(){},a.EventDispatcher.prototype={constructor:a.EventDispatcher,apply:function(b){b.addEventListener=a.EventDispatcher.prototype.addEventListener,b.hasEventListener=a.EventDispatcher.prototype.hasEventListener,b.removeEventListener=a.EventDispatcher.prototype.removeEventListener,b.fireEvent=a.EventDispatcher.prototype.fireEvent,b.dispatchEvent=a.EventDispatcher.prototype.fireEvent},addEventListener:function(a,b){a&&(void 0===this.listeners&&(this.listeners={}),"undefined"==typeof this.listeners[a]&&(this.listeners[a]=[]),this.listeners[a].push(b))},hasEventListener:function(a,b){if(!a)return!1;if(void 0===this.listeners)return!1;var c=this.listeners;return void 0!==c[a]&&c[a].indexOf(b)!==-1},removeEventListener:function(a,b){if(a&&(void 0===this.listeners&&(this.listeners={}),this.listeners[a]instanceof Array))for(var c=this.listeners[a],d=0,e=c.length;d<e;d++)if(c[d]===b){c.splice(d,1);break}},fireEvent:function(a){if(void 0===this.listeners&&(this.listeners={}),"string"==typeof a&&(a={type:a}),!a.target)try{a.target=this}catch(a){}if(!a.type)throw new Error("event type unknown.");if(this.listeners[a.type]instanceof Array)for(var b=this.listeners[a.type].slice(),c=0;c<b.length;c++)b[c].call(this,a)}}}(),"undefined"!=typeof window){var RTCPeerConnection=null,getUserMedia=null,attachMediaStream=null,reattachMediaStream=null,webrtcDetectedBrowser=null,webrtcDetectedVersion=null;if(navigator.mozGetUserMedia)webrtcDetectedBrowser="firefox",webrtcDetectedVersion=parseInt(navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1]),RTCPeerConnection=mozRTCPeerConnection,RTCSessionDescription=mozRTCSessionDescription,RTCIceCandidate=mozRTCIceCandidate,getUserMedia=navigator.mozGetUserMedia.bind(navigator),createIceServer=function(a,b,c){var d=null,e=a.split(":");if(0===e[0].indexOf("stun"))d={url:a};else if(0===e[0].indexOf("turn")&&(a.indexOf("transport=udp")!==-1||a.indexOf("?transport")===-1)){var f=a.split("?");d={url:f[0],credential:c,username:b}}return d},attachMediaStream=function(a,b){console.log("Attaching media stream"),a.mozSrcObject=b,a.play()},reattachMediaStream=function(a,b){console.log("Reattaching media stream"),a.mozSrcObject=b.mozSrcObject,a.play()},MediaStream.prototype.getVideoTracks=function(){return[]},MediaStream.prototype.getAudioTracks=function(){return[]};else if(navigator.webkitGetUserMedia){var match=navigator.userAgent.match(/Chrom(e|ium)\/([0-9]+)\./);webrtcDetectedBrowser="chrome",webrtcDetectedVersion=match?parseInt(navigator.userAgent.match(/Chrom(e|ium)\/([0-9]+)\./)[2]):40,createIceServer=function(a,b,c){var d=null,e=a.split(":");if(0===e[0].indexOf("stun"))d={url:a};else if(0===e[0].indexOf("turn"))if(webrtcDetectedVersion<28){var f=a.split("turn:");d={url:"turn:"+b+"@"+f[1],credential:c}}else d={url:a,credential:c,username:b};return d},RTCPeerConnection=webkitRTCPeerConnection,getUserMedia=navigator.webkitGetUserMedia.bind(navigator),attachMediaStream=function(a,b){"undefined"!=typeof a.srcObject?a.srcObject=b:"undefined"!=typeof a.mozSrcObject?a.mozSrcObject=b:"undefined"!=typeof a.src?a.src=URL.createObjectURL(b):console.log("Error attaching stream to element.")},reattachMediaStream=function(a,b){a.src=b.src},webkitMediaStream.prototype.getVideoTracks||(webkitMediaStream.prototype.getVideoTracks=function(){return this.videoTracks},webkitMediaStream.prototype.getAudioTracks=function(){return this.audioTracks}),webkitRTCPeerConnection.prototype.getLocalStreams||(webkitRTCPeerConnection.prototype.getLocalStreams=function(){return this.localStreams},webkitRTCPeerConnection.prototype.getRemoteStreams=function(){return this.remoteStreams})}else console.log("Browser does not appear to be WebRTC-capable")}!function(){var a=Autodesk.Viewing,b=(a.Private,""),c=!1,d=!1,e=!0;a.HTTP_REQUEST_HEADERS={},a.getApiEndpoint=function(){return b},a.setApiEndpoint=function(a,c,f){b=a,d=c,e=f,e||(d=!1)},a.getViewingUrl=function(a){return e?(a||b)+"/viewingservice/v1":(a||b)+"/derivativeservice/v2"},a.getUseCredentials=function(){return c},a.setUseCredentials=function(a){c=a},a.getManifestApi=function(b){var c=a.getViewingUrl(b);return d?c+"/bubbles/":e?c+"/":c+"/manifest/"},a.getItemApi=function(b){return e?a.getViewingUrl(b)+"/items/":a.getViewingUrl(b)+"/derivatives/"},a.getThumbnailApi=function(b){return a.getViewingUrl(b)+"/thumbnails/"},a.makeOssPath=function(a,c,d){return(a||b)+"/oss/v2/buckets/"+c+"/objects/"+encodeURIComponent(decodeURIComponent(d))}}(),function(){var a=Autodesk.Viewing,b=a.Private,c=a.getGlobal();c.PROTEIN_ROOT=null,c.PRISM_ROOT=null,c.LOCALIZATION_REL_PATH="",c.LMV_VIEWER_VERSION="@build_version@",c.LMV_VIEWER_PATCH="@build_number@",c.LMV_BUILD_TYPE="@build_type@",c.LMV_RESOURCE_VERSION=null,c.LMV_RESOURCE_ROOT="",c.LMV_THIRD_PARTY_COOKIE=void 0,"v"===LMV_VIEWER_VERSION.charAt(0)&&(LMV_VIEWER_VERSION=LMV_VIEWER_VERSION.substr(1)),c.stderr=function(){console.warn('"stderr" is deprecated; please use "Autodesk.Viewing.Private.logger" instead')},b.env=null,b.docItemId=null,b.token={accessToken:null,getAccessToken:null,tokenRefreshInterval:null},b.memoryOptimizedSvfLoading=!1,b.forceMemoryOptimizedModeOnSvfLoading=!1,b.assets=[],b.offline=!1,b.offlineResourcePrefix=null;var d={local:{RTC:["https://rtc-dev.api.autodesk.com:443","https://lmv.autodesk.com:443"]},dev:{RTC:["https://rtc-dev.api.autodesk.com:443","https://lmv.autodesk.com:443"]},stg:{RTC:["https://rtc-stg.api.autodesk.com:443","https://lmv.autodesk.com:443"]},prod:{RTC:["https://rtc.api.autodesk.com:443","https://lmv.autodesk.com:443"]}},e={local:"",dev:"https://viewing-dev.api.autodesk.com",stg:"https://viewing-staging.api.autodesk.com",prod:"https://viewing.api.autodesk.com"},f={local:"",dev:"https://developer-dev.api.autodesk.com",stg:"https://developer-stg.api.autodesk.com",prod:"https://developer.api.autodesk.com"},g={stg:{CLIENT_ID:"lmv-stag",CLIENT_KEY:"kjemi1rwAgsqIqyvDUtc9etPD6MsAzbV",ENDPOINT:"https://ase-stg.autodesk.com"},prod:{CLIENT_ID:"lmv-prod",CLIENT_KEY:"iaoUM2CRGydfn703yfPq4MAogZi8I5u4",ENDPOINT:"https://ase.autodesk.com"}};b.EnvironmentConfigurations={Local:{ROOT:"",LMV:d.local},Development:{ROOT:e.dev,LMV:d.dev,bubbleManifest:!0},Staging:{ROOT:e.stg,LMV:d.stg,bubbleManifest:!0},Production:{ROOT:e.prod,LMV:d.prod,bubbleManifest:!0},AutodeskDevelopment:{ROOT:f.dev,LMV:d.dev},AutodeskStaging:{ROOT:f.stg,LMV:d.stg},AutodeskProduction:{ROOT:f.prod,LMV:d.prod}},b.initializeEnvironmentVariable=function(a){var c;if(a&&a.env&&(c=a.env),c||(c=b.getParameterByName("env")),a&&a.offlineResourcePrefix&&(b.offlineResourcePrefix=a.offlineResourcePrefix),a&&a.offline&&"true"===a.offline&&(b.offline=!0),!c)switch(window.location.hostname){case"viewing-dev.api.autodesk.com":c="Development";break;case"viewing-staging.api.autodesk.com":c="Staging";break;case"viewing.api.autodesk.com":c="Production";break;case"developer-dev.api.autodesk.com":c="AutodeskDevelopment";break;case"developer-stg.api.autodesk.com":c="AutodeskStaging";break;case"developer.api.autodesk.com":c="AutodeskProduction";break;case"localhost.autodesk.com":c="Local";break;case"":c="Local";break;case"127.0.0.1":c="Local";break;default:c="AutodeskProduction"}b.ENABLE_TRACE&&("undefined"!=typeof window&&console.log("Host name : "+window.location.hostname),console.log("Environment initialized as : "+c)),b.env=c},b.initializeServiceEndPoints=function(c){var d=c.endpoint,e=c.bubbleManifest,f=!c.useDerivativeServiceV2;if(!d){var g=b.EnvironmentConfigurations[b.env];d=g.ROOT,e=g.bubbleManifest&&f}if(a.setApiEndpoint(d,e,f),!a.isNodeJS){var h=["viewer3D.js","viewer3D.min.js","firefly.js","firefly.min.js"];c&&c.hasOwnProperty("libraryName")&&h.push(c.libraryName);for(var i,j,k=0;k<h.length;k++){var l=b.getScript(h[k]);j=l?l.src:"";var m=j.indexOf(h[k]);if(m>=0){i=j.substr(0,m);break}}LMV_RESOURCE_VERSION="v"+LMV_VIEWER_VERSION;var n=b.getParameterByNameFromPath("v",j);n&&n.length&&n!=LMV_RESOURCE_VERSION?(console.warn("Version string mismatch between requested and actual version: "+n+" vs. "+LMV_RESOURCE_VERSION+". Using "+n),LMV_RESOURCE_VERSION=n):n&&n.length||(LMV_RESOURCE_VERSION=null,console.info("No viewer version specified, will implicitly use "+LMV_VIEWER_VERSION)),LMV_RESOURCE_ROOT=i||LMV_RESOURCE_ROOT}},b.initLoadContext=function(b){b=b||{},b.auth=a.getUseCredentials(),b.endpoint=a.getApiEndpoint(),b.headers||(b.headers={});for(var c in a.HTTP_REQUEST_HEADERS)b.headers[c]=a.HTTP_REQUEST_HEADERS[c];return b},b.refreshCookie=function(c,d,e){var f=new XMLHttpRequest;if(f.onload=d,f.onerror=e,f.ontimeout=e,0===b.env.indexOf("Autodesk")){var g=b.EnvironmentConfigurations[b.env].ROOT;f.open("POST",g+"/utility/v1/settoken",!0),f.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),f.withCredentials=!0,f.send("access-token="+c),a.isIE11&&(b.accessToken=c)}else{var c={oauth:{token:c}};f.open("POST",a.getViewingUrl()+"/token",!0),f.setRequestHeader("Content-Type","application/json"),f.withCredentials=!0,f.send(JSON.stringify(c))}},b.refreshRequestHeader=function(b){a.HTTP_REQUEST_HEADERS.Authorization="Bearer "+b},b.refreshToken=function(a,c,d){
function e(){LMV_THIRD_PARTY_COOKIE?b.refreshCookie(a,c,d):(b.refreshRequestHeader(a),c())}b.token.accessToken=a,void 0===LMV_THIRD_PARTY_COOKIE?b.refreshCookie(a,c,d):e()},b.initializeAuth=function(c,d){function e(a,f){h=a,b.refreshToken(h,b.token.tokenRefreshInterval?null:c);var g=f-60;g<=0&&(g=f),b.token.tokenRefreshInterval=1e3*g,setTimeout(function(){d.getAccessToken(e)},b.token.tokenRefreshInterval)}var f=d?d.shouldInitializeAuth:void 0;if(void 0===f){var g=b.getParameterByName("auth");f="false"!==g.toLowerCase()}if("Local"==b.env||!f)return setTimeout(c,0),a.setUseCredentials("undefined"!=typeof d.useCredentials&&d.useCredentials),a.getUseCredentials();a.isNodeJS&&(LMV_THIRD_PARTY_COOKIE=!1),a.setUseCredentials("undefined"==typeof d.useCredentials||d.useCredentials);var h;return d&&d.getAccessToken?(b.token.getAccessToken=d.getAccessToken,h=d.getAccessToken(e),"string"==typeof h&&h&&b.refreshToken(h,c)):d&&d.accessToken?(h=d.accessToken,b.refreshToken(h,c)):(h=b.getParameterByName("accessToken"),h||(h="9AMaRKBoPCIBy61JmQ8OLLLyRblS",b.logger.warn("Warning : no access token is provided. Use built in token : "+h)),b.refreshToken(h,c)),a.getUseCredentials()},b.initializeLogger=function(c){var d={eventCallback:c?c.eventCallback:void 0};if(b.logger.initialize(d),!(c&&c.hasOwnProperty("useADP")&&0==c.useADP||a.isNodeJS)){var e="https://ase-cdn.autodesk.com/adp/v1.0.3/js/adp-web-analytics-sdk.min.js",f=function(){if("undefined"==typeof Adp)return void b.logger.warn("Autodesk Data Platform SDK not found");var a;switch(LMV_BUILD_TYPE){case"Production":a=g.prod;break;default:a=g.stg}var c={product:{name:"LMV",line_name:"LMV",key:a.CLIENT_ID,id:a.CLIENT_KEY,id_provider:"appkey",build_id:LMV_VIEWER_VERSION+"."+LMV_VIEWER_PATCH,build_tag:LMV_BUILD_TYPE}},d={server:a.ENDPOINT,enable_geo_data:!1,enable_browser_data:!0,enable_session_messages:!0};b.logger.adp=new Adp(c,d)};"undefined"!=typeof requirejs?requirejs([e],function(a){window.Adp=a,f()}):b.loadDependency("Adp",e,f)}},b.initializeProtein=function(){if((!b.ENABLE_DEBUG||"Local"!=b.env||a.getUseCredentials())&&!b.offline){var c=new XMLHttpRequest;c.open("GET","https://raas-assets.autodesk.com/StaticContent/BaseAddress?family=protein",!0),c.responseType="json",c.onload=function(a){var d=c.response.url;d&&d.length&&(d=d.replace("http://","https://"),PROTEIN_ROOT=d+"/",b.logger.info("Protein root is: "+PROTEIN_ROOT))},c.send();var d=new XMLHttpRequest;d.open("GET","https://raas-assets.autodesk.com/StaticContent/BaseAddress?family=prism",!0),d.responseType="json",d.onload=function(a){var c=d.response.url;c&&c.length&&(c=c.replace("http://","https://"),PRISM_ROOT=c+"/",b.logger.info("Prism root is: "+PRISM_ROOT))},d.send()}},b.getParameterByName=function(a){return"undefined"==typeof window?"":b.getParameterByNameFromPath(a,window.location.href)},b.getParameterByNameFromPath=function(a,b){a=a.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var c="[\\?&]"+a+"=([^&#]*)",d=new RegExp(c),e=d.exec(b);return null==e?"":decodeURIComponent(e[1].replace(/\+/g," "))},b.urlIsApiViewingOrDev=function(a){return a.indexOf("developer.api.autodesk.com")!==-1||a.indexOf("developer-stg.api.autodesk.com")!==-1||a.indexOf("developer-dev.api.autodesk.com")!==-1||a.indexOf("viewing.api.autodesk.com")!==-1||a.indexOf("viewing-staging.api.autodesk.com")!==-1||a.indexOf("viewing-dev.api.autodesk.com")!==-1},b.getDemoDocumentURN=function(){var a;switch(b.env){case"Development":a="urn:dXJuOmFkc2suYTM2MGJldGFkZXY6ZnMuZmlsZTplbnRlcnByaXNlLmxtdnRlc3QuRFM1YTczMFFUYmYwMDIyZDA3NTFhYmE5MjZlZDZkMjJlZDY0P3ZlcnNpb249MQ==";break;case"Staging":a="urn:dXJuOmFkc2suczM6ZGVyaXZlZC5maWxlOlZpZXdpbmdTZXJ2aWNlVGVzdEFwcC91c2Vycy9NaWNoYWVsX0hhbicvTU0zNTAwQXNzZW1ibHkuZHdm";break;case"Production":a="FIXME";break;default:a="https://lmv.rocks/viewer/data/gears/output/bubble.json"}return a},b.setLanguage=function(a,b){var c={lng:a,resGetPath:"res/locales/__lng__/__ns__.json",ns:{namespaces:["allstrings"],defaultNs:"allstrings"},fallbackLng:"en",debug:!1};LOCALIZATION_REL_PATH="res/locales/"+a+"/",Autodesk.Viewing.i18n.init(c,function(a){Autodesk.Viewing.i18n.clearDebugLocString(),b&&b()})},b.initializeLocalization=function(a){var c=a&&a.language||navigator.language,d=c.split("-");c=d.length>1?d[0].toLowerCase()+"-"+d[1].toUpperCase():d[0].toLowerCase();var e=["cs","de","en","es","fr","it","ja","ko","pl","pt-BR","ru","tr","zh-HANS","zh-HANT"];e.indexOf(c)===-1&&(c=c.indexOf("zh-CN")>-1?"zh-HANS":c.indexOf("zh-TW")>-1?"zh-HANT":d.length>1&&e.indexOf(d[0])>-1?d[0]:"en"),b.setLanguage(c)},b.initializeUserInfo=function(a){a&&a.userInfo&&(b.setUserName(a.userInfo.name),a.comment2Token&&(b.comment2Token=a.comment2Token))},b.getScript=function(a){a=a.toLowerCase();var b=document.getElementsByTagName("SCRIPT");if(b&&b.length>0)for(var c=0;c<b.length;++c)if(b[c].src&&b[c].src.toLowerCase().indexOf(a)!==-1)return b[c];return null},b.getResourceUrl=function(a){var b=LMV_RESOURCE_VERSION;return LMV_RESOURCE_ROOT+a+(b?"?v="+b:"")},b.loadDependency=function(a,c,d){if("undefined"==typeof window[a]){var e=document.createElement("SCRIPT");e.src=c.indexOf("://")>0?c:b.getResourceUrl(c),document.head.appendChild(e),d&&(e.onload=d)}else d&&d()},Autodesk.Viewing.Initializer=function(c,d){function e(){b.initializeLegacyNamespaces(!1),THREE.warn=b.logger.warn.bind(b.logger),init_three_dds_loader(),init_three_pvr_loader(),b.initializeAuth(d,c),b.initializeLocalization(c),b.initializeUserInfo(c)}a.isNodeJS?(b.initializeEnvironmentVariable(c),b.initializeServiceEndPoints(c),b.initializeLogger(c),b.initializeAuth(d,c)):(b.WEBGL_HELP_LINK=c?c.webGLHelpLink:null,b.initializeEnvironmentVariable(c),b.initializeServiceEndPoints(c),b.initializeLogger(c),b.initializeProtein(),b.initWorkerScript(),b.loadDependency("THREE","three.min.js",function(){b.loadDependency("WGS","Local"===b.env?"wgs.js":"wgs.min.js",e)}))}}(),function(){"use strict";function a(a,b){function e(){return c.config.userName&&c.config.userName.length?c.config.userName:p?p.slice(0,5):"Unknown"}function f(a){switch(a.type){case"txt":j(a);break;case"joinok":i(a);break;case"join_error":break;case"sessionId":c.logger.info("Connect successful, your id is: "+a.id),p=a.id;break;case"joined":a.userStatus="joined",g(a);break;case"left":a.userStatus="left",h(a);break;case"camera":case"pointer":break;default:c.logger.log(a)}var b=a.roomId,d={type:o[a.type],data:a,channelId:b};u.dispatchEvent(d)}function g(a){if(a.user.name&&a.user.name.length||(a.user.name=a.user.id.slice(0,5)),a.roomId){var b=t[a.roomId];b?(b.users.push(a.user),c.logger.info(a.user+" joined room "+a.roomId)):c.logger.warn("Channel "+a.roomId+" does not exist for socket "+p)}}function h(a){c.logger.info(a.user+" left room "+a.room);for(var b in t){for(var d=t[b].users,e=-1,f=0;f<d.length;f++)if(d[f].id==a.user){e=f;break}e!=-1&&d.splice(e,1),delete t[b].userSet[a.user]}}function i(a){var b=t[a.roomId];c.logger.info("joined channel "+a.roomId),a.users&&a.users.length?b.users=a.users:b.users=[];for(var d=0;d<b.users.length;d++)b.users[d].name&&b.users[d].name.length||(b.users[d].name=b.users[d].id.slice(0,5));var f=e(),g=Autodesk.Viewing.i18n.translate("you"),h={id:p,name:f+" ("+g+")",isSelf:!0,status:0};b.userSet[p]||(b.users.push(h),b.userSet[p]=h),0!=h.id.indexOf(f)&&u.sendChatMessage("/nick "+f,a.roomId)}function j(a){if(0==a.msg.indexOf("/nick ")){var b=u.getUserById(a.from,a.roomId),c=a.msg.slice(6);if(c.length&&(b.name=c,b.id==p)){var d=Autodesk.Viewing.i18n.translate("you");b.name+=" ("+d+")"}u.dispatchEvent({type:"userListChange",data:a,channelId:a.roomId})}}function k(a){r<q.length?(c.logger.info("Connect failed, trying another server..."),n.disconnect(),n=null,r++,u.connect(u.sessionID)):u.dispatchEvent({type:"socketError",data:a})}function l(a){u.dispatchEvent({type:"socketError",data:a})}function m(a){r=0;for(var b in s)u.join(b)}var n,o={camera:"cameraChange",pointer:"pointerMove",joystick:"joystick",state:"viewerState",txt:"chatReceived",joinok:"userListChange",sessionId:"connectSucceeded",joined:"userListChange",left:"userListChange",private:"privateMessage",join_error:"socketError"},p=null,q=Array.isArray(a)?a:[a],r=0,s={},t={},u=this;this.connect=function(a){if(!n)return"undefined"!=typeof window.WebSocket&&(d||(d="undefined"!=typeof lmv_io?lmv_io:io),this.sessionID=a,n=d.connect(q[r]+"?sessionID="+a,{path:b,forceNew:!0}),n.on("connect",m),n.on("message",f),n.on("connect_error",k),n.on("error",l),!0)},this.join=function(a){return n&&n.connected?(delete s[a],t[a]={id:a,users:[],userSet:{}},void n.emit("join",{roomId:a,name:e()})):void(s[a]=1)},this.disconnect=function(){n&&(n.disconnect(),n=null,t={},p=null)},this.sendMessage=function(a,b,c){var d={type:a,from:p,msg:b,roomId:c};n.emit("message",d)},this.sendPrivateMessage=function(a,b){var c={type:"private",target:a,from:p,msg:b};n.emit("message",c)},this.sendChatMessage=function(a,b){var c={type:"txt",from:p,msg:a,roomId:b};n.emit("message",c),f(c)},this.getUserById=function(a,b){for(var c=t[b].users,d=0;d<c.length;d++)if(c[d].id==a)return c[d];return null},this.getLocalId=function(){return p},this.getChannelInfo=function(a){return t[a]},this.isConnected=function(){return n}}var b=Autodesk.Viewing,c=b.Private;c.config={userName:""},c.setUserName=function(a){c.config.userName=a};var d;a.prototype.constructor=a,b.EventDispatcher.prototype.apply(a.prototype);var e={};a.GetInstance=function(a,b){a||(a=c.EnvironmentConfigurations[c.env].LMV.RTC),Array.isArray(a)||(a=[a]);var d=e[a[0]];return d?d:(d=new c.MessageClient(a,b),e[a[0]]=d,d)},Autodesk.Viewing.Private.MessageClient=a}(),AutodeskNamespace("Autodesk.Viewing.Private"),function(){var a=Autodesk.Viewing,b=a.Private;b.P2PClient=function(a){function c(a){try{k=new RTCPeerConnection(t),k.onicecandidate=function(a){a.candidate?q.sendPrivateMessage(l,{type:"candidate",label:a.candidate.sdpMLineIndex,id:a.candidate.sdpMid,candidate:a.candidate.candidate}):b.logger.log("End of candidates.")},k.ondatachannel=function(a){b.logger.log("Data channel added."),o=a.channel,o.onmessage=h,p.dispatchEvent({type:"dataChannelAdded",data:a.channel})},k.onaddstream=function(a){b.logger.log("Remote stream added."),n=a.stream,p.dispatchEvent({type:"remoteStreamAdded",data:a.stream})},k.onremovestream=function(a){b.logger.log("Remote stream removed. Event: ",a),n=null,p.dispatchEvent({type:"remoteStreamRemoved",data:a.stream})},a&&(o=k.createDataChannel("sendDataChannel",{reliable:!1,ordered:!1}),o.onmessage=h)}catch(a){return b.logger.error("Failed to create PeerConnection, exception: "+a.message),void alert("Cannot create RTCPeerConnection object.")}}function d(a){b.logger.error("createOffer() error: ",e)}function f(a){if(k.setLocalDescription(a),q.sendPrivateMessage(l,a),s.length){for(var b=0;b<s.length;b++)k.addIceCandidate(s[b]);s=[]}}function g(a){for(var b=a.split("\n"),c=!1,d=!1,e=!1,f=0;f<b.length;f++)0==b[f].indexOf("a=mid:data")&&(c=!0),0==b[f].indexOf("a=mid:video")&&(e=!0),0==b[f].indexOf("a=mid:audio")&&(d=!0);return c&&!e&&!d}function h(a){var b=JSON.parse(a.data);switch(b.type){case"camera":p.dispatchEvent({type:"cameraChange",data:b});break;case"joystick":p.dispatchEvent({type:"joystick",data:b});break;case"state":p.dispatchEvent({type:"viewerState",data:b})}}function i(a){var c=a.data.msg;if(b.logger.debug("Client received message:"+JSON.stringify(c)),"offer"!=c.type||r)if("answer"===c.type&&r)k.setRemoteDescription(new RTCSessionDescription(c));else if("candidate"===c.type){var d=new RTCIceCandidate({sdpMLineIndex:c.label,candidate:c.candidate});r?k.addIceCandidate(d):s.push(d)}else"bye"===c&&r&&(p.dispatchEvent({type:"remoteHangup",data:null}),b.logger.info("Session terminated."),j());else b.logger.log("Received offer. Accepting."),p.receiveCall(a.data)}function j(){r=!1,k.close(),k=null,m=null,n=null,l=null}var k,l,m,n,o,p=this,q=a,r=!1,s=[],t={iceServers:[{url:"stun:stun.l.google.com:19302"}]},u={mandatory:{OfferToReceiveAudio:!0,OfferToReceiveVideo:!0}},v={mandatory:{OfferToReceiveAudio:!1,OfferToReceiveVideo:!1}};q.addEventListener("privateMessage",i),this.hangup=function(){b.logger.log("Hanging up."),r&&(q.sendPrivateMessage(l,"bye"),j())},this.initUserMedia=function(a){function c(c){b.logger.log("Adding local stream."),a&&a(c),p.dispatchEvent({type:"localStreamAdded",data:c})}function d(a){b.logger.error("getUserMedia error: ",a)}var e={video:!0,audio:!0};window.getUserMedia(e,c,d),b.logger.log("Getting user media with constraints",e)},this.callUser=function(a,e){return l?void b.logger.warn("Already in a call. Ignoring call request."):(l=a,b.logger.info("Calling user "+l),void(e?(c(!0),r=!0,b.logger.log("Sending data channel offer to peer"),k.createOffer(f,d)):this.initUserMedia(function(a){m=a,r||"undefined"==typeof m||(c(!1),k.addStream(m),r=!0,b.logger.log("Sending audio/video offer to peer"),k.createOffer(f,d))})))},this.receiveCall=function(a){l=a.from,l||(l=a.senderId);var d=a.msg.sdp;g(d)?(c(!0),r=!0,k.setRemoteDescription(new RTCSessionDescription(a.msg)),b.logger.log("Sending data-only answer to peer."),k.createAnswer(f,null,v)):this.initUserMedia(function(d){m=d,r||"undefined"==typeof m||(c(!1),k.addStream(m),r=!0),k.setRemoteDescription(new RTCSessionDescription(a.msg)),b.logger.log("Sending audio+video answer to peer."),k.createAnswer(f,null,u)})},this.getCurrentCallTarget=function(){return l},this.dataChannel=function(){return o}},b.P2PClient.prototype.constructor=b.P2PClient,Autodesk.Viewing.EventDispatcher.prototype.apply(b.P2PClient.prototype)}(),AutodeskNamespace("Autodesk.Viewing.Private.Collaboration"),function(){var a=Autodesk.Viewing,b=(a.Extensions,a.Private),c=b.Collaboration;c.JoyStick=function(a,b,c){function d(a,b,c){return a>c?c:a<b?b:a}function e(){if(h=document.createElement("div"),h.classList.add("joystickOuterRing"),b.appendChild(h),i=document.createElement("div"),i.classList.add("joystickInnerRing"),c){var a=document.createElement("span");a.classList.add("buttonText"),a.textContent=c,i.appendChild(a)}b.appendChild(i)}function f(){g=new Hammer.Manager(b,{recognizers:[[Hammer.Tap,{event:"singletap"}],[Hammer.Tap,{event:"doubletap",taps:2,interval:500,threshold:6,posThreshold:30}],[Hammer.Pan,{event:"drag",pointers:1}]]}),g.on("dragstart",j.dragStart),g.on("dragmove",j.dragMove),g.on("dragend",j.dragEnd),g.on("singletap",j.onSingleTap),g.on("doubletap",j.onDoubleTap)}var g,h,i,j=this,k=this.position=[0,0],l=.7,m=.2;this.dragStart=function(a){},this.dragMove=function(c){var e=(c.center.x-b.offsetLeft)/b.offsetWidth,f=(c.center.y-b.offsetTop)/b.offsetHeight;e=d(e,0,1),f=d(f,0,1),e=2*e-1,f=-(2*f-1);var g=Math.sqrt(e*e+f*f);e/=g,f/=g;var h=g/l;h=d(h,0,1),k[0]=e*h,k[1]=f*h,a.sendState();var j=.5*(k[0]*l)+.5,n=.5*(-k[1]*l)+.5;i.style.left=100*j-50*m+"%",i.style.top=100*n-50*m+"%"},this.dragEnd=function(b){k[0]=0,k[1]=0,a.sendState(),i.style.left="40%",i.style.top="40%"},this.onSingleTap=function(a){},this.onDoubleTap=function(a){},e(),f()},c.Slider=function(a,b,c){function d(a,b,c){return a>c?c:a<b?b:a}function e(){g=document.createElement("div"),g.classList.add("sliderBody"),b.appendChild(g),h=document.createElement("div"),h.classList.add("sliderThumb");var a=document.createElement("span");a.classList.add("buttonText"),a.style.fontSize="xx-small",a.textContent=c,h.appendChild(a),b.appendChild(h)}function f(){"ontouchstart"in window&&(i=new Hammer.Manager(b,{recognizers:[[Hammer.Tap,{event:"singletap"}],[Hammer.Pan,{event:"drag",pointers:1}]]}),i.on("dragstart",j.dragStart),i.on("dragmove",j.dragMove),i.on("dragend",j.dragEnd))}var g,h,i,j=this,k=j.position=0;this.dragStart=function(a){},this.dragMove=function(c){var e=(c.center.y-b.offsetTop)/b.offsetHeight;e=d(e,0,1),e=-(2*e-1),j.position=k=e,console.log(k),a.sendState();var f=.5*-k+.5;h.style.top=100*f-5+"%"},this.dragEnd=function(b){h.style.top="45%",j.position=k=0,a.sendState()},this.updateLayout=function(a){b.style.bottom=.125*a+"px",b.style.left=.46*a+"px",b.style.width=.08*a+"px",b.style.height=.25*a+"px",g.style.borderRadius=.02*a+"px",h.style.borderRadius=.02*a+"px"},e(),f()},c.RemoteControl=function(a){function d(){v.showNotification(!1)}function e(){function b(a,b,c){var f=.1*d;a.style.width=f+"px",a.style.height=f+"px",a.style.borderRadius=.5*f+"px",b?(a.style.left=d*a.anchorX-f+"px",a.tipText.style.right=d-a.offsetLeft+"px"):(a.style.left=d*a.anchorX+"px",a.tipText.style.left=a.offsetLeft+f+"px"),c?(a.style.bottom=.95*e-f+"px",a.tipText.style.bottom=.95*e-a.tipText.offsetHeight+"px"):(a.style.bottom=.05*e+"px",a.tipText.style.bottom=.05*e+"px")}var c=a.getBoundingClientRect(),d=c.right-c.left,e=.5*d;g.style.width=.5*d+"px",g.style.height=.5*d+"px",h.style.width=.5*d+"px",h.style.height=.5*d+"px",s.updateLayout(d),b(l,!0,!0),b(m,!1,!0),b(n,!1,!1),b(o,!0,!1),b(p,!1,!0),b(q,!0,!0)}function f(){function b(a,b,c,d,e){var f=document.createElement("div");f.classList.add("joystickButton"),f.style.backgroundColor=c;var g=document.createElement("span");g.classList.add("buttonText"),g.innerHTML=b,f.appendChild(g),f.onclick=function(a){v.sendState(d),f.classList.add("clicked")};var h=document.createElement("div");return h.classList.add("tipText"),h.textContent=e,f.tipText=h,a.appendChild(f),a.appendChild(h),f}g=document.createElement("div"),g.style.position="absolute",g.style.left="0%",g.style.bottom="0%",a.appendChild(g),h=document.createElement("div"),h.style.position="absolute",h.style.right="0%",h.style.bottom="0%",a.appendChild(h),l=b(a,"R","blue","gohome","RESET VIEW"),l.anchorX=.475,m=b(a,"S","red","select","SELECT"),m.anchorX=.525,n=b(a,"H","yellow","hide","HIDE"),n.anchorX=.525,o=b(a,"A","green","fly","AUTO MOVE"),o.anchorX=.475,p=b(a,"&#9733","#ff7700","savepoint","SAVE"),p.anchorX=.025,q=b(a,"&#9654","#ff7700","nextsavepoint","NEXT"),q.anchorX=.975,"ondeviceorientation"in window,window.addEventListener("orientationchange",e),window.addEventListener("resize",e),j=new c.JoyStick(v,g,"W"),k=new c.JoyStick(v,h,"L"),i=document.createElement("div"),i.style.position="absolute",i.style.left="45%",i.style.width="10%",i.style.height="50%",a.appendChild(i),s=new c.Slider(v,i,"EXPLODE")}var g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v=this;this.connect=function(a){this.showNotification(!0,"CONTACTING MOTHERSHIP","cyan"),t=b.MessageClient.GetInstance(),t.connect(),t.join(a),u=new b.P2PClient(t),u.addEventListener("dataChannelAdded",d);var c=function(a){var b=t.getChannelInfo(a.channelId).users;if(b&&2==b.length&&!u.getCurrentCallTarget()){v.showNotification(!0,"INITIATING DIRECT LINK","green");var c=b[0];c.id==t.getLocalId()&&(c=b[1]),u.callUser(c.id,!0)}else u.getCurrentCallTarget()&&(console.log("Unexpected user event."),console.log(a.data))};t.addEventListener("userListChange",c)},this.sendState=function(a){var b={x1:j.position[0],y1:j.position[1],x2:k.position[0],y2:k.position[1],explode:s.position};a&&(console.log(a),b.command=a);var c=u?u.dataChannel():null;c&&"open"==c.readyState?(r&&d(),c.send(JSON.stringify({type:"joystick",msg:b}))):r||this.showNotification(!0)},this.showNotification=function(b,c,d){if(b){r&&a.removeChild(r),r=document.createElement("div"),r.classList.add("errorBox");var e=document.createElement("span");e.classList.add("errorText"),e.classList.add("blink");var f=Autodesk.Viewing.i18n.translate("DISCONNECTED"),g=Autodesk.Viewing.i18n.translate("Reload main viewer and pair again");e.innerHTML=c?Autodesk.Viewing.i18n.translate(c):"<p>"+f+"</p> "+g,d&&(e.style.color=d),r.appendChild(e),a.appendChild(r)}else r&&(a.removeChild(r),r=null)},f(),e()}}();